{"version":3,"file":"components.build.js","sources":["../../../../src/js/components/dom-load.js","../../../../src/js/components/component.js","../../../../src/js/components/magnifying-glass.js","../../../../src/js/lib/utils.js","../../../../src/js/components/media/media.js","../../../../src/js/components/media/audio-player.js","../../../../src/js/components/svg-lib/svg-dragndrop.js","../../../../src/js/components/svg-lib/svg-draw.js","../../../../src/js/components/svg-lib/svg-text.js","../../../../src/js/components/svg.js","../../../../src/js/components/sortable.js","../../../../src/js/components/svg-lib/svg-radial-menu.js","../../../../src/js/components/editor/selectionMenu.js","../../../../src/js/components/editor/writtingMenu.js","../../../../src/js/components/editor/schema.js","../../../../src/js/components/editor/editor.js","../../../../src/js/components/keywords.js","../../../../src/js/components/test-quiz.js","../../../../src/js/components/fullscreen.js","../../../../src/js/components/user-text.js","../../../../src/js/components/media/audio-player-normal.js","../../../../src/js/components/media/audio-player-simple.js","../../../../src/js/components/fake-map.js","../../../../src/js/components/media/video.js","../../../../src/js/components/selectable.js","../../../../src/js/components/new-table.js","../../../../src/js/components/draggable.js","../../../../src/js/components/gallery.js","../../../../src/js/components/window-load.js","../../../../src/js/components/components.js","../../../../src/js/lib/unsupported-browsers.js"],"sourcesContent":["\r\nconst domLoadComponents = () => {\r\n  console.log('domLoad:components');\r\n\r\n  // instantiate\r\n\r\n  // run\r\n\r\n};\r\n\r\nexport default domLoadComponents;\r\n","export default class Component {\r\n  constructor($element) {\r\n    this.target = $element;\r\n    this.$slide = this.target.closest('.slide');\r\n    this.lang = document.documentElement.getAttribute('lang');\r\n\r\n    if (!HISTORYLAB.import.done) {\r\n\r\n      if (this.$slide) {\r\n        this.$buttonFeedback = this.$slide.querySelector('[data-feedback-button]');\r\n\r\n        if (this.$buttonFeedback) {\r\n          this.$buttonFeedbackText = this.$buttonFeedback.querySelector('span');\r\n        }\r\n      }\r\n\r\n\r\n      this.showFeedback = this.showFeedback.bind(this);\r\n    }\r\n  }\r\n\r\n  showFeedback() {\r\n    if (this.$buttonFeedback && this.$buttonFeedback.classList.contains('button-hidden')) {\r\n      this.$buttonFeedback.classList.remove('button-hidden');\r\n    }\r\n  }\r\n\r\n  hideFeedback() {\r\n    this.$buttonFeedback.classList.add('button-hidden');\r\n  }\r\n}\r\n","import Component from './component';\r\n\r\nexport default class MagnifyingGlass extends Component {\r\n  // https://www.youtube.com/watch?v=e8IwM3iqnL0\r\n  constructor($element) {\r\n    super($element);\r\n    // SVG lupa a ještě dynamicky měnícího se SVG,\r\n    // který není na počátku známé?\r\n    // if (el.nodeName === 'svg') {\r\n    //   console.log('SVG');\r\n    //   el.children[0].getAttribute('xlink:href')\r\n    // }\r\n    this.$element = document.querySelector('[data-lupa]');\r\n    this.$canvas = document.querySelector('[data-lupa-canvas]');\r\n    this.ctx = this.$canvas.getContext('2d');\r\n\r\n    this._onStart = this._onStart.bind(this);\r\n    this._onMove = this._onMove.bind(this);\r\n    this._onEnd = this._onEnd.bind(this);\r\n    this._update = this._update.bind(this);\r\n    this._onResize = this._onResize.bind(this);\r\n\r\n    this.zoomGlassSize = 230;\r\n    this.targetBCR = null;\r\n    this.zoomed = 0;\r\n    this.targetZoomed = 0;\r\n\r\n    this.x = 0;\r\n    this.y = 0;\r\n    this.trackingTouch = false;\r\n    this.displayStyle = '';\r\n\r\n    this._addEventListeners();\r\n    this._initCanvas();\r\n    this._onResize();\r\n\r\n    window.requestAnimationFrame(this._update);\r\n  }\r\n\r\n  _initCanvas() {\r\n    const width = this.zoomGlassSize;\r\n    const height = this.zoomGlassSize;\r\n    // if retina makes canvas more dense\r\n    const dPR = window.devicePixelRation || 1;\r\n    this.$canvas.width = width * dPR;\r\n    this.$canvas.height = height * dPR;\r\n\r\n    this.$canvas.style.width = `${width}px`;\r\n    this.$canvas.style.height = `${height}px`;\r\n\r\n    this.ctx.scale(dPR, dPR);\r\n  }\r\n\r\n  _onResize() {\r\n    this.targetBCR = this.target.getBoundingClientRect();\r\n  }\r\n\r\n  _onStart(event) {\r\n    this.displayStyle = getComputedStyle(this.$element).display;\r\n    if (event.target !== this.target || this.displayStyle === 'none') {\r\n      return;\r\n    }\r\n\r\n    event.preventDefault();\r\n    this.x = event.pageX || event.touches[0].pageX;\r\n    this.y = event.pageY || event.touches[0].pageY;\r\n\r\n    this.trackingTouch = true;\r\n    this.targetZoomed = 1;\r\n    this.zoomed = 0;\r\n\r\n    window.requestAnimationFrame(this._update);\r\n  }\r\n\r\n  _onMove(event) {\r\n    if (!this.trackingTouch || this.displayStyle === 'none') {\r\n      return;\r\n    }\r\n\r\n    this.x = event.pageX || event.touches[0].pageX;\r\n    this.y = event.pageY || event.touches[0].pageY;\r\n  }\r\n\r\n  _onEnd() {\r\n    if (this.targetZoomed) {\r\n      // show OK button or feedback\r\n      this.showFeedback();\r\n    }\r\n\r\n    this.targetZoomed = 0;\r\n    this.trackingTouch = false;\r\n  }\r\n\r\n  _update() {\r\n    const TAU = Math.PI * 2;\r\n    const MAX_RADIUS = 100;\r\n    const radius = this.zoomed * MAX_RADIUS;\r\n\r\n    this.targetBCR = this.target.getBoundingClientRect();\r\n\r\n    // local coordinates (ratio <0,1>)\r\n    const ratioX =\r\n      // min. 0\r\n      Math.max(0,\r\n        // max. 1\r\n        Math.min(1, ((this.x - this.targetBCR.left) / this.targetBCR.width))\r\n      );\r\n    // console.log(ratioX);\r\n    const ratioY =\r\n      // min. 0\r\n      Math.max(0,\r\n        // max. 1\r\n        Math.min(1, ((this.y - this.targetBCR.top) / this.targetBCR.height))\r\n      );\r\n    // console.log(ratioY);\r\n\r\n    // actual zooming (scaling)\r\n    const imageScale = 2.5;\r\n    const scaledTargetWidth = this.targetBCR.width * imageScale;\r\n    const scaledTargetHeight = this.targetBCR.height * imageScale;\r\n\r\n    // Firefox on Windows has a bug because of the shadow\r\n    if (!(platform.os.family.indexOf('Windows') > -1 && platform.name.indexOf('Firefox') > -1)) {\r\n      // Shadow.\r\n      this.ctx.shadowColor = 'rgba(0,0,0,0.4)';\r\n      this.ctx.shadowBlur = 12;\r\n      this.ctx.shadowOffsetY = 8;\r\n    }\r\n\r\n    // Background.\r\n    this.ctx.clearRect(0, 0, this.zoomGlassSize, this.zoomGlassSize);\r\n    this.ctx.fillStyle = '#fff';\r\n    this.ctx.beginPath();\r\n    this.ctx.arc(\r\n      // x\r\n      this.zoomGlassSize / 2,\r\n      // y\r\n      (this.zoomGlassSize - 10) - radius,\r\n      // radius, startAngle, endAngle\r\n      radius, 0, TAU);\r\n    this.ctx.closePath();\r\n    this.ctx.fill();\r\n\r\n    // save the default state (without image)\r\n    this.ctx.save();\r\n\r\n    // Zoomed image.\r\n    this.ctx.beginPath();\r\n    this.ctx.arc(\r\n      // x\r\n      this.zoomGlassSize / 2,\r\n      // y\r\n      (this.zoomGlassSize - 10) - (radius + 1),\r\n      // radius, startAngle, endAngle\r\n      radius * 1.03, 0, TAU);\r\n    this.ctx.clip();\r\n    this.ctx.closePath();\r\n    this.ctx.drawImage(this.target,\r\n      // dx and dy (left and top)\r\n      (-ratioX * scaledTargetWidth) + (this.zoomGlassSize / 2),\r\n      (-ratioY * scaledTargetHeight) + (this.zoomGlassSize / 2),\r\n      // scaled width and height\r\n      scaledTargetWidth, scaledTargetHeight);\r\n\r\n    // go back to default state (without image)\r\n    // so next update starts fresh\r\n    this.ctx.restore();\r\n\r\n    // Position the parent $element.\r\n    this._setTransformStyle(this.x, this.y);\r\n\r\n    // Update the zoom value.\r\n    this.zoomed += (this.targetZoomed - this.zoomed) / 4;\r\n\r\n    // Schedule another update if the zoom is fairly non-zero.\r\n    if (this.zoomed > 0.001) {\r\n      // if (this.zoomed > 0.001 && this.zoomed < 0.998) {\r\n      window.requestAnimationFrame(this._update);\r\n      // } else if (this.zoomed >= 0.998) {\r\n      //   this.zoomed = 1;\r\n    } else {\r\n      this.zoomed = 0;\r\n    }\r\n  }\r\n\r\n  _addEventListeners() {\r\n    // touch events\r\n    document.addEventListener('touchstart', this._onStart);\r\n    document.addEventListener('touchmove', this._onMove);\r\n    document.addEventListener('touchend', this._onEnd);\r\n    // mouse events\r\n    document.addEventListener('mousedown', this._onStart);\r\n    document.addEventListener('mousemove', this._onMove);\r\n    document.addEventListener('mouseup', this._onEnd);\r\n    // window events\r\n    window.addEventListener('resize', this._onResize);\r\n  }\r\n\r\n  _setTransformStyle(x, y) {\r\n    const halfYoomGlassSize = this.zoomGlassSize / 2;\r\n    let betterX;\r\n    let betterY;\r\n\r\n    if (x - halfYoomGlassSize < 0) {\r\n      betterX = Math.abs(x) + halfYoomGlassSize + 18;\r\n    }\r\n    else if (x + halfYoomGlassSize > window.innerWidth) {\r\n      betterX = window.innerWidth - (x - window.innerWidth) - this.zoomGlassSize;\r\n    }\r\n    else {\r\n      betterX = x;\r\n    }\r\n\r\n    if (y - this.zoomGlassSize < 0) {\r\n      betterY = Math.abs(y) + this.zoomGlassSize + 18;\r\n    }\r\n    else {\r\n      betterY = y;\r\n    }\r\n\r\n    this.$element.style.transform = `translate(${betterX}px, ${betterY}px)`;\r\n  }\r\n}\r\n","export function __isTouchEnabled() {\r\n  return ('ontouchstart' in window) ||\r\n    (navigator.maxTouchPoints > 0) ||\r\n    (navigator.msMaxTouchPoints > 0);\r\n}\r\n\r\n// Is touch: mql.matches === true\r\nexport function __isTouchOnly() {\r\n  return window.matchMedia('(hover: none)').matches;\r\n}\r\n\r\nexport function imageIsLoaded(src) {\r\n  return new Promise((resolve, reject) => {\r\n    const img = new Image();\r\n    img.onload = () => resolve(img);\r\n    img.onerror = reject;\r\n    img.src = src;\r\n  });\r\n}\r\n\r\nexport function __createNewCustomEvent(name, options = {}, data = null) {\r\n  const defaults = {\r\n    // https://developer.mozilla.org/en-US/docs/Web/Guide/Events/Creating_and_triggering_events#Event_bubbling\r\n    bubbles: true,\r\n    // cancelBubble\r\n    // stopPropagation()\r\n    // cancelable\r\n    // composed\r\n    // currentTarget\r\n    // defaultPrevented\r\n    // preventDefault()\r\n    // eventPhase\r\n    // returnValue\r\n    // preventDefault()\r\n    // defaultPrevented\r\n    // target\r\n    // timeStamp\r\n    // type\r\n    // isTrusted\r\n  };\r\n\r\n  const properties = Object.assign(defaults, options);\r\n\r\n  return new CustomEvent(name, {\r\n    detail: data,\r\n    ...properties,\r\n  });\r\n}\r\n\r\nexport function __dispatchEvent($element, type, options, payload) {\r\n  const event = __createNewCustomEvent(type, options, payload);\r\n\r\n  // console.log(event);\r\n  $element.dispatchEvent(event);\r\n}\r\n\r\n/* https://plainjs.com/javascript/events/trigger-an-event-11/ */\r\nexport function __triggerEvent(el, type) {\r\n\r\n  if ('createEvent' in document) {\r\n    // modern browsers, IE9+\r\n    const e = new Event(type);\r\n    el.dispatchEvent(e);\r\n  } else {\r\n    // IE 8\r\n    const e = document.createEventObject();\r\n    e.eventType = type;\r\n    el.fireEvent('on' + e.eventType, e);\r\n  }\r\n}\r\n\r\nexport function __keycodeIsPrintableCharacter(keycode) {\r\n\r\n  const valid =\r\n    (keycode > 47 && keycode < 58) || // number keys\r\n    keycode == 32 || keycode == 13 || // spacebar & return key(s) (if you want to allow carriage returns)\r\n    (keycode > 64 && keycode < 91) || // letter keys\r\n    (keycode > 95 && keycode < 112) || // numpad keys\r\n    (keycode > 185 && keycode < 193) || // ;=,-./` (in order)\r\n    (keycode > 218 && keycode < 223); // [\\]' (in order)\r\n  // https://stackoverflow.com/questions/12467240/determine-if-javascript-e-keycode-is-a-printable-non-control-character#answer-12467610\r\n\r\n  return valid;\r\n\r\n}\r\n\r\nexport function __isObject(item) {\r\n  return (item && typeof item === 'object' && !Array.isArray(item));\r\n}\r\n\r\n// https://stackoverflow.com/questions/27936772/how-to-deep-merge-instead-of-shallow-merge\r\n// Maybe use lodash ? https://lodash.com/docs/4.17.10#defaultsDeep\r\nexport function __mergeDeep(target, source) {\r\n  const output = Object.assign({}, target);\r\n  if (__isObject(target) && __isObject(source)) {\r\n    Object.keys(source).forEach((key) => {\r\n      if (__isObject(source[key])) {\r\n        if (!(key in target)) {\r\n          Object.assign(output, { [key]: source[key] });\r\n        } else {\r\n          output[key] = __mergeDeep(target[key], source[key]);\r\n        }\r\n      } else {\r\n        Object.assign(output, { [key]: source[key] });\r\n      }\r\n    });\r\n  }\r\n  return output;\r\n}\r\n\r\nexport function __isObjectEmpty(object) {\r\n  return !Object.keys(object).length;\r\n}\r\n\r\nexport function __insertBefore(newNode, referenceNode) {\r\n  referenceNode.parentNode.insertBefore(newNode, referenceNode);\r\n}\r\n\r\nexport function __insertAfter(newNode, referenceNode) {\r\n\r\n  referenceNode.parentNode.insertBefore(newNode, referenceNode.nextSibling);\r\n\r\n}\r\n\r\nexport function __getRealDimensions(el, translated = true) {\r\n\r\n  const clonedElement = el.cloneNode(true);\r\n\r\n  clonedElement.style.visibility = 'hidden';\r\n  clonedElement.style.display = 'block';\r\n\r\n  __insertAfter(clonedElement, el);\r\n\r\n  const elDimensions = clonedElement.getBoundingClientRect();\r\n  const elPosition = (translated) ? __positionTranslated(clonedElement) : __position(clonedElement);\r\n\r\n\r\n  __remove(clonedElement);\r\n\r\n  return {\r\n    width: elDimensions.width,\r\n    height: elDimensions.height,\r\n    top: elPosition.top,\r\n    left: elPosition.left,\r\n  };\r\n\r\n}\r\n\r\nexport function __remove(el /* :HTMLElement */) {\r\n\r\n  el.parentNode.removeChild(el);\r\n\r\n}\r\n\r\n\r\nexport function __getHTML(node) {\r\n\r\n  if (!node || !node.tagName) { return; }\r\n  if (node.outerHTML) { return node.outerHTML; }\r\n\r\n  // polyfill:\r\n  const wrapper = document.createElement('div');\r\n  wrapper.appendChild(node.cloneNode(true));\r\n  return wrapper.innerHTML;\r\n\r\n}\r\n\r\nexport function __getText(el) {\r\n  return el.innerText || el.textContent;\r\n}\r\n\r\nexport function __globalPosition(event) {\r\n  // d3.event\r\n  // The current event, if any. This is set during the invocation of an event listener, and is reset after the listener terminates. Use this to access standard event fields such as event.timeStamp and methods such as event.preventDefault. While you can use the native event.pageX and event.pageY, it is often more convenient to transform the event position to the local coordinate system of the container that received the event using d3.mouse, d3.touch or d3.touches.\r\n  // If you use Babel, Webpack, or another ES6-to-ES5 bundler, be aware that the value of d3.event changes during an event! An import of d3.event must be a live binding, so you may need to configure the bundler to import from D3’s ES6 modules rather than from the generated UMD bundle; not all bundlers observe jsnext:main. Also beware of conflicts with the window.event global.\r\n  \r\n  // for mobile no need more then first finge touch\r\n  return {\r\n    x: event.pageX || event.touches[0].pageX,\r\n    y: event.pageY || event.touches[0].pageY,\r\n  };\r\n}\r\n\r\nexport function __localPosition(event, container) {\r\n  // d3.mouse\r\n  // Returns the x and y coordinates of the current event relative to the specified container. The container may be an HTML or SVG container element, such as a G element or an SVG element. The coordinates are returned as a two-element array of numbers [x, y].\r\n  // BUG: d3.mouse doesn’t observe CSS transform on Firefox — https://github.com/d3/d3-selection/issues/81\r\n  // TEMPORARY FIX: https://github.com/d3/d3-selection/issues/191#issuecomment-474987103\r\n\r\n  let position = [];\r\n\r\n  if (platform.name === 'Firefox' && event.target.closest('.half-slide-active')) {\r\n    // this works for Firefox even in transformed container\r\n    // if (platform.name === 'Firefox')\r\n    // but creates another bug when used on top of another SVG element (with different viewbox?),\r\n    // so make temporary fix only of .half-slide-active to fix the orginal bug with new bug\r\n    // console.log(d3.event.target.closest('.half-slide-active'));\r\n    position = [\r\n      event.offsetX,\r\n      event.offsetY,\r\n    ];\r\n  } else {\r\n    // this works for Chrome\r\n    position = d3.pointer(event, container);\r\n\r\n    // fix for ios\r\n    // https://github.com/d3/d3-selection/blob/main/src/pointer.js\r\n    // vs\r\n    // https://github.com/d3/d3-selection/blob/main/src/pointers.js\r\n    // both or nothing\r\n    if (!position[0]) {\r\n      [ position ] = d3.pointers(event, container);\r\n    }\r\n  }\r\n\r\n  return {\r\n    x: d3.format('.0f')(position[0]),\r\n    y: d3.format('.0f')(position[1]),\r\n  };\r\n}\r\n\r\nexport function __positionTranslated(el) {\r\n\r\n\r\n  const curTransform = new WebKitCSSMatrix(window.getComputedStyle(el).webkitTransform);\r\n\r\n  const body = document.body;\r\n\r\n  const scrollTop = window.pageYOffset || body.scrollTop;\r\n  const scrollLeft = window.pageXOffset || body.scrollLeft;\r\n\r\n  return {\r\n    left: el.offsetLeft + curTransform.m41,\r\n    top: el.offsetTop + curTransform.m42,\r\n  };\r\n\r\n}\r\n\r\nexport function __position(el) {\r\n\r\n  const elAttibutes = el.getBoundingClientRect();\r\n  const body = document.body;\r\n\r\n  const scrollTop = window.pageYOffset || body.scrollTop;\r\n  const scrollLeft = window.pageXOffset || body.scrollLeft;\r\n\r\n  return {\r\n    left: elAttibutes.left + scrollLeft,\r\n    top: elAttibutes.top + scrollTop,\r\n    height: elAttibutes.height,\r\n    width: elAttibutes.width,\r\n  };\r\n}\r\n\r\n// TODO: check for https://github.com/vladocar/nanoJS/\r\nexport function __toggleClass(element, cls) {\r\n  if (__hasClass(element, cls)) {\r\n    __removeClass(element, cls);\r\n  } else {\r\n    __addClass(element, cls);\r\n  }\r\n}\r\n\r\nexport function __hasClass(element, cls) {\r\n  // if there are no elements or classes, we're done\r\n  if (!element || !cls) return false;\r\n  return (element.classList) ? element.classList.contains(cls) : (`${element.className} `).indexOf(`${cls} `) > -1;\r\n}\r\n\r\nexport function __addClass(elements, classes) {\r\n  let _elements = elements;\r\n  let _classes = classes;\r\n\r\n  // if there are no elements or classes, we're done\r\n  if (!_elements || !_classes) { return; }\r\n\r\n  if (typeof (_elements) === 'string') {\r\n    // if we have a selector, get the chosen _elements\r\n    _elements = document.querySelectorAll(_elements);\r\n  } else if (_elements.tagName) {\r\n    // if we have a single DOM element, make it an array to simplify behavior\r\n    _elements = [_elements];\r\n  }\r\n\r\n  if (typeof (_classes) === 'string') {\r\n    // make an array from string _classes\r\n    _classes = _classes.split(' ');\r\n  } else {\r\n    console.log('Class argument must be string with spaces in between class names.');\r\n    return;\r\n  }\r\n\r\n  // add class to all chosen _elements\r\n  for (let i = 0; i < _elements.length; i += 1) {\r\n    // check classList support\r\n    if (_elements[i].classList) {\r\n      _elements[i].classList.add(..._classes);\r\n    } else if (!__hasClass(_elements[i], ..._classes)) {\r\n      for (let j = 0; j < _classes.length; j += 1) {\r\n        _elements[i].classes += ` ${_classes[j]}`;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport function __removeClass(elements, classes) {\r\n  let _elements = elements;\r\n  let _classes = classes;\r\n\r\n  // if there are no elements or classes, we're done\r\n  if (!_elements || !_classes) { return; }\r\n\r\n  if (typeof (_elements) === 'string') {\r\n    // if we have a selector, get the chosen _elements\r\n    _elements = document.querySelectorAll(_elements);\r\n  } else if (_elements.tagName) {\r\n    // if we have a single DOM element, make it an array to simplify behavior\r\n    _elements = [_elements];\r\n  }\r\n\r\n  if (typeof (_classes) === 'string') {\r\n    // make an array from string _classes\r\n    _classes = _classes.split(' ');\r\n  } else {\r\n    console.log('Class argument must be string with spaces in between class names.');\r\n    return;\r\n  }\r\n\r\n  // remove class from all chosen _elements\r\n  for (let i = 0; i < _elements.length; i += 1) {\r\n    // check classList support\r\n    if (_elements[i].classList) {\r\n      _elements[i].classList.remove(..._classes);\r\n    } else {\r\n      for (let j = 0; j < _classes.length; j += 1) {\r\n        _elements[i].className = _elements[i].className.replace(new RegExp(`\\\\b${classes[j]}\\\\b`, 'g'), '');\r\n      }\r\n    }\r\n  }\r\n}\r\n","import { __createNewCustomEvent } from '../../lib/utils';\r\n\r\nconst mediaEvents = {\r\n  playchange: __createNewCustomEvent('playchange'),\r\n  timechange: __createNewCustomEvent('timechange'),\r\n  canplaystart: __createNewCustomEvent('canplaystart'),\r\n};\r\n\r\nfunction stopPlayingVideoPlayers($players) {\r\n  // pause all other playing media tracks\r\n  $players.forEach(($player) => {\r\n    const $media = $player.querySelector('audio') || $player.querySelector('video');\r\n    if ($media && !$media.paused) {\r\n      $media.pause();\r\n      $player\r\n        .querySelector('[data-player-control]')\r\n        .setAttribute('data-player-control', 'paused');\r\n    }\r\n  });\r\n}\r\n\r\nfunction getSecondsMinutesFormat(seconds) {\r\n  const duration = {\r\n    seconds: Math.floor(seconds),\r\n    minutes: Math.floor(seconds / 60),\r\n  };\r\n\r\n  duration.seconds = (duration.seconds - (duration.minutes * 60)).toString(10);\r\n\r\n  return `${duration.minutes}:${(`0${duration.seconds}`).slice(-2)}`;\r\n}\r\n\r\nexport {\r\n  getSecondsMinutesFormat,\r\n  stopPlayingVideoPlayers,\r\n  mediaEvents,\r\n};\r\n","import Component from '../component';\nimport { getSecondsMinutesFormat, stopPlayingVideoPlayers } from './media';\n\nexport default class AudioPlayer extends Component {\n  // eslint-disable-next-line no-useless-constructor\n  constructor($element) {\n    super($element);\n  }\n\n  // TODO: move to audio-simple.js\n  static addEventListeners($item, showFeedback) {\n    const $players = document.querySelectorAll('[data-player-audio]');\n    const $audio = $item.querySelector('audio');\n    const $playButton = $item.querySelector('[data-player-control]');\n    const $timeLeft = $item.querySelector('[data-audio-time-left]');\n\n    $playButton.addEventListener('click', (event) => {\n      if ($playButton.getAttribute('data-player-control') === 'paused') {\n        // TODO: abstract\n        stopPlayingVideoPlayers($players);\n        $audio.play();\n        $playButton.setAttribute('data-player-control', 'playing');\n      } else {\n        // TODO: abstract\n        $audio.pause();\n        $playButton.setAttribute('data-player-control', 'paused');\n      }\n\n      showFeedback();\n\n      event.stopPropagation();\n    }, false);\n\n    // do not propagate audio control events higher into the dom\n    $playButton.addEventListener('mousedown', (event) => {\n      event.stopPropagation();\n    }, false);\n\n    $audio.addEventListener('timeupdate', () => {\n      $timeLeft.innerText = getSecondsMinutesFormat($audio.currentTime);\n    });\n\n    $audio.addEventListener('ended', () => {\n      $playButton.setAttribute('data-player-control', 'paused');\n    });\n  }\n}\n","export default class SVGDragNDrop {\r\n  // static drag(id) {\r\n  //   d3.drag()\r\n  //     .on('start', () => {\r\n  //       SVGDragNDrop.start(id);\r\n  //     })\r\n  //     .on('drag', () => {\r\n  //       SVGDragNDrop.dragged(id);\r\n  //     })\r\n  //     .on('end', () => {\r\n  //       SVGDragNDrop.end(id);\r\n  //     });\r\n  // }\r\n\r\n  static start($element) {\r\n    d3.select($element).raise().classed('is-dragged', true);\r\n  }\r\n\r\n  static dragged(event, $element, type, diff, $node) {\r\n    let [xZarov, yZarov] = this.getJustifiedCord(event, $element, type, diff, $node);\r\n    d3.select($element).attr('x', xZarov.toFixed()).attr('y', yZarov.toFixed());\r\n  }\r\n\r\n  static end(event, $element, type, diff, $node) {\r\n    let [xZarov, yZarov] = this.getJustifiedCord(event, $element, type, diff, $node);\r\n    d3.select($element)\r\n      .attr('x', xZarov.toFixed())\r\n      .attr('y', yZarov.toFixed())\r\n      // neumožňuje v jiných funkcí s tímto objektem dále pracovat,\r\n      // protože pracují s id\r\n      // .attr('id', `${type}-${d3.event.x.toFixed()}-${d3.event.y.toFixed()}`)\r\n      .classed('is-dragged', false);\r\n  }\r\n\r\n  /**\r\n   * Method which return additional offsets due the orientation of textarea\r\n   * @returns {Array} [x,y]\r\n   *\r\n   * @param {Object} orientation object of orentation of textarea against black dot\r\n   * @param {Object} elementResolution object of element resolution\r\n   */\r\n  static getOffsetOfText(orientation, elementResolution) {\r\n    if (orientation[0] === 'left' && orientation[1] === 'top') {\r\n      return [elementResolution.width - 10, elementResolution.height - 10];\r\n    }\r\n    if (orientation[0] === 'left' && orientation[1] === 'bottom') {\r\n      return [elementResolution.width - 10, 0];\r\n    }\r\n    if (orientation[0] === 'right' && orientation[1] === 'top') {\r\n      return [0, elementResolution.height - 10];\r\n    }\r\n    if (orientation[0] === 'right' && orientation[1] === 'bottom') {\r\n      return [0, 0];\r\n    }\r\n  }\r\n\r\n  static getJustifiedCord(event, $element, type, diff, $node) {\r\n    const elementResolution = {\r\n      height: $node.offsetHeight,\r\n      width: $node.offsetWidth,\r\n    };\r\n\r\n    const svgResolution = $element\r\n      .getAttribute('data-svg-resolution')\r\n      .split(', ')\r\n      .map((e) => parseInt(e, 10));\r\n\r\n    switch (type) {\r\n      case 'text':\r\n        return this.textJustified(\r\n          event,\r\n          $element,\r\n          diff,\r\n          elementResolution,\r\n          svgResolution\r\n        );\r\n      case 'pretahovani':\r\n        return this.pretahovaniJustified(\r\n          event,\r\n          $element,\r\n          diff,\r\n          elementResolution,\r\n          svgResolution\r\n        );\r\n      case 'circle':\r\n        return this.circleJustified(event, svgResolution, diff, elementResolution);\r\n      default:\r\n        return this.circleJustified(event, svgResolution, diff, elementResolution);\r\n    }\r\n  }\r\n\r\n  static textJustified(event, $element, diff, elementResolution, svgResolution) {\r\n    const orientation = $element\r\n      .getAttribute('data-svg-text-orientation')\r\n      .split(', ');\r\n    const textCenter = this.getOffsetOfText(orientation, elementResolution);\r\n    let xZarov = 0;\r\n    let yZarov = 0;\r\n\r\n    // for x\r\n    if (event.x - diff.x <= 10 + textCenter[0]) {\r\n      xZarov = 10 + textCenter[0];\r\n    } else if (\r\n      event.x - diff.x >\r\n      svgResolution[0] - elementResolution.width + textCenter[0]\r\n    ) {\r\n      xZarov = svgResolution[0] - elementResolution.width + textCenter[0];\r\n    } else {\r\n      xZarov = event.x - diff.x;\r\n    }\r\n    // for y\r\n    if (event.y - diff.y <= 10 + textCenter[1]) {\r\n      yZarov = 10 + textCenter[1];\r\n    } else if (\r\n      event.y - diff.y >\r\n      svgResolution[1] - elementResolution.height + textCenter[1]\r\n    ) {\r\n      yZarov = svgResolution[1] - elementResolution.height + textCenter[1];\r\n    } else {\r\n      yZarov = event.y - diff.y;\r\n    }\r\n    return [xZarov, yZarov];\r\n  }\r\n\r\n  static pretahovaniJustified(event, $element, diff, elementResolution, svgResolution) {\r\n    elementResolution.height = $element.attributes.height.value;\r\n    elementResolution.width = $element.attributes.width.value;\r\n    let xZarov = 0;\r\n    let yZarov = 0;\r\n    // FOR X\r\n    // left side\r\n    if (event.x - diff.x <= 0) {\r\n      xZarov = 0;\r\n    }\r\n    // right side\r\n    else if (event.x - diff.x > svgResolution[0] - elementResolution.width) {\r\n      xZarov = svgResolution[0] - elementResolution.width;\r\n    }\r\n    // else for X axis\r\n    else {\r\n      xZarov = event.x - diff.x;\r\n    }\r\n    // FOR Y\r\n    // upper side\r\n    if (event.y - diff.y <= 0) {\r\n      yZarov = 0;\r\n    }\r\n    // down side\r\n    else if (\r\n      event.y - diff.y >\r\n      svgResolution[1] - elementResolution.height\r\n    ) {\r\n      yZarov = svgResolution[1] - elementResolution.height;\r\n    }\r\n    // else for y\r\n    else {\r\n      yZarov = event.y - diff.y;\r\n    }\r\n    return [xZarov, yZarov];\r\n  }\r\n\r\n  static circleJustified(event, svgResolution, diff, elementResolution) {\r\n    let xZarov = 0;\r\n    let yZarov = 0;\r\n    // FOR X\r\n    // left side\r\n    if (event.x - diff.x <= elementResolution.width / 2) {\r\n      xZarov = elementResolution.width / 2;\r\n    }\r\n    // right side\r\n    else if (\r\n      event.x - diff.x >\r\n      svgResolution[0] - elementResolution.width / 2\r\n    ) {\r\n      xZarov = svgResolution[0] - elementResolution.width / 2;\r\n    }\r\n    // else for X axis\r\n    else {\r\n      xZarov = event.x - diff.x;\r\n    }\r\n    // FOR Y\r\n    // upper side\r\n    if (event.y - diff.y <= elementResolution.height / 2) {\r\n      yZarov = elementResolution.height / 2;\r\n    }\r\n    // down side\r\n    else if (\r\n      event.y - diff.y >\r\n      svgResolution[1] - elementResolution.height / 2\r\n    ) {\r\n      yZarov = svgResolution[1] - elementResolution.height / 2;\r\n    }\r\n    // else for y\r\n    else {\r\n      yZarov = event.y - diff.y;\r\n    }\r\n    return [xZarov, yZarov];\r\n  }\r\n\r\n  static circleMove(d3Element, event, svgResolution, diff, elementResolution) {\r\n    const [xZarov, yZarov] = this.circleJustified(event, svgResolution, diff, elementResolution);\r\n    d3Element.attr('cx', xZarov.toFixed()).attr('cy', yZarov.toFixed());\r\n  }\r\n}\r\n","import { __localPosition, __dispatchEvent } from '../../lib/utils';\n\n// import SVG from '../svg';\nimport SVGDragNDrop from './svg-dragndrop';\nimport SVG from '../svg';\n\nexport default class SVGDraw {\n  // static selectPath(svg) {\n  //   // https://bl.ocks.org/mbostock/8027637\n  // }\n\n  static renderPath(event, $svg, color, callback) {\n    if (event.sourceEvent.target.nodeName === 'image') {\n\n      const line = d3.line()\n        // removed smooth curve to get rid of loong decimals\n        // see https://github.com/d3/d3-path/issues/10\n        .curve(d3.curveLinear); // _dragStarted\n\n      const format = d3.format('.0f');\n      const d = event.subject;\n      // origin\n      let x0 = format(event.x);\n      let y0 = format(event.y);\n\n      const id = `${$svg.id}_path-${x0}-${y0}`;\n\n      const active = d3.select(`#${$svg.id} .svg-view`).append('svg:path')\n        // .attr('marker-start', 'url('#marker-circle-blue')')\n        // .attr('marker-end', 'url('#marker-arrow-blue')')\n        .attr('data-svg-path', '')\n        .attr('class', `svg-path ${color}`)\n        .attr('id', id)\n        .datum(d);\n\n      // github.com/d3/d3-drag#event_on\n      event\n        .on('drag', (dragEvent) => {\n          // current position\n          const x1 = format(dragEvent.x);\n          const y1 = format(dragEvent.y);\n          // distance from origin\n          const dx = x1 - x0;\n          const dy = y1 - y0;\n\n          // if the distance of drag event is too large, make new origin\n          if ((dx * dx) + (dy * dy) > 300) d.push([x0 = x1, y0 = y1]);\n          // smooth line, correct last point\n          else d[d.length - 1] = [x1, y1];\n\n          active.attr('d', line);\n        })\n        .on('end', () => {\n          const $thisPath = d3.select(`#${id}`);\n          if ($thisPath) {\n            if ($thisPath.attr('d')) {\n              if ($thisPath.attr('d').length < 40) {\n                $thisPath.remove();\n              }\n              else {\n                // dispatch event that svg has changed\n                __dispatchEvent(document, 'svg.change', {}, {\n                  svg: {\n                    id: $svg.id,\n                    task: 'create',\n                    node: $thisPath.node(),\n                    nodeName: $thisPath.node().nodeName,\n                    contextMenu: false,\n                  },\n                });\n              }\n            }\n            else if (!$thisPath.attr('d')) {\n              $thisPath.remove();\n            }\n          }\n\n          callback();\n        });\n\n      // add events to element\n      SVGDraw.pathEventsManager($svg, d3.select(`#${id}`).node());\n    }\n  }\n\n  // Draw a SVG circle on click\n  static createCircle(event, $svg, color) {\n    const svgGroup = d3.select($svg).select('.svg-view');\n    // d3.select(`#${$svg.id} .svg-view`);\n    // const canvas = document.querySelector(`#${$svg.id} .svg-view`);\n    const localPosition = __localPosition(event, $svg);\n    const id = `${$svg.id}_circle-${localPosition.x}-${localPosition.y}`;\n\n    const $circle = svgGroup.append('svg:circle')\n      .attr('data-svg-circle', '')\n      .attr('id', id)\n      .attr('cx', localPosition.x)\n      .attr('cy', localPosition.y)\n      .attr('data-svg-resolution', `${svgGroup.attr('width')}, ${svgGroup.attr('height')}`)\n      .attr('data-svg-type', 'circle')\n      .attr('class', `svg-circle ${color} unselectable`);\n\n    const $element = document.querySelector(`#${id}`);\n\n    // add events to element\n    SVGDraw.circleEventsManager($svg, $element, 'circle');\n\n    // dispatch event that svg has changed\n    __dispatchEvent(document, 'svg.change', {}, {\n      svg: {\n        id: $svg.id,\n        task: 'create',\n        node: $element,\n        nodeName: $element.nodeName,\n        contextMenu: false,\n      },\n    });\n  }\n\n  static pathEventsManager($svg, $element) {\n    d3.select(`#${$element.id}`).on('click', (event) => {\n      // dispatch event that svg has changed\n      __dispatchEvent(document, 'svg.change', {}, {\n        svg: {\n          id: $svg.id,\n          task: 'remove',\n          node: event.target,\n          nodeName: event.target.nodeName,\n          contextMenu: false,\n        },\n      });\n\n      d3.select(`#${$element.id}`).remove();\n\n      event.preventDefault();\n    }, false);\n  }\n\n  static circleEventsManager($svg, $element) {\n    const $canvas = document.querySelector(`#${$svg.id} .svg-view`); // group <g>...</g>\n    const d3Element = d3.select($element);\n    const svgResolution = [\n      parseInt($canvas.getAttribute('width'), 10),\n      parseInt($canvas.getAttribute('height'), 10),\n    ];\n    const circleStyle = getComputedStyle($element);\n    const elementResolution = [\n      circleStyle.r * 2, // height\n      circleStyle.r * 2, // width\n    ];\n\n    // TODO:\n    // standalone function\n    // same for all draggable svg elements\n    let elementPosition = [\n      d3Element.attr('cx'),\n      d3Element.attr('cy'),\n    ];\n    let diff = {};\n\n    d3Element.on('click', (event) => {\n\n      // dispatch event that svg has changed\n      __dispatchEvent(document, 'svg.change', {}, {\n        svg: {\n          id: $svg.id,\n          task: 'remove',\n          node: $element,\n          nodeName: $element.nodeName,\n          contextMenu: false,\n        },\n      });\n\n      // dispatch event that drop item was deleted\n      const idParts = $element.id.split('_');\n      if (idParts[idParts.length - 1] === 'dropItem') {\n        __dispatchEvent(document, 'svg.drop.delete', {}, {\n          item: {\n            id: idParts[1],\n            $object: $element,\n          },\n        });\n      }\n\n      event.target.remove();\n    })\n      .call(d3.drag()\n        .container($canvas)\n        .subject($element)\n        .on('start', (event) => {\n          diff = {\n            x: event.x - elementPosition[0],\n            y: event.y - elementPosition[1],\n          };\n\n          SVGDragNDrop.start($element);\n\n          // dispatch event for radio menu - iOS fix\n          __dispatchEvent(document, 'event.propagation', {}, {\n            event: { from: 'circle.drag.start', data: event },\n          });\n        })\n        .on('drag', (event) => {\n          // dispatch event for radio menu - iOS fix\n          __dispatchEvent(document, 'event.stopPropagation', {}, { event: {} });\n          if (d3Element.attr('data-svg-selected') === 'true') return;\n          // SVGDragNDrop.dragged(event, $element, type, diff);\n          SVGDragNDrop.circleMove(d3Element, event, svgResolution, diff, elementResolution);\n        })\n        .on('end', (event) => {\n          // dispatch event for radio menu - iOS fix\n          __dispatchEvent(document, 'event.stopPropagation', {}, { event: {} });\n          if (d3Element.attr('data-svg-selected') === 'true') return;\n\n          const oldXCoordinate = elementPosition[0];\n          const oldYCoordinate = elementPosition[1];\n          let taskType = 'move';\n\n          // SVGDragNDrop.end(event, $element, type, diff);\n          SVGDragNDrop.circleMove(d3Element, event, svgResolution, diff, elementResolution);\n          d3Element.classed('is-dragged', false);\n\n          elementPosition = [\n            $element.getAttribute('cx'),\n            $element.getAttribute('cy'),\n          ];\n\n          // if clone is changed, then dispatch create event\n          if (SVG.removeCloneConnectionManager($element)) taskType = 'create';\n\n          if (elementPosition[0] !== oldXCoordinate || elementPosition[1] !== oldYCoordinate) {\n            // dispatch event that svg has changed\n            __dispatchEvent(document, 'svg.change', {}, {\n              svg: {\n                id: $svg.id,\n                task: taskType,\n                node: $element,\n                nodeName: $element.nodeName,\n                contextMenu: false,\n              },\n            });\n          }\n        }));\n  }\n}\n","import {\n  __addClass,\n  __removeClass,\n  __hasClass,\n  __dispatchEvent,\n} from '../../lib/utils';\n\nimport SVG from '../svg';\nimport SVGDragNDrop from './svg-dragndrop';\n\nexport default class SVGText {\n  static createText(maxLength = 333, minLength = 2) {\n    const $svg = document.querySelector('[data-svg-active=\"true\"]');\n    const svgID = $svg.id;\n    const svgGroup = d3.select($svg).select('.svg-view');\n\n    // const $canvas = $svg.querySelector('.svg-view');\n    const $radialMenu = document.querySelector('[data-radial-menu]');\n    const localPosition = {\n      x: $radialMenu.getAttribute('data-local-x'),\n      y: $radialMenu.getAttribute('data-local-y'),\n    };\n    const id = `${svgID}_svg-text-${localPosition.x}-${localPosition.y}`;\n    const hash = `#${id}`;\n    const orientation = {\n      x: (svgGroup.attr('width') - localPosition.x) > 320 ? 'right' : 'left',\n      y: (svgGroup.attr('height') - localPosition.y) > 60 ? 'bottom' : 'top',\n    };\n    // let firstWrite = true;\n\n    // text wrapper\n    const foreignObject = svgGroup.append('svg:foreignObject')\n      .attr('class', `svg-text orientation-${orientation.x} orientation-${orientation.y} unselectable`)\n      .attr('data-svg-text', '')\n      .attr('x', localPosition.x)\n      .attr('y', localPosition.y)\n      .attr('data-svg-text-orientation', `${orientation.x}, ${orientation.y}`)\n      .attr('data-svg-resolution', `${svgGroup.attr('width')}, ${svgGroup.attr('height')}`)\n      .attr('height', '4rem');\n\n    // create visual point of interest for text input\n    const circle = svgGroup.append('svg:circle')\n      .attr('id', `${id}-circle`)\n      .attr('cx', localPosition.x)\n      .attr('cy', localPosition.y)\n      .attr('class', 'svg-circle svg-circle-text do-not-remove unselectable');\n\n    // create text input\n    const textarea = foreignObject.append('xhtml:textarea')\n      .attr('maxlength', maxLength)\n      .attr('tabindex', '-1')\n      .attr('id', id)\n      .attr('class', 'svg-textarea')\n      .attr('data-save', '')\n      .attr('data-svg-textarea-target', svgID);\n\n    // set focus to the new text input\n    $svg.querySelector(hash).focus();\n\n    // add events to element\n    SVGText.textEventsManager($svg, textarea.node(), circle.node(), true, minLength);\n  }\n\n  static textEventsManager($svg, $textarea, $circle, isCreated, minLength = 2) {\n    const $canvas = $svg.querySelector('.svg-view');\n    const hash = `#${$textarea.id}`;\n    let firstWrite = isCreated;\n    let oldText = $textarea.value;\n\n    // TODO\n    // standalone function\n    // same for all draggable svg elements\n    const $element = $svg.querySelector(hash).parentElement;\n    let elementPosition = [\n      $element.getAttribute('x'),\n      $element.getAttribute('y'),\n    ];\n    let diff = {};\n\n    d3.select(hash)\n      // drag & drop\n      .call(d3.drag()\n        .container($canvas)\n        .subject($element)\n        .on('start', (event) => {\n          diff = {\n            x: event.x - elementPosition[0],\n            y: event.y - elementPosition[1],\n          };\n\n          SVGDragNDrop.start($element);\n\n          // dispatch event for radio menu - iOS fix\n          __dispatchEvent(document, 'event.propagation', {}, {\n            event: { from: 'text.drag.start', data: event },\n          });\n        })\n        .on('drag', (event) => {\n          // dispatch event for radio menu - iOS fix\n          __dispatchEvent(document, 'event.stopPropagation', {}, { event: {} });\n\n          SVGDragNDrop.dragged(event, $element, 'text', diff, $textarea);\n\n          // circle is moving with text\n          $circle.setAttribute('cx', $element.getAttribute('x'));\n          $circle.setAttribute('cy', $element.getAttribute('y'));\n        })\n        .on('end', (event) => {\n          // dispatch event for radio menu - iOS fix\n          __dispatchEvent(document, 'event.stopPropagation', {}, { event: {} });\n\n          const oldXCoordinate = elementPosition[0];\n          const oldYCoordinate = elementPosition[1];\n          let taskType = 'move';\n\n          SVGDragNDrop.end(event, $element, 'text', diff, $textarea);\n\n          elementPosition = [\n            $element.getAttribute('x'),\n            $element.getAttribute('y'),\n          ];\n\n          // circle is moving with text\n          $circle.setAttribute('cx', elementPosition[0]);\n          $circle.setAttribute('cy', elementPosition[1]);\n\n          if (!firstWrite && (elementPosition[0] !== oldXCoordinate || elementPosition[1] !== oldYCoordinate)) {\n            // if clone is changed, then dispatch create event\n            if (SVG.removeCloneConnectionManager($element.childNodes[0])) taskType = 'create';\n\n            // dispatch event that svg has changed\n            __dispatchEvent(document, 'svg.change', {}, {\n              svg: {\n                id: $svg.id,\n                task: taskType,\n                node: $element.childNodes[0],\n                nodeName: $element.childNodes[0].nodeName,\n                circle: $circle,\n                contextMenu: false,\n              },\n            });\n          }\n\n          // fix for tablets and mobiles\n          // circle must be over text\n          d3.select($circle).raise();\n        }))\n      // keystroke\n      // control height of the text input on every key stroke\n      .on('keyup', (event) => {\n        SVGText.updateTextareaHeight(event.target);\n      })\n      // loss of focus\n      .on('blur', (event) => {\n        const $target = event.target;\n        const { value } = $target;\n        let taskType;\n        let wrongBool = false;\n\n        if (value.length === 0) {\n          SVG.removeItem(false, hash);\n          return;\n        }\n        if (value.length < minLength) {\n          __addClass($target, 'is-wrong');\n          wrongBool = true;\n        } else if ((value.length >= minLength) && __hasClass($target, 'is-wrong')) {\n          __removeClass($target, 'is-wrong');\n          wrongBool = false;\n        }\n\n        if (oldText !== value) {\n          if (firstWrite) {\n            taskType = 'create';\n            firstWrite = false;\n          } else {\n            taskType = 'change';\n          }\n          oldText = value;\n          // if clone is changed, then dispatch create event\n          if (SVG.removeCloneConnectionManager($target)) taskType = 'create';\n\n          // dispatch event that svg has changed\n          __dispatchEvent(document, 'svg.change', {}, {\n            svg: {\n              id: $svg.id,\n              task: taskType,\n              node: $target,\n              nodeName: $target.nodeName,\n              circle: $circle,\n              isWrong: wrongBool,\n              contextMenu: false,\n            },\n          });\n        }\n\n        // update oldText\n        oldText = value;\n        // fix ios text writing\n        event.target.classList.remove('unselectable');\n      })\n      // gain focus\n      .on('focus', () => {\n        d3.select($element).raise();\n        d3.select($circle).raise();\n      });\n  }\n\n  static updateTextareaHeight($target) {\n    $target.style.height = '1px';\n\n    const newHeight = `${22 + $target.scrollHeight}px`;\n    $target.style.height = newHeight;\n\n    // fix value for FO either\n    const $parent = $target.parentElement;\n    $parent.setAttribute('height', newHeight);\n  }\n\n  static comicBubblesEventsManager($svg, $node) {\n    let firstWrite = true;\n    let oldText = $node.value;\n\n    d3.select($node).on('keyup', (event) => {\n      SVGText.updateTextareaHeight(event.target);\n    })\n      .on('blur', (event) => {\n        const $target = event.target;\n        const { value } = $target;\n        let taskType;\n\n        if (oldText !== value) {\n          if (firstWrite) {\n            taskType = 'create';\n            firstWrite = false;\n          } else {\n            taskType = 'change';\n            if (value.length === 0) {\n              firstWrite = true;\n            }\n          }\n          oldText = value;\n          // if clone is changed, then dispatch create event\n          if (SVG.removeCloneConnectionManager($target)) taskType = 'create';\n\n          // dispatch event that svg has changed\n          __dispatchEvent(document, 'svg.change', {}, {\n            svg: {\n              id: $svg.id,\n              task: taskType,\n              node: $target,\n              nodeName: $target.nodeName,\n              isBubble: true,\n              contextMenu: false,\n            },\n          });\n        }\n\n        // update oldText\n        oldText = value;\n      });\n  }\n}\n","/**\n * čára:\n *  - nakreslit   ( drag'n'drop )\n *  - smazat      ( left click )\n *  - radial menu ( right click)\n *    - změnit barvu\n *    - smazaní\n *    - textový komentář\n * textové pole:\n *  - vytvořit    ( right click on svg )\n *    - nic => smaže se\n *    - málo znaků => zčervená\n *    - přes řádek textu => zvětší se\n *  - změnit      ( click on and write )\n *  - smazat      ( right click on textarea )\n *  - přenést     ( drag'n'drop )\n *  - radial menu ( right click on mark )\n *    - změnit barvu\n *    - smazaní\n *    - textový komentář\n * značka:\n *  - nakreslit   ( left click on svg )\n *  - přenést     ( drag'n'drop )\n *  - smazat      ( left click on mark )\n *  - radial menu ( right click)\n *    - změnit barvu\n *    - smazaní\n *    - textový komentář\n * komiksová bublina:  ( je již vytvořena předem )\n *  - napsat dovnitř\n *    - nic => zůstane\n *    - přes řádek textu => zvětší se\n */\n/* eslint-disable brace-style */\nimport Component from './component';\nimport { __dispatchEvent, __removeClass, __addClass, __globalPosition } from '../lib/utils';\nimport SVGDraw from './svg-lib/svg-draw';\nimport SVGText from './svg-lib/svg-text';\n\nexport default class SVG extends Component {\n  constructor($element) {\n    super($element);\n    this.$canvas = this.target.querySelector('.svg-view');\n\n    this.format = d3.format('.0f');\n\n    this._setSize();\n\n    this.init();\n    this._initWhenDone();\n  }\n\n  init() {\n    if (HISTORYLAB.import.done) return;\n\n    // duplicate source of different svg element\n    this.toDuplicate = this.target.getAttribute('data-duplicate-svg');\n\n    // make array from data-attributes (contains what kind of actions can user do on this svg)\n    const svgSpecificActions = this.target.getAttribute('data-svg-target').split(' ');\n\n    // get default color\n    const colors = this.target.getAttribute('data-svg-colors');\n\n    for (let i = 0; i < svgSpecificActions.length; i += 1) {\n      if (svgSpecificActions[i] === 'kresleni') {\n        const svgSpecificColor = colors ? colors.split(' ')[0] : 'yellow';\n        this._initPath(this.showFeedback, svgSpecificColor);\n      }\n      else if (svgSpecificActions[i] === 'znacky') {\n        const svgSpecificColor = colors ? colors.split(' ')[0] : 'blue';\n        this._initCircle(this.showFeedback, svgSpecificColor);\n      }\n      // else if (svgSpecificActions[i] === 'text') {\n      //   this._initText();\n      // }\n    }\n\n    // this._initZoom();\n    // comic bubbles if exists\n    this._initComicBubbles();\n\n    // listen events\n    this._getEvents();\n    this._getDropEvent();\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  _initWhenDone() {\n    if (!HISTORYLAB.import.done) return;\n\n    d3.selectAll('[data-svg-text] textarea')\n      // local context needed because of `this`\n      // eslint-disable-next-line func-names\n      .on('mouseenter', function () {\n        d3.select(this.closest('foreignObject')).raise();\n      });\n  }\n\n  _setSize() {\n    // NOTE: Cannot set `width` because of change of width when on half slide.\n    // TODO: set size on window resize\n\n    // might not be needed when inside sortable or other higher level module\n    // TODO: add condition for other higher level modules\n    // if (this.target.closest('[data-sortable-target')) return false;\n\n    const viewbox = this.target.getAttribute('viewBox').split(' ');\n    const rect = this.target.getBoundingClientRect(); // max-height: 100vh\n    // const getMaxWidthAbsolute = () => {\n    //   if (matchMedia('screen and (min-width: 1025px)').matches) {\n    //     return window.innerWidth * .8; // max-width: 62vw\n    //   }\n\n    //   return window.innerWidth;\n    // };\n    const maxWidthAbsolute = window.innerWidth;\n    const maxHeightAbsolute = window.innerHeight * .9;\n    const getHeight = () => {\n      if (!rect.height) return viewbox[3];\n      if (rect.height > viewbox[3]) return viewbox[3];\n\n      return rect.height;\n    };\n\n    const height = getHeight() > maxHeightAbsolute ? maxHeightAbsolute : getHeight();\n\n    const scale = height / viewbox[3];\n    const maxWidth = viewbox[2] * scale;\n    const setMaxWidth = scale ? `${maxWidth < maxWidthAbsolute ? maxWidth : maxWidthAbsolute}px` : '';\n\n    this.target.style.maxWidth = setMaxWidth;\n\n    // fix for svg + draggable/gallery (horizontal layout) in Chrome\n    if (\n      this.target.getAttribute('data-svg-drop')\n      && !this.target.closest('.layout-vertical')\n    ) {\n      this.target.closest('.svgs-container').style.maxWidth = setMaxWidth;\n    }\n  }\n\n  // _initZoom() {\n  //   const view = d3.select(`#${this.target.id} .svg-view`);\n  //   const size = [\n  //     view.attr('width'),\n  //     view.attr('height'),\n  //   ];\n  //   SVGZoom.zoom(this.target, view, size);\n  // }\n\n  _initPath(callback, color) {\n    d3.select(this.target)\n      .call(d3.drag()\n        .container(() => this.target)\n        .subject((event) => {\n          const p = [event.x.toFixed(), event.y.toFixed()];\n\n          return [p, p];\n        })\n        .on('start', (event) => {\n          SVGDraw.renderPath(event, this.target, color, callback);\n        }));\n  }\n  // _initText() {\n  //   d3.select(this.target).on('click', () => {\n  //     SVGText.openTextDialog(this.target);\n  //     d3.event.preventDefault();\n  //   });\n  // }\n\n  _initCircle(callback, color) {\n    d3.select(this.target).on('click', (event) => {\n      const item = event.target;\n      const nodeName = item.nodeName;\n      const validPlace = (nodeName === 'image');\n      // const isCircle = (__hasClass(item, 'svg-circle'));\n\n      if (!validPlace) {\n        return;\n      }\n\n      SVGDraw.createCircle(event, this.target, color);\n      callback();\n\n      event.preventDefault();\n    }, false);\n  }\n\n  _initComicBubbles() {\n    const $comicBubbles = this.target.querySelectorAll('.svg-komiks .svg-textarea');\n\n    if ($comicBubbles) {\n      $comicBubbles.forEach(($comicBubble) => {\n        SVGText.comicBubblesEventsManager(this.target, $comicBubble);\n      });\n    }\n  }\n\n  _generateNewID(oldID) {\n    const idParts = oldID.split('_');\n    // beware if it's a error, return oldID\n    if (idParts.length < 2) {\n      console.log('Svg ID error!', oldID);\n      return oldID;\n    }\n\n    // solve thirt part of id\n    if (idParts[idParts.length - 1] !== `clone-${idParts[0]}`) {\n      idParts.push(`clone-${idParts[0]}`);\n    }\n\n    // solve first part of id\n    idParts[0] = this.target.id;\n\n    const newID = idParts.join('_');\n    return newID;\n  }\n\n  _getEvents() {\n\n    const svgDuplicateSources = this.toDuplicate ? this.toDuplicate.split(' ') : [];\n\n    if (svgDuplicateSources[0]) {\n\n      document.addEventListener('svg.change', (e) => {\n        if (svgDuplicateSources.includes(e.detail.svg.id)) {\n          const $templateNode = e.detail.svg.node;\n          const $templateCircle = e.detail.svg.circle;\n          const nodeName = e.detail.svg.nodeName;\n          const localNodeID = this._generateNewID($templateNode.id);\n          const $localNode = this.target.querySelector(`#${localNodeID}`);\n          let task;\n          // for creating new element or we edit the old one after created one\n          if ($localNode || e.detail.svg.task === 'create') {\n            task = e.detail.svg.task;\n          } else {\n            return;\n          }\n\n          /**\n           * 1. divided by node name\n           * 2. divided by task type\n           * path => svg lines\n           * TEXTAREA => text fields or comic bubbles\n           * foreignObject => svg circles\n           */\n          if (nodeName === 'path') {\n            switch (task) {\n              case 'create':\n                this._clonePath($templateNode, localNodeID);\n                break;\n              case 'color':\n                __removeClass($localNode, 'red blue');\n                __addClass($localNode, e.detail.svg.color);\n                break;\n              case 'remove':\n                $localNode.remove();\n                break;\n              default:\n                console.log('Nondefinated path events task. :(');\n            }\n          } else if (nodeName === 'TEXTAREA') {\n            if (e.detail.svg.isBubble) {\n              switch (task) {\n                case 'create':\n                  this._cloneComicBubbles($templateNode, localNodeID);\n                  break;\n                case 'change':\n                  if ($templateNode.value.length !== 0) {\n                    $localNode.value = $templateNode.value;\n                    // if needs resize\n                    if ($localNode.style.height !== $templateNode.style.height) {\n                      $localNode.style.height = $templateNode.style.height;\n                    }\n                  } else {\n                    $localNode.parentElement.remove();\n                  }\n                  break;\n                default:\n                  console.log('Nondefinated comicBubble events task. :(');\n              }\n            } else {\n              let templateCircleID;\n\n              // for removing from radial\n              if (!$templateCircle) {\n                const idParts = $templateNode.id.split('_');\n                // the middle part\n                // svg-text.js line 44\n                idParts[1] += '-circle';\n                templateCircleID = idParts.join('_');\n              } else {\n                templateCircleID = $templateCircle.id;\n              }\n\n              const localCircleID = this._generateNewID(templateCircleID);\n              let $localCircle = this.target.querySelector(`#${localCircleID}`);\n\n              switch (task) {\n                case 'create':\n                  $localCircle = this._cloneCircle($templateCircle, localCircleID);\n                  this._cloneTextField(e.detail.svg.isWrong, $templateNode, $localCircle, localNodeID);\n                  break;\n                case 'change':\n                  $localNode.value = $templateNode.value;\n                  // if is now wrong lenght\n                  if (e.detail.svg.isWrong) {\n                    __addClass($localNode, 'is-wrong');\n                  } else {\n                    __removeClass($localNode, 'is-wrong');\n                  }\n                  // if needs resize\n                  if ($localNode.style.height !== $templateNode.style.height) {\n                    $localNode.style.height = $templateNode.style.height;\n                  }\n                  break;\n                case 'color':\n                  __removeClass($localCircle, 'red blue');\n                  __addClass($localCircle, e.detail.svg.color);\n                  break;\n                case 'move':\n                  if ($localNode) {\n                    $localNode.parentElement.remove();\n                    $localCircle.remove();\n                  }\n                  $localCircle = this._cloneCircle($templateCircle, localCircleID);\n                  this._cloneTextField(e.detail.svg.isWrong, $templateNode, $localCircle, localNodeID);\n                  break;\n                case 'remove':\n                  $localNode.parentElement.remove();\n                  $localCircle.remove();\n                  break;\n                default:\n                  console.log('Nondefinated textField events task. :(');\n              }\n            }\n          } else if (nodeName === 'foreignObject' || nodeName === 'circle') {\n            switch (task) {\n              case 'create':\n                this._cloneCircle($templateNode, localNodeID);\n                break;\n              case 'color':\n                __removeClass($localNode, 'red blue');\n                __addClass($localNode, e.detail.svg.color);\n                break;\n              case 'move':\n                if ($localNode) {\n                  $localNode.remove();\n                }\n                this._cloneCircle($templateNode, localNodeID);\n                break;\n              case 'remove':\n                $localNode.remove();\n                break;\n              default:\n                console.log('Nondefinated circle events task. :(');\n            }\n          } else {\n            console.log('Nondefinated events nodeName. :(', nodeName);\n          }\n\n          // dispatch event that svg has changed\n          __dispatchEvent(document, 'svg.change', {}, {\n            svg: {\n              id: this.target.id,\n              task: e.detail.svg.task,\n              node: $templateNode,\n              circle: $templateCircle,\n              nodeName,\n              contextMenu: false,\n            },\n          });\n        }\n      });\n    }\n  }\n\n  _getDropEvent() {\n    // need if we drop more than one same item\n    let idSalt = 0;\n\n    document.addEventListener('svg.drop', (event) => {\n\n      if (event.detail.svg.id === this.target.id) {\n\n        const { $node, position, type, size } = event.detail.svg;\n\n        const getMultiply = () => {\n          // make images smaller when dropped\n          if (type === 'image' || type === 'svg') return .62;\n          // make tags larger when dropped to not jump on more lines\n          if (type === 'tag') return 1.075;\n\n          return 1;\n        }\n        const multiply = getMultiply();\n\n        size.width = size.width * multiply;\n        size.height = size.height * multiply;\n\n        const $d3canvas = d3.select(`#${this.target.id} .svg-view`);\n        const $d3foreignObject = $d3canvas.append('svg:foreignObject')\n          .attr('width', size.width)\n          .attr('height', size.height)\n          .attr('x', this.format(position[0] - (size.width / 2)))\n          .attr('y', this.format(position[1] - (size.height / 2)))\n          .attr('data-svg-resolution', `${$d3canvas.attr('width')}, ${$d3canvas.attr('height')}`)\n          .attr('data-svg-type', 'pretahovani')\n          .attr('id', `${this.target.id}_${$node.getAttribute('data-id')}_${idSalt}_dropItem`);\n          // _dropItem is important identifier\n\n        const $dropItem = document.createElement('div');\n        $dropItem.classList.add('dropped__item', `dropped__item--${type}`);\n        $dropItem.appendChild($node.firstElementChild.firstElementChild);\n\n        $d3foreignObject.append(() => $dropItem);\n\n        const $foreignObject = $d3foreignObject.node();\n\n        // increment salt\n        idSalt += 1;\n\n        // add events to element\n        SVGDraw.circleEventsManager(this.target, $foreignObject, $node, 'pretahovani');\n\n        // dispatch event that svg has changed\n        __dispatchEvent(document, 'svg.change', {}, {\n          svg: {\n            id: this.target.id,\n            task: 'create',\n            node: $foreignObject,\n            nodeName: $foreignObject.nodeName,\n            contextMenu: false,\n          },\n        });\n      }\n    });\n  }\n\n  _clonePath($templateNode, localNodeID) {\n    const $localNode = $templateNode.cloneNode(true);\n    $localNode.id = localNodeID;\n    this.$canvas.appendChild($localNode);\n    // add events to element\n    SVGDraw.pathEventsManager(this.target, $localNode);\n  }\n\n  _cloneTextField(isWrong, $templateNode, $localCircle, localNodeID) {\n    const $localNode = $templateNode.parentElement.cloneNode(true);\n    $localNode.childNodes[0].id = localNodeID;\n    this.$canvas.insertBefore($localNode, $localCircle);\n    if (isWrong) {\n      __addClass($localNode, 'is-wrong');\n    } else {\n      __removeClass($localNode, 'is-wrong');\n    }\n    // add events to element\n    SVGText.textEventsManager(this.target, $localNode.childNodes[0], $localCircle, false);\n  }\n\n  _cloneCircle($templateNode, localNodeID) {\n    const $localNode = $templateNode.cloneNode(true);\n    $localNode.id = localNodeID;\n    this.$canvas.appendChild($localNode);\n    SVGDraw.circleEventsManager(this.target, $localNode, $localNode, $templateNode.getAttribute('data-svg-type'));\n\n    return $localNode;\n  }\n\n  _cloneComicBubbles($templateNode, localNodeID) {\n    const $localNode = $templateNode.parentElement.cloneNode(true);\n    $localNode.childNodes[1].id = localNodeID;\n    this.$canvas.appendChild($localNode);\n    // add events to element\n    SVGText.comicBubblesEventsManager(this.target, $localNode.childNodes[1]);\n  }\n\n  static selectItem(item) {\n    item.setAttribute('data-svg-selected', 'true');\n  }\n\n  // Remove 'selected' classname from element within SVG\n  static deselectItem() {\n    // previously \"selected\" elements\n    const selected = document.querySelectorAll('[data-svg-selected=\"true\"]');\n    // unselect them\n    for (let i = 0; i < selected.length; i += 1) {\n      selected[i].setAttribute('data-svg-selected', 'false');\n    }\n  }\n\n  // Remove element from within SVG\n  // [data-svg-selected=\"true\"] marks selected element in SVG\n  static removeItem(isRadial, element = '[data-svg-selected=\"true\"]') {\n    let $element = document.querySelector(element);\n    let nodeName = $element.nodeName;\n    const $parent = $element.parentElement; // for <foreignObject>\n\n    // TEXTAREA => text field(right click in textarea)\n    // DIV => text field(click in radial menu) or circle\n    switch (nodeName) {\n      case 'path':\n      case 'circle':\n        // $element = $element;\n        break;\n      case 'TEXTAREA':\n        // $element = $element;\n        break;\n      case 'DIV':\n        if ($parent.childNodes[0]) {\n          $element = $parent.childNodes[0];\n        } else {\n          $element = $parent;\n        }\n        nodeName = $element.nodeName;\n        break;\n      default:\n        console.log('Nondefinated node type. :(', nodeName);\n    }\n\n    // get svg id from object id\n    const svgID = $element.id.split('_')[0];\n\n    // dispatch event that svg has changed\n    __dispatchEvent(document, 'svg.change', {}, {\n      svg: {\n        id: svgID,\n        task: 'remove',\n        node: $element,\n        nodeName,\n        contextMenu: isRadial,\n      },\n    });\n\n    if ($parent.nodeName === 'foreignObject') {\n      // remove comment's circle\n      // id by svg-text.js line 44\n      d3.select(`#${$element.id}-circle`).remove();\n\n      d3.select($parent).remove();\n\n      // dispatch event that drop item was deleted\n      const idParts = $parent.id.split('_');\n      if (idParts[idParts.length - 1] === 'dropItem') {\n        __dispatchEvent(document, 'svg.drop.delete', {}, {\n          item: {\n            id: idParts[1],\n            $object: $element.firstChild,\n          },\n        });\n      }\n    } else {\n      d3.select($element).remove();\n    }\n  }\n\n  // Unmark all SVGs with 'svg-active' classname\n  static deactivate() {\n    const allActiveSvgs = document.querySelectorAll('[data-svg-active=\"true\"]');\n    for (let i = 0; i < allActiveSvgs.length; i += 1) {\n      allActiveSvgs[i].setAttribute('data-svg-active', 'false');\n    }\n  }\n\n  // Mark active SVG with 'svg-active' classname\n  static activate(svg) {\n    SVG.deactivate();\n    svg.setAttribute('data-svg-active', 'true');\n  }\n\n  // Remove connection between clone and template\n  // Remove third part of id if exists\n  static removeCloneConnectionManager($node) {\n    const idParts = $node.id.split('_');\n    if (idParts[idParts.length - 1].includes('clone')) {\n      idParts.pop();\n      $node.id = idParts.join('_');\n      return true;\n    }\n    return false;\n  }\n\n  // Find near elements if exist\n  // Do nothing if event target is element of svg\n  // Small black radial menu circle has d=14px (_radial-menu.scss #radial-menu) 6\n  // check coordinates for element:\n  //  -3,-3  0,-5  +3,-3  \n  //  -5, 0        +5, 0\n  //  -3,+3  0,+5  +3,+3   \n  static findNearElements(event) {\n    let $element = event.target;\n    const relativeCoords = [\n      [-3,-3], [0,-5], [3,-3], [-5,0], [5,0], [-3,3], [0,5], [3,3]\n    ];\n    \n    // svg-radial-menu filterMenuButtons(clickedItem, hasText, hasMoreColors) 418\n    if ($element.nodeName === 'image') {\n      relativeCoords.every((coord) => {\n        const globalPosition = __globalPosition(event);\n        $element = document.elementFromPoint(globalPosition.x + coord[0], globalPosition.y + coord[1]);\n        return $element.nodeName === 'image';\n      });\n    }\n\n    return $element;\n  }\n}\n","import Component from './component';\r\nimport AudioPlayer from './media/audio-player';\r\nimport SVG from './svg';\r\nimport { stopPlayingVideoPlayers } from './media/media';\r\nimport { __dispatchEvent } from '../lib/utils';\r\n\r\nexport default class Sortable extends Component {\r\n  constructor($element) {\r\n    super($element);\r\n    this.$settings = document.querySelector(\r\n      `[data-sortable-id-reference=\"${this.target.id}\"]`,\r\n    );\r\n    this.feedback = JSON.parse(\r\n      this.$settings.getAttribute('data-module-zpetnavazba'),\r\n    );\r\n    this.$container = this.target;\r\n    this.$items = this.target.querySelectorAll('[data-sortable-drag]');\r\n    this.$droppables = this.target.querySelectorAll('[data-sortable-drop]');\r\n    this.$placeholder = () => document.querySelector('#sortable-placeholder');\r\n    this.$players = this.$container.querySelectorAll('[data-player-audio]');\r\n    this.$inheritors = document.querySelectorAll(\r\n      `[data-sortable-inheritor=${this.target.id}]`,\r\n    );\r\n    this.inheritors = [];\r\n    this.order = [];\r\n\r\n    // get direction (type of sortable \"horizontalni\" or \"vertikalni\")\r\n    this.direction = this.target.getAttribute('data-sortable-target');\r\n    this.trackingTouch = false;\r\n    this.before = false;\r\n    this.after = false;\r\n    this.evaluation = undefined;\r\n\r\n    this.mouse = {\r\n      x: (event) => event.clientX || event.touches[0].clientX,\r\n      y: (event) => event.clientY || event.touches[0].clientY,\r\n      x0: 0,\r\n      y0: 0,\r\n      x1: 0,\r\n      y1: 0,\r\n    };\r\n\r\n    this.dragged = {\r\n      el: null,\r\n      clone: null,\r\n      posRel: {},\r\n      rect: () => this.dragged.el.getBoundingClientRect(),\r\n      size: {},\r\n      type: null,\r\n    };\r\n\r\n    this.siblings = {\r\n      prev: null,\r\n      next: null,\r\n    };\r\n\r\n    this._onStart = this._onStart.bind(this);\r\n    this._onMove = this._onMove.bind(this);\r\n    this._onEnd = this._onEnd.bind(this);\r\n    this._update = this._update.bind(this);\r\n\r\n    this._setupInitialOrder();\r\n    this._setupInheritors();\r\n    this._addEventListeners();\r\n\r\n    this.cache = {\r\n      colors: []\r\n    };\r\n\r\n    // get colors for all feedback variants\r\n    if (this.feedback) {\r\n      this.cache.colors = this.feedback.map(feedback => feedback.barva);\r\n    }\r\n  }\r\n\r\n  _onStart(event) {\r\n    if (!event.target.hasAttribute('data-sortable-drag')) {\r\n      return;\r\n    }\r\n\r\n    // TODO: zastavit všechno audio on drag start\r\n    if (this.$players.length > 0) {\r\n      stopPlayingVideoPlayers(this.$players);\r\n    }\r\n\r\n    this.trackingTouch = true;\r\n\r\n    this.dragged.el = event.target;\r\n    this.dragged.type = event.target.getAttribute('data-sortable-drag');\r\n    this.dragged.clone = this.dragged.el.cloneNode(true);\r\n    this.dragged.posRel.top = this.dragged.el.offsetTop;\r\n    this.dragged.posRel.left = this.dragged.el.offsetLeft;\r\n    this.dragged.size.width = this.dragged.el.offsetWidth;\r\n    this.dragged.size.height = this.dragged.el.offsetHeight;\r\n\r\n    this.dragged.el.style.top = `${this.dragged.posRel.top}px`;\r\n    this.dragged.el.style.left = `${this.dragged.posRel.left}px`;\r\n    this.dragged.el.style.width = `${this.dragged.size.width}px`;\r\n    this.dragged.el.style.height = `${this.dragged.size.height}px`;\r\n    this.dragged.el.classList.add('is-dragged');\r\n\r\n    this.$container.classList.add('is-dragged');\r\n\r\n    this._addPlaceholder(this.dragged.el);\r\n    this._onOver();\r\n\r\n    this.mouse.x0 = this.mouse.x(event);\r\n    this.mouse.y0 = this.mouse.y(event);\r\n\r\n    event.preventDefault();\r\n  }\r\n\r\n  _onMove(event) {\r\n    if (!this.trackingTouch) {\r\n      return;\r\n    }\r\n\r\n    this.mouse.x1 = this.mouse.x(event) - this.mouse.x0;\r\n    this.mouse.y1 = this.mouse.y(event) - this.mouse.y0;\r\n\r\n    window.requestAnimationFrame(this._update);\r\n\r\n    this._onOver();\r\n  }\r\n\r\n  _onEnd(event) {\r\n    if (!this.trackingTouch) {\r\n      return;\r\n    }\r\n\r\n    this.trackingTouch = false;\r\n    this.$container.classList.remove('is-dragged');\r\n    this.dragged.el.classList.remove('is-dragged');\r\n    this.dragged.el.style.top = '';\r\n    this.dragged.el.style.left = '';\r\n    this.dragged.el.style.width = '';\r\n    this.dragged.el.style.height = '';\r\n    this.dragged.el.style.transform = '';\r\n\r\n    const $placeholder = this.$placeholder();\r\n    const rect = $placeholder.getBoundingClientRect();\r\n\r\n    switch (this.direction) {\r\n      case 'horizontal':\r\n        if (rect.left <= this.mouse.x(event) <= rect.right) {\r\n          this._onDrop();\r\n        }\r\n        break;\r\n      case 'vertical':\r\n        if (rect.top <= this.mouse.y(event) <= rect.bottom) {\r\n          this._onDrop();\r\n        }\r\n        break;\r\n\r\n      default:\r\n        break;\r\n    }\r\n\r\n    this._removePlaceholder();\r\n    this._updateOrder();\r\n    this._updateOrderInInheritors();\r\n    this._dispatchEvent();\r\n    this._checkAndResolveFeedback();\r\n  }\r\n\r\n  // _onEnter() {}\r\n\r\n  _onOver() {\r\n    this.before = false;\r\n    this.after = false;\r\n\r\n    this._getReference();\r\n\r\n    if (\r\n      this.siblings.next\r\n      && this.siblings.next.hasAttribute('data-sortable-drop')\r\n    ) {\r\n      const next = this.siblings.next.getBoundingClientRect();\r\n\r\n      switch (this.direction) {\r\n        case 'horizontal':\r\n          if (this.dragged.rect().right > next.left + next.width / 1.5) {\r\n            this.after = true;\r\n            this._addPlaceholder(this.siblings.next);\r\n          }\r\n          break;\r\n        case 'vertical':\r\n          if (this.dragged.rect().bottom > next.top + next.height / 1.5) {\r\n            this.after = true;\r\n            this._addPlaceholder(this.siblings.next);\r\n          }\r\n          break;\r\n\r\n        default:\r\n          break;\r\n      }\r\n    }\r\n\r\n    if (\r\n      this.siblings.prev\r\n      && this.siblings.prev.hasAttribute('data-sortable-drop')\r\n    ) {\r\n      const prev = this.siblings.prev.getBoundingClientRect();\r\n\r\n      switch (this.direction) {\r\n        case 'horizontal':\r\n          if (this.dragged.rect().left < prev.right - prev.width / 1.5) {\r\n            this.before = true;\r\n            this._addPlaceholder(this.siblings.prev);\r\n          }\r\n          break;\r\n        case 'vertical':\r\n          if (this.dragged.rect().top < prev.bottom - prev.height / 1.5) {\r\n            this.before = true;\r\n            this._addPlaceholder(this.siblings.prev);\r\n          }\r\n          break;\r\n\r\n        default:\r\n          break;\r\n      }\r\n    }\r\n  }\r\n\r\n  // _onLeave() {}\r\n\r\n  _onDrop() {\r\n    const $placeholder = this.$placeholder();\r\n\r\n    this._addEventListenerToItem(this.dragged.clone);\r\n    // TODO: přiřadit eventListenery audio playerům\r\n    if (this.dragged.clone.querySelector('[data-player-audio]')) {\r\n      AudioPlayer.addEventListeners(this.dragged.clone, this.showFeedback);\r\n    }\r\n\r\n    this.$container.insertBefore(this.dragged.clone, $placeholder);\r\n    this.dragged.el.parentElement.removeChild(this.dragged.el);\r\n  }\r\n\r\n  _update() {\r\n    this.dragged.el.style.transform = `translate3d(${this.mouse.x1}px, ${this.mouse.y1}px, 0) rotate(5deg)`;\r\n  }\r\n\r\n  _addPlaceholder(item) {\r\n    this._removePlaceholder();\r\n\r\n    const $placeholder = document.createElement('div');\r\n    $placeholder.classList.add('sortable-item', 'sortable-placeholder');\r\n    $placeholder.setAttribute('id', 'sortable-placeholder');\r\n    $placeholder.style.minHeight = `${this.dragged.size.height}px`;\r\n\r\n    if (this.dragged.el.querySelector('img')) {\r\n      const src = this.dragged.el.querySelector('img').getAttribute('src');\r\n      const img = document.createElement('img');\r\n      img.setAttribute('src', src);\r\n      $placeholder.appendChild(img);\r\n    }\r\n\r\n    if (this.after) {\r\n      this.$container.insertBefore($placeholder, item.nextElementSibling);\r\n    } else if (this.before) {\r\n      this.$container.insertBefore($placeholder, item);\r\n    } else {\r\n      this.$container.insertBefore($placeholder, item);\r\n    }\r\n  }\r\n\r\n  _removePlaceholder() {\r\n    const $placeholder = this.$placeholder();\r\n    if ($placeholder) $placeholder.parentElement.removeChild($placeholder);\r\n  }\r\n\r\n  _getReference() {\r\n    const $placeholder = this.$placeholder();\r\n    this.siblings.prev =\r\n      $placeholder.previousElementSibling === this.dragged.el\r\n        ? this.dragged.el.previousElementSibling\r\n        : $placeholder.previousElementSibling;\r\n    this.siblings.next =\r\n      $placeholder.nextElementSibling === this.dragged.el\r\n        ? this.dragged.el.nextElementSibling\r\n        : $placeholder.nextElementSibling;\r\n  }\r\n\r\n  _addEventListenerToItem($item) {\r\n    // touch events\r\n    $item.addEventListener('touchstart', this._onStart, false);\r\n    // mouse events\r\n    $item.addEventListener('mousedown', this._onStart, false);\r\n\r\n    if (this.dragged.type === 'svg') {\r\n      const svg = new SVG($item.querySelector('[data-svg-target]'));\r\n    }\r\n  }\r\n\r\n  _addEventListeners() {\r\n    // touch events\r\n    document.addEventListener('touchmove', this._onMove);\r\n    document.addEventListener('touchend', this._onEnd);\r\n    // mouse events\r\n    document.addEventListener('mousemove', this._onMove);\r\n    document.addEventListener('mouseup', this._onEnd);\r\n\r\n    this.$items.forEach(($item) => {\r\n      this._addEventListenerToItem($item);\r\n    });\r\n  }\r\n\r\n  // Methods for check if the array is sorted or not\r\n  // Return True: array is in the right state, False: array is NOT in the right state\r\n  // Array looks like: [1,2,3,4]\r\n  // eslint-disable-next-line class-methods-use-this\r\n  checkIfTheArrayIsGood(array) {\r\n    // condition for function some(), return if there is item in array which is not in right position\r\n    const elementInWrongPosition = (element, index) => index !== (element - 1);\r\n    // all has to be negate, to return the right condition (true: sorted, false:not sorted)\r\n    return !array.some(elementInWrongPosition);\r\n  }\r\n\r\n  // Method which check how many steps needs to be done to sort array\r\n  // Return: 0 -> 0 steps, array is sorted\r\n  //        1 -> 1 steps is needed for sort the array\r\n  //        2 -> 2 and more steps is needed for sort the array\r\n  // Array looks like: [1,2,3,4]\r\n  oneMove(array) {\r\n    if (this.checkIfTheArrayIsGood(array)) return 0; // Check if the array is sorted\r\n    for (let i = 0; i < array.length; i += 1) {\r\n      if (array[i] !== i + 1) {\r\n        const changedArray = [...array];\r\n        const element = changedArray[i];\r\n        changedArray.splice(i, 1);\r\n        changedArray.splice(element - 1, 0, element);\r\n\r\n        if (this.checkIfTheArrayIsGood(changedArray)) return 1; // Check if the array after 1 step is sorted\r\n      }\r\n    }\r\n    return 2; // In every other results the array needs more than 2 steps to be sorted\r\n  }\r\n\r\n  // After interaction with modul razeni this method is called to resolve a feedback button\r\n  _checkAndResolveFeedback() {\r\n    if (this.feedback) {\r\n      // Get the array of items (gets only their correct position - in int), example -> [1,3,4,2]\r\n      const arrayOfItems = [\r\n        ...this.target.querySelectorAll('[data-sortable-drag]'),\r\n      ].map((item) => parseInt(item.dataset.sortableSpravnaodpoved, 10));\r\n\r\n      // variable to map a feedback which is got from condition in JSON\r\n      let feedbackResult = 0;\r\n\r\n      // Check if the zpetnaVazba is 2 or 3 conditional\r\n      if (this.feedback.length === 2) {\r\n        if (!this.checkIfTheArrayIsGood(arrayOfItems)) {\r\n          feedbackResult = 1;\r\n        }\r\n      }\r\n      else {\r\n        feedbackResult = this.oneMove(arrayOfItems);\r\n      }\r\n\r\n      // map feedback via feedbackResult\r\n      const feedbackActual = this.feedback.find((feedback) => feedback.podminka === feedbackResult);\r\n\r\n      this.$buttonFeedback.classList.remove(...this.cache.colors);\r\n      this.$buttonFeedback.classList.add(feedbackActual.barva);\r\n      this.$buttonFeedbackText.innerText = feedbackActual.text;\r\n      this.evaluation = feedbackActual.splneno;\r\n    }\r\n    this.showFeedback();\r\n  }\r\n\r\n  _setupInitialOrder() {\r\n    this._updateOrder();\r\n  }\r\n\r\n  _setupInheritors() {\r\n    if (this.$inheritors.length > 0) {\r\n      this.inheritors = Array.from(this.$inheritors).map(($inheritor) => ({\r\n        $inheritor,\r\n        $container: $inheritor.querySelector('[data-sortable-inheritor-item]')\r\n          .parentElement,\r\n      }));\r\n    }\r\n  }\r\n\r\n  _updateOrder() {\r\n    this.order = Array.from(\r\n      this.target.querySelectorAll('[data-sortable-drag]'),\r\n    ).map(($item) => ({ id: parseInt($item.dataset.sortableIndex, 10) }));\r\n  }\r\n\r\n  _updateOrderInInheritors() {\r\n    if (this.$inheritors.length > 0) {\r\n      this.inheritors.forEach((inheritor) => {\r\n        this.order.forEach((item) => {\r\n          inheritor.$container.appendChild(\r\n            inheritor.$container.querySelector(\r\n              `[data-sortable-inheritor-item=\"${item.id}\"]`,\r\n            ),\r\n          );\r\n        });\r\n      });\r\n    }\r\n  }\r\n\r\n  _dispatchEvent() {\r\n    __dispatchEvent(\r\n      this.target,\r\n      'sortable.change',\r\n      {},\r\n      {\r\n        id: this.target.id,\r\n        evaluation: this.evaluation,\r\n        order: this.order,\r\n      },\r\n    );\r\n  }\r\n}\r\n","/* eslint-disable brace-style */\r\nimport {\r\n  __addClass,\r\n  __removeClass,\r\n  __hasClass,\r\n  __localPosition,\r\n  __globalPosition,\r\n  __dispatchEvent,\r\n} from '../../lib/utils';\r\nimport SVG from '../svg';\r\nimport SVGText from './svg-text';\r\n\r\nexport default class SVGRadialMenu {\r\n\r\n  constructor($radialMenu, $svgs) {\r\n    this.$radialMenu = $radialMenu;\r\n    this.$radialMenuItems = this.$radialMenu.querySelectorAll('[data-radial-menu-item]');\r\n    this.$colorItems = this.$radialMenu.querySelectorAll('.radial-menu-color');\r\n    this.$textItems = this.$radialMenu.querySelectorAll('.radial-menu-text');\r\n    this.$createTextItem = this.$radialMenu.querySelector('#create-text');\r\n    this.$removeItem = this.$radialMenu.querySelector('#remove-content');\r\n    this.$tooltip = this.$radialMenu.querySelector('[data-radial-menu-tooltip]');\r\n    this.$svgs = $svgs;\r\n\r\n    this.initialSetUp = true;\r\n\r\n    this.menuRadius = parseInt(window.getComputedStyle(this.$radialMenu.querySelector('.radial-menu-wrapper'), null).getPropertyValue('width'), 10) / 2;\r\n    this.itemRadius = parseInt(window.getComputedStyle(this.$radialMenu.querySelector('.radial-menu-item'), null).getPropertyValue('width'), 10) / 2;\r\n\r\n    this.init();\r\n  }\r\n\r\n  init() {\r\n    this.setUpRadialMenuItems();\r\n    this.addEventListenersToRadialMenu();\r\n\r\n    // activate radial menu when right click on svg\r\n    this.$svgs.forEach(($svg) => {\r\n      d3.select($svg)\r\n        .on('contextmenu', (event) => {\r\n          this.openRadialMenu(event, $svg);\r\n        });\r\n\r\n      this.iOSAddonEvents($svg);\r\n    });\r\n  }\r\n\r\n  static hasText($svg) {\r\n    const svgSpecificActions = $svg.getAttribute('data-svg-target').split(' ');\r\n    return svgSpecificActions.includes('text');\r\n  }\r\n\r\n  static hasMoreColors($svg) {\r\n    const colors = $svg.getAttribute('data-svg-colors');\r\n    const svgSpecificColor = colors ? colors.split(' ') : undefined;\r\n    return (svgSpecificColor && svgSpecificColor.length > 1) || !colors;\r\n  }\r\n\r\n  iOSAddonEvents($svg) {\r\n    // https://www.geeksforgeeks.org/detect-a-device-is-ios-or-not-using-javascript/\r\n    // https://github.com/victorqribeiro/radialMenu/blob/master/src/RadialMenu.js#L437\r\n    const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;\r\n    if (isIOS) {\r\n      console.log('This is a IOS device');\r\n      let timer;\r\n\r\n      // circle events\r\n      document.addEventListener('event.propagation', (e) => {\r\n        const event = e.detail.event.data.sourceEvent;\r\n\r\n        timer = setTimeout(() => {\r\n          event.preventDefault();\r\n          // first remove current selection\r\n          window.getSelection().removeAllRanges();\r\n          // set class for unselectable\r\n          event.target.classList.add('unselectable');\r\n          this.openRadialMenu(event, $svg);\r\n        }, 500);\r\n      });\r\n\r\n      document.addEventListener('event.stopPropagation', () => {\r\n        if (timer) clearTimeout(timer);\r\n      });\r\n\r\n      // image events\r\n      d3.select($svg)\r\n        .on('touchstart', (event) => {\r\n          // enable mobil yoom gesture\r\n          if (event.touches.length === 1) {\r\n            timer = setTimeout(() => {\r\n              event.preventDefault();\r\n              this.openRadialMenu(event, $svg);\r\n            }, 500);\r\n          }\r\n        })\r\n        .on('touchmove', (event) => {\r\n          event.preventDefault();\r\n          if (timer) clearTimeout(timer);\r\n        })\r\n        .on('touchend', () => {\r\n          if (timer) clearTimeout(timer);\r\n        })\r\n        .on('touchcancel', (event) => {\r\n          event.preventDefault();\r\n          if (timer) clearTimeout(timer);\r\n\r\n        });\r\n    }\r\n  }\r\n\r\n  openRadialMenu(event, $svg) {\r\n    const hasText = SVGRadialMenu.hasText($svg);\r\n    const hasMoreColors = SVGRadialMenu.hasMoreColors($svg);\r\n    \r\n    // fix for drawing and helpful for touch devices\r\n    const $clickedItem = SVG.findNearElements(event);\r\n    // mark this SVG as the active one\r\n    SVG.activate($svg);\r\n    // deselect all previously selected items\r\n    SVG.deselectItem();\r\n    // show radial menu buttons based on clicked element\r\n    // and .select appropriate elements based on clicked element\r\n    this.filterMenuButtons($clickedItem, hasText, hasMoreColors);\r\n    this.showRadialMenu(event, $svg);\r\n    // prevent default 'contextmenu' event\r\n    event.preventDefault();\r\n\r\n    this.initialSetUp = false;\r\n  }\r\n\r\n  setUpRadialMenuItems() {\r\n    // this.positionRadialMenuItems(this.$radialMenuItems);\r\n\r\n    this.$radialMenuItems.forEach(($item) => {\r\n      this.addEventListenersToRadialMenuItem($item);\r\n    });\r\n  }\r\n\r\n  positionRadialMenuItems($items) {\r\n    const _itemsLength = $items.length;\r\n    const _menuRadius = this.menuRadius;\r\n    const _itemRadius = this.itemRadius;\r\n    const _menuOffset = _menuRadius - _itemRadius;\r\n    const _interval = 0.6283185307;\r\n    // if more items center them\r\n    const _centerOffset = (-_interval / 2) + ((_itemsLength * _interval) / 2);\r\n\r\n    // make a \"flower\"\r\n    $items.forEach(($item, index) => {\r\n      // Calculate the angle at which the element will be placed.\r\n      // For a semicircle, we would use (index / _itemsLength) * Math.PI.\r\n      const angle = (Math.PI + ((index * _interval) * -1)) + _centerOffset;\r\n\r\n      // get position\r\n      const x = (_menuRadius * Math.sin(angle)) + _menuOffset;\r\n      const y = (_menuRadius * Math.cos(angle)) + _menuOffset;\r\n\r\n      // console.log('x: ' + x);\r\n      // console.log('y: ' + y);\r\n\r\n      $item.style.left = `${x.toFixed(1)}px`;\r\n      $item.style.top = `${y.toFixed(1)}px`;\r\n\r\n      // if (this.initialSetUp === true) {\r\n      //   this.addEventListenersToRadialMenuItem($item);\r\n      // }\r\n    });\r\n  }\r\n\r\n  addEventListenersToRadialMenu() {\r\n    this.onMouseLeave();\r\n\r\n    this.$radialMenu.addEventListener('click', (event) => {\r\n      this.hideRadialMenu(this.$radialMenu);\r\n      event.preventDefault();\r\n    });\r\n\r\n    this.$radialMenu.addEventListener('contextmenu', (event) => {\r\n      this.hideRadialMenu(this.$radialMenu);\r\n      event.preventDefault();\r\n    });\r\n  }\r\n\r\n  addEventListenersToRadialMenuItem(item) {\r\n    const $item = item;\r\n\r\n    // actions\r\n    const action = $item.getAttribute('data-radial-menu-item');\r\n    // remove item\r\n    if (action === 'remove-content') {\r\n      $item.addEventListener('click', () => {\r\n        SVG.removeItem(true);\r\n        this.hideRadialMenu();\r\n      }, false);\r\n    }\r\n    // create user text\r\n    else if (action === 'create-text') {\r\n      d3.select($item).on('click', () => {\r\n        SVGText.createText();\r\n        this.hideRadialMenu();\r\n      }, false);\r\n    }\r\n    // označit podobnost\r\n    else if (action === 'color-point-blue') {\r\n      $item.addEventListener('click', () => {\r\n        SVGRadialMenu.changeColor('blue');\r\n        this.hideRadialMenu();\r\n      }, false);\r\n    }\r\n    // označit rozdil\r\n    else if (action === 'color-point-red') {\r\n      $item.addEventListener('click', () => {\r\n        SVGRadialMenu.changeColor('red');\r\n        this.hideRadialMenu();\r\n      }, false);\r\n    }\r\n    // označit rozdil\r\n    else if (action === 'color-point-red') {\r\n      $item.addEventListener('click', () => {\r\n        SVGRadialMenu.changeColor('red');\r\n        this.hideRadialMenu();\r\n      }, false);\r\n    }\r\n    // přiřadit kategorii\r\n    // else if (action === 'category') {\r\n    //   const category = $item.getAttribute('data-category');\r\n    //   const categoryLabel = $item.getAttribute('data-radial-menu-item-tooltip');\r\n\r\n    //   $item.addEventListener('click', () => {\r\n    //     const $selected = document.querySelector('[data-svg-selected=\"true\"]');\r\n    //     const $parentForeignObject = $selected.parentElement;\r\n    //     let $category = $parentForeignObject.querySelector('.svg-category-label');\r\n\r\n    //     $selected.setAttribute('data-svg-category', category);\r\n\r\n    //     if (!$category) {\r\n    //       $category = document.createElement('div');\r\n    //       $category.classList.add('svg-category-label');\r\n    //       $parentForeignObject.prepend($category);\r\n    //     }\r\n\r\n    //     $category.innerText = categoryLabel;\r\n\r\n    //     this.hideRadialMenu();\r\n    //   }, false);\r\n    // }\r\n\r\n    // tooltip\r\n    $item.addEventListener('mouseenter', (event) => {\r\n      this.$tooltip.innerHTML = event.currentTarget.getAttribute('data-radial-menu-item-tooltip');\r\n      this.$tooltip.style.display = 'block';\r\n    }, false);\r\n    $item.addEventListener('mouseleave', () => {\r\n      this.$tooltip.innerHTML = '';\r\n      this.$tooltip.style.display = 'none';\r\n    }, false);\r\n  }\r\n\r\n  // Draw a SVG circle on click\r\n  static changeColor(color, element = '[data-svg-selected=\"true\"]') {\r\n    let $element = document.querySelector(element);\r\n    let { nodeName } = $element;\r\n    let taskType = 'color';\r\n\r\n    __removeClass($element, 'red blue');\r\n    __addClass($element, color);\r\n\r\n    // DIV => text field  or circle\r\n    switch (nodeName) {\r\n      case 'path':\r\n      case 'circle':\r\n        // $element = $element;\r\n        break;\r\n      case 'DIV':\r\n        if ($element.parentElement.childNodes[1]) {\r\n          $element = $element.parentElement.childNodes[1];\r\n        } else {\r\n          $element = $element.parentElement;\r\n        }\r\n        nodeName = $element.nodeName;\r\n        break;\r\n      default:\r\n        console.log('Nondefinated node type. :(', nodeName);\r\n    }\r\n\r\n    // if clone is changed, then dispatch create event\r\n    if (SVG.removeCloneConnectionManager($element)) taskType = 'create';\r\n\r\n    // get svg id from object id\r\n    const svgID = $element.id.split('_')[0];\r\n\r\n    // dispatch event that svg has changed\r\n    __dispatchEvent(document, 'svg.change', {}, {\r\n      svg: {\r\n        id: svgID,\r\n        task: taskType,\r\n        node: $element,\r\n        nodeName,\r\n        contextMenu: true,\r\n        color,\r\n      },\r\n    });\r\n  }\r\n\r\n  showRadialMenu(event, $activeSVG) {\r\n    const $svg = $activeSVG || document.querySelector('[data-svg-active=\"true\"]');\r\n    // get global position of the right click event\r\n    const globalPosition = __globalPosition(event);\r\n    const localPosition = __localPosition(event, $svg);\r\n    this.$radialMenu.setAttribute('data-local-x', localPosition.x);\r\n    this.$radialMenu.setAttribute('data-local-y', localPosition.y);\r\n    // set position of radial menu\r\n    // number of 13 is size of #radial-menu\r\n    this.$radialMenu.style.top = `${globalPosition.y - 7}px`;\r\n    this.$radialMenu.style.left = `${globalPosition.x - 7}px`;\r\n\r\n    // make a flower\r\n    const $activeRadialMenuItem = this.$radialMenu.querySelectorAll('.is-active');\r\n    this.positionRadialMenuItems($activeRadialMenuItem);\r\n\r\n    // show radial menu\r\n    __addClass(this.$radialMenu, 'is-active');\r\n\r\n    // return {\r\n    //   localPosition,\r\n    //   globalPosition,\r\n    // };\r\n  }\r\n\r\n  hideRadialMenu() {\r\n    // hide radial menu\r\n    __removeClass(this.$radialMenu, 'is-active');\r\n    // deactivate all SVGs\r\n    SVG.deactivate();\r\n    // deselect all SVG items\r\n    SVG.deselectItem();\r\n\r\n    // deactivate radial menu items when the menu is hidden\r\n    setTimeout(() => {\r\n      if (!__hasClass(this.$radialMenu, 'is-active')) {\r\n        this.$radialMenuItems.forEach(($item) => {\r\n          __removeClass($item, 'is-active');\r\n        });\r\n      }\r\n    }, 150);\r\n  }\r\n\r\n  onMouseLeave() {\r\n    let mouseLeaveDelay;\r\n\r\n    this.$radialMenu.addEventListener('mouseleave', () => {\r\n      mouseLeaveDelay = setTimeout(() => {\r\n        this.hideRadialMenu(this.$radialMenu);\r\n      }, 500);\r\n    });\r\n\r\n    this.$radialMenu.addEventListener('mouseenter', () => {\r\n      clearTimeout(mouseLeaveDelay);\r\n    });\r\n  }\r\n\r\n  filterMenuButtons(clickedItem, hasText, hasMoreColors) {\r\n    if (__hasClass(clickedItem, 'svg-path') || clickedItem.nodeName === 'path') {\r\n      if (hasText) {\r\n        __addClass(this.$createTextItem, 'is-active');\r\n      } else {\r\n        __removeClass(this.$createTextItem, 'is-active');\r\n      }\r\n      // __addClass(this.$removeItem, 'is-active');\r\n\r\n      if (hasMoreColors) {\r\n        this.$colorItems.forEach(($colorItem) => {\r\n          __addClass($colorItem, 'is-active');\r\n        });\r\n      }\r\n\r\n      this.$textItems.forEach(($textItem) => {\r\n        __removeClass($textItem, 'is-active');\r\n      });\r\n\r\n      // mark it as slected\r\n      // SVG.selectItem(clickedItem);\r\n    }\r\n    if (__hasClass(clickedItem, 'svg-circle')) {\r\n      if (hasText) {\r\n        __addClass(this.$createTextItem, 'is-active');\r\n      } else {\r\n        __removeClass(this.$createTextItem, 'is-active');\r\n      }\r\n      // __addClass(this.$removeItem, 'is-active');\r\n\r\n      if (hasMoreColors) {\r\n        this.$colorItems.forEach(($colorItem) => {\r\n          __addClass($colorItem, 'is-active');\r\n        });\r\n      }\r\n\r\n      this.$textItems.forEach(($textItem) => {\r\n        __removeClass($textItem, 'is-active');\r\n      });\r\n\r\n      // mark it as slected\r\n      // SVG.selectItem(clickedItem);\r\n    }\r\n    if (__hasClass(clickedItem, 'svg-textarea')) {\r\n      __removeClass(this.$createTextItem, 'is-active');\r\n      // __addClass(this.$removeItem, 'is-active');\r\n\r\n      if (!__hasClass(clickedItem, 'do-not-remove')) {\r\n        this.$colorItems.forEach(($colorItem) => {\r\n          __removeClass($colorItem, 'is-active');\r\n        });\r\n\r\n        this.$textItems.forEach(($textItem) => {\r\n          __addClass($textItem, 'is-active');\r\n        });\r\n      }\r\n\r\n      // mark it as slected\r\n      // SVG.selectItem(clickedItem);\r\n    }\r\n    if (clickedItem.nodeName === 'image') {\r\n      if (hasText) {\r\n        __addClass(this.$createTextItem, 'is-active');\r\n      } else {\r\n        __removeClass(this.$createTextItem, 'is-active');\r\n      }\r\n\r\n      __removeClass(this.$removeItem, 'is-active');\r\n\r\n      this.$colorItems.forEach(($colorItem) => {\r\n        __removeClass($colorItem, 'is-active');\r\n      });\r\n\r\n      this.$textItems.forEach(($textItem) => {\r\n        __removeClass($textItem, 'is-active');\r\n      });\r\n    }\r\n    else {\r\n      if (__hasClass(clickedItem, 'do-not-remove')) {\r\n        __removeClass(this.$removeItem, 'is-active');\r\n      } else {\r\n        if (hasText) {\r\n          __addClass(this.$createTextItem, 'is-active');\r\n        } else {\r\n          __removeClass(this.$createTextItem, 'is-active');\r\n        }\r\n        __addClass(this.$removeItem, 'is-active');\r\n      }\r\n      // mark it as slected\r\n      SVG.selectItem(clickedItem);\r\n    }\r\n  }\r\n}\r\n","import { __dispatchEvent } from '../../lib/utils';\r\n\r\n// plugin specification: https://prosemirror.net/docs/ref/#state.Plugin_System\r\nexport default class SelectionMenu {\r\n  constructor(editorId, schema, editorView, $menuTemplate) {\r\n    this.$menuBox = $menuTemplate;\r\n\r\n    this.init(editorId, schema, editorView);\r\n    this.update(editorView, null);\r\n  }\r\n\r\n  init(editorId, schema, editorView) {\r\n    const { nodes, marks } = schema;\r\n\r\n    // menu close buttom logic\r\n    // In Firefox still is selected text\r\n    const $closeButton = this.$menuBox.querySelector('a');\r\n    $closeButton.addEventListener('click', () => {\r\n      this.update(editorView);\r\n    });\r\n\r\n    // hide menu after unfocus editor\r\n    editorView.dom.parentNode.addEventListener('blur', (event) => {\r\n      if (event.relatedTarget\r\n        && !event.relatedTarget.classList.contains('menu-item') // no menu button\r\n        && !event.relatedTarget.classList.contains('contextual-menu-component')) { // no menu close button\r\n        this.update(editorView);\r\n      }\r\n    });\r\n\r\n    // menu items logic\r\n    const $menuItems = this.$menuBox.querySelectorAll('.menu-item');\r\n    // sugar for creating different data-tag-id\r\n    let sugar = 0;\r\n\r\n    if ($menuItems) {\r\n      $menuItems.forEach(($menuItem) => {\r\n        // get attributes for marked parts\r\n        const color = $menuItem.getAttribute('data-color');\r\n        const dataCommandName = $menuItem.getAttribute('data-command-name');\r\n\r\n        $menuItem.addEventListener('click', (event) => {\r\n          event.preventDefault();\r\n\r\n          if (!SelectionMenu.isAdded(marks.marker, editorView.state)) {\r\n            // create unique dataTagId\r\n            const dataTagId = `${this.$menuBox.id}-${sugar}`;\r\n            // add remove button from schema\r\n            SelectionMenu.addRemoveButton(editorView, nodes.removeButton);\r\n            // define command\r\n            // https://github.com/ProseMirror/prosemirror-commands/blob/91f86b300ba850d496cc6e142c0aed9ae81893f1/src/commands.js#L488\r\n            // https://github.com/ProseMirror/prosemirror-transform/blob/03a011ae1e098b958f9479c1cee1e997cef2ba4d/src/mark.js#L9\r\n            // https://github.com/ProseMirror/prosemirror-transform/blob/03a011ae1e098b958f9479c1cee1e997cef2ba4d/src/mark_step.js#L16\r\n            // https://github.com/ProseMirror/prosemirror-transform/blob/master/CHANGELOG.md#129-2021-01-19\r\n            const command = pm.toggleMark(marks.marker, { color, dataCommandName, dataTagId });\r\n            // marked selection part\r\n            command(editorView.state, editorView.dispatch, editorView);\r\n            // remember selection\r\n            const markedSelection = editorView.state.selection;\r\n            // set selection empty\r\n            SelectionMenu.closeSelection(editorView);\r\n            // increase sugar\r\n            sugar += 1;\r\n            // create one dispatchable dom element to dispatch from this tool\r\n            const $dispatchNode = SelectionMenu.connectAllSelectedParts(editorView, dataTagId);\r\n            // add removing marker logic\r\n            SelectionMenu.removingMarkerHandler({\r\n              editorId, editorView, markedSelection, $dispatchNode, dataTagId, dataCommandName, marker: marks.marker,\r\n            });\r\n            // dispatch event that editor has changed\r\n            __dispatchEvent(document, 'editor.change', {}, {\r\n              text: {\r\n                id: editorId,\r\n                task: 'add',\r\n                tagData: { tagName: dataCommandName },\r\n                value: $dispatchNode,\r\n                tagColor: color,\r\n              },\r\n            });\r\n          } // nothing will be marked\r\n          else {\r\n            this.update(editorView, null);\r\n          }\r\n        });\r\n      });\r\n    }\r\n\r\n    // add to editor\r\n    editorView.dom.parentNode.appendChild(this.$menuBox);\r\n  }\r\n\r\n  // calling from editor every time when editor is updated\r\n  // manage showing and hiding menu and menu position\r\n  update(view, lastState) {\r\n    const { state, readOnly } = view;\r\n    const activeElementClasses = document.activeElement.classList;\r\n\r\n    // have to be canvas dom node\r\n    if (!state || readOnly || state.selection.empty || !activeElementClasses.contains('canvas')) {\r\n      if (!this.$menuBox.classList.contains('hidden')) {\r\n        this.$menuBox.classList.add('hidden');\r\n      }\r\n      return;\r\n    }\r\n\r\n    this.$menuBox.classList.remove('hidden');\r\n\r\n    if (!this.$menuBox.offsetParent) {\r\n      if (!this.$menuBox.classList.contains('hidden')) {\r\n        this.$menuBox.classList.add('hidden');\r\n      }\r\n      return;\r\n    }\r\n    // Update the Content state before calculating the position\r\n    // this.contentUpdate(editorView.state);\r\n\r\n    const { from, to } = state.selection;\r\n\r\n    try {\r\n      const start = view.coordsAtPos(from);\r\n      const end = view.coordsAtPos(to);\r\n\r\n      const box = this.$menuBox.getBoundingClientRect();\r\n\r\n      const offsetParentBox = this.$menuBox.offsetParent.getBoundingClientRect();\r\n      let left = (((start.left + end.left) / 2) - (box.width / 2) - offsetParentBox.left);\r\n\r\n      if (left < 5) {\r\n        left = 5;\r\n      }\r\n\r\n      this.$menuBox.style.left = `${left}px`;\r\n      this.$menuBox.style.top = `${start.top - offsetParentBox.top - box.height}px`;\r\n    }\r\n    catch (err) {\r\n      console.error('Menu selection error', err);\r\n    }\r\n  }\r\n\r\n  destroy() {\r\n    if (this.$menuBox) {\r\n      this.$menuBox.remove();\r\n    }\r\n  }\r\n\r\n  // check if part of selection was marked\r\n  static isAdded(marker, state) {\r\n    const { ranges } = state.selection;\r\n    let has = false;\r\n\r\n    for (let i = 0; !has && i < ranges.length; i += 1) {\r\n      const { $from, $to } = ranges[i];\r\n      // https://prosemirror.net/docs/ref/#model.Node.rangeHasMark\r\n      has = state.doc.rangeHasMark($from.pos, $to.pos, marker);\r\n    }\r\n\r\n    return has;\r\n  }\r\n\r\n  // TODO: do in same transaction with toggleMark\r\n  static addRemoveButton(editorView, removeButton) {\r\n    const { state } = editorView;\r\n    const { ranges } = state.selection;\r\n\r\n    const lastPosition = ranges[ranges.length - 1].$to.pos;\r\n    // https://prosemirror.net/docs/ref/#state.EditorState.apply\r\n    // https://prosemirror.net/docs/ref/#transform.Transform.insert\r\n    // https://prosemirror.net/docs/ref/#model.NodeType.create\r\n    const newState = state.apply(state.tr.insert(lastPosition, removeButton.create()));\r\n    // update editor state\r\n    editorView.updateState(newState);\r\n  }\r\n\r\n  static closeSelection(editorView) {\r\n    const { state } = editorView;\r\n\r\n    // https://prosemirror.net/docs/ref/#state.EditorState.apply\r\n    // https://prosemirror.net/docs/ref/#state.Transaction.setSelection\r\n    // https://prosemirror.net/docs/ref/#state.TextSelection^create\r\n    const newState = state.apply(state.tr.setSelection(pm.TextSelection.create(state.doc, 0, 0)));\r\n    // update editor state\r\n    editorView.updateState(newState);\r\n  }\r\n\r\n  static removingMarkerHandler(inputs) {\r\n    const {\r\n      editorId, editorView, markedSelection, $dispatchNode, dataTagId, dataCommandName, marker,\r\n    } = inputs;\r\n    // find remove button at the end of marked part\r\n    const $removeButton = editorView.dom.querySelector(`[data-tag-id=${dataTagId}] > span.node-close`);\r\n\r\n    if ($removeButton) {\r\n      $removeButton.addEventListener('click', (event) => {\r\n        event.preventDefault();\r\n\r\n        // find all marked parts\r\n        const $markedParts = editorView.dom.querySelectorAll(`span[data-tag-id=${dataTagId}]`);\r\n        const { state } = editorView;\r\n        const { tr } = state;\r\n        // for all ranges\r\n        for (let index = 0; index < $markedParts.length; index += 1) {\r\n          const $markedPart = $markedParts[index];\r\n          // https://prosemirror.net/docs/ref/#view.EditorView.posAtDOM\r\n          const fromPos = editorView.posAtDOM($markedPart);\r\n          const toPos = fromPos + $markedPart.textContent.length + 2;\r\n          const matched = [];\r\n          const step = 0;\r\n\r\n          // better option but error\r\n          // tr.removeMark($from.pos, $to.pos, marker);\r\n\r\n          // copy pased from Transform.prototype.removeMark\r\n          // https://github.com/ProseMirror/prosemirror-transform/blob/master/src/mark.js\r\n          // https://prosemirror.net/docs/ref/#model.Node.nodesBetween\r\n          tr.doc.nodesBetween(fromPos, toPos, (node, pos) => {\r\n            if (!node.isInline) return;\r\n\r\n            let toRemove = null;\r\n            if (marker instanceof pm.MarkType) {\r\n              // https://prosemirror.net/docs/ref/#model.MarkType.isInSet\r\n              const found = marker.isInSet(node.marks);\r\n              if (found) toRemove = [found];\r\n            }\r\n            else if (marker) {\r\n              // https://prosemirror.net/docs/ref/#model.Mark.isInSet\r\n              if (marker.isInSet(node.marks)) toRemove = [marker];\r\n            }\r\n            else {\r\n              toRemove = node.marks;\r\n            }\r\n\r\n            if (toRemove && toRemove.length) {\r\n              const end = Math.min(pos + node.nodeSize, toPos);\r\n              for (let i = 0; i < toRemove.length; i += 1) {\r\n                const style = toRemove[i];\r\n                let found;\r\n                for (let j = 0; j < matched.length; j += 1) {\r\n                  const m = matched[j];\r\n                  // https://prosemirror.net/docs/ref/#model.Mark.eq\r\n                  if (m.step === step - 1 && style.eq(matched[j].style)) found = m;\r\n                }\r\n                if (found) {\r\n                  found.to = end;\r\n                  found.step = step;\r\n                }\r\n                else {\r\n                  matched.push({\r\n                    style, from: Math.max(pos, fromPos), to: end, step,\r\n                  });\r\n                }\r\n              }\r\n            }\r\n          });\r\n          // https://prosemirror.net/docs/ref/#transform.Transform.step\r\n          // https://prosemirror.net/docs/ref/#transform.RemoveMarkStep\r\n          matched.forEach((m) => tr.step(new pm.RemoveMarkStep(m.from, m.to, m.style)));\r\n        }\r\n\r\n        // remove removeButton and update state\r\n        // https://prosemirror.net/docs/ref/#view.EditorView.posAtDOM\r\n        const fromPostRB = editorView.posAtDOM($removeButton);\r\n        tr.delete(fromPostRB - 1, fromPostRB + 1);\r\n\r\n        // update editor state\r\n        const newState = state.apply(tr);\r\n        editorView.updateState(newState);\r\n\r\n        // dispatch event that editor has changed\r\n        __dispatchEvent(document, 'editor.change', {}, {\r\n          text: {\r\n            id: editorId,\r\n            task: 'remove',\r\n            tagData: { tagName: dataCommandName },\r\n            value: $dispatchNode,\r\n          },\r\n        });\r\n      });\r\n    }\r\n  }\r\n\r\n  // helper function for dispatch event\r\n  // connect all marked parts\r\n  // clone first part and add here text content of other parts\r\n  static connectAllSelectedParts(view, dataTagId) {\r\n    const $nodes = view.dom.querySelectorAll(`span[data-tag-id=${dataTagId}]`);\r\n    if ($nodes.length === 1) return $nodes[0];\r\n    if ($nodes.length > 1) {\r\n      const $finalNode = $nodes[0].cloneNode(true);\r\n      let fullContent = $nodes[0].textContent;\r\n      for (let i = 1; i < $nodes.length; i += 1) {\r\n        fullContent += $nodes[i].textContent;\r\n      }\r\n      $finalNode.innerHTML = fullContent;\r\n      return $finalNode;\r\n    }\r\n\r\n    console.error(\"Error: Didn't find parts of marked part of text.\");\r\n    return null;\r\n  }\r\n}\r\n","// plugin specification: https://prosemirror.net/docs/ref/#state.Plugin_System\r\nexport default class WrittingMenu {\r\n  constructor(editorView, $menuTemplate) {\r\n    this.$removeAllChanges = $menuTemplate.querySelector('.editor-toolbar-action-reset');\r\n\r\n    this.init(editorView);\r\n  }\r\n\r\n  init(editorView) {\r\n    const firstState = editorView.state;\r\n\r\n    this.$removeAllChanges.addEventListener('click', () => {\r\n      // eslint-disable-next-line no-alert, no-restricted-globals\r\n      const isConfirmed = confirm('Opravdu chcete vrátit text do původní podoby? Vaše změny se tímto ztratí.');\r\n\r\n      if (isConfirmed) {\r\n        editorView.updateState(firstState);\r\n      }\r\n    });\r\n  }\r\n\r\n  static update(view, lastState) {\r\n    // const { state, readOnly } = view;\r\n  }\r\n\r\n  destroy() {\r\n    if (this.$removeAllChanges) {\r\n      this.$removeAllChanges.remove();\r\n    }\r\n  }\r\n}\r\n","/**\r\n * Defined all supported html nodes in editor\r\n * Divided in nodes and marks\r\n * Nodes are static - https://prosemirror.net/docs/ref/#model.NodeSpec\r\n * Marks are dynamic - https://prosemirror.net/docs/ref/#model.MarkSpec\r\n * Example: https://github.com/ProseMirror/prosemirror-schema-basic/blob/master/src/schema-basic.js\r\n */\r\nconst schemaConfig = {\r\n  nodes: {\r\n    doc: { content: 'block+' },\r\n    heading: {\r\n      attrs: {\r\n        level: { default: 1 },\r\n        style: { default: false },\r\n      },\r\n      content: 'inline*',\r\n      group: 'block',\r\n      defining: true,\r\n      parseDOM: [{\r\n        tag: 'h1',\r\n        getAttrs(dom) {\r\n          return { level: 1, style: dom.getAttribute('style') };\r\n        },\r\n      },\r\n      {\r\n        tag: 'h2',\r\n        getAttrs(dom) {\r\n          return { level: 2, style: dom.getAttribute('style') };\r\n        },\r\n      },\r\n      {\r\n        tag: 'h3',\r\n        getAttrs(dom) {\r\n          return { level: 3, style: dom.getAttribute('style') };\r\n        },\r\n      },\r\n      {\r\n        tag: 'h4',\r\n        getAttrs(dom) {\r\n          return { level: 4, style: dom.getAttribute('style') };\r\n        },\r\n      },\r\n      {\r\n        tag: 'h5',\r\n        getAttrs(dom) {\r\n          return { level: 5, style: dom.getAttribute('style') };\r\n        },\r\n      },\r\n      {\r\n        tag: 'h6',\r\n        getAttrs(dom) {\r\n          return { level: 6, style: dom.getAttribute('style') };\r\n        },\r\n      }],\r\n      toDOM(node) { const { style } = node.attrs; return [`h${node.attrs.level}`, { style }, 0]; },\r\n    },\r\n    paragraph: {\r\n      content: 'inline*',\r\n      group: 'block',\r\n      defining: true,\r\n      attrs: {\r\n        style: { default: false },\r\n      },\r\n      parseDOM: [{\r\n        tag: 'p',\r\n        getAttrs(dom) {\r\n          return { style: dom.getAttribute('style') };\r\n        },\r\n      }],\r\n      toDOM(node) { const { style } = node.attrs; return ['p', { style }, 0]; },\r\n    },\r\n    list: {\r\n      content: 'block+',\r\n      group: 'block',\r\n      attrs: {\r\n        type: { default: false },\r\n      },\r\n      parseDOM: [{\r\n        tag: 'ol',\r\n        getAttrs(dom) {\r\n          return { type: dom.getAttribute('type') };\r\n        },\r\n      }],\r\n      toDOM(node) { const { type } = node.attrs; return ['ol', { type }, 0]; },\r\n    },\r\n    listItem: {\r\n      content: 'inline*',\r\n      group: 'block',\r\n      parseDOM: [{ tag: 'li' }],\r\n      toDOM() { return ['li', 0]; },\r\n    },\r\n    hard_break: {\r\n      group: 'block',\r\n      selectable: false,\r\n      parseDOM: [{ tag: 'br' }],\r\n      toDOM() { return ['br']; },\r\n    },\r\n    // hr: {\r\n    //   inline: true,\r\n    //   group: 'inline',\r\n    //   selectable: false,\r\n    //   parseDOM: [{ tag: 'hr' }],\r\n    //   toDOM() { return ['hr']; },\r\n    // },\r\n    text: {\r\n      inline: true,\r\n      group: 'inline',\r\n    },\r\n    // premarked parts\r\n    premarked: {\r\n      content: 'inline',\r\n      inline: true,\r\n      group: 'inline',\r\n      attrs: {\r\n        id: {},\r\n        textData: {},\r\n        className: {},\r\n      },\r\n      parseDOM: [{\r\n        tag: 'span.text-option',\r\n        getAttrs: ($dom) => {\r\n          const id = $dom.getAttribute('id');\r\n          const textData = $dom.getAttribute('data-text-option');\r\n          const className = $dom.getAttribute('class');\r\n          return { id, textData, className };\r\n        },\r\n      }],\r\n      toDOM: (node) => {\r\n        const { id, textData, className } = node.attrs;\r\n        return ['span', {\r\n          'id': id,\r\n          'class': className,\r\n          'data-text-option': textData,\r\n        }, 0];\r\n      },\r\n    },\r\n    // marker remove button\r\n    removeButton: {\r\n      inline: true,\r\n      group: 'inline',\r\n      selectable: false,\r\n      parseDOM: [{ tag: 'span.node-close' }],\r\n      toDOM() {\r\n        return ['span', { class: 'node-close' }, '×'];\r\n      },\r\n    },\r\n  },\r\n  marks: {\r\n    italic: {\r\n      parseDOM: [{ tag: 'i' }, { tag: 'em' }],\r\n      toDOM() { return ['em', 0]; },\r\n    },\r\n    bold: {\r\n      parseDOM: [{ tag: 'b' }],\r\n      toDOM() { return ['b', 0]; },\r\n    },\r\n    code: {\r\n      parseDOM: [{ tag: 'code' }],\r\n      toDOM() { return ['code', 0]; },\r\n    },\r\n    small: {\r\n      parseDOM: [{ tag: 'small' }],\r\n      toDOM() { return ['small', 0]; },\r\n    },\r\n    marker: {\r\n      attrs: {\r\n        color: {},\r\n        dataCommandName: {},\r\n        dataTagId: {},\r\n      },\r\n      parseDOM: [{\r\n        tag: 'span[data-tag-id]',\r\n        getAttrs: ($dom) => {\r\n          const color = $dom.getAttribute('data-color');\r\n          const dataCommandName = $dom.getAttribute('data-command-name');\r\n          const dataTagId = $dom.getAttribute('data-tag-id');\r\n          return { color, dataCommandName, dataTagId };\r\n        },\r\n      }],\r\n      toDOM: (node) => {\r\n        const { color, dataCommandName, dataTagId } = node.attrs;\r\n        return ['span', {\r\n          'class': `node-selected node-text-${color}`,\r\n          'data-command-name': dataCommandName,\r\n          'data-tag-id': dataTagId,\r\n          'data-color': color,\r\n        }, 0];\r\n      },\r\n    },\r\n    writtingInsertPart: {\r\n      attrs: {\r\n        id: {},\r\n      },\r\n      parseDOM: [{\r\n        tag: 'span.user-inserted-text.user-inserted-text-inner',\r\n        getAttrs: ($dom) => {\r\n          const id = $dom.getAttribute('data-add-id');\r\n          return { id };\r\n        },\r\n      }],\r\n      toDOM: (node) => {\r\n        const { id } = node.attrs;\r\n        return ['span', {\r\n          'class': 'user-inserted-text user-inserted-text-inner',\r\n          'data-add-id': id,\r\n        }, 0];\r\n      },\r\n    },\r\n    writtingRemovePart: {\r\n      attrs: {\r\n        id: {},\r\n      },\r\n      parseDOM: [{\r\n        tag: 'span.user-removed-text.user-removed-text-inner',\r\n        getAttrs: ($dom) => {\r\n          const id = $dom.getAttribute('data-remove-id');\r\n          return { id };\r\n        },\r\n      }],\r\n      toDOM: (node) => {\r\n        const { id } = node.attrs;\r\n        return ['span', {\r\n          'class': 'user-removed-text user-removed-text-inner',\r\n          'data-remove-id': id,\r\n        }, 0];\r\n      },\r\n    },\r\n  },\r\n};\r\n\r\nexport default schemaConfig;\r\n","import Component from '../component';\r\nimport SelectionMenu from './selectionMenu';\r\nimport WrittingMenu from './writtingMenu';\r\nimport schemaConfig from './schema';\r\nimport { __dispatchEvent } from '../../lib/utils';\r\n\r\nexport default class Editor extends Component {\r\n  constructor($element) {\r\n    super($element);\r\n    this.editor = undefined;\r\n    this.id = this.target.id;\r\n    this.editorType = this.target.getAttribute('data-editor');\r\n    // find editor place in cviceni\r\n    this.$editor = this.target.querySelector(`#prosemirror-editor-${this.id}`);\r\n    // find editor content\r\n    this.$content = this.target.querySelector(`#prosemirror-content-${this.id}`);\r\n    this.schema = new pm.Schema(schemaConfig);\r\n\r\n    // only if cviceni isn't done load html\r\n    if (!HISTORYLAB.import.done) {\r\n      this.initHTML();\r\n    }\r\n    else {\r\n      this.initJSON();\r\n    }\r\n  }\r\n\r\n  // calling from save-data.js\r\n  getEditorJSON() {\r\n    if (this.editor) {\r\n      // get JSON format of last editor state\r\n      return this.editor.state.toJSON();\r\n    }\r\n    return {};\r\n  }\r\n\r\n  // type of editor is set here\r\n  initHTML() {\r\n    let plugins;\r\n    // add plugin by editor type\r\n    if (this.editorType === 'zvyraznovani') {\r\n      const bubbleMenu = this.selectionMenu(this.id);\r\n      plugins = [bubbleMenu];\r\n    }\r\n\r\n    if (this.editorType === 'predznaceny') {\r\n      const premarkedParts = Editor.premarkedParts(this.id, this.schema);\r\n      plugins = [premarkedParts];\r\n    }\r\n\r\n    if (this.editorType === 'psani') {\r\n      const writting = this.writting(pm.keydownHandler);\r\n      const histKeymap = pm.keymap({ 'Mod-z': pm.undo, 'Mod-y': pm.redo });\r\n      plugins = [pm.history(), histKeymap, writting];\r\n    }\r\n\r\n    // create editor instance by defining editor view\r\n    this.editor = new pm.EditorView(this.$editor, {\r\n      // state is created from html structure parsed from our text and array of plugins\r\n      state: pm.EditorState.create({\r\n        doc: pm.DOMParser.fromSchema(this.schema).parse(this.$content),\r\n        plugins,\r\n      }),\r\n    });\r\n  }\r\n\r\n  // only visualization of saved data\r\n  // load saved data from JSON format\r\n  initJSON() {\r\n    const data = JSON.parse(this.$content.textContent);\r\n    const readOnly = Editor.readOnlyMod();\r\n    const { schema } = this;\r\n\r\n    // create editor instance by defining editor view\r\n    this.editor = new pm.EditorView(this.$editor, {\r\n      // editor state is created from JSON object and schema\r\n      state: pm.EditorState.fromJSON({ schema, plugins: [readOnly] }, data),\r\n    });\r\n  }\r\n\r\n  // only diable editing editor\r\n  // https://prosemirror.net/docs/ref/#view.EditorProps.editable\r\n  static readOnlyMod() {\r\n    return new pm.Plugin({\r\n      props: {\r\n        editable() {\r\n          return false;\r\n        },\r\n      },\r\n      // plugin key has to be unique in editor\r\n      key: new pm.PluginKey('ReadOnlyMod'),\r\n    });\r\n  }\r\n\r\n  // manager of marker\r\n  selectionMenu(editorId) {\r\n    const { schema } = this;\r\n    // get menu from gulp\r\n    const $menuTemplate = this.target.querySelector(`#marker-menu-${this.target.id}`);\r\n    return new pm.Plugin({\r\n      // set plugin visualization means set definated marker menu as part of plugin\r\n      view(editorView) {\r\n        return new SelectionMenu(editorId, schema, editorView, $menuTemplate);\r\n      },\r\n      // when editable is false history doesn't work\r\n      props: {\r\n        editable() {\r\n          return false;\r\n        },\r\n      },\r\n      // plugin key has to be unique in editor\r\n      key: new pm.PluginKey('SelectionMenu'),\r\n    });\r\n  }\r\n\r\n  // manager of premarker\r\n  static premarkedParts(editorId, schema) {\r\n    return new pm.Plugin({\r\n      props: {\r\n        // when editable is false history doesn't work\r\n        editable() {\r\n          return false;\r\n        },\r\n        // https://prosemirror.net/docs/ref/#view.EditorProps.handleClickOn\r\n        handleClickOn(view, pos, node, nodePos) {\r\n          if (schema.nodes.premarked.name === node.type.name) {\r\n            // definition of class adding to selected node\r\n            const classSelectDefinition = 'selected';\r\n            const { state } = view;\r\n            const { tr } = state;\r\n\r\n            let newClassName;\r\n            let task;\r\n            // variable for extra data from cviceni JSON for dispatch event distribution\r\n            const tagData = JSON.parse(node.attrs.textData);\r\n            tagData.tagName = 'vyznacena-pasaz';\r\n\r\n            if (node.attrs.className.includes(classSelectDefinition)) {\r\n              newClassName = node.attrs.className.replace(` ${classSelectDefinition}`, '');\r\n              task = 'remove';\r\n            }\r\n            else {\r\n              newClassName = `${node.attrs.className} ${classSelectDefinition}`;\r\n              task = 'add';\r\n            }\r\n\r\n            // for create new state it's important to not change html node directly\r\n            // it's important to use prosemirror functions\r\n            const nodeAttrs = {\r\n              id: node.attrs.id,\r\n              className: newClassName,\r\n              textData: node.attrs.textData,\r\n            };\r\n\r\n            // replace old node on set position by new node with new attributes\r\n            tr.setNodeMarkup(nodePos, null, nodeAttrs);\r\n\r\n            // changing editor's state\r\n            const newState = state.apply(tr);\r\n            view.updateState(newState);\r\n\r\n            // dispatch event that editor has changed\r\n            const $node = view.dom.querySelector(`#${node.attrs.id}`);\r\n            __dispatchEvent(document, 'editor.change', {}, {\r\n              text: {\r\n                id: editorId,\r\n                task,\r\n                tagData,\r\n                value: $node.cloneNode(true),\r\n              },\r\n            });\r\n          }\r\n          return false;\r\n        },\r\n      },\r\n      // plugin key has to be unique in editor\r\n      key: new pm.PluginKey('PremarkedParts'),\r\n    });\r\n  }\r\n\r\n  // manager of writting\r\n  writting(keydownHandler) {\r\n    // get menu items from gulp\r\n    const $toolbarTemplate = this.target.querySelector(`#toolbar-${this.target.id}`);\r\n    // console.log($toolbarTemplate);\r\n    let sugar = 0;\r\n\r\n    // definition of deleted parts logic\r\n    const deletedParts = (state, dispatch) => {\r\n      // create unique id\r\n      const id = `remove-part-${sugar}`;\r\n      // define command\r\n      const command = pm.toggleMark(this.schema.marks.writtingRemovePart, { id });\r\n      // marked selection part\r\n      command(state, dispatch);\r\n      // increase sugar\r\n      sugar += 1;\r\n      return true;\r\n    };\r\n\r\n    return new pm.Plugin({\r\n      // set plugin visualization means set definated writting menu as part of plugin\r\n      view(editorView) {\r\n        return new WrittingMenu(editorView, $toolbarTemplate);\r\n      },\r\n      props: {\r\n        handleKeyDown: keydownHandler({ Delete: deletedParts, Backspace: deletedParts }),\r\n      },\r\n      // plugin key has to be unique in editor\r\n      key: new pm.PluginKey('Writting'),\r\n    });\r\n  }\r\n}\r\n","import { __toggleClass, __getHTML, __dispatchEvent } from '../lib/utils';\r\nimport Component from './component';\r\n\r\n// zoom the image\r\nexport default class Keywords extends Component {\r\n  constructor($element, opts = {}) {\r\n    super($element);\r\n    this.id = this.target.id;\r\n    this.function = this.target.getAttribute('data-keywords') || 'selekce-' || 'selekce+';\r\n    this.$controls = this.target.querySelectorAll('[data-keywords-control]');\r\n\r\n    this.opts = { ...Keywords.defaults, ...opts };\r\n\r\n    this.$itemsContainer = this.target.querySelector(`.${this.opts.itemsContainerClassName}`);\r\n\r\n    if (this.opts.inherit && this.opts.inherit.from.length > 0) {\r\n      // console.log(this.opts.inherit.from);\r\n      this.isInherited = true;\r\n    }\r\n    else {\r\n      this.$items = this.target.querySelectorAll(`.${this.opts.itemClassName}`);\r\n    }\r\n\r\n  }\r\n\r\n  init() {\r\n    switch (this.function) {\r\n      case 'selekce-':\r\n      case 'selekce+':\r\n        // we have data at the instantiation for importing\r\n        if (this.opts.import && this.opts.import.length > 0) {\r\n          this.$itemsContainer.innerHTML = Keywords._getHTMLFromItems(this.opts.import);\r\n        }\r\n\r\n        // console.log(this.id, this.isInherited);\r\n        if (this.isInherited) {\r\n          // if onInit, we copy the elements\r\n          // by their ids into the itemsContainer of this object\r\n          if (this.opts.inherit.onInit) {\r\n            this._regenerateItemsContainerFromInherited();\r\n          }\r\n        }\r\n\r\n        this._registerHandlers();\r\n        break;\r\n      case 'wordcloud':\r\n        this.$items.forEach(($item) => {\r\n          $item.setAttribute('data-keywords-item', 0);\r\n        });\r\n        this._changeSizeOfKeywordItem(this.opts.skala);\r\n        break;\r\n\r\n      default:\r\n        break;\r\n    }\r\n  }\r\n\r\n  _changeSizeOfKeywordItem(maxLevel) {\r\n    maxLevel = maxLevel ? parseInt(maxLevel, 10) : 4;\r\n\r\n    function setNewLevelValue($keyword, number, feedback) {\r\n      const oldValue = parseInt($keyword.getAttribute('data-keywords-item'), 10);\r\n      const newValue = oldValue + number;\r\n      const value = Math.abs(newValue) > maxLevel ? oldValue : newValue;\r\n      $keyword.setAttribute('data-keywords-item', value);\r\n\r\n      feedback();\r\n    }\r\n\r\n    this.$controls.forEach(($control) => {\r\n      const $keyword = $control.parentElement.parentElement;\r\n      const controlFunction = $control.getAttribute('data-keywords-control');\r\n\r\n      switch (controlFunction) {\r\n        case 'minus':\r\n          $control.addEventListener('click', (event) => {\r\n            setNewLevelValue($keyword, -1, this.showFeedback);\r\n            event.preventDefault();\r\n          });\r\n          break;\r\n\r\n        case 'plus':\r\n          $control.addEventListener('click', (event) => {\r\n            setNewLevelValue($keyword, 1, this.showFeedback);\r\n            event.preventDefault();\r\n          });\r\n          break;\r\n\r\n        default:\r\n          break;\r\n      }\r\n    });\r\n  }\r\n\r\n  _regenerateItemsContainerFromInherited() {\r\n    let tempContent = '';\r\n\r\n    this.opts.inherit.from.forEach((id) => {\r\n      const temp = document.getElementById(id).querySelector(`.${this.opts.itemsContainerClassName}`).innerHTML;\r\n      // rename ids of the original items to avoid duplicates in the DOM\r\n      tempContent += Keywords.renameItemsIds(id, this.id, temp);\r\n      // console.log(tempContent);\r\n    });\r\n\r\n    this.$itemsContainer.innerHTML = tempContent;\r\n\r\n    this.$items = this.target.querySelectorAll(`.${this.opts.itemClassName}`);\r\n  }\r\n\r\n  _registerHandlers() {\r\n\r\n    // this.target.querySelectorAll(`.${this.opts.itemClassName}`).forEach(($item) => {\r\n    this.$items.forEach(($item) => {\r\n      $item.addEventListener('click', this._clickEventHandler.bind(this), true);\r\n      document.addEventListener('keyword.change', (e) => { this._dispatchEventHandler(e, $item); }, false);\r\n    });\r\n\r\n  }\r\n\r\n\r\n  _clickEventHandler(e) {\r\n\r\n    if (e.type === 'click') {\r\n\r\n      __toggleClass(e.currentTarget, 'disabled');\r\n\r\n      // dispatch event that keyword has changed\r\n      __dispatchEvent(document, 'keyword.change', {}, {\r\n        keywords: {\r\n          id: this.id,\r\n          node: e.currentTarget,\r\n        },\r\n      });\r\n\r\n      this.showFeedback();\r\n    }\r\n  }\r\n\r\n  _dispatchEventHandler(e, $item) {\r\n    const { id, node } = e.detail.keywords;\r\n\r\n    if (this.isInherited && this.opts.inherit.from.includes(id)) {\r\n      const currentId = $item.id;\r\n      const nodeId = node.id;\r\n      const removeFeatureIdFromCurrentId = currentId.replace(this.id, '');\r\n      const removeFeatureIdFromNodeId = nodeId.replace(id, '');\r\n\r\n      if (removeFeatureIdFromCurrentId === removeFeatureIdFromNodeId) {\r\n        __toggleClass($item, 'disabled');\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n\r\nKeywords._getItemFromDOMElement = ($item) => ({\r\n  class: $item.className,\r\n  id: $item.getAttribute('id'),\r\n  text: $item.innerText,\r\n});\r\n\r\nKeywords._getItemsHTML = ($itemsContainer) => $itemsContainer.innerHTML;\r\n\r\nKeywords._getItemsFromHTML = ($itemsContainer, itemsClassName) => {\r\n  const $items = $itemsContainer.querySelectorAll(`.${itemsClassName}`);\r\n  const itemsArray = [];\r\n\r\n  $items.forEach(($item) => {\r\n    itemsArray.push(Keywords._getItemFromDOMElement($item));\r\n  });\r\n\r\n\r\n  return itemsArray;\r\n\r\n};\r\n\r\nKeywords._getDOMElementFromItem = (item) => {\r\n\r\n  const newDiv = document.createElement('div');\r\n  newDiv.setAttribute('class', item.class);\r\n  newDiv.setAttribute('id', item.id);\r\n  newDiv.innerHTML = item.text;\r\n\r\n  return __getHTML(newDiv);\r\n\r\n};\r\n\r\nKeywords._getHTMLFromItems = (items) => {\r\n\r\n  let contentHTML = '';\r\n\r\n  items.forEach((item) => {\r\n\r\n    contentHTML += Keywords._getDOMElementFromItem(item);\r\n\r\n  });\r\n\r\n  return contentHTML;\r\n\r\n};\r\n\r\n\r\nKeywords.renameItemsIds = (oldId, newId, itemsHTML) => {\r\n\r\n  const expString = new RegExp(oldId, 'g');\r\n\r\n  return itemsHTML.replace(expString, newId);\r\n\r\n};\r\n\r\nKeywords.defaults = {\r\n  itemsContainerClassName: 'keywords-items-container',\r\n  itemClassName: 'keywords-item',\r\n};\r\n","import { __removeClass, __toggleClass } from '../lib/utils';\r\nimport Component from './component';\r\n\r\n\r\nexport default class TestQuiz extends Component {\r\n\r\n  constructor(id, element, opts) {\r\n    super(element);\r\n\r\n    this.id = id;\r\n\r\n    this.opts = { ...TestQuiz.defaults, ...opts };\r\n\r\n    this.$questions = this.target.querySelectorAll(`.${this.opts.itemClass}`);\r\n    this.cache = {\r\n      answersCorrect: 0,\r\n      colors: [],\r\n      questions: [],\r\n    };\r\n\r\n    // get colors for all feedback variants\r\n    if (this.opts.zpetnaVazba) {\r\n      this.cache.colors = this.opts.zpetnaVazba.map((feedback) => feedback.barva);\r\n    }\r\n  }\r\n\r\n  init() {\r\n    this._registerHandlers();\r\n  }\r\n\r\n  _registerHandlers() {\r\n\r\n    this.$questions.forEach(($question, questionIndex) => {\r\n      // all questions are without answer by default\r\n      this.cache.questions.push({ answered: false });\r\n\r\n      const answerCorrect = parseInt($question.getAttribute('data-module-answer'), 10);\r\n      const $answers = $question.querySelectorAll(`.${this.opts.optionClass}`);\r\n\r\n      $answers.forEach(($answer, answerIndex) => {\r\n        $answer.addEventListener('click', () => {\r\n          const $answerCurrent = $answer;\r\n\r\n          // if already selected do nothing\r\n          if ($answerCurrent.classList.contains('selected')) {\r\n            return;\r\n          }\r\n\r\n          // remove the selection\r\n          $answers.forEach(($answersItem) => __removeClass($answersItem, this.opts.selectedClass));\r\n          // select the clicked one\r\n          __toggleClass($answerCurrent, this.opts.selectedClass);\r\n\r\n          // get sum of all corect answers\r\n          if (this.opts.zpetnaVazba) {\r\n            if (answerIndex === answerCorrect) {\r\n              this.cache.answersCorrect += 1;\r\n            } else if (this.cache.answersCorrect !== 0 && this.cache.questions[questionIndex].answered === true) {\r\n              this.cache.answersCorrect -= 1;\r\n            }\r\n            // loop through all \"zpetnaVazba\" to get the one with the fullfilled condition\r\n            const feedbackActual = this.opts.zpetnaVazba.find((feedback) => feedback.podminka.includes(this.cache.answersCorrect));\r\n\r\n            // show the right feedback message\r\n            this.$buttonFeedback.classList.remove(...this.cache.colors);\r\n            this.$buttonFeedback.classList.add(feedbackActual.barva);\r\n            this.$buttonFeedbackText.innerText = feedbackActual.text;\r\n          }\r\n\r\n          // note that this question has been answered (whether true or false)\r\n          this.cache.questions[questionIndex].answered = true;\r\n\r\n          // show OK button with feedback only when all question have been answered\r\n          if (this.cache.questions.find((question) => !question.answered) === undefined) {\r\n            this.showFeedback();\r\n          }\r\n\r\n        }, false);\r\n      });\r\n    });\r\n  }\r\n}\r\n\r\nTestQuiz.defaults = {\r\n  itemClass: 'test-quiz-item',\r\n  optionClass: 'option',\r\n  selectedClass: 'selected',\r\n};\r\n","/* eslint-disable max-classes-per-file */\r\n// [data-fullscreen]\r\nimport Component from './component';\r\nimport MagnifyingGlass from './magnifying-glass';\r\nimport { imageIsLoaded } from '../lib/utils';\r\n\r\nclass Fullscreen extends Component {\r\n  constructor($element) {\r\n    super($element);\r\n\r\n    this.$fullscreen = document.querySelector('[data-fullscreen=\"fullscreen\"]');\r\n    this.$fullscreenContainer = this.$fullscreen.querySelector('[data-fullscreen=\"container\"]');\r\n    this.$fullscreenTarget = this.$fullscreen.querySelector('[data-fullscreen=\"target\"]');\r\n\r\n    this.window = {};\r\n    this.image = {};\r\n\r\n    this.window.width = window.innerWidth;\r\n    this.window.height = window.innerHeight;\r\n    this.window.ratio = this.window.width / this.window.height;\r\n  }\r\n}\r\n\r\nexport default class FullscreenToggle extends Fullscreen {\r\n  constructor($element) {\r\n    super($element);\r\n\r\n    this.imageAlternative = this.target.getAttribute('data-fullscreen-image');\r\n\r\n    // TODO: do not rely on DOM .nextElementSibling, .firstElementChild, etc…\r\n    this.target.addEventListener('click', (event) => {\r\n      // Check if there is different image for zvetseni\r\n      if (this.imageAlternative) {\r\n        this.$fullscreenContainer.innerHTML = this.target.nextElementSibling.nextElementSibling.outerHTML;\r\n        this.$fullscreenTarget = this.$fullscreenContainer.firstElementChild;\r\n        this.$fullscreenTarget.classList.remove('is-hidden');\r\n      }\r\n      else {\r\n        this.$fullscreenContainer.innerHTML = this.target.nextElementSibling.outerHTML;\r\n        this.$fullscreenTarget = this.$fullscreenContainer.firstElementChild;\r\n      }\r\n\r\n      this.$fullscreenTarget.removeAttribute('style');\r\n      this.$fullscreenTarget.removeAttribute('id');\r\n\r\n      switch (this.target.nextElementSibling.nodeName.toLowerCase()) {\r\n        case 'img':\r\n          setTimeout(() => {\r\n            imageIsLoaded(this.$fullscreenTarget.currentSrc)\r\n              .then(() => {\r\n                this.image.width = this.$fullscreenTarget.naturalWidth;\r\n                this.image.height = this.$fullscreenTarget.naturalHeight;\r\n                this.image.ratio = this.image.width / this.image.height;\r\n\r\n                this.setSize();\r\n\r\n                const magnifyingGlass = new MagnifyingGlass(this.$fullscreenTarget);\r\n              });\r\n          }, 10);\r\n          break;\r\n\r\n        case 'svg':\r\n          // eslint-disable-next-line no-case-declarations\r\n          const viewbox = this.$fullscreenTarget.getAttribute('viewBox').split(' ');\r\n\r\n          [, , this.image.width, this.image.height] = viewbox;\r\n          this.image.ratio = this.image.width / this.image.height;\r\n\r\n          this.setSize();\r\n\r\n          // eslint-disable-next-line no-case-declarations\r\n          const $svgTexts = this.$fullscreenTarget.querySelectorAll('textarea');\r\n          if ($svgTexts.length > 0) {\r\n            $svgTexts.forEach(($svgText) => {\r\n              const { id } = $svgText;\r\n              $svgText.removeAttribute('id');\r\n              $svgText.value = document.getElementById(id).value;\r\n              $svgText.readOnly = true;\r\n            });\r\n          }\r\n          break;\r\n\r\n        default:\r\n          break;\r\n      }\r\n\r\n      this.$fullscreen.classList.toggle('hidden');\r\n\r\n      this.showFeedback();\r\n\r\n      event.preventDefault();\r\n      event.stopPropagation();\r\n    }, false);\r\n\r\n  }\r\n\r\n  setSize() {\r\n    if (this.image.ratio >= this.window.ratio) {\r\n      this.$fullscreenTarget.style.width = '100%';\r\n      this.$fullscreenTarget.style.height = 'auto';\r\n    }\r\n    else {\r\n      this.$fullscreenTarget.style.width = 'auto';\r\n      this.$fullscreenTarget.style.height = `${this.window.height}px`;\r\n    }\r\n  }\r\n}\r\n","import Component from './component';\r\nimport { __dispatchEvent } from '../lib/utils';\r\n\r\nexport default class UserText extends Component {\r\n  constructor($element) {\r\n    super($element);\r\n\r\n    this.$item = this.target.closest('.user-text');\r\n    this.$counter = this.$item.querySelector('[data-usertext-counter]');\r\n    this.$counterWrapper = this.$item.querySelector('.user-text__counter');\r\n    this.$instruction = this.$item.querySelector('.user-text__question');\r\n\r\n    this.$userTexts = this.$slide.querySelectorAll('[data-textarea-target]');\r\n\r\n    this.feedback = JSON.parse(this.target.getAttribute('data-feedback'));\r\n\r\n    this.lengthExpected = {\r\n      min: parseInt(this.target.getAttribute('minlength') === '0' ? 1 : this.target.getAttribute('minlength'), 10),\r\n      avg: null,\r\n      max: parseInt(this.target.getAttribute('maxlength') / 2, 10),\r\n    };\r\n    this.lengthExpected.avg = Math.floor((this.lengthExpected.max - this.lengthExpected.min) / 4 + this.lengthExpected.min);\r\n\r\n    this.cache = {\r\n      answersCorrect: 0,\r\n      colors: [\r\n        'color-red',\r\n        'color-orange',\r\n        'color-green',\r\n      ],\r\n      questions: [],\r\n    };\r\n\r\n    this.lastValue = '';\r\n    this.hadData = this.target.value && this.target.value.length > 0;\r\n    this.wasUsed = false;\r\n\r\n    if (this.hadData) {\r\n      this.updateCharacterCounter();\r\n    }\r\n\r\n    if (!HISTORYLAB.import.done) {\r\n      // duplicate source of different text element\r\n      this.toDuplicate = this.target.getAttribute('data-duplicate-text');\r\n      this.textDuplicateSources = this.toDuplicate ? this.toDuplicate.split(' ') : [];\r\n\r\n      // listen events\r\n      this.getEvents();\r\n      this.addEventListeners();\r\n    }\r\n  }\r\n\r\n  updateCharacterCounter(length = this.target.value.length) {\r\n    this.$counterWrapper.classList.remove(...this.cache.colors);\r\n    if (length < this.lengthExpected.min) this.$counterWrapper.classList.add(this.cache.colors[0]);\r\n    else if (length <= this.lengthExpected.avg) this.$counterWrapper.classList.add(this.cache.colors[1]);\r\n    else if (length > this.lengthExpected.avg) this.$counterWrapper.classList.add(this.cache.colors[2]);\r\n\r\n    this.$counter.innerText = length;\r\n    this.target.classList.add('is-used', !this.wasUsed);\r\n    this.wasUsed = true;\r\n  }\r\n\r\n  updateFeedback(length = this.target.value.length) {\r\n    if (!this.$buttonFeedback) return;\r\n\r\n    this.$buttonFeedback.classList.remove(...this.cache.colors);\r\n    if (length < this.lengthExpected.min) {\r\n      this.$buttonFeedback.classList.add(this.cache.colors[0]);\r\n      this.$buttonFeedbackText.innerText = this.feedback.none;\r\n    } else {\r\n\r\n      if (length <= this.lengthExpected.avg) {\r\n        this.$buttonFeedback.classList.add(this.cache.colors[1]);\r\n        this.$buttonFeedbackText.innerText = this.feedback.short;\r\n      }\r\n      else if (length > this.lengthExpected.avg) {\r\n        this.$buttonFeedback.classList.add(this.cache.colors[2]);\r\n        this.$buttonFeedbackText.innerText = this.feedback.ok;\r\n      }\r\n\r\n      this.target.setAttribute('data-textarea-target', 'success');\r\n      // check if all conditions of the same component on the same slide are met\r\n      const conditionAll = Array.from(this.$userTexts).find(($userText) => ($userText.getAttribute('data-textarea-target') !== 'success'));\r\n\r\n      if (conditionAll === undefined) {\r\n        // show OK button or feedback\r\n        this.showFeedback();\r\n      }\r\n    }\r\n  }\r\n\r\n  addEventListeners() {\r\n    // BLUR\r\n    this.target.addEventListener('blur', (event) => {\r\n      this.updateCharacterCounter();\r\n\r\n      if (event.target.value !== this.lastValue) {\r\n        const taskName = (this.lastValue === '') ? 'create' : 'change';\r\n        this.lastValue = event.target.value;\r\n\r\n        // dispatch event that text has changed\r\n        __dispatchEvent(document, 'text.change', {}, {\r\n          text: {\r\n            id: event.target.id,\r\n            task: taskName,\r\n            text: event.target.value,\r\n          },\r\n        });\r\n\r\n        // remove connection of any textfields\r\n        this.textDuplicateSources = [];\r\n      }\r\n    });\r\n\r\n    // KEYUP\r\n    this.target.addEventListener('keyup', (event) => {\r\n      event.stopPropagation();\r\n\r\n      const valueLength = this.target.value.length;\r\n      this.updateCharacterCounter(valueLength);\r\n      this.updateFeedback(valueLength);\r\n    });\r\n  }\r\n\r\n  getEvents() {\r\n    // when Selectable module modify question in user text\r\n    if (this.$instruction && this.$instruction.hasAttribute('data-from')) {\r\n      const fromId = this.$instruction.getAttribute('data-from');\r\n\r\n      document.addEventListener('selection.change', (e) => {\r\n        if (fromId === e.detail.id && e.detail.itemData && typeof e.detail.itemData === 'string') {\r\n          this.$instruction.innerText = e.detail.itemData;\r\n        }\r\n      });\r\n    }\r\n\r\n    // when textarea value is taken from other textarea\r\n    if (this.textDuplicateSources[0]) {\r\n\r\n      document.addEventListener('text.change', (e) => {\r\n        if (this.textDuplicateSources.includes(e.detail.text.id)) {\r\n\r\n          const taskName = (this.target.value === '') ? 'create' : 'change';\r\n          switch (e.detail.text.task) {\r\n            case 'create':\r\n            case 'change':\r\n              // if is something already there\r\n              if (this.target.value !== '') this.target.value += '\\n';\r\n\r\n              // if array length is one it means that can by connection line\r\n              if (this.textDuplicateSources.length === 1) {\r\n                this.target.value = e.detail.text.text;\r\n              } else {\r\n                this.target.value += `${e.detail.text.text}\\n`;\r\n              }\r\n\r\n              // dispatch event that text has changed\r\n              __dispatchEvent(document, 'text.change', {}, {\r\n                text: {\r\n                  id: this.target.id,\r\n                  task: taskName,\r\n                  text: this.target.value,\r\n                },\r\n              });\r\n\r\n              // make different first value if is need\r\n              this.lastValue = this.target.value;\r\n\r\n              this.updateCharacterCounter();\r\n              break;\r\n            default:\r\n              console.log('Nondefinated text events task. :(');\r\n          }\r\n        }\r\n      });\r\n    }\r\n  }\r\n}\r\n","import Component from '../component';\r\n\r\nexport default class AudioPlayerNormal extends Component {\r\n\r\n  constructor($element) {\r\n    super($element);\r\n\r\n    this.$playButton = this.target.querySelector('[data-player-control]');\r\n    this.$loadWave = this.target.querySelector('[data-audio-wave]');\r\n    this.$leftTime = this.target.querySelector('[data-audio-time-left]');\r\n    this.$audioDuration = this.target.querySelector('[data-audio-time-duration]');\r\n\r\n    this.wavesurfer = WaveSurfer.create({\r\n      container: this.$loadWave,\r\n      waveColor: '#A77977',\r\n      progressColor: '#FCE4E3',\r\n      height: 80,\r\n      responsive: true,\r\n      barWidth: 2,\r\n    });\r\n    this.wavesurfer.load(this.$loadWave.dataset.src);\r\n\r\n    this.initWave();\r\n  }\r\n\r\n  initWave() {\r\n    this.wavesurfer.on('ready', () => {\r\n      this.$leftTime.textContent = '0:00';\r\n      const duration = this.wavesurfer.getDuration();\r\n      const minutes = Math.floor((duration % 3600) / 60);\r\n      const seconds = (`00${Math.floor(duration % 60)}`).slice(-2);\r\n      this.$audioDuration.textContent = `${minutes}:${seconds}`;\r\n\r\n      this.addListenerAfterReady();\r\n    });\r\n  }\r\n\r\n  addListenerAfterReady() {\r\n    this.wavesurfer.on('audioprocess', (time) => {\r\n      const minutes = Math.floor((time % 3600) / 60);\r\n      const seconds = (`00${Math.floor(time % 60)}`).slice(-2);\r\n      this.$leftTime.textContent = `${minutes}:${seconds}`;\r\n    });\r\n\r\n    this.wavesurfer.on('finish', () => {\r\n      this.$playButton.setAttribute('data-player-control', 'paused');\r\n    });\r\n\r\n    this.$playButton.addEventListener('click', () => {\r\n      this.wavesurfer.playPause();\r\n\r\n      if (this.$playButton.getAttribute('data-player-control') === 'paused') {\r\n        this.$playButton.setAttribute('data-player-control', 'playing');\r\n      } else {\r\n        this.$playButton.setAttribute('data-player-control', 'paused');\r\n      }\r\n\r\n      this.showFeedback();\r\n    });\r\n\r\n    // stop audio prehravac kdyz se zapne dalsi slajd\r\n    const $nextSlides = document.querySelectorAll('[data-nav-button]');\r\n    $nextSlides.forEach(($nextSlide) => {\r\n      $nextSlide.addEventListener('click', () => {\r\n        if (this.$playButton.getAttribute('data-player-control') === 'playing') {\r\n          this.wavesurfer.playPause();\r\n          this.$playButton.setAttribute('data-player-control', 'paused');\r\n        }\r\n      });\r\n    });\r\n\r\n  }\r\n\r\n}\r\n","import AudioPlayer from './audio-player';\r\nimport { getSecondsMinutesFormat } from './media';\r\n\r\nexport default class AudioPlayerSimple extends AudioPlayer {\r\n  constructor($element) {\r\n    super($element);\r\n\r\n    this.$audio = this.target.querySelector('audio');\r\n    this.$timeLeft = this.target.querySelector('[data-audio-time-left]');\r\n    this.$duration = this.target.querySelector('[data-audio-time-duration]');\r\n\r\n    this.$duration.innerText = `/${getSecondsMinutesFormat(this.$audio.duration)}`;\r\n\r\n    AudioPlayer.addEventListeners(this.target, this.showFeedback);\r\n  }\r\n}\r\n","import Component from './component';\r\n\r\nexport default class FakeMap extends Component {\r\n  constructor($element) {\r\n    super($element);\r\n\r\n    this.$buttons = this.target.querySelectorAll('[data-fake-map=\"toggle\"]');\r\n    this.$maps = this.target.querySelectorAll('[data-fake-map=\"map\"]');\r\n    this.lastActiveIndex = 0;\r\n\r\n    this.addEventListenerToButtons();\r\n  }\r\n\r\n  switchMap($button, index) {\r\n    this.$maps[this.lastActiveIndex].classList.remove('active');\r\n    this.$buttons[this.lastActiveIndex].classList.remove('active');\r\n\r\n    this.$maps[index].classList.add('active');\r\n    $button.classList.add('active');\r\n\r\n    this.lastActiveIndex = index;\r\n  }\r\n\r\n  addEventListenerToButtons() {\r\n    this.$buttons.forEach(($button, index) => {\r\n\r\n      $button.addEventListener('click', (event) => {\r\n        this.switchMap($button, index);\r\n        this.showFeedback();\r\n\r\n        event.preventDefault();\r\n      });\r\n\r\n    });\r\n  }\r\n}\r\n","/* eslint-disable no-nested-ternary */\r\nimport Component from '../component';\r\nimport { getSecondsMinutesFormat, mediaEvents } from './media';\r\n\r\nexport default class VideoPlayer extends Component {\r\n  constructor($element, options) {\r\n    super($element);\r\n\r\n    this.$media = this.target.querySelector('video');\r\n    this.options = Object(options);\r\n    this.prefix = this.options.prefix || 'media';\r\n    this.lang = Object(this.options.lang);\r\n    // lang.currentTime\r\n    // lang.play\r\n    // lang.pause\r\n    // lang.minutes\r\n    // lang.seconds\r\n    // lang.leaveFullscreen\r\n    // lang.enterFullscreen\r\n\r\n    this.paused = null;\r\n    this.currentTime = null;\r\n    this.duration = null;\r\n    this.interval = null;\r\n\r\n    this.$document = this.target.ownerDocument;\r\n    this.$controls = this.target.querySelector('.media-player-controls');\r\n    // play/pause toggle\r\n    this.$play = this.$controls.querySelector('[data-player-control]');\r\n    this.$playSymbol = this.$play.querySelector('.media-play-symbol');\r\n    this.$pauseSymbol = this.$play.querySelector('.media-pause-symbol');\r\n    // time slider\r\n    this.$time = this.$controls.querySelector('[data-video-time-progress]');\r\n    this.$timeMeter = this.$time.querySelector('.media-meter.media-time-meter');\r\n    this.$timeRange = this.$time.querySelector('.media-range.media-time-range');\r\n\r\n    // current time text\r\n    this.$currentTimeText = this.$document.createTextNode('');\r\n    this.$currentTime = this.$controls.querySelector('[data-video-time-left]');\r\n    this.$currentTime.appendChild(this.$currentTimeText);\r\n\r\n    // duration time text\r\n    this.durationTime = this.$media.duration;\r\n    this.$durationTime = this.$controls.querySelector('[data-video-time-duration]');\r\n    this.$durationTime.innerText = getSecondsMinutesFormat(this.durationTime);\r\n    this.$durationTime.setAttribute(\r\n      'title',\r\n      `${VideoPlayer.timeToAural(\r\n        this.durationTime,\r\n        this.lang.minutes || 'minutes',\r\n        this.lang.seconds || 'seconds',\r\n      )}`,\r\n    );\r\n\r\n    // fullscreen button\r\n    this.$fullscreen = this.$controls.querySelector(\r\n      '.fullscreen-toggle',\r\n    );\r\n    this.$enterFullscreenSymbol = this.$fullscreen.querySelector(\r\n      '.media-enterFullscreen-symbol',\r\n    );\r\n    this.$leaveFullscreenSymbol = this.$fullscreen.querySelector(\r\n      '.media-leaveFullscreen-symbol',\r\n    );\r\n\r\n    // fullscreen api\r\n    this._fullscreenchange = 'onfullscreenchange' in this.target\r\n      ? 'fullscreenchange'\r\n      : 'onwebkitfullscreenchange' in this.target\r\n        ? 'webkitfullscreenchange'\r\n        : 'onMSFullscreenChange' in this.target\r\n          ? 'MSFullscreenChange'\r\n          : 'fullscreenchange';\r\n\r\n    this._requestFullscreen = this.target.requestFullscreen\r\n    || this.target.webkitRequestFullscreen\r\n    // || this.target.mozRequestFullScreen\r\n    || this.target.msRequestFullscreen;\r\n\r\n    this.onCanPlayStart = this.onCanPlayStart.bind(this);\r\n    this.onLoadStart = this.onLoadStart.bind(this);\r\n    this.onLoadedData = this.onLoadedData.bind(this);\r\n    this.onPlayChange = this.onPlayChange.bind(this);\r\n    this.onTimeChange = this.onTimeChange.bind(this);\r\n    this.onPlayClick = this.onPlayClick.bind(this);\r\n    this.onTimeKeydown = this.onTimeKeydown.bind(this);\r\n    this.onTimeClick = this.onTimeClick.bind(this);\r\n    this.onTimeKeydown = this.onTimeKeydown.bind(this);\r\n    this.onFullscreenClick = this.onFullscreenClick.bind(this);\r\n    this.onFullscreenChange = this.onFullscreenChange.bind(this);\r\n\r\n    // add event listeners\r\n    this.$media.addEventListener('canplaythrough', this.onCanPlayStart);\r\n    this.$media.addEventListener('loadstart', this.onLoadStart);\r\n    this.$media.addEventListener('loadeddata', this.onLoadedData);\r\n    this.$media.addEventListener('pause', this.onPlayChange);\r\n    this.$media.addEventListener('play', this.onPlayChange);\r\n    this.$media.addEventListener('timeupdate', this.onTimeChange);\r\n    this.$controls.addEventListener('click', this.onPlayClick, false);\r\n    // this.$play.addEventListener('click', this.onPlayClick, false);\r\n    this.$play.addEventListener('keydown', this.onTimeKeydown);\r\n    this.$time.addEventListener('click', this.onTimeClick, false);\r\n    this.$time.addEventListener('keydown', this.onTimeKeydown);\r\n    this.$fullscreen.addEventListener('click', this.onFullscreenClick, false);\r\n    // listen for fullscreen changes\r\n    document.addEventListener(\r\n      this._fullscreenchange,\r\n      this.onFullscreenChange,\r\n    );\r\n\r\n    // pointer events from time control\r\n    VideoPlayer.onDrag(this.$time, this.$timeRange, (percentage) => {\r\n      this.$media.currentTime = this.duration * Math.max(0, Math.min(1, percentage));\r\n\r\n      this.onTimeChange();\r\n    });\r\n\r\n    this.onLoadStart();\r\n  }\r\n\r\n  static _fullscreenElement() {\r\n    return document.fullscreenElement\r\n    || document.webkitFullscreenElement\r\n    // || document.mozFullScreenElement\r\n    || document.msFullscreenElement;\r\n  }\r\n\r\n  static _exitFullscreen() {\r\n    return document.exitFullscreen\r\n    || document.webkitCancelFullScreen\r\n    // || document.mozCancelFullScreen\r\n    || document.msExitFullscreen;\r\n  }\r\n\r\n  // when the play state changes\r\n  onPlayChange() {\r\n    if (this.paused !== this.$media.paused) {\r\n      this.paused = this.$media.paused;\r\n\r\n      this.$play.setAttribute(\r\n        'aria-label',\r\n        this.paused ? this.lang.play || 'play' : this.lang.pause || 'pause',\r\n      );\r\n      this.target.setAttribute(\r\n        'data-player-state',\r\n        this.paused ? 'paused' : 'playing',\r\n      );\r\n      this.$playSymbol.setAttribute('aria-hidden', !this.paused);\r\n      this.$pauseSymbol.setAttribute('aria-hidden', this.paused);\r\n\r\n      clearInterval(this.interval);\r\n\r\n      if (!this.paused) {\r\n        // listen for time changes every 30th of a second\r\n        this.interval = setInterval(this.onTimeChange, 34);\r\n      }\r\n\r\n      // dispatch new \"playchange\" event\r\n      this.$media.dispatchEvent(mediaEvents.playchange);\r\n    }\r\n  }\r\n\r\n  // when the time changes\r\n  onTimeChange() {\r\n    if (\r\n      this.currentTime !== this.$media.currentTime\r\n      || this.duration !== this.$media.duration\r\n    ) {\r\n      this.currentTime = this.$media.currentTime;\r\n      this.duration = this.$media.duration || 0;\r\n\r\n      const currentTimePercentage = this.currentTime / this.duration;\r\n      // const currentTimeCode = VideoPlayer.timeToTimecode(this.currentTime);\r\n      const currentTimeCode = getSecondsMinutesFormat(this.currentTime);\r\n      // const remainingTimeCode = VideoPlayer.timeToTimecode(\r\n      //   this.duration - Math.floor(this.currentTime),\r\n      // );\r\n\r\n      if (currentTimeCode !== this.$currentTimeText.nodeValue) {\r\n        this.$currentTimeText.nodeValue = currentTimeCode;\r\n\r\n        this.$currentTime.setAttribute(\r\n          'title',\r\n          `${VideoPlayer.timeToAural(\r\n            this.currentTime,\r\n            this.lang.minutes || 'minutes',\r\n            this.lang.seconds || 'seconds',\r\n          )}`,\r\n        );\r\n      }\r\n\r\n      // if (remainingTimeCode !== this.$remainingTimeText.nodeValue) {\r\n      //   this.$remainingTimeText.nodeValue = remainingTimeCode;\r\n\r\n      //   $(this.$remainingTime, {\r\n      //     title: `${VideoPlayer.timeToAural(\r\n      //       this.duration - this.currentTime,\r\n      //       this.lang.minutes || 'minutes',\r\n      //       this.lang.seconds || 'seconds',\r\n      //     )}`,\r\n      //   });\r\n      // }\r\n\r\n      this.$time.setAttribute('aria-valuenow', this.currentTime);\r\n      this.$time.setAttribute('aria-valuemin', 0);\r\n      this.$time.setAttribute('aria-valuemax', this.duration);\r\n\r\n      this.$timeMeter.style.width = `${currentTimePercentage * 100}%`;\r\n\r\n      // dispatch new \"timechange\" event\r\n      this.$media.dispatchEvent(mediaEvents.timechange);\r\n    }\r\n  }\r\n\r\n  // when media loads for the first time\r\n  onLoadStart() {\r\n    this.$media.removeEventListener('canplaythrough', this.onCanPlayStart);\r\n    this.$media.addEventListener('canplaythrough', this.onCanPlayStart);\r\n\r\n    this.onPlayChange();\r\n    this.onFullscreenChange();\r\n    this.onTimeChange();\r\n  }\r\n\r\n  // when the immediate current playback position is available\r\n  onLoadedData() {\r\n    this.onTimeChange();\r\n  }\r\n\r\n  // when the media can play\r\n  onCanPlayStart() {\r\n    this.$media.removeEventListener('canplaythrough', this.nCanPlayStart);\r\n\r\n    // dispatch new \"canplaystart\" event\r\n    this.$media.dispatchEvent(mediaEvents.canplaystart);\r\n\r\n\r\n    if (!this.paused || this.$media.autoplay) {\r\n      this.$media.play();\r\n    }\r\n  }\r\n\r\n  onFullscreenChange() {\r\n    const isFullscreen = this.target === VideoPlayer._fullscreenElement();\r\n\r\n    this.$fullscreen.setAttribute(\r\n      'aria-label',\r\n      isFullscreen\r\n        ? this.lang.leaveFullscreen || 'leave full screen'\r\n        : this.lang.enterFullscreen || 'enter full screen',\r\n    );\r\n    this.$enterFullscreenSymbol.setAttribute('aria-hidden', isFullscreen);\r\n    this.$leaveFullscreenSymbol.setAttribute('aria-hidden', !isFullscreen);\r\n  }\r\n\r\n  // when the play control is clicked\r\n  onPlayClick(event) {\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n\r\n    this.$media[this.$media.paused ? 'play' : 'pause']();\r\n  }\r\n\r\n  // when the time control\r\n  onTimeClick(event) {\r\n    event.stopPropagation();\r\n\r\n    // handle click if clicked without pointer\r\n    if (!event.pointerType && !event.detail) {\r\n      this.onPlayClick(event);\r\n    }\r\n  }\r\n\r\n  // click from fullscreen control\r\n  onFullscreenClick(event) {\r\n    event.stopPropagation();\r\n\r\n    if (this._requestFullscreen) {\r\n      if (this.target === VideoPlayer._fullscreenElement()) {\r\n        // exit fullscreen\r\n        VideoPlayer._exitFullscreen().call(document);\r\n      } else {\r\n        // enter fullscreen\r\n        this._requestFullscreen.call(this.target);\r\n\r\n        // maintain focus in internet explorer\r\n        this.$fullscreen.focus();\r\n\r\n        // maintain focus in safari\r\n        setTimeout(() => {\r\n          this.$fullscreen.focus();\r\n        }, 200);\r\n      }\r\n    } else if (this.$media.webkitSupportsFullscreen) {\r\n      // iOS allows fullscreen of the video itself\r\n      if (this.$media.webkitDisplayingFullscreen) {\r\n        // exit ios fullscreen\r\n        this.$media.webkitExitFullscreen();\r\n      } else {\r\n        // enter ios fullscreen\r\n        this.$media.webkitEnterFullscreen();\r\n      }\r\n\r\n      this.onFullscreenChange();\r\n    }\r\n  }\r\n\r\n  // keydown from play control or current time control\r\n  onTimeKeydown(event) {\r\n    const { keyCode, shiftKey } = event;\r\n\r\n    // 37: LEFT, 38: UP, 39: RIGHT, 40: DOWN\r\n    if (keyCode >= 37 && keyCode <= 40) {\r\n      event.preventDefault();\r\n\r\n      const offset = keyCode === 37 || keyCode === 39 ? keyCode - 38 : keyCode - 39;\r\n\r\n      this.$media.currentTime = Math.max(\r\n        0,\r\n        Math.min(\r\n          this.$media.duration,\r\n          this.$media.currentTime + offset * (shiftKey ? 10 : 1),\r\n        ),\r\n      );\r\n\r\n      this.onTimeChange();\r\n    }\r\n  }\r\n\r\n  // Handle Drag Ranges\r\n  static onDrag(target, innerTarget, listener) {\r\n    // eslint-disable-line max-params\r\n    const hasPointerEvent = undefined !== target.onpointerup;\r\n    const hasTouchEvent = undefined !== target.ontouchstart;\r\n    const pointerDown = hasPointerEvent\r\n      ? 'pointerdown'\r\n      : hasTouchEvent\r\n        ? 'touchstart'\r\n        : 'mousedown';\r\n    const pointerMove = hasPointerEvent\r\n      ? 'pointermove'\r\n      : hasTouchEvent\r\n        ? 'touchmove'\r\n        : 'mousemove';\r\n    const pointerUp = hasPointerEvent\r\n      ? 'pointerup'\r\n      : hasTouchEvent\r\n        ? 'touchend'\r\n        : 'mouseup';\r\n\r\n    // ...\r\n    const axisProp = 'clientX';\r\n\r\n    let window;\r\n    let start;\r\n    let end;\r\n\r\n    function onpointermove(event) {\r\n      // prevent browser actions on this event\r\n      event.preventDefault();\r\n\r\n      // the pointer coordinate\r\n      const position = axisProp in event\r\n        ? event[axisProp]\r\n        : (event.touches && event.touches[0] && event.touches[0][axisProp])\r\n            || 0;\r\n\r\n      // the percentage of the pointer along the container\r\n      const percentage = (position - start) / (end - start);\r\n\r\n      // call the listener with percentage\r\n      listener(percentage);\r\n    }\r\n\r\n    function onpointerdown(event) {\r\n      // window\r\n      window = target.ownerDocument.defaultView;\r\n\r\n      // client boundaries\r\n      const rect = innerTarget.getBoundingClientRect();\r\n\r\n      // the container start and end coordinates\r\n      start = rect.left;\r\n      end = rect.right;\r\n\r\n      onpointermove(event);\r\n\r\n      window.addEventListener(pointerMove, onpointermove);\r\n      window.addEventListener(pointerUp, onpointerup);\r\n    }\r\n\r\n    function onpointerup() {\r\n      window.removeEventListener(pointerMove, onpointermove);\r\n      window.removeEventListener(pointerUp, onpointerup);\r\n    }\r\n\r\n    // on pointer down\r\n    target.addEventListener(pointerDown, onpointerdown);\r\n  }\r\n\r\n  // Time To Timecode\r\n  // DEPRECATED (media.util)\r\n  // static timeToTimecode(time) {\r\n  //   return `${`0${Math.floor(time / 60)}`.slice(-2)}:${`0${Math.floor(\r\n  //     time % 60,\r\n  //   )}`.slice(-2)}`;\r\n  // }\r\n\r\n  // Time To Aural\r\n  // DEPRECATED (media.util)\r\n  static timeToAural(time, langMinutes, langSeconds) {\r\n    return `${Math.floor(time / 60)} ${langMinutes}, ${Math.floor(\r\n      time % 60,\r\n    )} ${langSeconds}`;\r\n  }\r\n}\r\n","/* eslint-disable linebreak-style */\r\nimport Component from './component';\r\nimport { __dispatchEvent } from '../lib/utils';\r\n\r\nexport default class Selectable extends Component {\r\n\r\n  constructor($element) {\r\n    super($element);\r\n\r\n    // TODO: is DOM element before/after the editor itself.. move it to the editor?\r\n    this.$settings = document.querySelector(`[data-selectable-id-reference=\"${this.target.id}\"]`);\r\n\r\n    this.feedback = JSON.parse(this.$settings.getAttribute('data-module-zpetnavazba'));\r\n    this.settings = JSON.parse(this.$settings.getAttribute('data-module-settings'));\r\n\r\n    this.$items = this.target.querySelectorAll('.selectable-item');\r\n\r\n    this.cache = {\r\n      answersCorrect: 0,\r\n      zpetnaVazba: false,\r\n      colors: [],\r\n      checkedInput: 0,\r\n    };\r\n\r\n    this.$inputs = this.target.querySelectorAll('input');\r\n    this.$inputs.forEach(($input) => {\r\n      this._changeClassIfChecked($input);\r\n      this._addEventListeners($input);\r\n    });\r\n\r\n    // get colors for all feedback variants\r\n    if (this.feedback) {\r\n      this.cache.zpetnaVazba = true;\r\n      this.cache.colors = this.feedback.map((feedback) => feedback.barva);\r\n    }\r\n\r\n  }\r\n\r\n  _addEventListeners($input) {\r\n    $input.addEventListener('change', () => {\r\n\r\n      this.$inputs.forEach(($input_) => {\r\n        this._changeClassIfChecked($input_);\r\n      });\r\n\r\n      this._checkAndResolveFeedback();\r\n\r\n      this._dispatchEvent($input);\r\n    }, false);\r\n  }\r\n\r\n  /* eslint class-methods-use-this: [\"error\", { \"exceptMethods\": [\"_changeClassIfChecked\"] }] */\r\n  // TODO: might be possible with CSS only with `:checked` selector & sibling combinator`+` or `~`\r\n  _changeClassIfChecked($input) {\r\n    $input.closest('.selectable-item').classList.toggle('is-checked', $input.checked === true);\r\n  }\r\n\r\n  _checkAndResolveFeedback() {\r\n    this.cache.answersCorrect = 0;\r\n\r\n    if (this.settings.viceOdpovedi) {\r\n      this.$items.forEach(($item, index) => {\r\n        if (this.$inputs[index].checked) {\r\n          this.cache.checkedInput += 1;\r\n        }\r\n        if (this.$inputs[index].checked && $item.hasAttribute('data-select-spravnaodpoved')) {\r\n          this.cache.answersCorrect += 1;\r\n        }\r\n        if (!this.$inputs[index].checked && !$item.hasAttribute('data-select-spravnaodpoved')) {\r\n          this.cache.answersCorrect += 1;\r\n        }\r\n      });\r\n    }\r\n    else {\r\n      this.$items.forEach(($item, index) => {\r\n        if (this.$inputs[index].checked) {\r\n          this.cache.checkedInput += 1;\r\n        }\r\n        if (this.$inputs[index].checked && $item.hasAttribute('data-select-spravnaodpoved')) {\r\n          this.cache.answersCorrect += 1;\r\n        }\r\n      });\r\n    }\r\n\r\n    // Display feedback button (if no checkbox is select, the button is hidden)\r\n    if ((this.cache.checkedInput === 0 && !this.settings.vybrano) || (this.cache.checkedInput === this.$inputs.length && this.settings.vybrano) || this.settings.disableFeedback) {\r\n      this.hideFeedback();\r\n    } else {\r\n\r\n      if (this.cache.zpetnaVazba) {\r\n        const feedbackActual = this.feedback.find((feedback) => feedback.podminka.includes(this.cache.answersCorrect));\r\n        this.$buttonFeedback.classList.remove(...this.cache.colors);\r\n        this.$buttonFeedback.classList.add(feedbackActual.barva);\r\n        this.$buttonFeedbackText.innerText = feedbackActual.text;\r\n      }\r\n\r\n      this.showFeedback();\r\n    }\r\n\r\n    this.target.classList.toggle('has-checked', this.cache.checkedInput > 0);\r\n\r\n    this.cache.checkedInput = 0;\r\n  }\r\n\r\n  _dispatchEvent($input) {\r\n    // const items = Array.from(this.$inputs).map(($input) => ({\r\n    //   checked: $input.checked,\r\n    //   id: $input.id,\r\n    // }));\r\n    const $label = $input.parentNode.querySelector('label');\r\n    let task;\r\n\r\n    if ($input.type === 'radio') {\r\n      task = 'change';\r\n    }\r\n    else if ($input.type === 'checkbox') {\r\n      task = ($input.checked) ? 'select' : 'unselect';\r\n    }\r\n    else {\r\n      console.error('ERROR: Undefinated input type.');\r\n    }\r\n\r\n    __dispatchEvent(this.target, 'selection.change', {}, {\r\n      id: this.target.id,\r\n      task,\r\n      itemId: $input.id,\r\n      itemData: $input.getAttribute('data-selectable-data'),\r\n      $node: $label.firstChild,\r\n    });\r\n  }\r\n}\r\n","/* eslint-disable no-case-declarations */\r\nimport Component from './component';\r\n\r\nexport default class NewTable extends Component {\r\n  constructor($element) {\r\n    super($element);\r\n    // duplicate source of different editor elements\r\n    this.dataFrom = this.target.parentNode.getAttribute('data-from');\r\n    this.dataSources = this.dataFrom ? this.dataFrom.split(' ') : [];\r\n    this.id = $element.getAttribute('id');\r\n    this.cache = {\r\n      tasks: [],\r\n    };\r\n\r\n    this.init();\r\n  }\r\n\r\n  init() {\r\n    const autofill = this.target.parentNode.getAttribute('data-autofill');\r\n\r\n    switch (autofill) {\r\n      case 'columns':\r\n        this._columnManager();\r\n        break;\r\n      case 'rows':\r\n        this._rowManager();\r\n        break;\r\n      case 'cells':\r\n        const allCells = this.target.querySelectorAll('.table-new__cell');\r\n\r\n        allCells.forEach(($cell) => {\r\n          const columnId = $cell.getAttribute('data-column-id');\r\n          const rowId = $cell.getAttribute('data-row-id');\r\n          // add listener only for cells in table\r\n          if (columnId && rowId) {\r\n            this._cellManager($cell, columnId, rowId);\r\n          }\r\n        });\r\n        break;\r\n      default:\r\n        console.log('NewTableERROR: Undefinated autofill key word!', autofill);\r\n    }\r\n  }\r\n\r\n  _rowManager() {\r\n    document.addEventListener('editor.change', (e) => {\r\n      const data = e.detail.text;\r\n\r\n      if (this.dataSources.includes(data.id)) {\r\n        let $tableRow;\r\n        let rightToAdd = true;\r\n\r\n        // get columns header\r\n        const $header = this.target.previousSibling;\r\n        const $headerCells = $header.firstChild.childNodes;\r\n\r\n        switch (data.task) {\r\n          case 'add':\r\n            $tableRow = document.createElement('div');\r\n            $tableRow.setAttribute('class', 'table-new__row');\r\n\r\n            $headerCells.forEach(($item) => {\r\n              const $rowCell = document.createElement('div');\r\n              $rowCell.setAttribute('class', 'table-new__cell');\r\n              const itemType = JSON.parse($item.getAttribute('data-type'));\r\n\r\n              // check if tagName is definated and than set variable to false\r\n              if (itemType.tagName && itemType.tagName !== data.tagData.tagName) {\r\n                rightToAdd = false;\r\n              }\r\n              else {\r\n                // add data to cell\r\n                this.fillCell(itemType, data, $rowCell);\r\n              }\r\n\r\n              // only add if it is right to add\r\n              if (rightToAdd) $tableRow.appendChild($rowCell);\r\n            });\r\n\r\n            // only add if it is right to add\r\n            if (rightToAdd) this.target.appendChild($tableRow);\r\n            break;\r\n          case 'remove':\r\n            const tableRows = this.target.childNodes;\r\n\r\n            tableRows.forEach(($row) => {\r\n              $row.childNodes.forEach(($cell, index) => {\r\n                const itemType = JSON.parse($headerCells[index].getAttribute('data-type'));\r\n\r\n                if (NewTable.isRightToDeleteHelper($cell, data.value, itemType)) {\r\n                  $tableRow = $row;\r\n\r\n                }\r\n              });\r\n            });\r\n\r\n            // olny if row for remove exists\r\n            if ($tableRow) {\r\n              // remove tasks from cache\r\n              $tableRow.childNodes.forEach(($cell) => {\r\n                this._removeTaskFromCache($cell);\r\n              });\r\n\r\n              $tableRow.remove();\r\n            }\r\n            break;\r\n          default:\r\n            console.log('NewTableERROR: Undefinated task for new table! (rowManager)');\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  // TODO: adding just specific tags names like in rowManager\r\n  _columnManager() {\r\n    document.addEventListener('editor.change', (e) => {\r\n      const data = e.detail.text;\r\n\r\n      if (this.dataSources.includes(data.id)) {\r\n        const $rows = this.target.childNodes;\r\n\r\n        switch (data.task) {\r\n          case 'add':\r\n            $rows.forEach(($row) => {\r\n              const $cell = document.createElement('div');\r\n              $cell.setAttribute('class', 'table-new__cell');\r\n\r\n              const $firstCell = $row.firstChild;\r\n              const itemType = JSON.parse($firstCell.getAttribute('data-type'));\r\n\r\n              // add data to cell\r\n              this.fillCell(itemType, data, $cell);\r\n\r\n              $row.appendChild($cell);\r\n            });\r\n            break;\r\n          case 'remove':\r\n            let columnIndex;\r\n            $rows.forEach(($row) => {\r\n              const $firstCell = $row.firstChild;\r\n              const itemType = JSON.parse($firstCell.getAttribute('data-type'));\r\n\r\n              $row.childNodes.forEach(($cell, index) => {\r\n                if (NewTable.isRightToDeleteHelper($cell, data.value, itemType)) {\r\n                  columnIndex = index;\r\n                }\r\n              });\r\n            });\r\n\r\n            this.target.childNodes.forEach(($row) => {\r\n              // remove tasks from cache\r\n              this._removeTaskFromCache($row.childNodes[columnIndex]);\r\n\r\n              $row.childNodes[columnIndex].remove();\r\n            });\r\n            break;\r\n          default:\r\n            console.log('NewTableERROR: Undefinated task for new table! (columnManager)');\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  _cellManager($cell, columnId, rowId) {\r\n    const itemType = JSON.parse(this._findCellType($cell));\r\n    const cellController = (data) => {\r\n      switch (data.task) {\r\n        case 'add':\r\n          const $tag = document.createElement('div');\r\n          this.fillCell(itemType, data, $cell);\r\n\r\n          $cell.appendChild($tag);\r\n          break;\r\n        case 'remove':\r\n          const $tags = $cell.querySelectorAll('div');\r\n          let removed = false;\r\n          for (let i = 0; i < $tags.length; i += 1) {\r\n            if (!removed && NewTable.isRightToDeleteHelper($tags[i], data.value, itemType)) {\r\n              // TODO: remove only childrens of $elm => empty div is still there\r\n              $tags[i].remove();\r\n              removed = true;\r\n            }\r\n          }\r\n          break;\r\n        default:\r\n          console.log('NewTableERROR: Undefinated task for new table! (cellManager)');\r\n      }\r\n    };\r\n\r\n    document.addEventListener('editor.change', (e) => {\r\n      const data = e.detail.text;\r\n\r\n      if (this.dataSources.includes(data.id) && (data.tagData.tagName === rowId || data.tagData.tagName === columnId)) {\r\n\r\n        if (!itemType.textId || itemType.textId === data.id) {\r\n          cellController(data);\r\n        }\r\n      }\r\n    });\r\n    document.addEventListener('draggable.drop', (e) => {\r\n      const data = e.detail;\r\n\r\n      if (this.dataSources.includes(data.id) && e.detail.columnId === columnId) {\r\n        // get text\r\n        const $span = data.$node.querySelector('span').cloneNode(true);\r\n        $span.classList.add('node-selected', 'node-text-gray');\r\n        $span.setAttribute('data-by', 'table-drop');\r\n\r\n        cellController({ task: data.task, value: $span });\r\n      }\r\n    });\r\n  }\r\n\r\n  fillCell(itemType, data, $node) {\r\n    let $innerItem;\r\n    let cacheObj;\r\n\r\n    // seed init or generate\r\n    let seed = 0;\r\n    if (this.cache.tasks.length > 0) {\r\n      const lastId = this.cache.tasks[this.cache.tasks.length - 1].id;\r\n      const idParts = lastId.split('-');\r\n      seed = +idParts[idParts.length - 1] + 1;\r\n    }\r\n\r\n    $node.classList.add(`table-new__cell--${itemType.name}`, `table-new__cell--${itemType.type}`);\r\n\r\n    switch (itemType.name) {\r\n      case 'dup-text':\r\n        $innerItem = document.createElement('div');\r\n        if (itemType.type === 'text') {\r\n          $innerItem.innerHTML = data.value.textContent;\r\n        }\r\n        else if (itemType.type === 'tag') {\r\n          // have to by clone, because if not it will by duplicatet do more tables it will be just in last one\r\n          $innerItem.appendChild(data.value.cloneNode(true));\r\n        }\r\n        break;\r\n      case 'select':\r\n        // create task in cache\r\n        cacheObj = { id: `${this.id}-select-${seed}`, answer: '', rightAnswer: data.tagData };\r\n        this.cache.tasks.push(cacheObj);\r\n\r\n        // create node in html\r\n        $innerItem = document.createElement(itemType.name);\r\n\r\n        $innerItem.setAttribute('id', cacheObj.id);\r\n        $innerItem.setAttribute('data-save', 'value');\r\n        $innerItem.setAttribute('tabindex', -1);\r\n\r\n        itemType.options.forEach((value) => {\r\n          const $option = document.createElement('option');\r\n          $option.innerHTML = value;\r\n          $innerItem.appendChild($option);\r\n        });\r\n\r\n        // add event listener\r\n        $innerItem.addEventListener('change', (event) => this._correctedAnswer(event, cacheObj));\r\n        break;\r\n      case 'input':\r\n      case 'textarea':\r\n        // create task in cache\r\n        cacheObj = { id: `${this.id}-input-${seed}`, answer: '', rightAnswer: data.tagData };\r\n        this.cache.tasks.push(cacheObj);\r\n\r\n        // create node in html\r\n        $innerItem = document.createElement(itemType.name);\r\n\r\n        $innerItem.setAttribute('id', cacheObj.id);\r\n        $innerItem.setAttribute('data-save', 'value');\r\n        $innerItem.setAttribute('tabindex', -1);\r\n\r\n        if (itemType.name === 'textarea') {\r\n          $innerItem.setAttribute('resize', cacheObj.id);\r\n        }\r\n\r\n        Object.keys(itemType.attributes).forEach((key) => {\r\n          $innerItem.setAttribute(key, itemType.attributes[key]);\r\n        });\r\n\r\n        // add event listener\r\n        $innerItem.addEventListener('change', (event) => this._correctedAnswer(event, cacheObj));\r\n        break;\r\n      case 'drop':\r\n        $innerItem = document.createElement('div');\r\n        const numberOfDrops = itemType.number ? itemType.number : -1;\r\n        // set attribute for draggable logic\r\n        $innerItem.setAttribute('data-drop-place', numberOfDrops);\r\n        break;\r\n      default:\r\n        $innerItem = document.createElement('div');\r\n        /*\r\n          if item Type name is value of data object from delivered cviceni feature\r\n          then use it and it's value set in table\r\n          else set empry value and show error\r\n       */\r\n        if (data.tagData[itemType.name]) {\r\n          $innerItem.innerHTML = data.tagData[itemType.name];\r\n        }\r\n        else {\r\n          $innerItem.innerHTML = ' ';\r\n          console.log('FillCellERROR: Undefinated object name.', itemType);\r\n        }\r\n    }\r\n    $node.appendChild($innerItem);\r\n  }\r\n\r\n  // prepare for more types of duplicate types\r\n  static isRightToDeleteHelper(elm, deliveredValue, itemType) {\r\n    let result;\r\n    if (itemType.name === 'dup-text') {\r\n      result = elm.textContent === deliveredValue.textContent;\r\n    } // different type then dup-text hasn't duplicate option\r\n    else {\r\n      result = false;\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  _findCellType($cell) {\r\n    const rowType = $cell.parentNode.firstChild.getAttribute('data-type');\r\n    if (rowType) return rowType;\r\n\r\n    // if rows header isn´t definated\r\n    const columnId = $cell.getAttribute('data-column-id');\r\n    const $columnHeader = this.target.parentNode.querySelector(`.table-new__cell--header[data-column-id=${columnId}]`);\r\n    if ($columnHeader) return $columnHeader.getAttribute('data-type');\r\n\r\n    return 'empty';\r\n  }\r\n\r\n  _correctedAnswer(event, cacheObj) {\r\n    this.cache.tasks.forEach((task) => {\r\n      if (task.id === cacheObj.id) {\r\n        task.answer = event.target.value;\r\n      }\r\n    });\r\n\r\n    // console.log('select change', this.cache);\r\n  }\r\n\r\n  _removeTaskFromCache($cell) {\r\n    this.cache.tasks.forEach((task, index) => {\r\n      if ($cell.firstChild.tagName === 'SELECT' || $cell.firstChild.tagName === 'INPUT' || $cell.firstChild.tagName === 'TEXTAREA') {\r\n        if ($cell.firstChild.id === task.id) {\r\n          this.cache.tasks.splice(index, 1);\r\n        }\r\n      }\r\n    });\r\n  }\r\n}\r\n","import Component from './component';\r\nimport { __dispatchEvent } from '../lib/utils';\r\n\r\n\r\nexport default class Draggable extends Component {\r\n  constructor($element) {\r\n    super($element);\r\n\r\n    this.idPrefix = 'drag-item';\r\n    // duplicate source of different editor elements\r\n    this.dataFrom = this.target.getAttribute('data-from');\r\n    this.dataSources = this.dataFrom ? this.dataFrom.split(' ') : [];\r\n\r\n    this.position = {\r\n      x: 0,\r\n      y: 0,\r\n      dx: 0,\r\n      dy: 0,\r\n    };\r\n    this.cache = {\r\n      // to know if draggable item was dropped or not and how many times\r\n      items: {},\r\n    };\r\n\r\n    this.$targetPrevious = null;\r\n    this.$targetCurrent = null;\r\n    this.$draggedItem = null;\r\n\r\n    this.objWidth = null;\r\n    this.objHeight = null;\r\n\r\n    this.init();\r\n  }\r\n\r\n  init() {\r\n    const $dragItems = this.target.querySelectorAll('.draggable__item');\r\n    $dragItems.forEach(($dragItem) => {\r\n      // get id\r\n      const id = $dragItem.getAttribute('data-id');\r\n      // inicial drop numbers\r\n      this.cache.items[id] = 0;\r\n      // use d3 container for $dragItem\r\n      this.dragAndDropEvents(d3.select($dragItem), id);\r\n    });\r\n\r\n    // initial handler for dropped item to svg\r\n    this.handleDeleteItemFromSvgDrop();\r\n\r\n    // initial handler for adding tags from text\r\n    this.handleAddTagsFromText();\r\n  }\r\n\r\n  // dropToken is used for handle usecase when user drag from drop-place to drop-place\r\n  dragAndDropEvents($dragItem, itemId, dropToken = true) {\r\n    // drag & drop\r\n    $dragItem.call(d3.drag()\r\n      .container(this.$slide)\r\n      .on('start', (event) => { this.onStart(event, $dragItem); })\r\n      .on('drag', (event) => { this.onDrag(event, $dragItem); })\r\n      .on('end', (event) => { this.onDrop(event, $dragItem, itemId, dropToken); }));\r\n  }\r\n\r\n  onStart(event, $dragItem) {\r\n\r\n    this.$slide.classList.add('is-dragging');\r\n\r\n    this.$targetPrevious = event.sourceEvent.target;\r\n\r\n    // in this method is better to have classic html node\r\n    const $dragItemHTML = $dragItem.node();\r\n\r\n    // initial position\r\n    this.objWidth = $dragItemHTML.offsetWidth;\r\n    this.objHeight = $dragItemHTML.offsetHeight;\r\n    this.position.x = event.sourceEvent.clientX - event.sourceEvent.offsetX;\r\n    this.position.y = event.sourceEvent.clientY - event.sourceEvent.offsetY;\r\n    this.position.dx = 0;\r\n    this.position.dy = 0;\r\n\r\n    // get dragged node\r\n    // clone element if from DRAG place\r\n    if ($dragItemHTML.parentNode.hasAttribute('data-drag-place')) {\r\n      this.$draggedItem = $dragItemHTML.cloneNode(true);\r\n    }\r\n    // do not clone if from DROP place\r\n    else {\r\n      this.$draggedItem = $dragItemHTML;\r\n\r\n      // get table data\r\n      const $table = $dragItemHTML.closest('.table-new__body');\r\n      const $cell = $dragItemHTML.closest('.table-new__cell');\r\n      const columnId = $cell.getAttribute('data-column-id');\r\n\r\n      // dispatch event that item has been removed from drop place\r\n      __dispatchEvent(document, 'draggable.drop', {}, {\r\n        id: $table.id,\r\n        task: 'remove',\r\n        columnId,\r\n        // type: itemType,\r\n        $node: $dragItemHTML,\r\n      });\r\n    }\r\n\r\n    // add to body\r\n    document.body.appendChild(this.$draggedItem);\r\n    // convert back to d3 container\r\n    this.$draggedItem = d3.select(this.$draggedItem);\r\n\r\n    this.$draggedItem\r\n      .classed('is-dragged', true)\r\n      .classed('was-dropped', false)\r\n      .attr('style', `top:${this.position.y}px; left:${this.position.x}px;`);\r\n  }\r\n\r\n  onDrag(event, $dragItem) {\r\n    // console.log($dragItem.node());\r\n    // update position\r\n    this.position.dx += event.dx;\r\n    this.position.dy += event.dy;\r\n\r\n    // move with dragging element\r\n    this.$draggedItem.style('transform', `translate3d(${this.position.dx}px, ${this.position.dy}px, 0) rotate(5deg)`);\r\n\r\n    this.$targetCurrent = event.sourceEvent.target;\r\n    // check for make placeholder in drop place\r\n    if (this.$targetPrevious !== this.$targetCurrent) {\r\n\r\n      // remove placeholder in old target\r\n      const $placeholderOld = this.$targetPrevious.querySelector('.draggable__item--placeholder');\r\n      if ($placeholderOld) $placeholderOld.remove();\r\n\r\n      // create placeholder in new target\r\n      if (this.$targetCurrent.hasAttribute('data-drop-place')) {\r\n        const numberOfPossibleDrops = this.$targetCurrent.getAttribute('data-drop-place');\r\n        const numberOfDropsDone = this.$targetCurrent.childElementCount;\r\n\r\n        // console.log('ondrag', numberOfDropsDone);\r\n\r\n        if (numberOfPossibleDrops === '-1' || +numberOfPossibleDrops > numberOfDropsDone) {\r\n          // remove this class is important for creating placeholder from dragging item from drop place\r\n          const $placeholderNew = $dragItem.clone(true)\r\n            .classed('is-dragged', false)\r\n            .classed('draggable__item--placeholder', true)\r\n            .attr('style', 'outline: 0px;')\r\n            .node();\r\n\r\n          this.$targetCurrent.appendChild($placeholderNew);\r\n        }\r\n      }\r\n\r\n      // update target\r\n      this.$targetPrevious = this.$targetCurrent;\r\n    }\r\n  }\r\n\r\n  onDrop(event, $dragItem, itemId, dropToken) {\r\n    this.$targetCurrent = event.sourceEvent.target;\r\n\r\n    // when dropping within droppable normal DOM node\r\n    if (this.$targetCurrent.hasAttribute('data-drop-place')) {\r\n\r\n      // get placeholder\r\n      let $dropItem = this.$targetCurrent.querySelector('.draggable__item--placeholder');\r\n\r\n      if ($dropItem) {\r\n        const itemType = $dropItem.getAttribute('data-draggable-item');\r\n\r\n        // remove unneeded classes for dropItem\r\n        $dropItem.classList.remove('draggable__item--placeholder', 'was-dropped');\r\n        $dropItem.classList.add('dropped__item');\r\n\r\n        // update drops num\r\n        if (dropToken) {\r\n          $dragItem.classed('was-dropped', true);\r\n          this.cache.items[itemId] += 1;\r\n        }\r\n\r\n        if (itemType === 'svg') {\r\n          const $fullScreenIcon = $dropItem.querySelector('[data-fullscreen=\"toggle\"]');\r\n          // replaced svg don't have full screen icon\r\n          if ($fullScreenIcon) {\r\n            $fullScreenIcon.remove();\r\n          }\r\n        }\r\n        else {\r\n          // add cross for remove item\r\n          const $rightElmChild = $dropItem.firstElementChild;\r\n          const $cross = document.createElement('span');\r\n          $cross.classList.add('node-close');\r\n          $cross.innerText = '×';\r\n\r\n          // remove svg from frop item\r\n          $rightElmChild.removeChild($rightElmChild.lastElementChild);\r\n          $rightElmChild.appendChild($cross);\r\n\r\n          // remove item after click on cross\r\n          $cross.addEventListener('click', () => {\r\n            this.removeDraggableItem($dropItem, itemId, dropToken);\r\n          });\r\n        }\r\n\r\n        // add events to clone for posible dragging back\r\n        // dropItem has to by in d3 container\r\n        this.dragAndDropEvents(d3.select($dropItem), itemId, false);\r\n      } // only click on drop item\r\n      else {\r\n        $dropItem = $dragItem.clone(true)\r\n          .classed('is-dragged', false)\r\n          .attr('style', 'outline: 0px;')\r\n          .node();\r\n\r\n        this.$targetCurrent.appendChild($dropItem);\r\n\r\n        // add events to clone for posible dragging back\r\n        // dropItem has to by in d3 container\r\n        this.dragAndDropEvents(d3.select($dropItem), itemId, false);\r\n      }\r\n\r\n      // get table data\r\n      const $table = this.$targetCurrent.closest('.table-new__body');\r\n      const $cell = this.$targetCurrent.closest('.table-new__cell');\r\n      const columnId = $cell.getAttribute('data-column-id');\r\n\r\n      // dispatch event that item has been dropped\r\n      __dispatchEvent(document, 'draggable.drop', {}, {\r\n        id: $table.id,\r\n        task: 'add',\r\n        columnId,\r\n        // type: itemType,\r\n        $node: $dropItem,\r\n      });\r\n\r\n      // remove draggedItem from DOM\r\n      this.$draggedItem.remove();\r\n    }\r\n    // when dropping within SVG\r\n    else {\r\n      // get svg\r\n      const $svg = this.$targetCurrent.closest('svg');\r\n      // check drop attribute\r\n      const svgCanDrop = $svg ? $svg.hasAttribute('data-svg-drop') : false;\r\n\r\n      // when dropping within droppable svg node\r\n      if (svgCanDrop) {\r\n\r\n        // see __localPosition in ../lib/utils\r\n        // however d3.event.offsetX does not work here\r\n        const getLocalPositionBasedOnBrowser = () => {\r\n          const $slideActive = $svg.closest('.half-slide-active');\r\n\r\n          if (platform.name === 'Firefox' && $slideActive) {\r\n            // this works for Firefox even in transformed container\r\n            return [\r\n              d3.pointer(event, $svg)[0] - ($slideActive.offsetWidth + this.objWidth),\r\n              d3.pointer(event, $svg)[1],\r\n            ];\r\n          }\r\n\r\n          // this works for Chrome\r\n          return d3.pointer(event, $svg);\r\n        };\r\n\r\n        const position = getLocalPositionBasedOnBrowser();\r\n        const $node = this.$draggedItem.classed('is-dragged', false)\r\n          .attr('style', 'outline: 0px;')\r\n          .node();\r\n\r\n        // update drops num\r\n        $dragItem.classed('was-dropped', true);\r\n        this.cache.items[itemId] += 1;\r\n\r\n        // add to svg\r\n        // dispatch event that svg has changed\r\n        __dispatchEvent(document, 'svg.drop', {}, {\r\n          svg: {\r\n            id: $svg.id,\r\n            $node,\r\n            type: $node.getAttribute('data-draggable-item'),\r\n            position,\r\n            size: {\r\n              width: this.objWidth,\r\n              height: this.objHeight,\r\n            },\r\n          },\r\n        });\r\n\r\n        this.$draggedItem.remove();\r\n\r\n      }\r\n      // when dropping outside of droppable area\r\n      else {\r\n        // if it's last drop then remove drop class\r\n        this.removeDraggableItem(this.$draggedItem, itemId, dropToken);\r\n      }\r\n\r\n    }\r\n\r\n    this.$slide.classList.remove('is-dragging');\r\n  }\r\n\r\n  handleDeleteItemFromSvgDrop() {\r\n\r\n    document.addEventListener('svg.drop.delete', (event) => {\r\n      const { id, $object } = event.detail.item;\r\n\r\n      // console.log('smazano', id, $object);\r\n      const $sameItemFromDragPlace = this.target.querySelector(`div[data-id=${id}]`);\r\n\r\n      if ($sameItemFromDragPlace) {\r\n        // if it's last drop then remove drop class\r\n        if (this.cache.items[id] === 1) {\r\n          $sameItemFromDragPlace.classList.remove('was-dropped');\r\n        }\r\n\r\n        // update drop number of concrete item\r\n        this.cache.items[id] -= 1;\r\n      }\r\n    });\r\n  }\r\n\r\n  handleAddTagsFromText() {\r\n    // need if we drop more than one same item\r\n    let idSalt = 1;\r\n\r\n    document.addEventListener('editor.change', (e) => {\r\n      const data = e.detail.text;\r\n      const concreteTagName = this.target.getAttribute('data-tagName');\r\n\r\n      // if concreteTagName\r\n      if (this.dataSources.includes(data.id) && (!concreteTagName || concreteTagName === data.tagData.tagName)) {\r\n        let $newDaggabletItem;\r\n        let $tagTextSpan;\r\n        let textToAdd;\r\n        let newId;\r\n        let idParts;\r\n\r\n        switch (data.task) {\r\n          case 'add':\r\n            // clone hidden tag\r\n            $newDaggabletItem = this.target.firstElementChild.cloneNode(true);\r\n            $newDaggabletItem.classList.remove('hidden');\r\n\r\n            // find place where to add tags text\r\n            $tagTextSpan = $newDaggabletItem.querySelector('.keywords-item');\r\n\r\n            // get right text to add\r\n            textToAdd = data.value.textContent;\r\n            if (textToAdd[textToAdd.length - 1] === '×') {\r\n              textToAdd = textToAdd.slice(0, -1);\r\n            }\r\n\r\n            // add text\r\n            $tagTextSpan.firstElementChild.innerHTML = textToAdd;\r\n\r\n            // add color to draggable item\r\n            $newDaggabletItem.firstElementChild.classList.add(`node-text-${data.tagColor}`);\r\n            $tagTextSpan.classList.add(`node-text-${data.tagColor}`);\r\n\r\n            // create new id\r\n            newId = $newDaggabletItem.getAttribute('data-id');\r\n            idParts = newId.split('-');\r\n            idParts.splice(-1, 1, `dup-${idSalt}`);\r\n            newId = idParts.join('-');\r\n\r\n            // set new id\r\n            $newDaggabletItem.setAttribute('data-id', newId);\r\n\r\n            // add to cache\r\n            this.cache.items[newId] = 0;\r\n\r\n            idSalt += 1;\r\n            this.target.appendChild($newDaggabletItem);\r\n\r\n            // add listeners for drag'n'drop\r\n            this.dragAndDropEvents(d3.select($newDaggabletItem), newId);\r\n            break;\r\n          case 'remove':\r\n            this.target.childNodes.forEach(($cell) => {\r\n              if (Draggable.isRightToDeleteHelper($cell, data.value, $cell.getAttribute('data-draggable-item'))) {\r\n                $cell.remove();\r\n              }\r\n            });\r\n            break;\r\n          default:\r\n            console.log('NewTableERROR: Undefinated task for new table! (cellManager)');\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  removeDraggableItem($draggedItem, itemId, dropToken) {\r\n    // if it's last drop then remove drop class\r\n    if (this.cache.items[itemId] === 1) {\r\n      const $sameItemFromDragPlace = this.target.querySelector(`div[data-id=${itemId}]`);\r\n      $sameItemFromDragPlace.classList.remove('was-dropped');\r\n    }\r\n\r\n    // update drop number of concrete item\r\n    if (!dropToken) {\r\n      this.cache.items[itemId] -= 1;\r\n    }\r\n\r\n    // remove draggedItem from DOM\r\n    $draggedItem.remove();\r\n  }\r\n\r\n  // prepare for more types of duplicate types\r\n  static isRightToDeleteHelper(elm, deliveredValue, itemType) {\r\n    // fix for tags\r\n    // table div textContent include '×' as last char\r\n    // because it is in self span\r\n    let elemTextContent;\r\n    if (itemType === 'tag' && elm.textContent[elm.textContent.length - 1] === '×') {\r\n      elemTextContent = elm.textContent.slice(0, -1);\r\n    }\r\n    else {\r\n      elemTextContent = elm.textContent;\r\n    }\r\n    return elemTextContent === deliveredValue.textContent;\r\n  }\r\n}\r\n","import Component from './component';\r\nimport AudioPlayer from './media/audio-player';\r\n\r\nexport default class Gallery extends Component {\r\n  constructor($element) {\r\n    super($element);\r\n\r\n    // select all right gallery items\r\n    const $selectableItemss = this.target.querySelectorAll('.selected-item');\r\n    const $dupItems = this.target.querySelectorAll('[data-duplicate]');\r\n\r\n    // set events for all found items\r\n    $selectableItemss.forEach(($item) => Gallery.setSelectEvents($item));\r\n    $dupItems.forEach(($item) => Gallery.setTextEvents($item));\r\n\r\n    console.log(this.target, $dupItems);\r\n  }\r\n\r\n  static setSelectEvents($item) {\r\n    const selectedId = $item.id;\r\n    const $placeholder = $item.querySelector('.selected-item__placeholder');\r\n\r\n    document.addEventListener('selection.change', (e) => {\r\n      if (selectedId === e.detail.id) {\r\n        const data = e.detail;\r\n        const idTail = '-duplicated';\r\n\r\n        switch (data.task) {\r\n          // singlechoice\r\n          case 'change':\r\n            Gallery.removeItemFromSelect($item);\r\n            Gallery.addItemFromSelect($item, idTail, data);\r\n            break;\r\n\r\n          // multichoice\r\n          case 'select':\r\n            // hide placeholder\r\n            $placeholder.classList.add('is-hidden');\r\n\r\n            Gallery.addItemFromSelect($item, idTail, data);\r\n            break;\r\n\r\n          case 'unselect':\r\n            Gallery.removeItemFromSelect($item, data.itemId + idTail);\r\n\r\n            // show placeholder if its have to\r\n            if ($item.childElementCount === 1) {\r\n              $placeholder.classList.remove('is-hidden');\r\n            }\r\n            break;\r\n\r\n          default:\r\n            console.error('ERROR: Undefinated task type.');\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  static setTextEvents($item) {\r\n    const acceptedId = $item.getAttribute('data-duplicate');\r\n    const textDuplicateSources = acceptedId ? acceptedId.split(' ') : [];\r\n\r\n    document.addEventListener('text.change', (e) => {\r\n      const data = e.detail.text;\r\n\r\n      if (textDuplicateSources.includes(data.id)) {\r\n        switch (data.task) {\r\n          case 'create':\r\n          case 'change':\r\n            // TODO: More inputs to one output\r\n            $item.innerHTML = data.text;\r\n            break;\r\n          default:\r\n            console.log('Nondefinated text events task. :(');\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  static addItemFromSelect($item, idTail, data) {\r\n    const $dupNode = data.$node.cloneNode(true);\r\n    $dupNode.setAttribute('data-id', data.itemId + idTail);\r\n\r\n    // add listeners to audio\r\n    if ($dupNode.hasAttribute('data-player-audio')) {\r\n      AudioPlayer.addEventListeners($dupNode, () => {});\r\n    }\r\n\r\n    $item.appendChild($dupNode);\r\n  }\r\n\r\n  static removeItemFromSelect($item, dataId = undefined) {\r\n    if (dataId) {\r\n      const $dupNode = $item.querySelector(`[data-id=${dataId}]`);\r\n      $dupNode.remove();\r\n    }\r\n    else {\r\n      $item.firstChild.remove();\r\n    }\r\n  }\r\n}\r\n","/* eslint-disable no-unused-vars */\r\nimport MagnifyingGlass from './magnifying-glass';\r\nimport Sortable from './sortable';\r\nimport SVG from './svg';\r\nimport SVGRadialMenu from './svg-lib/svg-radial-menu';\r\nimport Editor from './editor/editor';\r\nimport Keywords from './keywords';\r\nimport TestQuiz from './test-quiz';\r\nimport FullscreenToggle from './fullscreen';\r\nimport UserText from './user-text';\r\nimport AudioPlayerNormal from './media/audio-player-normal';\r\nimport AudioPlayerSimple from './media/audio-player-simple';\r\nimport FakeMap from './fake-map';\r\nimport { stopPlayingVideoPlayers } from './media/media';\r\nimport VideoPlayer from './media/video';\r\nimport Selectable from './selectable';\r\nimport NewTable from './new-table';\r\nimport Draggable from './draggable';\r\nimport Gallery from './gallery';\r\n\r\nconst windowLoadComponents = () => {\r\n  console.log('windowLoad:components');\r\n\r\n  // Video player - normal\r\n  const $videoPlayers = document.querySelectorAll('[data-player-video]');\r\n  if ($videoPlayers.length > 0) {\r\n    $videoPlayers.forEach(($videoPlayer) => {\r\n      // console.log('$videoPlayer', $videoPlayer);\r\n      const videoPlayer = new VideoPlayer($videoPlayer);\r\n    });\r\n\r\n    document.addEventListener('slide.change', () => {\r\n      stopPlayingVideoPlayers($videoPlayers);\r\n    });\r\n  }\r\n\r\n  // Audio player - normal\r\n  const $audioPlayerNormals = document.querySelectorAll('[data-player-audio=\"normal\"]');\r\n  if ($audioPlayerNormals.length > 0) {\r\n    $audioPlayerNormals.forEach(($audioPlayerNormal) => {\r\n      const audioPlayerNormal = new AudioPlayerNormal($audioPlayerNormal);\r\n    });\r\n\r\n    // TODO > audio-player-normal.js#61\r\n    // document.addEventListener('slide.change', () => {\r\n    //   stopPlayingVideoPlayers($audioPlayerNormals);\r\n    // });\r\n  }\r\n\r\n  // Audio player — simple\r\n  const $audioPlayerSimples = document.querySelectorAll('[data-player-audio=\"simple\"]');\r\n  if ($audioPlayerSimples.length > 0) {\r\n    $audioPlayerSimples.forEach(($audioPlayerSimple) => {\r\n      const audioPlayerSimple = new AudioPlayerSimple($audioPlayerSimple);\r\n    });\r\n\r\n    document.addEventListener('slide.change', () => {\r\n      stopPlayingVideoPlayers($audioPlayerSimples);\r\n    });\r\n  }\r\n\r\n  // Fullscreen\r\n  const $fullscreenToggles = document.querySelectorAll('[data-fullscreen=\"toggle\"]');\r\n  if ($fullscreenToggles.length > 0) {\r\n    $fullscreenToggles.forEach(($fullscreenToggle) => {\r\n      const fullscreenToggle = new FullscreenToggle($fullscreenToggle);\r\n    });\r\n  }\r\n\r\n  // Magnifying glass\r\n  const $magnifyingGlass = document.querySelectorAll('[data-lupa-target]');\r\n  if ($magnifyingGlass.length > 0) {\r\n    for (let i = 0; i < $magnifyingGlass.length; i += 1) {\r\n      const magnifyingGlass = new MagnifyingGlass($magnifyingGlass[i]);\r\n    }\r\n  }\r\n\r\n  // Fake Map\r\n  const $fakeMaps = document.querySelectorAll('[data-fake-map=\"target\"]');\r\n  if ($fakeMaps.length > 0) {\r\n    for (let i = 0; i < $fakeMaps.length; i += 1) {\r\n      const fakeMap = new FakeMap($fakeMaps[i]);\r\n    }\r\n  }\r\n\r\n  //\r\n  // load these below in working mode only\r\n\r\n  // User texts\r\n  // - preview/working mode logic inside the component\r\n  //  - show\r\n  const $userTexts = document.querySelectorAll('[data-textarea-target=\"\"]');\r\n  if ($userTexts.length > 0) {\r\n    $userTexts.forEach(($userText) => {\r\n      const userText = new UserText($userText);\r\n    });\r\n  }\r\n\r\n  // SVG + Radial menu\r\n  // - preview/working mode logic in side the component\r\n  //  - to set max-width\r\n  const $svgs = document.querySelectorAll('[data-svg-target]');\r\n  if ($svgs.length > 0) {\r\n\r\n    if (HISTORYLAB.import.done !== true) {\r\n      // radial menu\r\n      const $radialMenu = document.querySelector('[data-radial-menu]');\r\n      if ($radialMenu) {\r\n        const radialMenu = new SVGRadialMenu($radialMenu, $svgs);\r\n      }\r\n    }\r\n\r\n    // svgs\r\n    // setSize is needed\r\n    $svgs.forEach(($svg) => {\r\n      const svg = new SVG($svg);\r\n    });\r\n  }\r\n\r\n  // Editor\r\n  const $editors = document.querySelectorAll('[data-editor]');\r\n  if ($editors.length > 0) {\r\n    $editors.forEach(($editor) => {\r\n      const editor = new Editor($editor);\r\n      // important for getting data from editor\r\n      // each editor has to be add to list of cviceni tools\r\n      // editor id must to be unique\r\n      HISTORYLAB.tools[editor.id] = editor;\r\n    });\r\n  }\r\n\r\n  if (HISTORYLAB.import.done !== true) {\r\n    // Test Quizes\r\n    const $testQuizs = document.querySelectorAll('[data-target-test-quiz]');\r\n    if ($testQuizs.length > 0) {\r\n      $testQuizs.forEach(($testQuiz) => {\r\n        const settings = document.querySelector(\r\n          `[data-test-quiz-id-reference=\"${$testQuiz.getAttribute(\r\n            'data-test-quiz-id',\r\n          )}\"]`,\r\n        );\r\n\r\n        const testQuiz = new TestQuiz(\r\n          $testQuiz.getAttribute('data-test-quiz-id'),\r\n          $testQuiz,\r\n          JSON.parse(settings.getAttribute('data-module-settings')),\r\n        );\r\n        testQuiz.init();\r\n      });\r\n    }\r\n\r\n    // New table\r\n    const $newTables = document.querySelectorAll('[data-new-table]');\r\n    if ($newTables.length > 0) {\r\n      $newTables.forEach(($newTable) => {\r\n        const newTable = new NewTable($newTable);\r\n      });\r\n    }\r\n\r\n    // Pretahovani\r\n    const $draggables = document.querySelectorAll('[data-draggable]');\r\n    if ($draggables.length > 0) {\r\n      $draggables.forEach(($draggable) => {\r\n        const draggable = new Draggable($draggable);\r\n      });\r\n    }\r\n\r\n    // Sortable\r\n    const $sortables = document.querySelectorAll('[data-sortable-target]');\r\n    if ($sortables.length > 0) {\r\n      $sortables.forEach(($sortable) => {\r\n        const sortable = new Sortable($sortable);\r\n      });\r\n    }\r\n\r\n    // Selectable\r\n    const $selectables = document.querySelectorAll('[data-selectable-target]');\r\n    if ($selectables.length > 0) {\r\n      $selectables.forEach(($selectable) => {\r\n        const selectable = new Selectable($selectable);\r\n      });\r\n    }\r\n\r\n    // Keywords selection\r\n    const $keywords = document.querySelectorAll('[data-keywords]');\r\n    if ($keywords.length > 0) {\r\n      $keywords.forEach(($keyword) => {\r\n        const settings = $keyword.hasAttribute('data-module-settings')\r\n          ? $keyword.getAttribute('data-module-settings')\r\n          : {};\r\n        const keywords = new Keywords($keyword, JSON.parse(settings));\r\n        keywords.init();\r\n      });\r\n    }\r\n\r\n    // Gallery listener\r\n    const $galleries = document.querySelectorAll('[data-gallery]');\r\n    if ($galleries.length > 0) {\r\n      $galleries.forEach(($gallery) => {\r\n        const gallery = new Gallery($gallery);\r\n      });\r\n    }\r\n  }\r\n};\r\n\r\nexport default windowLoadComponents;\r\n","/* eslint-disable consistent-return */\r\nimport domLoadComponents from './dom-load';\r\nimport windowLoadComponents from './window-load';\r\nimport unsupportedBrowsers from '../lib/unsupported-browsers';\r\n\r\n(() => {\r\n  if (unsupportedBrowsers()) return false;\r\n\r\n  // The DOMContentLoaded event fires when parsing of the current page is complete. DOMContentLoaded is a great event to use to hookup UI functionality to complex web pages.\r\n  document.addEventListener('DOMContentLoaded', domLoadComponents, false);\r\n\r\n  // The load event fires when all files have finished loading from all resources, including ads and images.\r\n  window.addEventListener('load', windowLoadComponents, false);\r\n})();\r\n","const unsupportedBrowsers = () => {\r\n\r\n  // feature detection for unsupported browsers\r\n  const isUnsupported = !Array.from\r\n    || !Element.prototype.matches\r\n    || !Element.prototype.closest\r\n    || typeof window.CustomEvent !== 'function'\r\n    || typeof Object.assign !== 'function';\r\n\r\n  if (isUnsupported) {\r\n    console.warn('Not supported browser.');\r\n\r\n    const $unsupported = document.querySelector('#unsupported');\r\n    $unsupported.querySelector('#unsupported-browser').innerHTML = ` ${platform.name} ${platform.version} `;\r\n    $unsupported.classList.remove('is-hidden');\r\n\r\n    return true;\r\n  }\r\n\r\n  return false;\r\n};\r\n\r\nexport default unsupportedBrowsers;\r\n"],"names":["domLoadComponents","console","log","Component","$element","_classCallCheck","this","target","$slide","closest","lang","document","documentElement","getAttribute","HISTORYLAB","done","$buttonFeedback","querySelector","$buttonFeedbackText","showFeedback","bind","classList","contains","remove","add","MagnifyingGlass","_this","$canvas","ctx","getContext","_onStart","_assertThisInitialized","_onMove","_onEnd","_update","_onResize","zoomGlassSize","targetBCR","zoomed","targetZoomed","x","y","trackingTouch","displayStyle","_addEventListeners","_initCanvas","window","requestAnimationFrame","width","height","dPR","devicePixelRation","style","scale","getBoundingClientRect","value","event","getComputedStyle","display","preventDefault","pageX","touches","pageY","TAU","Math","PI","radius","ratioX","max","min","left","ratioY","top","scaledTargetWidth","scaledTargetHeight","platform","os","family","indexOf","name","shadowColor","shadowBlur","shadowOffsetY","clearRect","fillStyle","beginPath","arc","closePath","fill","save","clip","drawImage","restore","_setTransformStyle","addEventListener","betterX","betterY","halfYoomGlassSize","abs","innerWidth","transform","__createNewCustomEvent","options","data","defaults","bubbles","properties","Object","assign","CustomEvent","_objectSpread","detail","__dispatchEvent","type","payload","dispatchEvent","__globalPosition","__localPosition","container","position","offsetX","offsetY","d3","pointer","_slicedToArray","pointers","format","__toggleClass","element","cls","__hasClass","__removeClass","__addClass","concat","className","elements","classes","_elements","_classes","querySelectorAll","tagName","split","i","length","_elements$i$classList","apply","_toConsumableArray","j","_elements$i$classList2","replace","RegExp","mediaEvents","playchange","timechange","canplaystart","stopPlayingVideoPlayers","$players","forEach","$player","$media","paused","pause","setAttribute","getSecondsMinutesFormat","seconds","duration","floor","minutes","toString","slice","AudioPlayer","_super","call","$item","$audio","$playButton","$timeLeft","play","stopPropagation","innerText","currentTime","SVGDragNDrop","select","raise","classed","diff","$node","_this$getJustifiedCor2","getJustifiedCord","xZarov","yZarov","attr","toFixed","_this$getJustifiedCor4","orientation","elementResolution","offsetHeight","offsetWidth","svgResolution","map","e","parseInt","textJustified","pretahovaniJustified","circleJustified","textCenter","getOffsetOfText","attributes","d3Element","_this$circleJustified2","SVGDraw","$svg","color","callback","sourceEvent","nodeName","line","curve","curveLinear","d","subject","x0","y0","id","active","append","datum","on","dragEvent","x1","y1","dx","dy","push","$thisPath","svg","task","node","contextMenu","pathEventsManager","svgGroup","localPosition","circleEventsManager","circleStyle","r","elementPosition","idParts","item","$object","drag","start","from","circleMove","oldXCoordinate","oldYCoordinate","taskType","SVG","removeCloneConnectionManager","SVGText","maxLength","minLength","svgID","$radialMenu","hash","foreignObject","circle","textarea","focus","textEventsManager","$textarea","$circle","isCreated","firstWrite","oldText","parentElement","dragged","end","childNodes","updateTextareaHeight","$target","wrongBool","isWrong","removeItem","newHeight","scrollHeight","isBubble","_setSize","init","_initWhenDone","toDuplicate","svgSpecificActions","colors","svgSpecificColor","_initPath","_initCircle","_initComicBubbles","_getEvents","_getDropEvent","selectAll","viewbox","rect","maxWidthAbsolute","maxHeightAbsolute","innerHeight","getHeight","maxWidth","setMaxWidth","_this2","p","renderPath","_this3","createCircle","_this4","$comicBubbles","$comicBubble","comicBubblesEventsManager","oldID","join","_this5","svgDuplicateSources","includes","$templateNode","$templateCircle","localNodeID","_generateNewID","$localNode","_clonePath","_cloneComicBubbles","templateCircleID","localCircleID","$localCircle","_cloneCircle","_cloneTextField","_this6","idSalt","_event$detail$svg","size","multiply","$d3canvas","$d3foreignObject","$dropItem","createElement","appendChild","firstElementChild","$foreignObject","cloneNode","insertBefore","selected","isRadial","$parent","firstChild","allActiveSvgs","deactivate","pop","every","coord","globalPosition","elementFromPoint","Sortable","$settings","feedback","JSON","parse","$container","$items","$droppables","$placeholder","$inheritors","inheritors","order","direction","before","after","evaluation","undefined","mouse","clientX","clientY","el","clone","posRel","siblings","prev","next","_setupInitialOrder","_setupInheritors","cache","barva","hasAttribute","offsetTop","offsetLeft","_addPlaceholder","_onOver","right","_onDrop","bottom","_removePlaceholder","_updateOrder","_updateOrderInInheritors","_dispatchEvent","_checkAndResolveFeedback","_getReference","_addEventListenerToItem","addEventListeners","removeChild","minHeight","src","img","nextElementSibling","previousElementSibling","array","some","index","checkIfTheArrayIsGood","changedArray","splice","_this$$buttonFeedback","arrayOfItems","dataset","sortableSpravnaodpoved","feedbackResult","oneMove","feedbackActual","find","podminka","text","splneno","Array","$inheritor","sortableIndex","inheritor","SVGRadialMenu","$svgs","$radialMenuItems","$colorItems","$textItems","$createTextItem","$removeItem","$tooltip","initialSetUp","menuRadius","getPropertyValue","itemRadius","setUpRadialMenuItems","addEventListenersToRadialMenu","openRadialMenu","iOSAddonEvents","timer","test","navigator","userAgent","MSStream","setTimeout","getSelection","removeAllRanges","clearTimeout","hasText","hasMoreColors","$clickedItem","findNearElements","activate","deselectItem","filterMenuButtons","showRadialMenu","addEventListenersToRadialMenuItem","_itemsLength","_menuRadius","_itemRadius","_menuOffset","_interval","_centerOffset","angle","sin","cos","onMouseLeave","hideRadialMenu","action","createText","changeColor","innerHTML","currentTarget","$activeSVG","$activeRadialMenuItem","positionRadialMenuItems","mouseLeaveDelay","_this7","clickedItem","$colorItem","$textItem","selectItem","_$element","SelectionMenu","editorId","schema","editorView","$menuTemplate","$menuBox","update","nodes","marks","dom","parentNode","relatedTarget","$menuItems","sugar","$menuItem","dataCommandName","isAdded","marker","state","dataTagId","addRemoveButton","removeButton","pm","toggleMark","command","dispatch","markedSelection","selection","closeSelection","$dispatchNode","connectAllSelectedParts","removingMarkerHandler","tagData","tagColor","view","lastState","readOnly","activeElementClasses","activeElement","empty","offsetParent","to","coordsAtPos","box","offsetParentBox","err","error","ranges","has","$from","$to","_ranges$i","doc","rangeHasMark","pos","lastPosition","newState","tr","insert","create","updateState","setSelection","TextSelection","inputs","$removeButton","$markedParts","_loop","$markedPart","fromPos","posAtDOM","toPos","textContent","matched","nodesBetween","isInline","toRemove","MarkType","found","isInSet","nodeSize","m","step","eq","RemoveMarkStep","fromPostRB","$nodes","$finalNode","fullContent","WrittingMenu","$removeAllChanges","firstState","confirm","schemaConfig","content","heading","attrs","level","default","group","defining","parseDOM","tag","getAttrs","toDOM","paragraph","list","listItem","hard_break","selectable","inline","premarked","textData","$dom","class","italic","bold","code","small","data-command-name","data-tag-id","writtingInsertPart","writtingRemovePart","Editor","editor","editorType","$editor","$content","Schema","initJSON","initHTML","toJSON","plugins","selectionMenu","premarkedParts","writting","keydownHandler","histKeymap","keymap","undo","Mod-y","redo","history","EditorView","EditorState","DOMParser","fromSchema","readOnlyMod","fromJSON","Plugin","props","editable","key","PluginKey","$toolbarTemplate","deletedParts","handleKeyDown","Delete","Backspace","handleClickOn","nodePos","classSelectDefinition","newClassName","nodeAttrs","setNodeMarkup","Keywords","opts","$controls","$itemsContainer","itemsContainerClassName","inherit","isInherited","itemClassName","_getHTMLFromItems","onInit","_regenerateItemsContainerFromInherited","_registerHandlers","_changeSizeOfKeywordItem","skala","maxLevel","setNewLevelValue","$keyword","number","oldValue","newValue","$control","tempContent","temp","getElementById","renameItemsIds","_clickEventHandler","_dispatchEventHandler","keywords","_e$detail$keywords","currentId","nodeId","_getItemFromDOMElement","_getItemsHTML","_getItemsFromHTML","itemsClassName","itemsArray","_getDOMElementFromItem","newDiv","__getHTML","outerHTML","wrapper","items","contentHTML","oldId","newId","itemsHTML","expString","TestQuiz","$questions","itemClass","answersCorrect","questions","zpetnaVazba","$question","questionIndex","answered","answerCorrect","$answers","optionClass","$answer","answerIndex","$answerCurrent","$answersItem","selectedClass","_this2$$buttonFeedbac","question","FullscreenToggle","_super2","imageAlternative","$fullscreenContainer","$fullscreenTarget","removeAttribute","toLowerCase","currentSrc","Promise","resolve","reject","Image","onload","onerror","then","image","naturalWidth","naturalHeight","ratio","setSize","_viewbox","$svgTexts","$svgText","$fullscreen","toggle","Fullscreen","UserText","$counter","$counterWrapper","$instruction","$userTexts","lengthExpected","avg","lastValue","hadData","wasUsed","updateCharacterCounter","textDuplicateSources","getEvents","_this$$counterWrapper","arguments","none","ok","conditionAll","$userText","taskName","valueLength","updateFeedback","fromId","itemData","AudioPlayerNormal","$loadWave","$leftTime","$audioDuration","wavesurfer","WaveSurfer","waveColor","progressColor","responsive","barWidth","load","initWave","getDuration","addListenerAfterReady","time","playPause","$nextSlide","AudioPlayerSimple","$duration","FakeMap","$buttons","$maps","lastActiveIndex","addEventListenerToButtons","$button","switchMap","VideoPlayer","prefix","interval","$document","ownerDocument","$play","$playSymbol","$pauseSymbol","$time","$timeMeter","$timeRange","$currentTimeText","createTextNode","$currentTime","durationTime","$durationTime","timeToAural","$enterFullscreenSymbol","$leaveFullscreenSymbol","_fullscreenchange","_requestFullscreen","requestFullscreen","webkitRequestFullscreen","msRequestFullscreen","onCanPlayStart","onLoadStart","onLoadedData","onPlayChange","onTimeChange","onPlayClick","onTimeKeydown","onTimeClick","onFullscreenClick","onFullscreenChange","onDrag","percentage","clearInterval","setInterval","currentTimePercentage","currentTimeCode","nodeValue","removeEventListener","nCanPlayStart","autoplay","isFullscreen","_fullscreenElement","leaveFullscreen","enterFullscreen","pointerType","_exitFullscreen","webkitSupportsFullscreen","webkitDisplayingFullscreen","webkitExitFullscreen","webkitEnterFullscreen","keyCode","shiftKey","offset","fullscreenElement","webkitFullscreenElement","msFullscreenElement","exitFullscreen","webkitCancelFullScreen","msExitFullscreen","innerTarget","listener","hasPointerEvent","onpointerup","hasTouchEvent","ontouchstart","pointerDown","pointerMove","pointerUp","axisProp","onpointermove","onpointerdown","defaultView","langMinutes","langSeconds","Selectable","settings","checkedInput","$inputs","$input","_changeClassIfChecked","$input_","checked","viceOdpovedi","vybrano","disableFeedback","hideFeedback","$label","itemId","NewTable","dataFrom","dataSources","tasks","autofill","_columnManager","_rowManager","$cell","columnId","rowId","_cellManager","$tableRow","rightToAdd","$headerCells","previousSibling","$rowCell","itemType","fillCell","$row","isRightToDeleteHelper","_removeTaskFromCache","$rows","$firstCell","columnIndex","_findCellType","cellController","$tag","$tags","removed","textId","$span","$innerItem","cacheObj","seed","answer","rightAnswer","$option","_correctedAnswer","keys","numberOfDrops","rowType","$columnHeader","elm","deliveredValue","Draggable","idPrefix","$targetPrevious","$targetCurrent","$draggedItem","objWidth","objHeight","$dragItem","dragAndDropEvents","handleDeleteItemFromSvgDrop","handleAddTagsFromText","dropToken","onStart","onDrop","$dragItemHTML","$table","body","$placeholderOld","numberOfPossibleDrops","numberOfDropsDone","childElementCount","$placeholderNew","$slideActive","$fullScreenIcon","$rightElmChild","$cross","lastElementChild","removeDraggableItem","_event$detail$item","$sameItemFromDragPlace","$newDaggabletItem","$tagTextSpan","textToAdd","concreteTagName","Gallery","$selectableItemss","$dupItems","setSelectEvents","setTextEvents","selectedId","idTail","removeItemFromSelect","addItemFromSelect","acceptedId","$dupNode","dataId","windowLoadComponents","$videoPlayers","$videoPlayer","$audioPlayerNormals","$audioPlayerNormal","$audioPlayerSimples","$audioPlayerSimple","$fullscreenToggles","$fullscreenToggle","$magnifyingGlass","$fakeMaps","$editors","tools","$testQuizs","$testQuiz","$newTables","$newTable","$draggables","$draggable","$sortables","$sortable","$selectables","$selectable","$keywords","$galleries","$gallery","Element","prototype","matches","warn","$unsupported","version","unsupportedBrowsers"],"mappings":"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"}