{"version":3,"file":"components.build.js","sources":["../../../../src/js/components/component.js","../../../../src/js/components/magnifying-glass.js","../../../../src/js/lib/utils.js","../../../../src/js/components/photo-detail.js","../../../../src/js/components/media/media.js","../../../../src/js/components/media/audio-player.js","../../../../src/js/components/sortable.js","../../../../src/js/components/svg-lib/svg-dragndrop.js","../../../../src/js/components/svg-lib/svg-draw.js","../../../../src/js/components/svg-lib/svg-text.js","../../../../src/js/components/svg.js","../../../../src/js/components/svg-lib/svg-radial-menu.js","../../../../src/js/store/observer.js","../../../../src/js/store/store-constants.js","../../../../src/js/store/store.js","../../../../src/js/store/store-global.js","../../../../src/js/components/editor/editor.js","../../../../src/js/components/analytical-table.js","../../../../src/js/store/store-keywords.js","../../../../src/js/components/keywords.js","../../../../src/js/components/editor-tags-placeholder.js","../../../../src/js/components/test-quiz.js","../../../../src/js/components/generic-table.js","../../../../src/js/components/fullscreen.js","../../../../src/js/components/user-text.js","../../../../src/js/components/media/audio-player-normal.js","../../../../src/js/components/media/audio-player-simple.js","../../../../src/js/components/fake-map.js","../../../../src/js/components/media/video.js","../../../../src/js/components/components.js","../../../../src/js/components/dom-load.js","../../../../src/js/components/window-load.js"],"sourcesContent":["export default class Component {\r\n  constructor($element) {\r\n    this.target = $element;\r\n    this.$slide = this.target.closest('.slide');\r\n\r\n    if (this.$slide) {\r\n      this.$buttonFeedback = this.$slide.querySelector('[data-feedback-button]');\r\n      this.$buttonFeedbackText = this.$buttonFeedback.querySelector('span');\r\n    }\r\n\r\n    this.showFeedback = this.showFeedback.bind(this);\r\n  }\r\n\r\n  showFeedback() {\r\n    if (this.$buttonFeedback && this.$buttonFeedback.classList.contains('button-hidden')) {\r\n      this.$buttonFeedback.classList.remove('button-hidden');\r\n    }\r\n  }\r\n}\r\n","import Component from './component';\r\n\r\nexport default class MagnifyingGlass extends Component {\r\n  // https://www.youtube.com/watch?v=e8IwM3iqnL0\r\n  constructor($element) {\r\n    super($element);\r\n    // SVG lupa a ještě dynamicky měnícího se SVG,\r\n    // který není na počátku známé?\r\n    // if (el.nodeName === 'svg') {\r\n    //   console.log('SVG');\r\n    //   el.children[0].getAttribute('xlink:href')\r\n    // }\r\n    this.$element = document.querySelector('[data-lupa]');\r\n    this.$canvas = document.querySelector('[data-lupa-canvas]');\r\n    this.ctx = this.$canvas.getContext('2d');\r\n\r\n    this._onStart = this._onStart.bind(this);\r\n    this._onMove = this._onMove.bind(this);\r\n    this._onEnd = this._onEnd.bind(this);\r\n    this._update = this._update.bind(this);\r\n    this._onResize = this._onResize.bind(this);\r\n\r\n    this.zoomGlassSize = 230;\r\n    this.targetBCR = null;\r\n    this.zoomed = 0;\r\n    this.targetZoomed = 0;\r\n\r\n    this.x = 0;\r\n    this.y = 0;\r\n    this.trackingTouch = false;\r\n\r\n    this._addEventListeners();\r\n    this._initCanvas();\r\n    this._onResize();\r\n\r\n    window.requestAnimationFrame(this._update);\r\n  }\r\n\r\n  _initCanvas() {\r\n    const width = this.zoomGlassSize;\r\n    const height = this.zoomGlassSize;\r\n    // if retina makes canvas more dense\r\n    const dPR = window.devicePixelRation || 1;\r\n    this.$canvas.width = width * dPR;\r\n    this.$canvas.height = height * dPR;\r\n\r\n    this.$canvas.style.width = `${width}px`;\r\n    this.$canvas.style.height = `${height}px`;\r\n\r\n    this.ctx.scale(dPR, dPR);\r\n  }\r\n\r\n  _onResize() {\r\n    this.targetBCR = this.target.getBoundingClientRect();\r\n  }\r\n\r\n  _onStart(event) {\r\n    if (event.target !== this.target) {\r\n      return;\r\n    }\r\n\r\n    event.preventDefault();\r\n\r\n\r\n    this.x = event.pageX || event.touches[0].pageX;\r\n    this.y = event.pageY || event.touches[0].pageY;\r\n\r\n    this.trackingTouch = true;\r\n    this.targetZoomed = 1;\r\n    this.zoomed = 0;\r\n\r\n    window.requestAnimationFrame(this._update);\r\n  }\r\n\r\n  _onMove(event) {\r\n    if (!this.trackingTouch) {\r\n      return;\r\n    }\r\n\r\n    this.x = event.pageX || event.touches[0].pageX;\r\n    this.y = event.pageY || event.touches[0].pageY;\r\n  }\r\n\r\n  _onEnd() {\r\n    if (this.targetZoomed) {\r\n      // show OK button or feedback\r\n      this.showFeedback();\r\n    }\r\n\r\n    this.targetZoomed = 0;\r\n    this.trackingTouch = false;\r\n  }\r\n\r\n  _update() {\r\n    const TAU = Math.PI * 2;\r\n    const MAX_RADIUS = 100;\r\n    const radius = this.zoomed * MAX_RADIUS;\r\n\r\n    this.targetBCR = this.target.getBoundingClientRect();\r\n\r\n    // local coordinates (ratio <0,1>)\r\n    const ratioX =\r\n      // min. 0\r\n      Math.max(0,\r\n        // max. 1\r\n        Math.min(1, ((this.x - this.targetBCR.left) / this.targetBCR.width))\r\n      );\r\n    // console.log(ratioX);\r\n    const ratioY =\r\n      // min. 0\r\n      Math.max(0,\r\n        // max. 1\r\n        Math.min(1, ((this.y - this.targetBCR.top) / this.targetBCR.height))\r\n      );\r\n    // console.log(ratioY);\r\n\r\n    // actual zooming (scaling)\r\n    const imageScale = 2.5;\r\n    const scaledTargetWidth = this.targetBCR.width * imageScale;\r\n    const scaledTargetHeight = this.targetBCR.height * imageScale;\r\n\r\n    // Firefox on Windows has a bug because of the shadow\r\n    if (!(platform.os.family.indexOf('Windows') > -1 && platform.name.indexOf('Firefox') > -1)) {\r\n      // Shadow.\r\n      this.ctx.shadowColor = 'rgba(0,0,0,0.4)';\r\n      this.ctx.shadowBlur = 12;\r\n      this.ctx.shadowOffsetY = 8;\r\n    }\r\n\r\n    // Background.\r\n    this.ctx.clearRect(0, 0, this.zoomGlassSize, this.zoomGlassSize);\r\n    this.ctx.fillStyle = '#fff';\r\n    this.ctx.beginPath();\r\n    this.ctx.arc(\r\n      // x\r\n      this.zoomGlassSize / 2,\r\n      // y\r\n      (this.zoomGlassSize - 10) - radius,\r\n      // radius, startAngle, endAngle\r\n      radius, 0, TAU);\r\n    this.ctx.closePath();\r\n    this.ctx.fill();\r\n\r\n    // save the default state (without image)\r\n    this.ctx.save();\r\n\r\n    // Zoomed image.\r\n    this.ctx.beginPath();\r\n    this.ctx.arc(\r\n      // x\r\n      this.zoomGlassSize / 2,\r\n      // y\r\n      (this.zoomGlassSize - 10) - (radius + 1),\r\n      // radius, startAngle, endAngle\r\n      radius * 1.03, 0, TAU);\r\n    this.ctx.clip();\r\n    this.ctx.closePath();\r\n    this.ctx.drawImage(this.target,\r\n      // dx and dy (left and top)\r\n      (-ratioX * scaledTargetWidth) + (this.zoomGlassSize / 2),\r\n      (-ratioY * scaledTargetHeight) + (this.zoomGlassSize / 2),\r\n      // scaled width and height\r\n      scaledTargetWidth, scaledTargetHeight);\r\n\r\n    // go back to default state (without image)\r\n    // so next update starts fresh\r\n    this.ctx.restore();\r\n\r\n    // Position the parent $element.\r\n    this.$element.style.transform = `translate(${this.x}px, ${this.y}px)`;\r\n\r\n    // Update the zoom value.\r\n    this.zoomed += (this.targetZoomed - this.zoomed) / 4;\r\n\r\n    // Schedule another update if the zoom is fairly non-zero.\r\n    if (this.zoomed > 0.001) {\r\n      // if (this.zoomed > 0.001 && this.zoomed < 0.998) {\r\n      window.requestAnimationFrame(this._update);\r\n      // } else if (this.zoomed >= 0.998) {\r\n      //   this.zoomed = 1;\r\n    } else {\r\n      this.zoomed = 0;\r\n    }\r\n  }\r\n\r\n  _addEventListeners() {\r\n    // touch events\r\n    document.addEventListener('touchstart', this._onStart);\r\n    document.addEventListener('touchmove', this._onMove);\r\n    document.addEventListener('touchend', this._onEnd);\r\n    // mouse events\r\n    document.addEventListener('mousedown', this._onStart);\r\n    document.addEventListener('mousemove', this._onMove);\r\n    document.addEventListener('mouseup', this._onEnd);\r\n    // window events\r\n    window.addEventListener('resize', this._onResize);\r\n  }\r\n}\r\n","// https://stackoverflow.com/questions/901115/how-can-i-get-query-string-values-in-javascript#3855394\nexport function __getQueryStringParams() {\n  const parameters = window.location.search.substr(1).split('&');\n\n  if (parameters === '') {\n    return {};\n  }\n\n  const b = {};\n\n  for (let i = 0; i < parameters.length; i += 1) {\n    const p = parameters[i].split('=', 2);\n\n    if (p.length === 1) {\n      b[p[0]] = '';\n    } else {\n      b[p[0]] = decodeURIComponent(p[1].replace(/\\+/g, ' '));\n    }\n  }\n\n  return b;\n}\n\nexport function __createNewCustomEvent(name, options = {}, data = null) {\n  const defaults = {\n    // https://developer.mozilla.org/en-US/docs/Web/Guide/Events/Creating_and_triggering_events#Event_bubbling\n    bubbles: true,\n    // cancelBubble\n    // stopPropagation()\n    // cancelable\n    // composed\n    // currentTarget\n    // defaultPrevented\n    // preventDefault()\n    // eventPhase\n    // returnValue\n    // preventDefault()\n    // defaultPrevented\n    // target\n    // timeStamp\n    // type\n    // isTrusted\n  };\n\n  const properties = Object.assign(defaults, options);\n\n  return new CustomEvent(name, {\n    detail: data,\n    ...properties,\n  });\n}\n\nexport function __dispatchEvent($element, type, options, payload) {\n  const event = __createNewCustomEvent(type, options, payload);\n\n  $element.dispatchEvent(event);\n}\n\n/* https://plainjs.com/javascript/events/trigger-an-event-11/ */\nexport function __triggerEvent(el, type) {\n\n  if ('createEvent' in document) {\n    // modern browsers, IE9+\n    const e = new Event(type);\n    el.dispatchEvent(e);\n  } else {\n    // IE 8\n    const e = document.createEventObject();\n    e.eventType = type;\n    el.fireEvent('on'+e.eventType, e);\n  }\n}\n\nexport function __keycodeIsPrintableCharacter(keycode) {\n\n  const valid =\n    (keycode > 47 && keycode < 58) || // number keys\n    keycode == 32 || keycode == 13 || // spacebar & return key(s) (if you want to allow carriage returns)\n    (keycode > 64 && keycode < 91) || // letter keys\n    (keycode > 95 && keycode < 112) || // numpad keys\n    (keycode > 185 && keycode < 193) || // ;=,-./` (in order)\n    (keycode > 218 && keycode < 223); // [\\]' (in order)\n  // https://stackoverflow.com/questions/12467240/determine-if-javascript-e-keycode-is-a-printable-non-control-character#answer-12467610\n\n  return valid;\n\n}\n\nexport function __isObject(item) {\n  return (item && typeof item === 'object' && !Array.isArray(item));\n}\n\n// https://stackoverflow.com/questions/27936772/how-to-deep-merge-instead-of-shallow-merge\n// Maybe use lodash ? https://lodash.com/docs/4.17.10#defaultsDeep\nexport function __mergeDeep(target, source) {\n  const output = Object.assign({}, target);\n  if (__isObject(target) && __isObject(source)) {\n    Object.keys(source).forEach((key) => {\n      if (__isObject(source[key])) {\n        if (!(key in target)) {\n          Object.assign(output, { [key]: source[key] });\n        } else {\n          output[key] = __mergeDeep(target[key], source[key]);\n        }\n      } else {\n        Object.assign(output, { [key]: source[key] });\n      }\n    });\n  }\n  return output;\n}\n\nexport function __isObjectEmpty(object) {\n  return !Object.keys(object).length;\n}\n\nexport function __insertBefore(newNode, referenceNode) {\n  referenceNode.parentNode.insertBefore(newNode, referenceNode);\n}\n\nexport function __insertAfter(newNode, referenceNode) {\n\n  referenceNode.parentNode.insertBefore(newNode, referenceNode.nextSibling);\n\n}\n\nexport function __getRealDimensions(el, translated = true) {\n\n  const clonedElement = el.cloneNode(true);\n\n  clonedElement.style.visibility = 'hidden';\n  clonedElement.style.display = 'block';\n\n  __insertAfter(clonedElement, el);\n\n  const elDimensions = clonedElement.getBoundingClientRect();\n  const elPosition = (translated) ? __positionTranslated(clonedElement) : __position(clonedElement);\n\n\n  __remove(clonedElement);\n\n  return {\n    width: elDimensions.width,\n    height: elDimensions.height,\n    top: elPosition.top,\n    left: elPosition.left,\n  };\n\n}\n\nexport function __remove(el /* :HTMLElement */) {\n\n  el.parentNode.removeChild(el);\n\n}\n\n\nexport function __getHTML(node) {\n\n  if (!node || !node.tagName) { return; }\n  if (node.outerHTML) { return node.outerHTML; }\n\n  // polyfill:\n  const wrapper = document.createElement('div');\n  wrapper.appendChild(node.cloneNode(true));\n  return wrapper.innerHTML;\n\n}\n\nexport function __getText(el) {\n  return el.innerText || el.textContent;\n}\n\nexport function __globalPosition(event) {\n  // d3.event\n  // The current event, if any. This is set during the invocation of an event listener, and is reset after the listener terminates. Use this to access standard event fields such as event.timeStamp and methods such as event.preventDefault. While you can use the native event.pageX and event.pageY, it is often more convenient to transform the event position to the local coordinate system of the container that received the event using d3.mouse, d3.touch or d3.touches.\n  // If you use Babel, Webpack, or another ES6-to-ES5 bundler, be aware that the value of d3.event changes during an event! An import of d3.event must be a live binding, so you may need to configure the bundler to import from D3’s ES6 modules rather than from the generated UMD bundle; not all bundlers observe jsnext:main. Also beware of conflicts with the window.event global.\n  return {\n    x: event.pageX,\n    y: event.pageY,\n  };\n}\n\nexport function __localPosition(container) {\n  // d3.mouse\n  // Returns the x and y coordinates of the current event relative to the specified container. The container may be an HTML or SVG container element, such as a G element or an SVG element. The coordinates are returned as a two-element array of numbers [x, y].\n  // BUG: d3.mouse doesn’t observe CSS transform on Firefox — https://github.com/d3/d3-selection/issues/81\n  const pos = d3.mouse(container);\n  return {\n    x: d3.format('.0f')(pos[0]),\n    y: d3.format('.0f')(pos[1]),\n  };\n}\n\nexport function __positionTranslated(el) {\n\n\n  const curTransform = new WebKitCSSMatrix(window.getComputedStyle(el).webkitTransform);\n\n  const body = document.body;\n\n  const scrollTop = window.pageYOffset || body.scrollTop;\n  const scrollLeft = window.pageXOffset || body.scrollLeft;\n\n  return {\n    left: el.offsetLeft + curTransform.m41,\n    top: el.offsetTop + curTransform.m42,\n  };\n\n}\n\nexport function __position(el) {\n\n  const elAttibutes = el.getBoundingClientRect();\n  const body = document.body;\n\n  const scrollTop = window.pageYOffset || body.scrollTop;\n  const scrollLeft = window.pageXOffset || body.scrollLeft;\n\n  return {\n    left: elAttibutes.left + scrollLeft,\n    top: elAttibutes.top + scrollTop,\n    height: elAttibutes.height,\n    width: elAttibutes.width,\n  };\n}\n\n// TODO: check for https://github.com/vladocar/nanoJS/\nexport function __toggleClass(element, cls) {\n  if (__hasClass(element, cls)) {\n    __removeClass(element, cls);\n  } else {\n    __addClass(element, cls);\n  }\n}\n\nexport function __hasClass(element, cls) {\n  // if there are no elements or classes, we're done\n  if (!element || !cls) return false;\n  return (element.classList) ? element.classList.contains(cls) : (`${element.className} `).indexOf(`${cls} `) > -1;\n}\n\nexport function __addClass(elements, classes) {\n  let _elements = elements;\n  let _classes = classes;\n\n  // if there are no elements or classes, we're done\n  if (!_elements || !_classes) { return; }\n\n  if (typeof (_elements) === 'string') {\n    // if we have a selector, get the chosen _elements\n    _elements = document.querySelectorAll(_elements);\n  } else if (_elements.tagName) {\n    // if we have a single DOM element, make it an array to simplify behavior\n    _elements = [_elements];\n  }\n\n  if (typeof (_classes) === 'string') {\n    // make an array from string _classes\n    _classes = _classes.split(' ');\n  } else {\n    console.log('Class argument must be string with spaces in between class names.');\n    return;\n  }\n\n  // add class to all chosen _elements\n  for (let i = 0; i < _elements.length; i += 1) {\n    // check classList support\n    if (_elements[i].classList) {\n      _elements[i].classList.add(..._classes);\n    } else if (!__hasClass(_elements[i], ..._classes)) {\n      for (let j = 0; j < _classes.length; j += 1) {\n        _elements[i].classes += ` ${_classes[j]}`;\n      }\n    }\n  }\n}\n\nexport function __removeClass(elements, classes) {\n  let _elements = elements;\n  let _classes = classes;\n\n  // if there are no elements or classes, we're done\n  if (!_elements || !_classes) { return; }\n\n  if (typeof (_elements) === 'string') {\n    // if we have a selector, get the chosen _elements\n    _elements = document.querySelectorAll(_elements);\n  } else if (_elements.tagName) {\n    // if we have a single DOM element, make it an array to simplify behavior\n    _elements = [_elements];\n  }\n\n  if (typeof (_classes) === 'string') {\n    // make an array from string _classes\n    _classes = _classes.split(' ');\n  } else {\n    console.log('Class argument must be string with spaces in between class names.');\n    return;\n  }\n\n  // remove class from all chosen _elements\n  for (let i = 0; i < _elements.length; i += 1) {\n    // check classList support\n    if (_elements[i].classList) {\n      _elements[i].classList.remove(..._classes);\n    } else {\n      for (let j = 0; j < _classes.length; j += 1) {\n        _elements[i].className = _elements[i].className.replace(new RegExp(`\\\\b${classes[j]}\\\\b`, 'g'), '');\n      }\n    }\n  }\n}\n","import { __addClass, __removeClass, __hasClass } from '../lib/utils';\r\nimport Component from './component';\r\n\r\n// zoom the image\r\nexport default class PhotoDetail extends Component {\r\n  constructor(element) {\r\n    super(element);\r\n    this.zoomIntensity = 3;\r\n    this.targetContainer = this.target.parentElement;\r\n\r\n    this._onClick = this._onClick.bind(this);\r\n    this._onMove = this._onMove.bind(this);\r\n    // TODO: if window size has changed\r\n    this._onResize = this._onResize.bind(this);\r\n\r\n    this._getImageDimensions();\r\n    this._addEventListeners();\r\n  }\r\n\r\n  _getImageDimensions() {\r\n    // returns the size of the scaled image\r\n    // and its position relative to the viewport\r\n    this.targetBCR = this.target.getBoundingClientRect();\r\n\r\n    // we just need to set the height of the container\r\n    // only for on window load and on window resize\r\n    // width is 100% of its container\r\n    this.targetContainer.style.height = `${this.targetBCR.height}px`;\r\n\r\n    // TODO: count image side ratio\r\n  }\r\n\r\n  _onResize() {\r\n    // returns the size of the scaled image\r\n    // and its position relative to the viewport\r\n    this.targetBCR = this.target.getBoundingClientRect();\r\n  }\r\n\r\n  _onClick(event) {\r\n    if (event.target !== this.target) {\r\n      return;\r\n    }\r\n\r\n    // Cancels the event if it is cancelable, without stopping further propagation of the event.\r\n    event.preventDefault();\r\n\r\n    // to zoom\r\n    if (!__hasClass(this.target, 'enlarged')) {\r\n\r\n      this._onResize();\r\n\r\n      // add state class\r\n      __addClass(this.target, 'enlarged');\r\n\r\n      // get mouse event position\r\n      this.x = event.clientX || event.touches[0].pageX;\r\n      this.y = event.clientY || event.touches[0].pageY;\r\n\r\n      // set position\r\n      this.target.style.top = `${this.positionY}%`;\r\n      this.target.style.left = `${this.positionX}%`;\r\n    } else {\r\n      // to unzoom\r\n      // remove move state class if present\r\n      if (__hasClass(this.target, 'detail-move')) {\r\n        __removeClass(this.target, 'detail-move');\r\n      }\r\n\r\n      // remove zoom state class\r\n      __removeClass(this.target, 'enlarged');\r\n\r\n      // remove zoomed position\r\n      this.target.style.left = '';\r\n      this.target.style.top = '';\r\n    }\r\n  }\r\n\r\n  _onMove(event) {\r\n    if (event.target !== this.target || !__hasClass(this.target, 'enlarged')) {\r\n      return;\r\n    }\r\n\r\n    // run only it was zoomed already\r\n    if (__hasClass(this.target, 'enlarged')) {\r\n\r\n      // add state class\r\n      if (!__hasClass(this.target, 'detail-move')) {\r\n        __addClass(this.target, 'detail-move');\r\n      }\r\n\r\n      // track mouse event position\r\n      this.x = event.clientX || event.touches[0].pageX;\r\n      this.y = event.clientY || event.touches[0].pageY;\r\n\r\n      // get position\r\n      this.target.style.top = `${this.positionY}%`;\r\n      this.target.style.left = `${this.positionX}%`;\r\n    }\r\n\r\n  }\r\n\r\n  static get positionY() {\r\n    return (((this.y - this.targetBCR.top) / this.targetBCR.height) * -100) * (this.zoomIntensity - 1);\r\n  }\r\n  static get positionX() {\r\n    return (((this.x - this.targetBCR.left) / this.targetBCR.width) * -100) * (this.zoomIntensity - 1);\r\n  }\r\n\r\n  _addEventListeners() {\r\n    // touch events\r\n    document.addEventListener('touchstart', this._onClick);\r\n    document.addEventListener('touchmove', this._onMove);\r\n    // mouse events\r\n    document.addEventListener('mousedown', this._onClick);\r\n    document.addEventListener('mousemove', this._onMove);\r\n    // window events\r\n    // window.addEventListener('resize', this._onResize);\r\n  }\r\n}\r\n","import { __createNewCustomEvent } from '../../lib/utils';\r\n\r\nconst mediaEvents = {\r\n  playchange: __createNewCustomEvent('playchange'),\r\n  timechange: __createNewCustomEvent('timechange'),\r\n  canplaystart: __createNewCustomEvent('canplaystart'),\r\n};\r\n\r\nfunction stopPlayingVideoPlayers($players) {\r\n  // pause all other playing media tracks\r\n  $players.forEach(($player) => {\r\n    const $media = $player.querySelector('audio') || $player.querySelector('video');\r\n    if ($media && !$media.paused) {\r\n      $media.pause();\r\n      $player\r\n        .querySelector('[data-player-control]')\r\n        .setAttribute('data-player-control', 'paused');\r\n    }\r\n  });\r\n}\r\n\r\nfunction getSecondsMinutesFormat(seconds) {\r\n  const duration = {\r\n    seconds: Math.floor(seconds),\r\n    minutes: Math.floor(seconds / 60),\r\n  };\r\n\r\n  duration.seconds = (duration.seconds - (duration.minutes * 60)).toString(10);\r\n\r\n  return `${duration.minutes}:${(`0${duration.seconds}`).slice(-2)}`;\r\n}\r\n\r\nexport {\r\n  getSecondsMinutesFormat,\r\n  stopPlayingVideoPlayers,\r\n  mediaEvents,\r\n};\r\n","import Component from '../component';\r\nimport { getSecondsMinutesFormat, stopPlayingVideoPlayers } from './media';\r\n\r\nexport default class AudioPlayer extends Component {\r\n  // eslint-disable-next-line no-useless-constructor\r\n  constructor($element) {\r\n    super($element);\r\n  }\r\n\r\n  // TODO: move to audio-simple.js\r\n  static addEventListeners($item, showFeedback) {\r\n    const $players = document.querySelectorAll('[data-player-audio]');\r\n    const $audio = $item.querySelector('audio');\r\n    const $playButton = $item.querySelector('[data-player-control]');\r\n    const $timeLeft = $item.querySelector('[data-audio-time-left]');\r\n\r\n    $playButton.addEventListener('click', (event) => {\r\n      if ($playButton.getAttribute('data-player-control') === 'paused') {\r\n        // TODO: abstract\r\n        stopPlayingVideoPlayers(Array.from($players));\r\n        $audio.play();\r\n        $playButton.setAttribute('data-player-control', 'playing');\r\n      } else {\r\n        // TODO: abstract\r\n        $audio.pause();\r\n        $playButton.setAttribute('data-player-control', 'paused');\r\n      }\r\n\r\n      showFeedback();\r\n\r\n      event.stopPropagation();\r\n    }, false);\r\n\r\n    // do not propagate audio control events higher into the dom\r\n    $playButton.addEventListener('mousedown', (event) => {\r\n      event.stopPropagation();\r\n    }, false);\r\n\r\n    $audio.addEventListener('timeupdate', () => {\r\n      $timeLeft.innerText = getSecondsMinutesFormat($audio.currentTime);\r\n    });\r\n\r\n    $audio.addEventListener('ended', () => {\r\n      $playButton.setAttribute('data-player-control', 'paused');\r\n    });\r\n  }\r\n}\r\n","import Component from './component';\r\nimport AudioPlayer from './media/audio-player';\r\nimport { stopPlayingVideoPlayers } from './media/media';\r\n\r\nexport default class Sortable extends Component {\r\n  constructor($element) {\r\n    super($element);\r\n\r\n    this.container = this.target;\r\n    this.items = $element.querySelectorAll('[data-sortable-drag]');\r\n    this.droppables = $element.querySelectorAll('[data-sortable-drop]');\r\n    this.placeholder = () => document.querySelector('#sortable-placeholder');\r\n    this.$players = this.container.querySelectorAll('[data-player-audio]');\r\n\r\n    // get direction (type of sortable \"horizontalni\" or \"vertikalni\")\r\n    this.direction = this.target.getAttribute('data-sortable-target');\r\n    this.trackingTouch = false;\r\n    this.before = false;\r\n    this.after = false;\r\n\r\n    this.mouse = {\r\n      x: event => event.clientX || event.touches[0].clientX,\r\n      y: event => event.clientY || event.touches[0].clientY,\r\n      x0: 0,\r\n      y0: 0,\r\n      x1: 0,\r\n      y1: 0,\r\n    };\r\n\r\n    this.dragged = {\r\n      el: null,\r\n      clone: null,\r\n      posRel: {},\r\n      rect: () => this.dragged.el.getBoundingClientRect(),\r\n      size: {},\r\n    };\r\n\r\n    this.siblings = {\r\n      prev: null,\r\n      next: null,\r\n    };\r\n\r\n    this._onStart = this._onStart.bind(this);\r\n    this._onMove = this._onMove.bind(this);\r\n    this._onEnd = this._onEnd.bind(this);\r\n    this._update = this._update.bind(this);\r\n\r\n    this._addEventListeners();\r\n  }\r\n\r\n  _onStart(event) {\r\n    if (!event.target.hasAttribute('data-sortable-drag')) {\r\n      return;\r\n    }\r\n\r\n    // TODO: zastavit všechno audio on drag start\r\n    if (this.$players.length > 0) {\r\n      stopPlayingVideoPlayers(this.$players);\r\n    }\r\n\r\n\r\n    this.trackingTouch = true;\r\n\r\n    this.dragged.el = event.target;\r\n    this.dragged.clone = this.dragged.el.cloneNode(true);\r\n    this.dragged.posRel.top = this.dragged.el.offsetTop;\r\n    this.dragged.posRel.left = this.dragged.el.offsetLeft;\r\n    this.dragged.size.width = this.dragged.el.offsetWidth;\r\n    this.dragged.size.height = this.dragged.el.offsetHeight;\r\n\r\n    this.dragged.el.style.top = `${this.dragged.posRel.top}px`;\r\n    this.dragged.el.style.left = `${this.dragged.posRel.left}px`;\r\n    this.dragged.el.style.width = `${this.dragged.size.width}px`;\r\n    this.dragged.el.style.height = `${this.dragged.size.height}px`;\r\n    this.dragged.el.classList.add('is-dragged');\r\n\r\n    this.container.classList.add('is-dragged');\r\n\r\n    this._addPlaceholder(this.dragged.el);\r\n    this._onOver(event);\r\n\r\n    this.mouse.x0 = this.mouse.x(event);\r\n    this.mouse.y0 = this.mouse.y(event);\r\n\r\n    event.preventDefault();\r\n  }\r\n\r\n  _onMove(event) {\r\n    if (!this.trackingTouch) {\r\n      return;\r\n    }\r\n\r\n    this.mouse.x1 = this.mouse.x(event) - this.mouse.x0;\r\n    this.mouse.y1 = this.mouse.y(event) - this.mouse.y0;\r\n\r\n    window.requestAnimationFrame(this._update);\r\n\r\n    this._onOver(event);\r\n  }\r\n\r\n  _onEnd(event) {\r\n    if (!this.trackingTouch) {\r\n      return;\r\n    }\r\n\r\n    this.trackingTouch = false;\r\n    this.container.classList.remove('is-dragged');\r\n    this.dragged.el.classList.remove('is-dragged');\r\n    this.dragged.el.style.top = '';\r\n    this.dragged.el.style.left = '';\r\n    this.dragged.el.style.width = '';\r\n    this.dragged.el.style.height = '';\r\n    this.dragged.el.style.transform = '';\r\n\r\n    const placeholder = this.placeholder();\r\n    const rect = placeholder.getBoundingClientRect();\r\n\r\n    switch (this.direction) {\r\n      case 'horizontal':\r\n        if (rect.left <= this.mouse.x(event) <= rect.right) {\r\n          this._onDrop();\r\n        }\r\n        break;\r\n      case 'vertical':\r\n        if (rect.top <= this.mouse.y(event) <= rect.bottom) {\r\n          this._onDrop();\r\n        }\r\n        break;\r\n\r\n      default:\r\n        break;\r\n    }\r\n\r\n    this._removePlaceholder();\r\n  }\r\n\r\n  // _onEnter() {}\r\n\r\n  _onOver(event) {\r\n    this.before = false;\r\n    this.after = false;\r\n\r\n    this._getReference();\r\n\r\n    if (\r\n      this.siblings.next\r\n      && this.siblings.next.hasAttribute('data-sortable-drop')\r\n    ) {\r\n      const next = this.siblings.next.getBoundingClientRect();\r\n\r\n      switch (this.direction) {\r\n        case 'horizontal':\r\n          if (this.dragged.rect().right > (next.left + (next.width / 1.5))) {\r\n            this.after = true;\r\n            this._addPlaceholder(this.siblings.next);\r\n          }\r\n          break;\r\n        case 'vertical':\r\n          if (this.dragged.rect().bottom > (next.top + (next.height / 1.5))) {\r\n            this.after = true;\r\n            this._addPlaceholder(this.siblings.next);\r\n          }\r\n          break;\r\n\r\n        default:\r\n          break;\r\n      }\r\n    }\r\n\r\n    if (\r\n      this.siblings.prev\r\n      && this.siblings.prev.hasAttribute('data-sortable-drop')\r\n    ) {\r\n      const prev = this.siblings.prev.getBoundingClientRect();\r\n\r\n      switch (this.direction) {\r\n        case 'horizontal':\r\n          if (this.dragged.rect().left < (prev.right - (prev.width / 1.5))) {\r\n            this.before = true;\r\n            this._addPlaceholder(this.siblings.prev);\r\n          }\r\n          break;\r\n        case 'vertical':\r\n          if (this.dragged.rect().top < (prev.bottom - (prev.height / 1.5))) {\r\n            this.before = true;\r\n            this._addPlaceholder(this.siblings.prev);\r\n          }\r\n          break;\r\n\r\n        default:\r\n          break;\r\n      }\r\n    }\r\n  }\r\n\r\n  // _onLeave() {}\r\n\r\n  _onDrop() {\r\n    const placeholder = this.placeholder();\r\n\r\n    this._addEventListenerToItem(this.dragged.clone);\r\n    // TODO: přiřadit eventListenery audio playerům\r\n    if (this.dragged.clone.querySelector('[data-player-audio]')) {\r\n      AudioPlayer.addEventListeners(this.dragged.clone, this.showFeedback);\r\n    }\r\n\r\n    this.container.insertBefore(this.dragged.clone, placeholder);\r\n    this.dragged.el.parentNode.removeChild(this.dragged.el);\r\n\r\n    // show OK button or feedback\r\n    this.showFeedback();\r\n  }\r\n\r\n  _update() {\r\n    this.dragged.el.style.transform = `translate3d(${this.mouse.x1}px, ${\r\n      this.mouse.y1\r\n    }px, 0) rotate(5deg)`;\r\n  }\r\n\r\n  _addPlaceholder(item) {\r\n    this._removePlaceholder();\r\n\r\n    const placeholder = document.createElement('div');\r\n    placeholder.classList.add('sortable-item', 'sortable-placeholder');\r\n    placeholder.setAttribute('id', 'sortable-placeholder');\r\n    placeholder.style.minHeight = `${this.dragged.size.height}px`;\r\n\r\n    if (this.dragged.el.querySelector('img')) {\r\n      const src = this.dragged.el.querySelector('img').getAttribute('src');\r\n      const img = document.createElement('img');\r\n      img.setAttribute('src', src);\r\n      placeholder.appendChild(img);\r\n    }\r\n\r\n    if (this.after) {\r\n      this.container.insertBefore(placeholder, item.nextElementSibling);\r\n    } else if (this.before) {\r\n      this.container.insertBefore(placeholder, item);\r\n    } else {\r\n      this.container.insertBefore(placeholder, item);\r\n    }\r\n  }\r\n\r\n  _removePlaceholder() {\r\n    const placeholder = this.placeholder();\r\n    if (placeholder) placeholder.parentNode.removeChild(placeholder);\r\n  }\r\n\r\n  _getReference() {\r\n    const placeholder = this.placeholder();\r\n    this.siblings.prev = placeholder.previousElementSibling === this.dragged.el\r\n      ? this.dragged.el.previousElementSibling\r\n      : placeholder.previousElementSibling;\r\n    this.siblings.next = placeholder.nextElementSibling === this.dragged.el\r\n      ? this.dragged.el.nextElementSibling\r\n      : placeholder.nextElementSibling;\r\n  }\r\n\r\n  _addEventListenerToItem($item) {\r\n    // touch events\r\n    $item.addEventListener('touchstart', this._onStart, false);\r\n    // mouse events\r\n    $item.addEventListener('mousedown', this._onStart, false);\r\n  }\r\n\r\n  _addEventListeners() {\r\n    // touch events\r\n    document.addEventListener('touchmove', this._onMove);\r\n    document.addEventListener('touchend', this._onEnd);\r\n    // mouse events\r\n    document.addEventListener('mousemove', this._onMove);\r\n    document.addEventListener('mouseup', this._onEnd);\r\n\r\n    for (let i = 0; i < this.items.length; i += 1) {\r\n      this._addEventListenerToItem(this.items[i]);\r\n    }\r\n  }\r\n}\r\n","export default class SVGDragNDrop {\r\n  // static drag(id) {\r\n  //   d3.drag()\r\n  //     .on('start', () => {\r\n  //       SVGDragNDrop.start(id);\r\n  //     })\r\n  //     .on('drag', () => {\r\n  //       SVGDragNDrop.dragged(id);\r\n  //     })\r\n  //     .on('end', () => {\r\n  //       SVGDragNDrop.end(id);\r\n  //     });\r\n  // }\r\n\r\n  static start(element) {\r\n    d3.select(element).raise().classed('is-dragged', true);\r\n  }\r\n\r\n  static dragged(element, diff) {\r\n\r\n    d3.select(element)\r\n      .attr('x', (d3.event.x - diff.x).toFixed())\r\n      .attr('y', (d3.event.y - diff.y).toFixed());\r\n  }\r\n\r\n  static end(element, type, diff) {\r\n\r\n    d3.select(element)\r\n      .attr('x', (d3.event.x - diff.x).toFixed())\r\n      .attr('y', (d3.event.y - diff.y).toFixed())\r\n      // neumožňuje v jiných funkcí s tímto objektem dále pracovat,\r\n      // protože pracují s id\r\n      // .attr('id', `${type}-${d3.event.x.toFixed()}-${d3.event.y.toFixed()}`)\r\n      .classed('is-dragged', false);\r\n  }\r\n}\r\n","import { __localPosition } from '../../lib/utils';\r\n\r\n// import SVG from '../svg';\r\nimport SVGDragNDrop from './svg-dragndrop';\r\n\r\nexport default class SVGDraw {\r\n  // static selectPath(svg) {\r\n  //   // https://bl.ocks.org/mbostock/8027637\r\n  // }\r\n\r\n  static renderPath($svg, callback) {\r\n    if (d3.event.sourceEvent.target.nodeName === 'image') {\r\n\r\n      const line = d3.line()\r\n        // removed smooth curve to get rid of loong decimals\r\n        // see https://github.com/d3/d3-path/issues/10\r\n        .curve(d3.curveLinear); // _dragStarted\r\n\r\n      const format = d3.format('.0f');\r\n      const d = d3.event.subject;\r\n      // origin\r\n      let x0 = format(d3.event.x);\r\n      let y0 = format(d3.event.y);\r\n\r\n      const id = `path-${x0}-${y0}`;\r\n\r\n      const active = d3.select(`#${$svg.id} .svg-view`).append('svg:path')\r\n        // .attr('marker-start', 'url('#marker-circle-blue')')\r\n        // .attr('marker-end', 'url('#marker-arrow-blue')')\r\n        .attr('data-svg-path', '')\r\n        .attr('class', 'svg-path')\r\n        .attr('id', id)\r\n        .datum(d);\r\n\r\n      // github.com/d3/d3-drag#event_on\r\n      d3.event\r\n        .on('drag', () => {\r\n          // current position\r\n          const x1 = format(d3.event.x);\r\n          const y1 = format(d3.event.y);\r\n          // distance from origin\r\n          const dx = x1 - x0;\r\n          const dy = y1 - y0;\r\n\r\n          // if the distance of drag event is too large, make new origin\r\n          if ((dx * dx) + (dy * dy) > 300) d.push([x0 = x1, y0 = y1]);\r\n          // smooth line, correct last point\r\n          else d[d.length - 1] = [x1, y1];\r\n\r\n          active.attr('d', line);\r\n        })\r\n        .on('end', () => {\r\n          const $thisPath = d3.select(`#${id}`);\r\n          if ($thisPath) {\r\n            if ($thisPath.attr('d')) {\r\n              if ($thisPath.attr('d').length < 40) {\r\n                $thisPath.remove();\r\n              }\r\n            } else if (!$thisPath.attr('d')) {\r\n              $thisPath.remove();\r\n            }\r\n          }\r\n\r\n          callback();\r\n        });\r\n\r\n      d3.select(`#${id}`).on('click', () => {\r\n        d3.select(`#${id}`).remove();\r\n        d3.event.preventDefault();\r\n      }, false);\r\n\r\n    }\r\n\r\n  }\r\n\r\n  // Draw a SVG circle on click\r\n  static createCircle($svg, color = 'blue') {\r\n    const d3svg = d3.select(`#${$svg.id} .svg-view`);\r\n    const canvas = document.querySelector(`#${$svg.id} .svg-view`);\r\n    const localPosition = __localPosition($svg);\r\n    const id = `circle-${localPosition.x}-${localPosition.y}`;\r\n    const hash = `#${id}`;\r\n    // circle wrapper\r\n    const foreignObject = d3svg.append('svg:foreignObject')\r\n      .attr('data-svg-circle', '')\r\n      .attr('id', id)\r\n      .attr('x', localPosition.x)\r\n      .attr('y', localPosition.y)\r\n      .attr('width', 1)\r\n      .attr('height', 1);\r\n\r\n    // TODO:\r\n    // standalone function\r\n    // same for all draggable svg elements\r\n    const element = document.querySelector(hash);\r\n    let elementPosition = [\r\n      element.getAttribute('x'),\r\n      element.getAttribute('y'),\r\n    ];\r\n    let diff = {};\r\n\r\n    const circle = foreignObject.append('xhtml:div')\r\n      .attr('class', 'svg-circle')\r\n      .on('click', () => {\r\n        // console.log('remove circle');\r\n        d3.select(d3.event.target.parentNode).remove();\r\n      })\r\n      .call(d3.drag()\r\n        .container(canvas)\r\n        .subject(element)\r\n        .on('start', () => {\r\n          diff = {\r\n            x: d3.event.x - elementPosition[0],\r\n            y: d3.event.y - elementPosition[1],\r\n          };\r\n\r\n          SVGDragNDrop.start(hash);\r\n        })\r\n        .on('drag', () => {\r\n          SVGDragNDrop.dragged(hash, diff);\r\n        })\r\n        .on('end', () => {\r\n          SVGDragNDrop.end(hash, 'circle', diff);\r\n\r\n          elementPosition = [\r\n            element.getAttribute('x'),\r\n            element.getAttribute('y'),\r\n          ];\r\n        })\r\n      );\r\n  }\r\n}\r\n","import { __addClass, __removeClass, __hasClass } from '../../lib/utils';\r\n\r\nimport SVGDragNDrop from './svg-dragndrop';\r\n\r\nexport default class SVGText {\r\n  static createText(maxLength = 333, minLength = 2) {\r\n    const $svg = document.querySelector('[data-svg-active=\"true\"]');\r\n    const svgID = $svg.id;\r\n    const svgGroup = d3.select($svg).select('.svg-view');\r\n\r\n    const $canvas = $svg.querySelector('.svg-view');\r\n    const $radialMenu = document.querySelector('[data-radial-menu]');\r\n    const localPosition = {\r\n      x: $radialMenu.getAttribute('data-local-x'),\r\n      y: $radialMenu.getAttribute('data-local-y'),\r\n    };\r\n    const id = `svg-text-${localPosition.x}-${localPosition.y}`;\r\n    const hash = `#${id}`;\r\n    const orientation = {\r\n      x: (svgGroup.attr('width') - localPosition.x) > 320 ? 'right' : 'left',\r\n      y: (svgGroup.attr('height') - localPosition.y) > 60 ? 'bottom' : 'top',\r\n    };\r\n\r\n    // text wrapper\r\n    const foreignObject = svgGroup.append('svg:foreignObject')\r\n      .attr('class', `svg-text orientation-${orientation.x} orientation-${orientation.y}`)\r\n      .attr('data-svg-text', '')\r\n      .attr('x', localPosition.x)\r\n      .attr('y', localPosition.y)\r\n      .attr('width', 1)\r\n      .attr('height', 1);\r\n\r\n    // create visual point of interest for text input\r\n    foreignObject.append('xhtml:div')\r\n      .attr('class', 'svg-circle svg-circle-text');\r\n    // create text input\r\n    const textarea = foreignObject.append('xhtml:textarea')\r\n      .attr('maxlength', maxLength)\r\n      .attr('tabindex', '-1')\r\n      .attr('id', id)\r\n      .attr('class', 'svg-textarea')\r\n      .attr('data-save', '')\r\n      .attr('data-svg-textarea-target', svgID);\r\n\r\n    // set focus to the new text input\r\n    document.querySelector(`${hash}`).focus();\r\n\r\n    // TODO\r\n    // standalone function\r\n    // same for all draggable svg elements\r\n    const element = document.querySelector(hash).parentNode;\r\n    let elementPosition = [\r\n      element.getAttribute('x'),\r\n      element.getAttribute('y'),\r\n    ];\r\n    let diff = {};\r\n\r\n    d3.select(`${hash}`)\r\n      // drag & drop\r\n      .call(d3.drag()\r\n        .container($canvas)\r\n        .subject(element)\r\n        .on('start', () => {\r\n          diff = {\r\n            x: d3.event.x - elementPosition[0],\r\n            y: d3.event.y - elementPosition[1],\r\n          };\r\n\r\n          SVGDragNDrop.start(element);\r\n        })\r\n        .on('drag', () => {\r\n          SVGDragNDrop.dragged(element, diff);\r\n        })\r\n        .on('end', () => {\r\n          SVGDragNDrop.end(element, 'text', diff);\r\n\r\n          elementPosition = [\r\n            element.getAttribute('x'),\r\n            element.getAttribute('y'),\r\n          ];\r\n        }) )\r\n      // keystroke\r\n      // control height of the text input on every key stroke\r\n      .on('keyup', () => {\r\n        SVGText.updateTextareaHeight(d3.event.target);\r\n      })\r\n      // loss of focus\r\n      .on('blur', () => {\r\n        const target = d3.event.target;\r\n        const value = target.value;\r\n\r\n        if (value.length === 0) {\r\n          SVG.removeItem(hash);\r\n          return;\r\n        }\r\n        if (value.length < minLength) {\r\n          __addClass(target, 'is-wrong');\r\n        } else if ((value.length >= minLength) && __hasClass(target, 'is-wrong')) {\r\n          __removeClass(target, 'is-wrong');\r\n        }\r\n      })\r\n      // gain focus\r\n      .on('focus', () => {\r\n        d3.select(element).raise();\r\n      });\r\n  }\r\n\r\n  static updateTextareaHeight($target) {\r\n    $target.style.height = '1px';\r\n    $target.style.height = `${22 + $target.scrollHeight}px`;\r\n  }\r\n}\r\n","import Component from './component';\r\n\r\nimport SVGDraw from './svg-lib/svg-draw';\r\nimport SVGText from './svg-lib/svg-text';\r\n\r\nexport default class SVG extends Component {\r\n  constructor($element) {\r\n    super($element);\r\n\r\n    this.init();\r\n  }\r\n\r\n  init() {\r\n    // make array from data-attributes (contains what kind of actions can user do on this svg)\r\n    const svgSpecificActions = this.target.getAttribute('data-svg-target').split(' ');\r\n    for (let i = 0; i < svgSpecificActions.length; i += 1) {\r\n      if (svgSpecificActions[i] === 'kresleni') {\r\n        this._initPath(this.showFeedback);\r\n      }\r\n      else if (svgSpecificActions[i] === 'znacky') {\r\n        this._initCircle(this.showFeedback);\r\n      }\r\n      // else if (svgSpecificActions[i] === 'text') {\r\n      //   this._initText();\r\n      // }\r\n    }\r\n\r\n    // this._initZoom();\r\n    // fix for IE\r\n    this._setSize();\r\n    // comic bubbles if exists\r\n    this._initComicBubbles();\r\n  }\r\n\r\n  _setSize() {\r\n    // TODO: set size on window resize\r\n    const viewbox = this.target.getAttribute('viewBox').split(' ');\r\n    const height = this.target.getBoundingClientRect().height;\r\n    const scale = height / viewbox[3];\r\n\r\n    this.target.style.maxWidth = `${viewbox[2] * scale}px`;\r\n  }\r\n\r\n  // _initZoom() {\r\n  //   const view = d3.select(`#${this.target.id} .svg-view`);\r\n  //   const size = [\r\n  //     view.attr('width'),\r\n  //     view.attr('height'),\r\n  //   ];\r\n  //   SVGZoom.zoom(this.target, view, size);\r\n  // }\r\n\r\n  _initPath(callback) {\r\n    d3.select(this.target)\r\n      .call(d3.drag()\r\n        .container(() => {\r\n          return this.target;\r\n        })\r\n        .subject(() => {\r\n          const p = [d3.event.x.toFixed(), d3.event.y.toFixed()];\r\n\r\n          return [p, p];\r\n        })\r\n        .on('start', () => {\r\n          SVGDraw.renderPath(this.target, callback);\r\n        }));\r\n  }\r\n  // _initText() {\r\n  //   d3.select(this.target).on('click', () => {\r\n  //     SVGText.openTextDialog(this.target);\r\n  //     d3.event.preventDefault();\r\n  //   });\r\n  // }\r\n\r\n  _initCircle(callback) {\r\n    d3.select(this.target).on('click', () => {\r\n      const item = d3.event.target;\r\n      const nodeName = item.nodeName;\r\n      const validPlace = (nodeName === 'image');\r\n      // const isCircle = (__hasClass(item, 'svg-circle'));\r\n\r\n      if (!validPlace) {\r\n        return;\r\n      }\r\n\r\n      SVGDraw.createCircle(this.target);\r\n\r\n      callback();\r\n\r\n      d3.event.preventDefault();\r\n    }, false);\r\n  }\r\n\r\n  _initComicBubbles() {\r\n    const comicBubbles = this.target.querySelectorAll('.svg-komiks .svg-textarea');\r\n\r\n    if (comicBubbles) {\r\n      d3.selectAll(comicBubbles).on('keyup', () => {\r\n        SVGText.updateTextareaHeight(d3.event.target);\r\n      });\r\n    }\r\n  }\r\n\r\n  static selectItem(item) {\r\n    item.setAttribute('data-svg-selected', 'true');\r\n  }\r\n\r\n  // Remove 'selected' classname from element within SVG\r\n  static deselectItem() {\r\n    // previously \"selected\" elements\r\n    const selected = document.querySelectorAll('[data-svg-selected=\"true\"]');\r\n    // unselect them\r\n    for (let i = 0; i < selected.length; i += 1) {\r\n      selected[i].setAttribute('data-svg-selected', 'false');\r\n    }\r\n  }\r\n\r\n  // Remove element from within SVG\r\n  static removeItem(item = '[data-svg-selected=\"true\"]') {\r\n    const $parent = document.querySelector(item).parentNode;\r\n\r\n    if ($parent.nodeName === 'foreignObject') {\r\n      d3.select($parent).remove();\r\n    } else {\r\n      d3.select(item).remove();\r\n    }\r\n  }\r\n\r\n  // Unmark all SVGs with 'svg-active' classname\r\n  static deactivate() {\r\n    const allActiveSvgs = document.querySelectorAll('[data-svg-active=\"true\"]');\r\n    for (let i = 0; i < allActiveSvgs.length; i += 1) {\r\n      allActiveSvgs[i].setAttribute('data-svg-active', 'false');\r\n    }\r\n  }\r\n\r\n  // Mark active SVG with 'svg-active' classname\r\n  static activate(svg) {\r\n    SVG.deactivate();\r\n    svg.setAttribute('data-svg-active', 'true');\r\n  }\r\n}\r\n","import { __addClass, __removeClass, __hasClass, __localPosition, __globalPosition } from '../../lib/utils';\r\nimport SVG from '../svg';\r\nimport SVGText from './svg-text';\r\n\r\nexport default class SVGRadialMenu {\r\n\r\n  constructor($radialMenu, $svgs) {\r\n    this.$radialMenu = $radialMenu;\r\n    this.$radialMenuItems = this.$radialMenu.querySelectorAll('[data-radial-menu-item]');\r\n    this.$colorItems = this.$radialMenu.querySelectorAll('.radial-menu-color');\r\n    this.$textItems = this.$radialMenu.querySelectorAll('.radial-menu-text');\r\n    this.$createTextItem = this.$radialMenu.querySelector('#create-text');\r\n    this.$removeItem = this.$radialMenu.querySelector('#remove-content');\r\n    this.$tooltip = this.$radialMenu.querySelector('[data-radial-menu-tooltip]');\r\n    this.$svgs = $svgs;\r\n\r\n    this.initialSetUp = true;\r\n\r\n    this.menuRadius = parseInt(window.getComputedStyle(this.$radialMenu.querySelector('.radial-menu-wrapper'), null).getPropertyValue('width'), 10) / 2;\r\n    this.itemRadius = parseInt(window.getComputedStyle(this.$radialMenu.querySelector('.radial-menu-item'), null).getPropertyValue('width'), 10) / 2;\r\n\r\n    this.init();\r\n  }\r\n\r\n  init() {\r\n    this.setUpRadialMenuItems();\r\n    this.addEventListenersToRadialMenu();\r\n\r\n    // activate radial menu when right click on svg\r\n    Array.from(this.$svgs).forEach(($svg) => {\r\n      d3.select($svg).on('contextmenu', () => {\r\n        // mark this SVG as the active one\r\n        SVG.activate($svg);\r\n        // deselect all previously selected items\r\n        SVG.deselectItem();\r\n        // show radial menu buttons based on clicked element\r\n        // and .select appropriate elements based on clicked element\r\n        this.filterMenuButtons(d3.event.target);\r\n        this.showRadialMenu($svg, d3.event);\r\n        // prevent default 'contextmenu' event\r\n        d3.event.preventDefault();\r\n      });\r\n    });\r\n\r\n    this.initialSetUp = false;\r\n  }\r\n\r\n  setUpRadialMenuItems() {\r\n    // this.positionRadialMenuItems(this.$radialMenuItems);\r\n\r\n    Array.from(this.$radialMenuItems).forEach(($item) => {\r\n      this.addEventListenersToRadialMenuItem($item);\r\n    });\r\n  }\r\n\r\n  positionRadialMenuItems($items) {\r\n    const _itemsLength = $items.length;\r\n    const _menuRadius = this.menuRadius;\r\n    const _itemRadius = this.itemRadius;\r\n    const _menuOffset = _menuRadius - _itemRadius;\r\n    const _interval = 0.6283185307;\r\n    // if more items center them\r\n    const _centerOffset = (-_interval / 2) + ((_itemsLength * _interval) / 2);\r\n\r\n    // make a \"flower\"\r\n    Array.from($items).forEach(($item, index) => {\r\n      // Calculate the angle at which the element will be placed.\r\n      // For a semicircle, we would use (index / _itemsLength) * Math.PI.\r\n      const angle = (Math.PI + ((index * _interval) * -1)) + _centerOffset;\r\n\r\n      // get position\r\n      const x = (_menuRadius * Math.sin(angle)) + _menuOffset;\r\n      const y = (_menuRadius * Math.cos(angle)) + _menuOffset;\r\n\r\n      // console.log('x: ' + x);\r\n      // console.log('y: ' + y);\r\n\r\n      $item.style.left = `${x.toFixed(1)}px`;\r\n      $item.style.top = `${y.toFixed(1)}px`;\r\n\r\n      // if (this.initialSetUp === true) {\r\n      //   this.addEventListenersToRadialMenuItem($item);\r\n      // }\r\n    });\r\n  }\r\n\r\n  addEventListenersToRadialMenu() {\r\n    this.onMouseLeave();\r\n\r\n    this.$radialMenu.addEventListener('click', (event) => {\r\n      this.hideRadialMenu(this.$radialMenu);\r\n      event.preventDefault();\r\n    });\r\n\r\n    this.$radialMenu.addEventListener('contextmenu', (event) => {\r\n      this.hideRadialMenu(this.$radialMenu);\r\n      event.preventDefault();\r\n    });\r\n  }\r\n\r\n  addEventListenersToRadialMenuItem(item) {\r\n    const $item = item;\r\n\r\n    // actions\r\n    const action = $item.getAttribute('data-radial-menu-item');\r\n    // remove item\r\n    if (action === 'remove-content') {\r\n      $item.addEventListener('click', () => {\r\n        SVG.removeItem();\r\n        this.hideRadialMenu();\r\n      }, false);\r\n    }\r\n    // create user text\r\n    else if (action === 'create-text') {\r\n      d3.select($item).on('click', () => {\r\n        SVGText.createText();\r\n        this.hideRadialMenu();\r\n      }, false);\r\n    }\r\n    // označit podobnost\r\n    else if (action === 'color-point-blue') {\r\n      $item.addEventListener('click', () => {\r\n        SVGRadialMenu.changeColor('blue');\r\n        this.hideRadialMenu();\r\n      }, false);\r\n    }\r\n    // označit rozdil\r\n    else if (action === 'color-point-red') {\r\n      $item.addEventListener('click', () => {\r\n        SVGRadialMenu.changeColor('red');\r\n        this.hideRadialMenu();\r\n      }, false);\r\n    }\r\n    // označit rozdil\r\n    else if (action === 'color-point-red') {\r\n      $item.addEventListener('click', () => {\r\n        SVGRadialMenu.changeColor('red');\r\n        this.hideRadialMenu();\r\n      }, false);\r\n    }\r\n    // přiřadit kategorii\r\n    // else if (action === 'category') {\r\n    //   const category = $item.getAttribute('data-category');\r\n    //   const categoryLabel = $item.getAttribute('data-radial-menu-item-tooltip');\r\n\r\n    //   $item.addEventListener('click', () => {\r\n    //     const $selected = document.querySelector('[data-svg-selected=\"true\"]');\r\n    //     const $parentForeignObject = $selected.parentNode;\r\n    //     let $category = $parentForeignObject.querySelector('.svg-category-label');\r\n\r\n    //     $selected.setAttribute('data-svg-category', category);\r\n\r\n    //     if (!$category) {\r\n    //       $category = document.createElement('div');\r\n    //       $category.classList.add('svg-category-label');\r\n    //       $parentForeignObject.prepend($category);\r\n    //     }\r\n\r\n    //     $category.innerText = categoryLabel;\r\n\r\n    //     this.hideRadialMenu();\r\n    //   }, false);\r\n    // }\r\n\r\n    // tooltip\r\n    $item.addEventListener('mouseenter', (event) => {\r\n      this.$tooltip.innerHTML = event.currentTarget.getAttribute('data-radial-menu-item-tooltip');\r\n      this.$tooltip.style.display = 'block';\r\n    }, false);\r\n    $item.addEventListener('mouseleave', () => {\r\n      this.$tooltip.innerHTML = '';\r\n      this.$tooltip.style.display = 'none';\r\n    }, false);\r\n  }\r\n\r\n  // Draw a SVG circle on click\r\n  static changeColor(color) {\r\n    const $selected = document.querySelector('[data-svg-selected=\"true\"]');\r\n    __removeClass($selected, 'red blue');\r\n    __addClass($selected, color);\r\n  }\r\n\r\n  showRadialMenu($activeSVG, event) {\r\n    const $svg = $activeSVG || document.querySelector('[data-svg-active=\"true\"]');\r\n    // get global position of the right click event\r\n    const globalPosition = __globalPosition(event);\r\n    const localPosition = __localPosition($svg);\r\n    this.$radialMenu.setAttribute('data-local-x', localPosition.x);\r\n    this.$radialMenu.setAttribute('data-local-y', localPosition.y);\r\n    // set position of radial menu\r\n    // number of 13 is size of #radial-menu\r\n    this.$radialMenu.style.top = `${globalPosition.y - 7}px`;\r\n    this.$radialMenu.style.left = `${globalPosition.x - 7}px`;\r\n\r\n    // make a flower\r\n    const $activeRadialMenuItem = this.$radialMenu.querySelectorAll('.is-active');\r\n    this.positionRadialMenuItems($activeRadialMenuItem);\r\n\r\n    // show radial menu\r\n    __addClass(this.$radialMenu, 'is-active');\r\n\r\n    // return {\r\n    //   localPosition,\r\n    //   globalPosition,\r\n    // };\r\n  }\r\n\r\n  hideRadialMenu() {\r\n    // hide radial menu\r\n    __removeClass(this.$radialMenu, 'is-active');\r\n    // deactivate all SVGs\r\n    SVG.deactivate();\r\n    // deselect all SVG items\r\n    SVG.deselectItem();\r\n\r\n    // deactivate radial menu items when the menu is hidden\r\n    setTimeout(() => {\r\n      if (!__hasClass(this.$radialMenu, 'is-active')) {\r\n        Array.from(this.$radialMenuItems).forEach(($item) => {\r\n          __removeClass($item, 'is-active');\r\n        });\r\n      }\r\n    }, 150);\r\n  }\r\n\r\n  onMouseLeave() {\r\n    let mouseLeaveDelay;\r\n\r\n    this.$radialMenu.addEventListener('mouseleave', () => {\r\n      mouseLeaveDelay = setTimeout(() => {\r\n        this.hideRadialMenu(this.$radialMenu);\r\n      }, 500);\r\n    });\r\n\r\n    this.$radialMenu.addEventListener('mouseenter', () => {\r\n      clearTimeout(mouseLeaveDelay);\r\n    });\r\n  }\r\n\r\n  filterMenuButtons(clickedItem) {\r\n    if (__hasClass(clickedItem, 'svg-path') || clickedItem.nodeName === 'path') {\r\n      __addClass(this.$createTextItem, 'is-active');\r\n      // __addClass(this.$removeItem, 'is-active');\r\n\r\n      Array.from(this.$colorItems).forEach(($colorItem) => {\r\n        __addClass($colorItem, 'is-active');\r\n      });\r\n\r\n      Array.from(this.$textItems).forEach(($textItem) => {\r\n        __removeClass($textItem, 'is-active');\r\n      });\r\n\r\n      // mark it as slected\r\n      // SVG.selectItem(clickedItem);\r\n    }\r\n    if (__hasClass(clickedItem, 'svg-circle')) {\r\n      __addClass(this.$createTextItem, 'is-active');\r\n      // __addClass(this.$removeItem, 'is-active');\r\n\r\n      Array.from(this.$colorItems).forEach(($colorItem) => {\r\n        __addClass($colorItem, 'is-active');\r\n      });\r\n\r\n      Array.from(this.$textItems).forEach(($textItem) => {\r\n        __removeClass($textItem, 'is-active');\r\n      });\r\n\r\n      // mark it as slected\r\n      // SVG.selectItem(clickedItem);\r\n    }\r\n    if (__hasClass(clickedItem, 'svg-textarea')) {\r\n      __removeClass(this.$createTextItem, 'is-active');\r\n      // __addClass(this.$removeItem, 'is-active');\r\n\r\n      if (!__hasClass(clickedItem, 'do-not-remove')) {\r\n        Array.from(this.$colorItems).forEach(($colorItem) => {\r\n          __removeClass($colorItem, 'is-active');\r\n        });\r\n\r\n        Array.from(this.$textItems).forEach(($textItem) => {\r\n          __addClass($textItem, 'is-active');\r\n        });\r\n      }\r\n\r\n      // mark it as slected\r\n      // SVG.selectItem(clickedItem);\r\n    }\r\n    if (clickedItem.nodeName === 'image') {\r\n      __addClass(this.$createTextItem, 'is-active');\r\n      __removeClass(this.$removeItem, 'is-active');\r\n\r\n      Array.from(this.$colorItems).forEach(($colorItem) => {\r\n        __removeClass($colorItem, 'is-active');\r\n      });\r\n\r\n      Array.from(this.$textItems).forEach(($textItem) => {\r\n        __removeClass($textItem, 'is-active');\r\n      });\r\n    }\r\n    else {\r\n      if (__hasClass(clickedItem, 'do-not-remove')) {\r\n        __removeClass(this.$removeItem, 'is-active');\r\n      } else {\r\n        __addClass(this.$removeItem, 'is-active');\r\n      }\r\n      // mark it as slected\r\n      SVG.selectItem(clickedItem);\r\n    }\r\n  }\r\n}\r\n","export default class Observer {\r\n\r\n  constructor() {\r\n    this._events = [];\r\n  }\r\n\r\n  /**\r\n   * Add event listener\r\n   *\r\n   * {String} events - e.g. 'my-event-1 my-event-2'\r\n   * {Function} fn - event listener\r\n   */\r\n  on(events, fn) {\r\n\r\n    events = this._split(events);\r\n\r\n    events.forEach((event) => {\r\n\r\n      if (!this._events[event]) {\r\n        this._events[event] = [];\r\n      }\r\n\r\n      this._events[event].push(fn);\r\n    });\r\n\r\n  }\r\n\r\n  off(events, fn) {\r\n\r\n    events = this._split(events);\r\n\r\n    events.forEach((event) => {\r\n\r\n      if (!this._events[event]) { return; }\r\n\r\n      this.events[event] = this._events[event].filter((current_fn) => {\r\n        return current_fn !== fn;\r\n      });\r\n\r\n    });\r\n\r\n\r\n  }\r\n\r\n  // something like dispatchEvent\r\n  trigger(events, args) {\r\n\r\n    events = this._split(events);\r\n\r\n    // console.log(events);\r\n\r\n    events.forEach((event) => {\r\n\r\n      if (!this._events[event]) { return; }\r\n\r\n      this._events[event].forEach((fn) => {\r\n        fn.call(this, event, args);\r\n      });\r\n\r\n    });\r\n\r\n  }\r\n\r\n  _split(events) {\r\n    return events.replace(/^\\s+|\\s+$/g, '').split(/\\s+/);\r\n  }\r\n\r\n}\r\n","const actionTypes = {\r\n  editor: {\r\n    id: 'editor',\r\n    ADD_TAG: 'editor:ADD_TAG',\r\n    DELETE_TAG: 'editor:DELETE_TAG',\r\n    UPDATE_TAG: 'editor:UPDATE_TAG',\r\n    CHANGE: 'editor:CHANGE',\r\n  },\r\n  keywords: {\r\n    id: 'keywords',\r\n    CHANGE: 'keywords:CHANGE'\r\n  },\r\n  testQuiz: {\r\n    id: 'testQuiz',\r\n    ADD_ANSWER: 'testQuiz:ADD_ANSWER',\r\n    REMOVE_ANSWER: 'testQuiz:REMOVE_ANSWER',\r\n    UPDATE_ANSWER: 'testQuiz:UPDATE_ANSWER',\r\n    CHANGE: 'testQuiz:CHANGE',\r\n  },\r\n  textOptions: {\r\n    id: 'textOptions',\r\n    ADD: 'textOptions:ADD',\r\n    DELETE: 'textOptions:DELETE',\r\n    UPDATE: 'textOptions:UPDATE',\r\n    CHANGE: 'textOptions:CHANGE'\r\n  },\r\n  store: {\r\n    id: 'store',\r\n    ADD: 'ADD',\r\n    DELETE: 'DELETE',\r\n    UPDATE: 'UPDATE',\r\n    CHANGE: 'CHANGE',\r\n  }\r\n};\r\n\r\n\r\nexport default actionTypes;\r\n","import Observer from './observer';\r\nimport actionTypes from './store-constants';\r\n\r\n/*\r\nconst tagContainer: Object = {\r\n  editorId?: number,\r\n  id: string,\r\n  tagName: string,\r\n  tag: HTMLElement,\r\n  data?: Object\r\n}\r\n*/\r\n\r\n\r\nclass Store extends Observer {\r\n\r\n  constructor() {\r\n\r\n    super();\r\n\r\n    /* here the global space for storing objects and data */\r\n    this._data = {};\r\n    this._data.tags = [];\r\n  }\r\n\r\n  _checkTagExists(tagId) {\r\n    let tagExists = false;\r\n    this._data.tags.forEach((item, i) => {\r\n\r\n      if (item.id === tagId) {\r\n        tagExists = { item, index: i };\r\n      }\r\n\r\n    });\r\n\r\n    return tagExists;\r\n  }\r\n\r\n  addTag(tagContainer) {\r\n\r\n    if (this._data.tags.length === 0 || !this._checkTagExists(tagContainer.id)) {\r\n\r\n      if (undefined === tagContainer.data.userSelectedNodeItems) {\r\n        tagContainer.data.userSelectedNodeItems = [];\r\n      }\r\n\r\n      this._data.tags.push(tagContainer);\r\n\r\n      store.trigger(actionTypes.editor.CHANGE, {\r\n        action: {\r\n          id: actionTypes.editor.id,\r\n          type: actionTypes.editor.ADD_TAG,\r\n          data: {\r\n            tagContainer,\r\n          },\r\n        },\r\n\r\n      });\r\n\r\n    } else {\r\n      throw new Error('Tag already exists! Will not add it.');\r\n    }\r\n\r\n  }\r\n\r\n  deleteTag(tagContainer) {\r\n\r\n    let tagExists = this._checkTagExists(tagContainer.id);\r\n\r\n    if (false !== tagExists) {\r\n\r\n      this._data.tags.splice(tagExists.index, 1);\r\n\r\n      store.trigger(actionTypes.editor.CHANGE, {\r\n        action: {\r\n          id: actionTypes.editor.id,\r\n          type: actionTypes.editor.DELETE_TAG,\r\n          data: {\r\n            tagContainer: { editorId: tagContainer.editorId, id: tagContainer.id, tagName: tagContainer.tagName, data: {} },\r\n          },\r\n        },\r\n\r\n      });\r\n\r\n      return true;\r\n\r\n    } else {\r\n      throw new Error('Tag does not exist! Will not delete it.');\r\n    }\r\n\r\n  }\r\n\r\n  getAllTags(opts) {\r\n\r\n\r\n    if (undefined === opts || !opts.editorId) { return this._data.tags }\r\n\r\n    const selectedTags = this._data.tags.filter((item) => {\r\n      return item.editorId === opts.editorId;\r\n    });\r\n\r\n    return selectedTags;\r\n  }\r\n\r\n  getTagsBy(opts) {\r\n\r\n    const allowedKeys = ['editorId', 'id', 'tagName'];\r\n\r\n    if (opts === undefined) { return false}\r\n    if ( allowedKeys.indexOf( opts.key ) === -1 ) {return false}\r\n\r\n    if (!Array.isArray(opts.value)) {\r\n      opts.value = [opts.value];\r\n    }\r\n\r\n    // console.log(opts.value);\r\n    // console.log(this._data.tags);\r\n\r\n    const selectedTags = this._data.tags.filter((item) => {\r\n\r\n      return ( item[opts.key] === opts.value[0] ) || ( item[opts.key] === opts.value[1] );\r\n\r\n    });\r\n\r\n    return selectedTags;\r\n\r\n  }\r\n\r\n  getLastTag(opts) {\r\n\r\n    if (undefined === opts || !opts.editorId) {\r\n      return this._data.tags[this._data.tags.length - 1];\r\n    }\r\n\r\n    const selectedTags = this._data.tags.filter((item) => {\r\n      return item.editorId === opts.editorId;\r\n    });\r\n\r\n    return selectedTags[selectedTags.length - 1];\r\n  }\r\n\r\n}\r\n\r\nconst store = new Store();\r\nexport default store;\r\n","import Observer from './observer';\r\nimport actionTypes from './store-constants';\r\n\r\nclass StoreGlobal extends Observer {\r\n\r\n  constructor() {\r\n\r\n    super();\r\n\r\n    /* here the global space for storing objects and data */\r\n    this._data = [];\r\n\r\n  }\r\n\r\n  _checkExists(id) {\r\n    let objectExists = false;\r\n    this._data.forEach((item, i) => {\r\n\r\n      if (item.id === id) {\r\n        objectExists = { item, index: i };\r\n      }\r\n\r\n    });\r\n\r\n    return objectExists;\r\n  }\r\n\r\n  add(data) {\r\n\r\n    // console.log('add global called');\r\n\r\n    if (this._data.length === 0 || !this._checkExists(data.id)) {\r\n\r\n      this._data.push(data);\r\n\r\n      store.trigger(actionTypes.textOptions.id, {\r\n        action: {\r\n          type: actionTypes.textOptions.ADD,\r\n        },\r\n        data,\r\n      });\r\n\r\n    } else {\r\n      throw new Error('Object already exists! Will not add it.');\r\n    }\r\n\r\n  }\r\n\r\n  delete(data) {\r\n\r\n    const objectExists = this._checkExists(data.id);\r\n\r\n    if (objectExists !== false) {\r\n\r\n      this._data.splice(objectExists.index, 1);\r\n\r\n      store.trigger(actionTypes.textOptions.id, {\r\n        action: {\r\n          type: actionTypes.textOptions.DELETE,\r\n        },\r\n        data,\r\n      });\r\n\r\n      return true;\r\n\r\n    }\r\n    throw new Error('Tag does not exist! Will not delete it.');\r\n\r\n\r\n  }\r\n\r\n  getAll(opts) {\r\n\r\n    if (undefined === opts || !opts.editor) { return this._data; }\r\n\r\n    const selectedObjs = this._data.filter(item => item.id === opts.id);\r\n\r\n    return selectedObjs;\r\n  }\r\n\r\n  getBy(opts) {\r\n\r\n    const allowedKeys = ['id'];\r\n\r\n    if ((opts === undefined) || (allowedKeys.indexOf(opts.key) === -1)) {\r\n      return false;\r\n    }\r\n\r\n    if (!Array.isArray(opts.value)) {\r\n      opts.value = [opts.value];\r\n    }\r\n\r\n    const selectedObjs = this._data.filter(item => (item[opts.key] === opts.value[0]) || (item[opts.key] === opts.value[1]));\r\n\r\n    return selectedObjs;\r\n\r\n  }\r\n\r\n  getLast(opts) {\r\n\r\n    if (undefined === opts || !opts.editor) {\r\n      return this._data[this._data.length - 1];\r\n    }\r\n\r\n    const selectedObjs = this._data.filter(item => item.id === opts.id);\r\n\r\n    return selectedObjs[selectedObjs.length - 1];\r\n  }\r\n\r\n}\r\n\r\nconst store = new StoreGlobal();\r\nexport default store;\r\n","import {\r\n  __mergeDeep, __hasClass, __addClass, __removeClass, __position, __positionTranslated, __remove, __getRealDimensions, __insertBefore, __keycodeIsPrintableCharacter, __toggleClass,\r\n} from '../../lib/utils';\r\nimport store from '../../store/store';\r\nimport storeGlobal from '../../store/store-global';\r\nimport Component from '../component';\r\n// import actionTypes from '../store/store-constants';\r\n\r\n\r\nexport default class Editor extends Component {\r\n\r\n  constructor(element) {\r\n    super(element);\r\n\r\n    // TODO: should extend default Component class and use this.target?\r\n    // this.$editor is better, more readable\r\n    this.$editor = this.target;\r\n    this.id = this.$editor.id;\r\n    // TODO: is DOM element before/after the editor itself.. move it to the editor?\r\n    this.settings = JSON.parse(document.querySelector(`[data-editor-id-reference=\"${this.id}\"]`).getAttribute('data-module-settings'));\r\n\r\n    this.opts = __mergeDeep(Editor.defaults, this.settings);\r\n\r\n    this.models = {\r\n      passive: [\r\n        'cteni',\r\n      ],\r\n      interactive: [\r\n        'predznaceny', 'zvyraznovani', 'komentáře', 'psani',\r\n      ],\r\n      withMenu: [\r\n        'predznaceny', 'zvyraznovani', 'komentáře',\r\n      ],\r\n    };\r\n\r\n    this.totalTagId = 0;\r\n\r\n    this.hasMenu = true;\r\n\r\n    this.selection = null;\r\n    this.lastSelectionSettings = {};\r\n    this.isCollapsed = null;\r\n    this.savedSelectionRange = null;\r\n    this.selectionAttributes = null;\r\n    this.dummyRangeElement = null;\r\n\r\n    this.selectionMouseDown = false;\r\n    this.selectionDirection = null;\r\n\r\n    this.hasEditableContentChanged = false;\r\n    this.lastPressedKey = null;\r\n\r\n    this.hasToolbar = false;\r\n    this.toolbar = {};\r\n\r\n    this.originalContent = {};\r\n    this.currentContent = {};\r\n\r\n    this._handlers = [];\r\n\r\n    this.wrapLastDeletesTimeoutClass = '';\r\n    this.wrapLastDeletesTimeoutFunction = () => { };\r\n    this.wrapLastAdditionsTimeoutClass = '';\r\n    this.wrapLastAdditionsTimeoutFunction = () => { };\r\n    this.isWrappingLastText = false;\r\n    this.isWriting = false;\r\n\r\n    this.$groupDeleted = null;\r\n\r\n    this.cache = {\r\n      body: document.body,\r\n      window,\r\n    };\r\n\r\n    this.init();\r\n  }\r\n\r\n  init() {\r\n    if (Editor._hasMenu(this.opts)) {\r\n      try {\r\n        this.$menu = this.$editor.getElementsByClassName(this.opts.menuClass)[0];\r\n\r\n        // TODO: generalize .item class via defaults and opts\r\n        this.$menuActions = this.$menu.getElementsByClassName('menu')[0].getElementsByClassName('menu-item');\r\n        this.$menuClose = this.$menu.getElementsByClassName('close')[0];\r\n      } catch (error) {\r\n        this.hasMenu = false;\r\n      }\r\n    } else {\r\n      this.hasMenu = false;\r\n    }\r\n\r\n    if (Editor._hasToolbar(this.opts)) {\r\n      this.hasToolbar = true;\r\n    }\r\n\r\n    this.$canvas = this.$editor.getElementsByClassName(this.opts.canvasClass)[0];\r\n\r\n    // only if the editor is INTERACTIVE\r\n    if (this.opts.funkce !== 'cteni') {\r\n      __addClass(this.$menu, 'hidden');\r\n\r\n      // only if the editor is for WRITING\r\n      if (this.opts.funkce === 'psani') {\r\n        this.originalContent.html = this.$canvas.innerHTML;\r\n        this.originalContent.text = this.$canvas.innerText;\r\n        this.currentContent.html = this.$canvas.innerHTML;\r\n        this.currentContent.text = this.$canvas.innerText;\r\n\r\n        this.wrapLastDeletesTimeoutClass = this._generateNewTagGroupClass();\r\n        this.wrapLastAdditionsTimeoutClass = this._generateNewTagGroupClass();\r\n      }\r\n\r\n      // only if the editor is with extra TOOLBAR\r\n      if (this.hasToolbar) {\r\n        this.toolbar.$element = this.$editor.getElementsByClassName('editor-toolbar')[0];\r\n        this.toolbar.$btnReset = this.toolbar.$element.getElementsByClassName('editor-toolbar-action-reset')[0];\r\n      }\r\n\r\n      this.registerEditableHandlers();\r\n    }\r\n\r\n    // only if the editor is with PREHIGHLIGHTED text\r\n    if (this.opts.funkce === 'predznaceny') {\r\n      this.initPreHighlightedTextOptions();\r\n    }\r\n\r\n  }\r\n\r\n  _generateNewTagId() {\r\n    this.totalTagId = this.totalTagId + 1;\r\n    return `${this.id}-${this.totalTagId}`;\r\n  }\r\n\r\n  _generateNewTagGroupClass() {\r\n    this.totalTagId = this.totalTagId + 1;\r\n    return `group-${this.id}-${this.totalTagId}`;\r\n  }\r\n\r\n  // add all eventListeners\r\n  // TODO: separate special case from universal ones?\r\n  registerEditableHandlers() {\r\n\r\n    this.$canvas.addEventListener('mousedown', this.handlerFocus.bind(this), false);\r\n    this.$canvas.addEventListener('focusout ', this.handlerFocus.bind(this), false);\r\n\r\n    // Necessary when mouseup is outside the $canvas element\r\n    // therefore we have to capture the event outside the element through body element\r\n    this.cache.body.addEventListener('mouseup', this.handlerFocus.bind(this), false);\r\n\r\n\r\n    if (this.opts.funkce === 'psani') {\r\n\r\n      this.$canvas.addEventListener('keydown', (e) => {\r\n\r\n        const selection = window.getSelection();\r\n        const keyCode = e.which || e.keyCode;\r\n        let keyName = e.key;\r\n\r\n        // show OK button or feedback\r\n        this.showFeedback();\r\n\r\n        // start DELETE\r\n        if (keyName === 'Backspace' || keyName === 'Delete') {\r\n          if (selection.rangeCount) {\r\n            window.clearTimeout(this.wrapLastDeletesTimeoutFunction);\r\n\r\n            const range = selection.getRangeAt(0);\r\n            const cloneRange = range.cloneRange();\r\n\r\n            if (this.lastSelectionSettings.isCollapsed) {\r\n\r\n              try {\r\n                cloneRange.setStart(range.startContainer, range.startOffset - 1);\r\n              } catch (e) {\r\n                // backspace was pressed at the beginning of the node\r\n                cloneRange.setStart(range.startContainer, range.startOffset);\r\n                cloneRange.collapse(true);\r\n              }\r\n\r\n            } else {\r\n              cloneRange.setStart(range.startContainer, range.startOffset);\r\n\r\n            }\r\n\r\n            cloneRange.setEnd(range.endContainer, range.endOffset);\r\n\r\n            // do nothing when it's space\r\n            const addedFragment = cloneRange.cloneContents();\r\n            const addedFragmentString = addedFragment.textContent.trim();\r\n\r\n            if ((addedFragmentString !== '' && addedFragmentString !== '&nbsp;') || this.isWrappingLastText) {\r\n\r\n              const dummyElementInner = document.createElement('span');\r\n              dummyElementInner.className = `user-removed-text-inner ${this.wrapLastDeletesTimeoutClass}`;\r\n\r\n              cloneRange.surroundContents(dummyElementInner);\r\n\r\n              selection.removeAllRanges();\r\n              selection.addRange(range);\r\n\r\n              this.wrapLastDeletesTimeoutFunction = setTimeout(() => {\r\n\r\n                this.isWrappingLastText = false;\r\n\r\n                // wrap all previous deletes to one element\r\n                const dummyElement = document.createElement('span');\r\n                dummyElement.contentEditable = false;\r\n                dummyElement.className = 'user-removed-text';\r\n\r\n                const newGeneratedId = this._generateNewTagId();\r\n                dummyElement.id = newGeneratedId;\r\n\r\n                const elements = Array.from(document.getElementsByClassName(this.wrapLastDeletesTimeoutClass));\r\n\r\n                __insertBefore(dummyElement, elements[0]);\r\n\r\n                elements.forEach((el, i) => {\r\n                  dummyElement.appendChild(el);\r\n                });\r\n\r\n\r\n                // create close button\r\n                const $btnClose = document.createElement('span');\r\n                $btnClose.className = this.opts.closeBtnClass;\r\n\r\n                const clickHandler = (e) => {\r\n                  const $nodeElement = e.currentTarget.parentNode;\r\n                  this._removeNodeKeepTextContent($nodeElement);\r\n                  e.stopPropagation();\r\n                };\r\n\r\n                $btnClose.addEventListener('click', clickHandler.bind(this));\r\n\r\n                document.getElementById(newGeneratedId).appendChild($btnClose);\r\n\r\n                this.wrapLastDeletesTimeout = true;\r\n                this.wrapLastDeletesTimeoutClass = this._generateNewTagGroupClass();\r\n\r\n              }, 700);\r\n\r\n              this.isWrappingLastText = true;\r\n\r\n              e.preventDefault();\r\n\r\n            } else {\r\n\r\n              if (!this.isWrappingLastText) {\r\n                // we're removing spaces, do nothing use browser's default behaviour, unless the wrapping is going on\r\n                return;\r\n              }\r\n              e.preventDefault();\r\n            }\r\n          }\r\n        }\r\n        // end DELETE\r\n\r\n        // start WRITING\r\n        else if (__keycodeIsPrintableCharacter(keyCode)) {\r\n\r\n          // if nothing is selected (selection is empty)\r\n          if (this.lastSelectionSettings.isCollapsed) {\r\n\r\n            // if \"space\" was written\r\n            if (keyCode === 32) {\r\n              if (!this.isWrappingLastText) {\r\n                // we're adding spaces, do nothing use browser's default behaviour, unless the wrapping is going on\r\n                return;\r\n              }\r\n              // fill a space as the keyname for the spacebar\r\n              keyName = ' ';\r\n            }\r\n\r\n            // The Selection.rangeCount read-only property returns the number of ranges in the selection.\r\n            if (selection.rangeCount) {\r\n\r\n              window.clearTimeout(this.wrapLastAdditionsTimeoutFunction);\r\n\r\n              const range = selection.getRangeAt(0);\r\n              const cloneRange = range.cloneRange();\r\n\r\n              cloneRange.setStart(range.startContainer, range.startOffset);\r\n              cloneRange.setEnd(range.endContainer, range.endOffset);\r\n\r\n              const textToAddElement = document.createElement('span');\r\n              textToAddElement.contentEditable = false;\r\n              textToAddElement.className = `user-inserted-text-inner ${this.wrapLastAdditionsTimeoutClass}`;\r\n              textToAddElement.innerHTML = keyName;\r\n\r\n              cloneRange.insertNode(textToAddElement);\r\n\r\n              // move the caret after the inserted character\r\n              range.setStartAfter(textToAddElement);\r\n\r\n              selection.removeAllRanges();\r\n              selection.addRange(range);\r\n\r\n              this.wrapLastAdditionsTimeoutFunction = setTimeout(() => {\r\n\r\n                this.isWrappingLastText = false;\r\n\r\n                // wrap all previous deletes to one element\r\n                const dummyElement = document.createElement('span');\r\n                dummyElement.contentEditable = false;\r\n                dummyElement.className = 'user-inserted-text';\r\n\r\n                const newGeneratedId = this._generateNewTagId();\r\n                dummyElement.id = newGeneratedId;\r\n\r\n                const elements = Array.from(document.getElementsByClassName(this.wrapLastAdditionsTimeoutClass));\r\n\r\n                __insertBefore(dummyElement, elements[0]);\r\n\r\n                elements.forEach((el, i) => {\r\n                  dummyElement.appendChild(el);\r\n                });\r\n\r\n\r\n                // create close button\r\n                const $btnClose = document.createElement('span');\r\n                $btnClose.className = this.opts.closeBtnClass;\r\n\r\n                const clickHandler = (e) => {\r\n                  const $nodeElement = e.currentTarget.parentNode;\r\n                  __remove($nodeElement);\r\n                  e.stopPropagation();\r\n                };\r\n\r\n                $btnClose.addEventListener('click', clickHandler.bind(this));\r\n                document.getElementById(newGeneratedId).appendChild($btnClose);\r\n\r\n                this.wrapLastAdditionsTimeoutClass = this._generateNewTagGroupClass();\r\n\r\n              }, 700);\r\n\r\n              this.isWrappingLastText = true;\r\n\r\n            }\r\n\r\n\r\n            if (this.hasEditableContentChanged === false) {\r\n              this.hasEditableContentChanged = true;\r\n            }\r\n\r\n            e.preventDefault();\r\n          }\r\n\r\n          // writing over existing text is selected\r\n          else {\r\n            window.clearTimeout(this.wrapLastAdditionsTimeoutFunction);\r\n\r\n            const range = selection.getRangeAt(0);\r\n            const cloneRange = range.cloneRange();\r\n\r\n            cloneRange.setStart(range.startContainer, range.startOffset);\r\n            cloneRange.setEnd(range.endContainer, range.endOffset);\r\n\r\n            // 1. handle deleting the text that was selected when writing started\r\n            if (this.isWriting === false && selection.toString().length > 0) {\r\n              // add deleted text node only for the first time and only if there is some selected text\r\n              this.$groupDeleted = document.createElement('span');\r\n              this.$groupDeleted.contentEditable = false;\r\n              this.$groupDeleted.className = 'user-removed-text';\r\n\r\n              const groupDeletedId = this._generateNewTagId();\r\n              this.$groupDeleted.id = groupDeletedId;\r\n\r\n              const $groupInnerDeleted = document.createElement('span');\r\n              $groupInnerDeleted.className = 'user-removed-text-inner';\r\n\r\n              this.$groupDeleted.appendChild($groupInnerDeleted);\r\n\r\n              cloneRange.surroundContents(this.$groupDeleted);\r\n\r\n              // create close button\r\n              const $btnClose = document.createElement('span');\r\n              $btnClose.className = this.opts.closeBtnClass;\r\n\r\n              const clickHandler = (e) => {\r\n                const $nodeElement = e.currentTarget.parentNode;\r\n                this._removeNodeKeepTextContent($nodeElement);\r\n                e.stopPropagation();\r\n              };\r\n\r\n              $btnClose.addEventListener('click', clickHandler.bind(this));\r\n              this.$groupDeleted.appendChild($btnClose);\r\n            }\r\n\r\n\r\n            // 2. adding new text\r\n            this.isWriting = true;\r\n\r\n            const $groupInnerAdded = document.createElement('span');\r\n            $groupInnerAdded.contentEditable = false;\r\n            $groupInnerAdded.className = `user-inserted-text-inner ${this.wrapLastAdditionsTimeoutClass}`;\r\n\r\n            // add a space so there is a space between the added and removed text\r\n            $groupInnerAdded.innerHTML = `${keyName}`;\r\n\r\n            // TODO: error after deleted selection\r\n            __insertBefore($groupInnerAdded, this.$groupDeleted);\r\n            range.setStartAfter($groupInnerAdded);\r\n\r\n            selection.removeAllRanges();\r\n            selection.addRange(range);\r\n\r\n            this.wrapLastAdditionsTimeoutFunction = setTimeout(() => {\r\n              this.isWriting = false;\r\n\r\n              // wrap all previous deletes to one element\r\n              const $groupAdded = document.createElement('span');\r\n              $groupAdded.contentEditable = false;\r\n              $groupAdded.className = 'user-inserted-text';\r\n\r\n              const newGeneratedId = this._generateNewTagId();\r\n              $groupAdded.id = newGeneratedId;\r\n\r\n              const elements = Array.from(document.getElementsByClassName(this.wrapLastAdditionsTimeoutClass));\r\n\r\n              __insertBefore($groupAdded, elements[0]);\r\n\r\n              elements.forEach((el, i) => {\r\n                $groupAdded.appendChild(el);\r\n              });\r\n\r\n              const $btnClose = document.createElement('span');\r\n              $btnClose.className = this.opts.closeBtnClass;\r\n\r\n              const clickHandler = (e) => {\r\n                const $nodeElement = e.currentTarget.parentNode;\r\n                __remove($nodeElement);\r\n                e.stopPropagation();\r\n              };\r\n\r\n              $btnClose.addEventListener('click', clickHandler.bind(this));\r\n              document.getElementById(newGeneratedId).appendChild($btnClose);\r\n\r\n              this.wrapLastAdditionsTimeoutClass = this._generateNewTagGroupClass();\r\n\r\n            }, 700);\r\n\r\n            e.preventDefault();\r\n          }\r\n        }\r\n        // end WRITING\r\n      });\r\n    }\r\n\r\n\r\n    if (this.hasMenu) {\r\n      this.registerMenuHandler();\r\n    }\r\n\r\n    if (this.hasToolbar) {\r\n      this.toolbar.$btnReset.addEventListener('click', () => {\r\n\r\n        const isConfirmed = confirm('Opravdu chcete vrátit text do původní podoby? Vaše změny se tímto ztratí.');\r\n\r\n        if (isConfirmed) {\r\n          this.$canvas.innerHTML = this.originalContent.html;\r\n        }\r\n\r\n      });\r\n    }\r\n\r\n  }\r\n\r\n  registerMenuHandler() {\r\n    for (let i = 0, len = this.$menuActions.length; i < len; i += 1) {\r\n      this.$menuActions[i].addEventListener('click', this.handlerMenuActions.bind(this), false);\r\n    }\r\n\r\n    this.$menuClose.addEventListener('click', this.handlerMenuClose.bind(this), false);\r\n  }\r\n\r\n  initPreHighlightedTextOptions() {\r\n    const dataAttr = 'data-text-option';\r\n\r\n    // loop over updated DOM via DOM manipulation\r\n    this.$textOptionsElements = this.$editor.querySelectorAll(`[${dataAttr}]`);\r\n    Array.from(this.$textOptionsElements).forEach(($textOption) => {\r\n\r\n      $textOption.addEventListener('click', () => {\r\n        __toggleClass($textOption, this.opts.textOptions.selectedClass);\r\n\r\n        if (__hasClass($textOption, this.opts.textOptions.selectedClass)) {\r\n          storeGlobal.add({\r\n            editor: this.id,\r\n            id: $textOption.id,\r\n            tag: $textOption,\r\n            data: JSON.parse($textOption.getAttribute(dataAttr)),\r\n          });\r\n        } else {\r\n          storeGlobal.delete({\r\n            editor: this.id,\r\n            id: $textOption.id,\r\n          });\r\n        }\r\n\r\n        // show OK button or feedback\r\n        this.showFeedback();\r\n      });\r\n\r\n    });\r\n\r\n  }\r\n\r\n  toggleMenu(clickClose = false) {\r\n\r\n    if (clickClose === true) {\r\n      __addClass(this.$menu, 'hidden');\r\n      return;\r\n    }\r\n\r\n    if (this.selectionMouseDown === true) {\r\n      __addClass(this.$menu, 'hidden');\r\n      return;\r\n    }\r\n\r\n    if (__hasClass(this.$menu, 'hidden') && this.selectionMouseDown === false) {\r\n      this._setmenuDimensions();\r\n      __removeClass(this.$menu, 'hidden');\r\n    }\r\n\r\n  }\r\n\r\n  _setmenuDimensions() {\r\n    const menuDimensions = __getRealDimensions(this.$menu);\r\n    const parentTranslatedPosition = __positionTranslated(this.$editor);\r\n    const parentDimensions = __position(this.$editor);\r\n\r\n    // let additionalSize = ( this.selectionDirection === \"right\" ) ?\r\n\r\n    const isOverflowAt = {\r\n      right: (this.selectionAttributes.left + this.selectionAttributes.width + menuDimensions.width + this.opts.menuMargin.x) > (parentTranslatedPosition.left + parentDimensions.width),\r\n      top: (this.selectionAttributes.top - menuDimensions.height - this.opts.menuMargin.y) < (parentTranslatedPosition.top),\r\n      bottom: (this.selectionAttributes.top + this.selectionAttributes.height + menuDimensions.height + this.opts.menuMargin.y) > (parentTranslatedPosition.top + parentDimensions.height),\r\n    };\r\n\r\n    let leftDimensions;\r\n    let topDimensions;\r\n\r\n    if (isOverflowAt.right) {\r\n\r\n      leftDimensions = this.selectionAttributes.left - menuDimensions.width - this.opts.menuMargin.x;\r\n\r\n    } else {\r\n\r\n      leftDimensions = this.selectionAttributes.left + this.selectionAttributes.width + this.opts.menuMargin.x;\r\n\r\n    }\r\n\r\n    if (isOverflowAt.top) {\r\n\r\n      topDimensions = this.selectionAttributes.top + menuDimensions.height + this.opts.menuMargin.y;\r\n\r\n    } else {\r\n\r\n      topDimensions = this.selectionAttributes.top - menuDimensions.height - this.opts.menuMargin.y;\r\n\r\n    }\r\n\r\n    this.$menu.style.left = `${leftDimensions}px`;\r\n    this.$menu.style.top = `${topDimensions}px`;\r\n\r\n  }\r\n\r\n  handlerMenuClose(e) {\r\n\r\n    this.toggleMenu(true);\r\n\r\n    e.preventDefault();\r\n\r\n  }\r\n\r\n  handlerMenuActions(e) {\r\n\r\n    const $el = e.currentTarget;\r\n    const command = $el.getAttribute('data-command');\r\n    const commandName = $el.getAttribute('data-command-name');\r\n\r\n    /* :TODO: Cache the options for given element to avoid JSON parsing each time */\r\n    const options = JSON.parse($el.getAttribute('data-command-options'));\r\n\r\n    this.setSelection(command, commandName, options);\r\n\r\n    e.preventDefault();\r\n\r\n  }\r\n\r\n  handlerFocus(e) {\r\n    const isMouseRightClick = e.which === 3;\r\n\r\n    if (isMouseRightClick) { return; }\r\n\r\n    if (__hasClass(e.target, 'node-close')) { return; }\r\n\r\n    if (__hasClass(e.target, 'node-selected')) { return; }\r\n\r\n    if (e.type === 'mousedown') {\r\n\r\n      // start tracking the mouse down\r\n      this.selectionMouseDown = true;\r\n\r\n      if (this.hasMenu === true) {\r\n        this.toggleMenu();\r\n      }\r\n\r\n    }\r\n\r\n    if (e.type === 'mouseup' && this.selectionMouseDown) {\r\n\r\n      // reset saved last selection settings\r\n      this.lastSelectionSettings = {};\r\n\r\n      this.selection = window.getSelection();\r\n      this.isCollapsed = this.lastSelectionSettings.isCollapsed = this.selection.isCollapsed;\r\n      this.savedSelectionRange = this.selection.getRangeAt(0);\r\n\r\n      this.selectionMouseDown = false;\r\n\r\n      this.lastSelectionSettings.anchorOffset = this.selection.anchorOffset;\r\n      this.lastSelectionSettings.focusOffset = this.selection.focusOffset;\r\n      this.lastSelectionSettings.text = this.savedSelectionRange.toString();\r\n\r\n      /* https://developer.mozilla.org/en-US/docs/Web/API/Selection/isCollapsed */\r\n      /* Returns a Boolean indicating whether the selection's start and end points are at the same position. */\r\n      /* display context menu only if the cursor is NOT at the same position */\r\n      if (this.selection.isCollapsed === false && this.savedSelectionRange.toString().trim() !== '') {\r\n\r\n        this.selectionDirection = (this.selection.anchorOffset <= this.selection.focusOffset) ? 'right' : 'left';\r\n\r\n        if (this.hasMenu === true) {\r\n\r\n          this._setSelectionPosition(); // :TODO: cannot be used in contentEditable editor yet\r\n\r\n          this.toggleMenu();\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  _setSelectionPosition() {\r\n\r\n    const dummyElement = document.createElement('span');\r\n    dummyElement.className = 'dummy-range-element';\r\n\r\n    this.savedSelectionRange.surroundContents(dummyElement);\r\n\r\n    const selectionPosition = __positionTranslated(dummyElement);\r\n    const selectionDimension = __position(dummyElement);\r\n\r\n    this.selectionAttributes = {\r\n      left: selectionPosition.left,\r\n      top: selectionPosition.top,\r\n      width: selectionDimension.width,\r\n      height: selectionDimension.height,\r\n    };\r\n\r\n    __removeClass(dummyElement, 'dummy-range-element');\r\n\r\n    this._removeNodeKeepTextContent(dummyElement);\r\n\r\n  }\r\n\r\n  _extractAndSaveContents($domEl) {\r\n    $domEl.appendChild(this.savedSelectionRange.extractContents());\r\n    this.savedSelectionRange.insertNode($domEl);\r\n\r\n    const tagName = $domEl.getAttribute('data-command-name');\r\n    const newTagId = this._generateNewTagId();\r\n\r\n    $domEl.setAttribute('data-tag-id', newTagId);\r\n\r\n    store.addTag({\r\n      editor: this.id,\r\n      id: newTagId,\r\n      tag: $domEl,\r\n      tagName,\r\n      data: {},\r\n    });\r\n\r\n  }\r\n\r\n  _removeNodeKeepTextContent(node) {\r\n    const text = node.textContent;\r\n    node.parentNode.insertBefore(document.createTextNode(text), node);\r\n    __remove(node);\r\n  }\r\n\r\n  _createCloseBtnForElement(parentEl, opts = {}) {\r\n\r\n    const $elClose = document.createElement('span');\r\n    $elClose.setAttribute('class', opts.class);\r\n\r\n    const classesToToggle = opts.toggleClass.split(' ');\r\n\r\n\r\n    const clickHandler = (e) => {\r\n\r\n      const $closeBtn = e.currentTarget;\r\n      const $nodeElement = $closeBtn.parentNode;\r\n\r\n      $closeBtn.removeEventListener('click', clickHandler);\r\n      $nodeElement.removeChild($closeBtn);\r\n\r\n      if (undefined !== $nodeElement.commentRef) {\r\n\r\n        /* :TODO: temporary way to save the reference to the DOM element */\r\n        this.$editor.removeChild($nodeElement.commentRef);\r\n        $nodeElement.commentRef = null;\r\n\r\n      }\r\n\r\n      this._removeNodeKeepTextContent($nodeElement);\r\n\r\n      const tagName = $nodeElement.getAttribute('data-command-name');\r\n\r\n      store.deleteTag({\r\n        editor: this.id,\r\n        id: $nodeElement.getAttribute('data-tag-id'),\r\n        tag: $nodeElement,\r\n        tagName,\r\n        data: {},\r\n      });\r\n\r\n      e.stopPropagation();\r\n\r\n    };\r\n\r\n    $elClose.addEventListener('click', clickHandler.bind(this));\r\n\r\n    parentEl.appendChild($elClose);\r\n\r\n  }\r\n\r\n  _calculateCommentPosition($node) /* : Object */ {\r\n\r\n    const nodePosition = __positionTranslated($node);\r\n\r\n    return {\r\n      left: `${nodePosition.left + parseInt($node.offsetWidth, 10) + this.opts.commentMargin.x}px`,\r\n      top: `${nodePosition.top + this.opts.commentMargin.y}px`,\r\n    };\r\n\r\n  }\r\n\r\n  _createCommentForNode($el, opts = {}) {\r\n\r\n    const commentTemplate = document.getElementById('comment-template').innerHTML;\r\n\r\n    const div = document.createElement('div');\r\n    div.innerHTML = commentTemplate;\r\n\r\n    const commentDiv = div.childNodes[1];\r\n\r\n    // attach js reference to the dom element\r\n    commentDiv.data = {};\r\n    commentDiv.data.nodeRef = $el;\r\n\r\n    const commentNewTextarea = commentDiv.getElementsByClassName('comment-new-text')[0];\r\n    const commentDivButtonSubmit = commentDiv.getElementsByTagName('button')[0];\r\n    const commentCommentsContainer = commentDiv.getElementsByClassName('comments-container')[0];\r\n\r\n    const calculatedCommentPosition = this._calculateCommentPosition($el);\r\n\r\n    commentDiv.style.left = calculatedCommentPosition.left;\r\n    commentDiv.style.top = calculatedCommentPosition.top;\r\n\r\n    __addClass(commentDiv, opts.class);\r\n\r\n    commentDiv.addEventListener('click', (e) => {\r\n\r\n      if (__hasClass(e.target, 'close')) {\r\n\r\n        __addClass(commentDiv, 'hidden');\r\n        __removeClass($el, 'active');\r\n\r\n      }\r\n\r\n    });\r\n\r\n    commentDivButtonSubmit.addEventListener('click', (e) => {\r\n\r\n      if (commentNewTextarea.value !== '') {\r\n\r\n        const commentItem = document.createElement('div');\r\n        commentItem.className = 'comment-item';\r\n\r\n        commentItem.innerText = commentNewTextarea.value;\r\n\r\n        commentCommentsContainer.appendChild(commentItem);\r\n\r\n        commentNewTextarea.value = '';\r\n      }\r\n\r\n    });\r\n\r\n    this.$editor.append(commentDiv);\r\n\r\n    __addClass($el, 'comment-created');\r\n\r\n    /* :TODO: Temporary way to save the reference to the DOM element */\r\n    $el.commentRef = commentDiv;\r\n\r\n\r\n  }\r\n\r\n  _addCommentHandlerForElement($el, opts = {}) {\r\n\r\n    __addClass($el, 'has-comments');\r\n\r\n    function clickHandler(e) {\r\n\r\n      if (!__hasClass(e.target, 'node-close')) {\r\n\r\n        if (!__hasClass($el, 'comment-created')) {\r\n\r\n          this._createCommentForNode($el, opts);\r\n\r\n        } else {\r\n\r\n          /* recalculate comment div position */\r\n          const calculatedCommentPosition = this._calculateCommentPosition($el);\r\n\r\n          $el.commentRef.style.left = calculatedCommentPosition.left;\r\n          $el.commentRef.style.top = calculatedCommentPosition.top;\r\n\r\n          __removeClass($el.commentRef, 'hidden');\r\n\r\n        }\r\n\r\n        if (!__hasClass($el, 'active')) {\r\n\r\n          __addClass($el, 'active');\r\n\r\n        } else {\r\n\r\n          __removeClass($el, 'active');\r\n          __addClass($el.commentRef, 'hidden');\r\n\r\n        }\r\n\r\n      }\r\n\r\n      e.stopPropagation();\r\n\r\n    }\r\n\r\n    $el.addEventListener('click', clickHandler.bind(this));\r\n\r\n  }\r\n\r\n  setSelection(command, commandName, opts = {}) {\r\n\r\n    if (this.selection) {\r\n\r\n      if (command === 'toggle-class') {\r\n\r\n        const $el = document.createElement('span');\r\n        $el.setAttribute('class', opts.toggleClass);\r\n        $el.setAttribute('data-command-name', commandName);\r\n\r\n        if (opts.closeBtn === true) {\r\n          this._createCloseBtnForElement($el, {\r\n            class: 'node-close',\r\n            toggleClass: opts.toggleClass,\r\n          });\r\n        }\r\n\r\n        if (opts.comments === true) {\r\n          this._addCommentHandlerForElement($el, {\r\n            class: opts.commentsClass,\r\n          });\r\n        }\r\n\r\n        this._extractAndSaveContents($el);\r\n\r\n        if (opts.showCommentsOnInit === true) {\r\n          $el.click();\r\n        }\r\n\r\n      }\r\n\r\n      // hide context menu after selecting the action#\r\n      this.toggleMenu(true);\r\n\r\n      // show OK button or feedback\r\n      this.showFeedback();\r\n\r\n    }\r\n\r\n  }\r\n\r\n}\r\n\r\nEditor.defaults = {\r\n  menuClass: 'contextual-menu-component',\r\n  canvasClass: 'canvas',\r\n  resetBtnClass: 'reset',\r\n  closeBtnClass: 'node-close',\r\n  nodeSelectedClass: 'node-selected',\r\n  commentMargin: {\r\n    x: 50,\r\n    y: 0,\r\n  },\r\n  menuMargin: {\r\n    x: 15,\r\n    y: 15,\r\n  },\r\n  textOptions: {\r\n    enable: false,\r\n    animatedClass: 'active',\r\n    selectedClass: 'selected',\r\n    deselectedClass: 'deselected',\r\n  },\r\n\r\n};\r\n\r\nEditor._hasMenu = opts => opts.funkce !== 'cteni' && opts.funkce !== 'psani' && (opts.menu !== false && opts.menu !== undefined);\r\nEditor._hasToolbar = opts => opts.funkce === 'psani' || (opts.toolbar !== false && opts.toolbar !== undefined);\r\n","import { __hasClass, __getHTML, __remove } from '../lib/utils';\r\nimport store from '../store/store';\r\nimport actionTypes from '../store/store-constants';\r\nimport Component from './component';\r\n\r\n\r\nexport default class AnalyticalTable extends Component {\r\n\r\n  constructor(id, element, opts) {\r\n    super(element);\r\n\r\n    this.id = id;\r\n\r\n    this.opts = Object.assign({}, AnalyticalTable.defaults, opts);\r\n\r\n    this.isAdvanced = this.opts.isAdvanced;\r\n\r\n    this.rowIndex = 0;\r\n\r\n    this.tableResult = this.target.getElementsByClassName('table-result')[0];\r\n    this.tableResultBody = this.tableResult.getElementsByClassName('table-body')[0];\r\n    this.tableSelectedItems = this.target.getElementsByClassName('table-selected-items')[0];\r\n    this.tableSelectedItemsBody = this.tableSelectedItems.getElementsByClassName('table-body')[0];\r\n\r\n    this.activeDragged = null;\r\n\r\n    // choose the HTML for a row according to whether we work with the advanced version of a table\r\n    this._getRowHTML = (this.isAdvanced) ? AnalyticalTable._getAdvancedRowHTML : AnalyticalTable._getRowHTML;\r\n\r\n  }\r\n\r\n  init() {\r\n    this._registerStoreHandlers(this.tableResultBody, this.tableSelectedItemsBody);\r\n    this._registerHandlers();\r\n  }\r\n\r\n  _registerStoreHandlers(tableResultBody, tableSelectedItemsBody) {\r\n\r\n    store.on(actionTypes.editor.CHANGE, (event, payload) => {\r\n\r\n      const action = payload.action;\r\n      let addedTagContainer;\r\n      let $node;\r\n      // let deletedItem;\r\n\r\n      switch (action.type) {\r\n\r\n        case actionTypes.editor.ADD_TAG:\r\n\r\n          addedTagContainer = action.data.tagContainer;\r\n\r\n          switch (addedTagContainer.tagName) {\r\n\r\n            case this.opts.casti[1].sloupce[0].tag:\r\n\r\n              tableResultBody.insertAdjacentHTML('beforeend', this._getRowHTML(__getHTML(addedTagContainer.tag), addedTagContainer.id));\r\n\r\n\r\n              // TODO: fix this\r\n              if (this.opts.letSecondCaseRunIfSame || this.opts.casti[1].sloupce[0].tag === this.opts.casti[1].sloupce[1].tag) {\r\n\r\n              } else {\r\n                break;\r\n              }\r\n            // break;\r\n\r\n            case this.opts.casti[1].sloupce[1].tag:\r\n\r\n\r\n              $node = addedTagContainer.tag.cloneNode(true);\r\n              $node.setAttribute('draggable', true);\r\n              $node.addEventListener('click', this._handlerDraggable.bind(this), false);\r\n              $node.addEventListener('dragstart', this._handlerDraggable.bind(this), false);\r\n              $node.addEventListener('dragend', this._handlerDraggable.bind(this), false);\r\n              $node.addEventListener('drag', this._handlerDraggable.bind(this), false);\r\n\r\n              tableSelectedItemsBody.appendChild($node);\r\n\r\n\r\n              break;\r\n\r\n            default:\r\n              break;\r\n\r\n          }\r\n          break;\r\n\r\n        case actionTypes.editor.DELETE_TAG:\r\n\r\n          addedTagContainer = action.data.tagContainer;\r\n\r\n          // console.log(\"from DELETE_TAG action\", addedTagContainer);\r\n\r\n          // simple analytical table tasks\r\n          // const deletedItems = document.querySelectorAll(`[data-tag-id=\"${addedTagContainer.id}\"]`);\r\n\r\n          Array.prototype.forEach.call(document.querySelectorAll(`[data-tag-id=\"${addedTagContainer.id}\"]`), ($node) => {\r\n\r\n            if (__hasClass($node.parentNode, 'cell-read-only')) {\r\n              // we have to remove the whole row from the table\r\n              // --> cell --> table-row\r\n              __remove($node.parentNode.parentNode);\r\n\r\n            } else {\r\n              __remove($node);\r\n            }\r\n\r\n          });\r\n\r\n          break;\r\n\r\n        default:\r\n          break;\r\n      }\r\n\r\n\r\n    });\r\n\r\n  }\r\n\r\n  _registerHandlers() {\r\n\r\n    this.target.addEventListener('dragover', this._handlerDrop.bind(this), false);\r\n    this.target.addEventListener('dragleave', this._handlerDrop.bind(this), false);\r\n    this.target.addEventListener('drop', this._handlerDrop.bind(this), false);\r\n\r\n  }\r\n\r\n\r\n  _handlerDraggable(e) {\r\n\r\n    if (e.type === 'dragstart') {\r\n      e.dataTransfer.setData('text/plain', 'node');\r\n      e.dataTransfer.dropEffect = '';\r\n      e.target.style.opacity = 0.5;\r\n\r\n      this.activeDragged = e.target.cloneNode(true);\r\n    }\r\n\r\n    if (e.type === 'dragend') {\r\n      e.target.style.opacity = 1;\r\n\r\n      // show OK button or feedback\r\n      this.showFeedback();\r\n    }\r\n\r\n    return false;\r\n\r\n  }\r\n\r\n  _handlerDrop(e) {\r\n    if (e.target.localName == \"input\") {\r\n\r\n      if (e.type === 'dragover') {\r\n        e.preventDefault();\r\n        e.dataTransfer.dropEffect = 'none';\r\n      }\r\n\r\n      if (e.type === 'drop') {\r\n        e.preventDefault();\r\n      }\r\n    }\r\n\r\n    if (__hasClass(e.target, 'dashboard-canvas-widget-content')) {\r\n      if (e.type === 'dragover') {\r\n\r\n        e.preventDefault();\r\n        e.dataTransfer.dropEffect = '';\r\n        e.target.style.background = '#eee';\r\n      }\r\n\r\n      if (e.type === 'dragleave') {\r\n\r\n        e.target.style.background = '#fff';\r\n\r\n      }\r\n\r\n      if (e.type === 'drop') {\r\n\r\n\r\n        e.preventDefault();\r\n\r\n        e.target.style.background = '#fff';\r\n        this.activeDragged.style.opacity = 1;\r\n\r\n\r\n        this.activeDragged.addEventListener('click', (e) => {\r\n\r\n          if (__hasClass(e.target, 'node-close')) {\r\n\r\n            e.target.parentNode.remove();\r\n\r\n          }\r\n\r\n        });\r\n\r\n        e.target.appendChild(this.activeDragged);\r\n\r\n\r\n      }\r\n\r\n\r\n    }\r\n\r\n\r\n    return false;\r\n\r\n  }\r\n\r\n\r\n}\r\n\r\nAnalyticalTable.defaults = {\r\n  isAdvanced: false,\r\n};\r\n\r\n\r\nAnalyticalTable._getRowHTML = (nodeHTML, index = 0) => {\r\n\r\n  const tableRowTemplate = `\r\n    <div class=\"table-row\">\r\n      <div class=\"cell cell-read-only cell-border-right\">${nodeHTML}</div>\r\n      <div class=\"cell dashboard-canvas-widget-content\"></div>\r\n    </div>\r\n  `;\r\n\r\n  return tableRowTemplate;\r\n\r\n};\r\n\r\nAnalyticalTable._getAdvancedRowHTML = (nodeHTML, index = 0) => {\r\n\r\n  const tableRowTemplate = `\r\n    <div class=\"table-row\">\r\n      <div class=\"cell cell-read-only cell-border-right\">${nodeHTML}</div>\r\n      <div class=\"cell dashboard-canvas-widget-content cell-border-right\"></div>\r\n      <div class=\"cell table-input\">\r\n        <input id=\"table-akteri-vztahy-input-${index}\" data-input-target=\"\" data-save=\"value\" type=\"text\" placeholder=\"Vztah aktérů…\" tabindex=\"-1\">\r\n      </div>\r\n    </div>\r\n  `;\r\n\r\n  return tableRowTemplate;\r\n\r\n};\r\n","import Observer from './observer';\r\nimport actionTypes from './store-constants';\r\n\r\n/*\r\nconst tagContainer: Object = {\r\n  editorId?: number,\r\n  id: string,\r\n  tag: HTMLElement,\r\n  data?: Object\r\n}\r\n*/\r\n\r\n\r\nclass StoreKeywords extends Observer {\r\n\r\n  constructor() {\r\n\r\n    super();\r\n\r\n    /* here the global space for storing objects and data */\r\n    this._data = {};\r\n\r\n  }\r\n\r\n\r\n  change(keywordsId, newItems, newItemsHTML) {\r\n\r\n    if (!this._data[keywordsId]) {\r\n      this._data[keywordsId] = {};\r\n    }\r\n\r\n    this._data[keywordsId].items = newItems;\r\n    this._data[keywordsId].itemsHTML = newItemsHTML;\r\n\r\n    store.trigger(actionTypes.keywords.CHANGE, {\r\n      action: {\r\n        id: actionTypes.keywords.id,\r\n        type: actionTypes.keywords.CHANGE,\r\n        data: {\r\n          keywordsId: keywordsId,\r\n          newItems: newItems,\r\n          newItemsHTML: newItemsHTML\r\n        },\r\n      },\r\n\r\n    });\r\n\r\n  }\r\n\r\n  export() {\r\n    return this._data;\r\n  }\r\n\r\n}\r\n\r\nconst store = new StoreKeywords();\r\nexport default store;\r\n","import { __toggleClass, __getHTML } from '../lib/utils';\r\nimport Component from './component';\r\nimport store from '../store/store-keywords';\r\nimport actionTypes from '../store/store-constants';\r\n\r\n// zoom the image\r\nexport default class Keywords extends Component {\r\n  constructor($element, opts = {}) {\r\n    super($element);\r\n    this.id = this.target.id;\r\n    this.function = this.target.getAttribute('data-keywords') || 'selekce';\r\n    this.$controls = Array.from(this.target.querySelectorAll('[data-keywords-control]'));\r\n\r\n    this.opts = Object.assign({}, Keywords.defaults, opts);\r\n\r\n    this.$itemsContainer = this.target.getElementsByClassName(this.opts.itemsContainerClassName)[0];\r\n\r\n    if (this.opts.inherit && this.opts.inherit.from.length > 0) {\r\n      // console.log(this.opts.inherit.from);\r\n      this.isInherited = true;\r\n    } else {\r\n      this.$items = this.target.getElementsByClassName(this.opts.itemClassName);\r\n    }\r\n\r\n  }\r\n\r\n  init() {\r\n    switch (this.function) {\r\n      case 'selekce':\r\n        // we have data at the instantiation for importing\r\n        if (this.opts.import && this.opts.import.length > 0) {\r\n          this.$itemsContainer.innerHTML = Keywords._getHTMLFromItems(this.opts.import);\r\n        }\r\n\r\n        // save the state of all instances on Init\r\n        /* :TODO: a possible duplicity when the instance has the isInherited set to TRUE */\r\n        store.change(\r\n          this.id,\r\n          Keywords._getItemsFromHTML(this.$itemsContainer, this.opts.itemClassName),\r\n          Keywords._getItemsHTML(this.$itemsContainer),\r\n        );\r\n\r\n        // console.log(this.id, this.isInherited);\r\n        if (this.isInherited) {\r\n          // if onInit, we copy the elements\r\n          // by their ids into the itemsContainer of this object\r\n          if (this.opts.inherit.onInit) {\r\n            this._regenerateItemsContainerFromInherited();\r\n          }\r\n\r\n          this._registerStoreHandlers();\r\n        }\r\n\r\n        this._registerHandlers();\r\n        break;\r\n\r\n      case 'wordcloud':\r\n        Array.from(this.$items).forEach(($item) => {\r\n          $item.setAttribute('data-keywords-item', 0);\r\n        });\r\n        this._changeSizeOfKeywordItem(this.opts.skala);\r\n        break;\r\n\r\n      default:\r\n        break;\r\n    }\r\n  }\r\n\r\n  _changeSizeOfKeywordItem(maxLevel) {\r\n    maxLevel = maxLevel ? parseInt(maxLevel, 10) : 4;\r\n\r\n    function setNewLevelValue($keyword, number, feedback) {\r\n      const oldValue = parseInt($keyword.getAttribute('data-keywords-item'), 10);\r\n      const newValue = oldValue + number;\r\n      const value = Math.abs(newValue) > maxLevel ? oldValue : newValue;\r\n      $keyword.setAttribute('data-keywords-item', value);\r\n\r\n      feedback();\r\n    }\r\n\r\n    this.$controls.forEach(($control) => {\r\n      const $keyword = $control.parentElement.parentElement;\r\n      const controlFunction = $control.getAttribute('data-keywords-control');\r\n\r\n      switch (controlFunction) {\r\n        case 'minus':\r\n          $control.addEventListener('click', (event) => {\r\n            setNewLevelValue($keyword, -1, this.showFeedback);\r\n            event.preventDefault();\r\n          });\r\n          break;\r\n\r\n        case 'plus':\r\n          $control.addEventListener('click', (event) => {\r\n            setNewLevelValue($keyword, 1, this.showFeedback);\r\n            event.preventDefault();\r\n          });\r\n          break;\r\n\r\n        default:\r\n          break;\r\n      }\r\n    });\r\n  }\r\n\r\n  _regenerateItemsContainerFromInherited() {\r\n    let tempContent = '';\r\n\r\n    this.opts.inherit.from.forEach((id) => {\r\n      const temp = document.getElementById(id).getElementsByClassName(this.opts.itemsContainerClassName)[0].innerHTML;\r\n      // rename ids of the original items to avoid duplicates in the DOM\r\n      tempContent += Keywords.renameItemsIds(id, this.id, temp);\r\n      // console.log(tempContent);\r\n    });\r\n\r\n    this.$itemsContainer.innerHTML = tempContent;\r\n\r\n    this.$items = this.target.getElementsByClassName(this.opts.itemClassName);\r\n\r\n    store.change(\r\n      this.id,\r\n      Keywords._getItemsFromHTML(this.$itemsContainer, this.opts.itemClassName),\r\n      Keywords._getItemsHTML(this.$itemsContainer),\r\n    );\r\n\r\n  }\r\n\r\n  _registerHandlers() {\r\n\r\n    Array.from(this.target.getElementsByClassName(this.opts.itemClassName)).forEach(($item) => {\r\n      $item.addEventListener('click', this._eventHandler.bind(this), true);\r\n    });\r\n\r\n  }\r\n\r\n  _registerStoreHandlers() {\r\n    store.on(actionTypes.keywords.CHANGE, (event, payload) => {\r\n\r\n      const action = payload.action;\r\n      const data = payload.action.data;\r\n\r\n      switch (action.type) {\r\n\r\n        case actionTypes.keywords.CHANGE:\r\n\r\n          // if there are other objects this object inherits items from, update the html\r\n          if (this.opts.inherit.from.indexOf(data.keywordsId) > -1) {\r\n            this._regenerateItemsContainerFromInherited();\r\n\r\n            // regenerate event handlers\r\n            this._registerHandlers();\r\n          }\r\n\r\n          break;\r\n\r\n        default:\r\n          break;\r\n      }\r\n\r\n    });\r\n\r\n  }\r\n\r\n\r\n  _eventHandler(e) {\r\n\r\n    if (e.type === 'click') {\r\n      // console.log(e.target, e.currentTarget);\r\n      __toggleClass(e.currentTarget, 'disabled');\r\n\r\n      store.change(\r\n        this.id,\r\n        Keywords._getItemsFromHTML(this.$itemsContainer, this.opts.itemClassName),\r\n        Keywords._getItemsHTML(this.$itemsContainer),\r\n      );\r\n\r\n      this.showFeedback();\r\n    }\r\n\r\n  }\r\n\r\n}\r\n\r\n\r\nKeywords._getItemFromDOMElement = $item => ({\r\n  class: $item.className,\r\n  id: $item.getAttribute('id'),\r\n  text: $item.innerText,\r\n});\r\n\r\nKeywords._getItemsHTML = $itemsContainer => $itemsContainer.innerHTML;\r\n\r\nKeywords._getItemsFromHTML = ($itemsContainer, itemsClassName) => {\r\n  const $items = $itemsContainer.getElementsByClassName(itemsClassName);\r\n  const itemsArray = [];\r\n\r\n  Array.from($items).forEach(($item) => {\r\n    itemsArray.push(Keywords._getItemFromDOMElement($item));\r\n  });\r\n\r\n\r\n  return itemsArray;\r\n\r\n};\r\n\r\nKeywords._getDOMElementFromItem = (item) => {\r\n\r\n  const newDiv = document.createElement('div');\r\n  newDiv.setAttribute('class', item.class);\r\n  newDiv.setAttribute('id', item.id);\r\n  newDiv.innerHTML = item.text;\r\n\r\n  return __getHTML(newDiv);\r\n\r\n};\r\n\r\nKeywords._getHTMLFromItems = (items) => {\r\n\r\n  let contentHTML = '';\r\n\r\n  items.forEach((item) => {\r\n\r\n    contentHTML += Keywords._getDOMElementFromItem(item);\r\n\r\n  });\r\n\r\n  return contentHTML;\r\n\r\n};\r\n\r\n\r\nKeywords.renameItemsIds = (oldId, newId, itemsHTML) => {\r\n\r\n  const expString = new RegExp(oldId, 'g');\r\n\r\n  return itemsHTML.replace(expString, newId);\r\n\r\n};\r\n\r\nKeywords.defaults = {\r\n  itemsContainerClassName: 'keywords-items-container',\r\n  itemClassName: 'keywords-item',\r\n};\r\n","import { __getHTML } from '../lib/utils';\r\n\r\nimport store from '../store/store';\r\nimport actionTypes from '../store/store-constants';\r\n\r\n// zoom the image\r\nexport default class EditorTagsPlaceholder {\r\n  constructor(element, opts = {}) {\r\n\r\n    this.$element = element;\r\n    this.id = this.$element.getAttribute('id');\r\n\r\n    this.opts = Object.assign({}, EditorTagsPlaceholder.defaults, opts);\r\n\r\n    this.commandNames = JSON.parse(this.$element.getAttribute(this.opts.itemSubscribeAttributeClassName));\r\n    this.$itemsContainer = this.$element.getElementsByClassName(this.opts.itemsContainerClassName)[0];\r\n\r\n  }\r\n\r\n  init() {\r\n\r\n    this._registerStoreHandlers();\r\n\r\n  }\r\n\r\n\r\n  _registerStoreHandlers() {\r\n\r\n    store.on(actionTypes.editor.CHANGE, (event, payload) => {\r\n\r\n      const action = payload.action;\r\n      const data = payload.action.data;\r\n      const tagContainer = data.tagContainer;\r\n\r\n      if (this.commandNames.indexOf(tagContainer.tagName) > -1) {\r\n\r\n        const tags = store.getTagsBy({key: 'tagName', value: this.commandNames});\r\n\r\n        let content = \"\";\r\n\r\n        tags.forEach((tag) => {\r\n\r\n          content += __getHTML( tag.tag );\r\n\r\n        });\r\n\r\n        this.$itemsContainer.innerHTML = content;\r\n\r\n      }\r\n\r\n  });\r\n\r\n  }\r\n\r\n\r\n\r\n}\r\n\r\n\r\n\r\n\r\n\r\nEditorTagsPlaceholder.defaults = {\r\n  itemsContainerClassName: \"editor-tags-placeholder-content\",\r\n  itemSubscribeAttributeClassName: 'data-placeholder-editor-subscribe'\r\n\r\n};\r\n","import { __removeClass, __toggleClass } from '../lib/utils';\r\nimport Component from './component';\r\n// import store from '../store/store';\r\n// import actionTypes from '../store/store-constants';\r\n\r\n\r\nexport default class TestQuiz extends Component {\r\n\r\n  constructor(id, element, opts) {\r\n    super(element);\r\n\r\n    this.id = id;\r\n\r\n    this.opts = Object.assign({}, TestQuiz.defaults, opts);\r\n\r\n    this.$questions = this.target.getElementsByClassName(this.opts.itemClass);\r\n    this.cache = {\r\n      answersCorrect: 0,\r\n      colors: [],\r\n      questions: [],\r\n    };\r\n\r\n    // get colors for all feedback variants\r\n    if (this.opts.zpetnaVazba) {\r\n      this.cache.colors = this.opts.zpetnaVazba.map(feedback => feedback.barva);\r\n    }\r\n  }\r\n\r\n  init() {\r\n    // this._registerStoreHandlers();\r\n    this._registerHandlers();\r\n  }\r\n\r\n  _registerHandlers() {\r\n\r\n    Array.from(this.$questions).forEach(($question, questionIndex) => {\r\n      // all questions are without answer by default\r\n      this.cache.questions.push({ answered: false });\r\n\r\n      const answerCorrect = parseInt($question.getAttribute('data-module-answer'), 10);\r\n      const $answers = Array.from($question.getElementsByClassName(this.opts.optionClass));\r\n\r\n      $answers.forEach(($answer, answerIndex) => {\r\n        $answer.addEventListener('click', () => {\r\n          const $answerCurrent = $answer;\r\n\r\n          // if already selected do nothing\r\n          if ($answerCurrent.classList.contains('selected')) {\r\n            return;\r\n          }\r\n\r\n          // remove the selection\r\n          $answers.forEach($answersItem => __removeClass($answersItem, this.opts.selectedClass));\r\n          // select the clicked one\r\n          __toggleClass($answerCurrent, this.opts.selectedClass);\r\n\r\n          // get sum of all corect answers\r\n          if (this.opts.zpetnaVazba) {\r\n            if (answerIndex === answerCorrect) {\r\n              this.cache.answersCorrect += 1;\r\n            } else if (this.cache.answersCorrect !== 0 && this.cache.questions[questionIndex].answered === true) {\r\n              this.cache.answersCorrect -= 1;\r\n            }\r\n            // loop through all \"zpetnaVazba\" to get the one with the fullfilled condition\r\n            const feedbackActual = this.opts.zpetnaVazba.find(feedback => feedback.podminka.includes(this.cache.answersCorrect));\r\n\r\n            // show the right feedback message\r\n            this.$buttonFeedback.classList.remove(...this.cache.colors);\r\n            this.$buttonFeedback.classList.add(feedbackActual.barva);\r\n            this.$buttonFeedbackText.innerText = feedbackActual.text;\r\n          }\r\n\r\n          // note that this question has been answered (whether true or false)\r\n          this.cache.questions[questionIndex].answered = true;\r\n\r\n          // show OK button with feedback only when all question have been answered\r\n          if (this.cache.questions.find(question => !question.answered) === undefined) {\r\n            this.showFeedback();\r\n          }\r\n\r\n        }, false);\r\n      });\r\n    });\r\n  }\r\n}\r\n\r\nTestQuiz.defaults = {\r\n  itemClass: 'test-quiz-item',\r\n  optionClass: 'option',\r\n  selectedClass: 'selected',\r\n};\r\n","import { __remove } from '../lib/utils';\r\nimport storeGlobal from '../store/store-global';\r\nimport actionTypes from '../store/store-constants';\r\nimport Component from './component';\r\n\r\n\r\nexport default class GenericTable extends Component {\r\n\r\n  constructor($element, opts) {\r\n    super($element);\r\n\r\n    this.id = this.target.id;\r\n    this.opts = Object.assign({}, GenericTable.defaults, opts);\r\n\r\n    this.rowIndex = 0;\r\n\r\n    this.$tableResultBody = this.target.getElementsByClassName('table-body')[0];\r\n\r\n    this.dataSettings = this.opts.data;\r\n\r\n    this.cache = {\r\n      tasksToComplete: 0,\r\n      tasksCompleted: 0,\r\n      tasks: [],\r\n    };\r\n  }\r\n\r\n  init() {\r\n\r\n    if (this.dataSettings.source === 'store') {\r\n      this._registerStoreHandlers();\r\n    }\r\n\r\n    // this._registerHandlers();\r\n  }\r\n\r\n  _registerStoreHandlers() {\r\n\r\n    // register store event handler\r\n    // in tabulkaObecna JSON settings, subscribe is an array, here we need a string of strings separated by spaces\r\n    storeGlobal.on(this.dataSettings.subscribe.join(' '), (event, payload) => {\r\n      const action = payload.action;\r\n      const data = payload.data;\r\n\r\n      switch (action.type) {\r\n\r\n        case actionTypes[event].ADD: {\r\n          this.$tableResultBody.insertAdjacentHTML('beforeend', GenericTable._getRowHTML(data));\r\n\r\n          const $allRows = this.$tableResultBody.querySelectorAll('.table-row');\r\n          const $lastRow = $allRows[$allRows.length - 1];\r\n\r\n          const $newSelects = $lastRow.querySelectorAll('select');\r\n\r\n          this.cache.tasksToComplete += $newSelects.length;\r\n\r\n          Array.from($newSelects).forEach(($select) => {\r\n            this.cache.tasks.push({ answered: false });\r\n            const taskNumber = this.cache.tasks.length - 1;\r\n\r\n            $select.addEventListener('change', () => {\r\n              if (this.cache.tasks[taskNumber].answered === false) {\r\n                this.cache.tasksCompleted += 1;\r\n                this.cache.tasks[taskNumber].answered = true;\r\n              }\r\n              if (this.cache.tasksToComplete === this.cache.tasksCompleted) {\r\n                // show OK button or feedback\r\n                this.showFeedback();\r\n              }\r\n            });\r\n          });\r\n          break;\r\n        }\r\n        case actionTypes[event].DELETE: {\r\n          const $row = document.getElementById(`${data.id}_table`);\r\n          __remove($row);\r\n          this.cache.tasksToComplete -= $row.querySelectorAll('select').length;\r\n          this.cache.tasksCompleted -= $row.querySelectorAll('select').length;\r\n\r\n          if (this.cache.tasksToComplete <= this.cache.tasksCompleted) {\r\n            // show OK button or feedback\r\n            this.showFeedback();\r\n          }\r\n\r\n          break;\r\n        }\r\n        default:\r\n          break;\r\n      }\r\n\r\n    });\r\n\r\n  }\r\n\r\n\r\n}\r\n\r\nGenericTable.defaults = {};\r\n\r\n// data.data.text: editor text name\r\n// data.data.vyraz selected text option text value\r\nGenericTable._getRowHTML = (data) => {\r\n  const tableRowTemplate = `\r\n    <div class=\"table-row\" id=\"${data.id}_table\">\r\n      <div class=\"cell\">${data.data.text}</div>\r\n      <div class=\"cell\">${data.data.vyraz}</div>\r\n      <div class=\"cell\">\r\n        <select id=\"${data.id}-select-osoba\" name=\"osoba\" data-save=\"value\">\r\n          <option>Vyberte osobu</option>\r\n          <option>já</option>\r\n          <option>ty</option>\r\n          <option>on/ona/ono</option>\r\n          <option>my</option>\r\n          <option>vy</option>\r\n          <option>oni/ony/ona</option>\r\n          <option>infinitiv</option>\r\n        </select>\r\n      </div>\r\n      <div class=\"cell\">\r\n        <select id=\"${data.id}-select-zpusob\" name=\"zpusob\" data-save=\"value\">\r\n          <option>Vyberte způsob</option>\r\n          <option>oznamovací</option>\r\n          <option>podmiňovací</option>\r\n          <option>rozkazovací</option>\r\n          <option id=\"select-zpusob-infinitiv\">infinitiv</option>\r\n        </select>\r\n      </div>\r\n    </div>\r\n  `;\r\n\r\n  return tableRowTemplate;\r\n\r\n};\r\n","// [data-fullscreen]\r\nimport Component from './component';\r\n\r\nclass Fullscreen extends Component {\r\n  constructor($element) {\r\n    super($element);\r\n\r\n    this.$fullscreen = document.querySelector('[data-fullscreen=\"target\"]');\r\n    this.$fullscreenImage = this.$fullscreen.querySelector('[data-fullscreen=\"image\"]');\r\n\r\n    this.window = {};\r\n    this.image = {};\r\n\r\n    this.window.width = window.innerWidth;\r\n    this.window.height = window.innerHeight;\r\n    this.window.ratio = this.window.width / this.window.height;\r\n\r\n    this.$fullscreenImage.onload = () => {\r\n      this.image.width = this.$fullscreenImage.naturalWidth;\r\n      this.image.height = this.$fullscreenImage.naturalHeight;\r\n      this.image.ratio = this.image.width / this.image.height;\r\n\r\n      if (this.image.ratio >= this.window.ratio) {\r\n        this.$fullscreenImage.style.width = '100%';\r\n        this.$fullscreenImage.style.height = 'auto';\r\n      } else {\r\n        this.$fullscreenImage.style.width = 'auto';\r\n        this.$fullscreenImage.style.height = `${this.window.height}px`;\r\n      }\r\n    };\r\n\r\n  }\r\n}\r\n\r\nexport default class FullscreenToggle extends Fullscreen {\r\n  constructor($element) {\r\n    super($element);\r\n\r\n    this.target.addEventListener('click', (event) => {\r\n      this.$fullscreenImage.src = this.target.nextElementSibling.src;\r\n      this.$fullscreen.classList.toggle('hidden');\r\n\r\n      this.showFeedback();\r\n\r\n      event.preventDefault();\r\n      event.stopPropagation();\r\n    }, false);\r\n\r\n  }\r\n}\r\n","import Component from './component';\r\n\r\nexport default class UserText extends Component {\r\n  constructor($element) {\r\n    super($element);\r\n    this.$userTexts = this.$slide.querySelectorAll('[data-textarea-target]');\r\n\r\n    this.lengthExpected = {\r\n      min: parseInt(this.target.getAttribute('minlength') === '0' ? 1 : this.target.getAttribute('minlength'), 10),\r\n      avg: null,\r\n      max: parseInt(this.target.getAttribute('maxlength') / 2, 10),\r\n    };\r\n    this.lengthExpected.avg = Math.floor((this.lengthExpected.max - this.lengthExpected.min) / 4 + this.lengthExpected.min);\r\n\r\n    this.cache = {\r\n      answersCorrect: 0,\r\n      colors: [\r\n        'color-red',\r\n        'color-orange',\r\n        'color-green',\r\n      ],\r\n      questions: [],\r\n    };\r\n\r\n    this.sendFeedback();\r\n  }\r\n\r\n  sendFeedback() {\r\n    this.target.addEventListener('keyup', (event) => {\r\n      event.stopPropagation();\r\n\r\n      const valueLength = this.target.value.length;\r\n\r\n      // CONDITION: type three chars at least\r\n      // TODO: should be variable, a paramater from JSON\r\n      this.$buttonFeedback.classList.remove(...this.cache.colors);\r\n      if (valueLength < this.lengthExpected.min) {\r\n        this.$buttonFeedback.classList.add(this.cache.colors[0]);\r\n        this.$buttonFeedbackText.innerText = 'Napiš něco!';\r\n      } else {\r\n\r\n        if (valueLength <= this.lengthExpected.avg) {\r\n          this.$buttonFeedback.classList.add(this.cache.colors[1]);\r\n          this.$buttonFeedbackText.innerText = 'Není toho moc.';\r\n        }\r\n        else if (valueLength > this.lengthExpected.avg) {\r\n          this.$buttonFeedback.classList.add(this.cache.colors[2]);\r\n          this.$buttonFeedbackText.innerText = 'Mám hotovo!';\r\n        }\r\n\r\n        this.target.setAttribute('data-textarea-target', 'success');\r\n        // check if all conditions of the same component on the same slide are met\r\n        const conditionAll = Array.from(this.$userTexts).find($userText => ($userText.getAttribute('data-textarea-target') !== 'success'));\r\n\r\n        if (conditionAll === undefined) {\r\n          // show OK button or feedback\r\n          this.showFeedback();\r\n        }\r\n      }\r\n    });\r\n  }\r\n}\r\n","import Component from '../component';\r\n\r\nexport default class AudioPlayerNormal extends Component {\r\n\r\n  constructor($element) {\r\n    super($element);\r\n\r\n    this.$playButton = this.target.querySelector('[data-player-control]');\r\n    this.$loadWave = this.target.querySelector('[data-audio-wave]');\r\n    this.$leftTime = this.target.querySelector('[data-audio-time-left]');\r\n    this.$audioDuration = this.target.querySelector('[data-audio-time-duration]');\r\n\r\n    this.wavesurfer = WaveSurfer.create({\r\n      container: this.$loadWave,\r\n      waveColor: '#A77977',\r\n      progressColor: '#FCE4E3',\r\n      height: 80,\r\n      responsive: true,\r\n      barWidth: 2,\r\n    });\r\n    this.wavesurfer.load(this.$loadWave.dataset.src);\r\n\r\n    this.initWave();\r\n  }\r\n\r\n  initWave() {\r\n    this.wavesurfer.on('ready', () => {\r\n      this.$leftTime.textContent = '0:00';\r\n      const duration = this.wavesurfer.getDuration();\r\n      const minutes = Math.floor((duration % 3600) / 60);\r\n      const seconds = (`00${Math.floor(duration % 60)}`).slice(-2);\r\n      this.$audioDuration.textContent = `${minutes}:${seconds}`;\r\n\r\n      this.addListenerAfterReady();\r\n    });\r\n  }\r\n\r\n  addListenerAfterReady() {\r\n    this.wavesurfer.on('audioprocess', (time) => {\r\n      const minutes = Math.floor((time % 3600) / 60);\r\n      const seconds = (`00${Math.floor(time % 60)}`).slice(-2);\r\n      this.$leftTime.textContent = `${minutes}:${seconds}`;\r\n    });\r\n\r\n    this.wavesurfer.on('finish', () => {\r\n      this.$playButton.setAttribute('data-player-control', 'paused');\r\n    });\r\n\r\n    this.$playButton.addEventListener('click', () => {\r\n      this.wavesurfer.playPause();\r\n\r\n      if (this.$playButton.getAttribute('data-player-control') === 'paused') {\r\n        this.$playButton.setAttribute('data-player-control', 'playing');\r\n      } else {\r\n        this.$playButton.setAttribute('data-player-control', 'paused');\r\n      }\r\n\r\n      this.showFeedback();\r\n    });\r\n\r\n    // stop audio prehravac kdyz se zapne dalsi slajd\r\n    const $nextSlides = document.querySelectorAll('[data-nav-button]');\r\n    Array.from($nextSlides).forEach(($nextSlide) => {\r\n      $nextSlide.addEventListener('click', () => {\r\n        if (this.$playButton.getAttribute('data-player-control') === 'playing') {\r\n          this.wavesurfer.playPause();\r\n          this.$playButton.setAttribute('data-player-control', 'paused');\r\n        }\r\n      });\r\n    });\r\n\r\n  }\r\n\r\n}\r\n","import AudioPlayer from './audio-player';\r\nimport { getSecondsMinutesFormat } from './media';\r\n\r\nexport default class AudioPlayerSimple extends AudioPlayer {\r\n  constructor($element) {\r\n    super($element);\r\n\r\n    this.$audio = this.target.querySelector('audio');\r\n    this.$timeLeft = this.target.querySelector('[data-audio-time-left]');\r\n    this.$duration = this.target.querySelector('[data-audio-time-duration]');\r\n\r\n    this.$duration.innerText = `/${getSecondsMinutesFormat(this.$audio.duration)}`;\r\n\r\n    AudioPlayer.addEventListeners(this.target, this.showFeedback);\r\n  }\r\n}\r\n","import Component from './component';\r\n\r\nexport default class FakeMap extends Component {\r\n  constructor($element) {\r\n    super($element);\r\n\r\n    this.$buttons = this.target.querySelectorAll('[data-fake-map=\"toggle\"]');\r\n    this.$maps = this.target.querySelectorAll('[data-fake-map=\"map\"]');\r\n    this.lastActiveIndex = 0;\r\n\r\n    this.addEventListenerToButtons();\r\n  }\r\n\r\n  switchMap($button, index) {\r\n    this.$maps[this.lastActiveIndex].classList.remove('active');\r\n    this.$buttons[this.lastActiveIndex].classList.remove('active');\r\n\r\n    this.$maps[index].classList.add('active');\r\n    $button.classList.add('active');\r\n\r\n    this.lastActiveIndex = index;\r\n  }\r\n\r\n  addEventListenerToButtons() {\r\n    this.$buttons.forEach(($button, index) => {\r\n\r\n      $button.addEventListener('click', (event) => {\r\n        this.switchMap($button, index);\r\n        this.showFeedback();\r\n\r\n        event.preventDefault();\r\n      });\r\n\r\n    });\r\n  }\r\n}\r\n","/* eslint-disable no-nested-ternary */\r\nimport Component from '../component';\r\nimport { getSecondsMinutesFormat, mediaEvents } from './media';\r\n\r\nexport default class VideoPlayer extends Component {\r\n  constructor($element, options) {\r\n    super($element);\r\n\r\n    this.$media = this.target.querySelector('video');\r\n    this.options = Object(options);\r\n    this.prefix = this.options.prefix || 'media';\r\n    this.lang = Object(this.options.lang);\r\n    // lang.currentTime\r\n    // lang.play\r\n    // lang.pause\r\n    // lang.minutes\r\n    // lang.seconds\r\n    // lang.leaveFullscreen\r\n    // lang.enterFullscreen\r\n\r\n    this.paused = null;\r\n    this.currentTime = null;\r\n    this.duration = null;\r\n    this.interval = null;\r\n\r\n    this.$document = this.target.ownerDocument;\r\n    this.$controls = this.target.querySelector('.media-player-controls');\r\n    // play/pause toggle\r\n    this.$play = this.$controls.querySelector('[data-player-control]');\r\n    this.$playSymbol = this.$play.querySelector('.media-play-symbol');\r\n    this.$pauseSymbol = this.$play.querySelector('.media-pause-symbol');\r\n    // time slider\r\n    this.$time = this.$controls.querySelector('[data-video-time-progress]');\r\n    this.$timeMeter = this.$time.querySelector('.media-meter.media-time-meter');\r\n    this.$timeRange = this.$time.querySelector('.media-range.media-time-range');\r\n\r\n    // current time text\r\n    this.$currentTimeText = this.$document.createTextNode('');\r\n    this.$currentTime = this.$controls.querySelector('[data-video-time-left]');\r\n    this.$currentTime.appendChild(this.$currentTimeText);\r\n\r\n    // duration time text\r\n    this.durationTime = this.$media.duration;\r\n    this.$durationTime = this.$controls.querySelector('[data-video-time-duration]');\r\n    this.$durationTime.innerText = getSecondsMinutesFormat(this.durationTime);\r\n    this.$durationTime.setAttribute(\r\n      'title',\r\n      `${VideoPlayer.timeToAural(\r\n        this.durationTime,\r\n        this.lang.minutes || 'minutes',\r\n        this.lang.seconds || 'seconds',\r\n      )}`,\r\n    );\r\n\r\n    // fullscreen button\r\n    this.$fullscreen = this.$controls.querySelector(\r\n      '.fullscreen-toggle',\r\n    );\r\n    this.$enterFullscreenSymbol = this.$fullscreen.querySelector(\r\n      '.media-enterFullscreen-symbol',\r\n    );\r\n    this.$leaveFullscreenSymbol = this.$fullscreen.querySelector(\r\n      '.media-leaveFullscreen-symbol',\r\n    );\r\n\r\n    // fullscreen api\r\n    this._fullscreenchange = 'onfullscreenchange' in this.target\r\n      ? 'fullscreenchange'\r\n      : 'onwebkitfullscreenchange' in this.target\r\n        ? 'webkitfullscreenchange'\r\n        : 'onMSFullscreenChange' in this.target\r\n          ? 'MSFullscreenChange'\r\n          : 'fullscreenchange';\r\n\r\n    this._requestFullscreen = this.target.requestFullscreen\r\n    || this.target.webkitRequestFullscreen\r\n    // || this.target.mozRequestFullScreen\r\n    || this.target.msRequestFullscreen;\r\n\r\n    this.onCanPlayStart = this.onCanPlayStart.bind(this);\r\n    this.onLoadStart = this.onLoadStart.bind(this);\r\n    this.onLoadedData = this.onLoadedData.bind(this);\r\n    this.onPlayChange = this.onPlayChange.bind(this);\r\n    this.onTimeChange = this.onTimeChange.bind(this);\r\n    this.onPlayClick = this.onPlayClick.bind(this);\r\n    this.onTimeKeydown = this.onTimeKeydown.bind(this);\r\n    this.onTimeClick = this.onTimeClick.bind(this);\r\n    this.onTimeKeydown = this.onTimeKeydown.bind(this);\r\n    this.onFullscreenClick = this.onFullscreenClick.bind(this);\r\n    this.onFullscreenChange = this.onFullscreenChange.bind(this);\r\n\r\n    // add event listeners\r\n    this.$media.addEventListener('canplaythrough', this.onCanPlayStart);\r\n    this.$media.addEventListener('loadstart', this.onLoadStart);\r\n    this.$media.addEventListener('loadeddata', this.onLoadedData);\r\n    this.$media.addEventListener('pause', this.onPlayChange);\r\n    this.$media.addEventListener('play', this.onPlayChange);\r\n    this.$media.addEventListener('timeupdate', this.onTimeChange);\r\n    this.$controls.addEventListener('click', this.onPlayClick, false);\r\n    // this.$play.addEventListener('click', this.onPlayClick, false);\r\n    this.$play.addEventListener('keydown', this.onTimeKeydown);\r\n    this.$time.addEventListener('click', this.onTimeClick, false);\r\n    this.$time.addEventListener('keydown', this.onTimeKeydown);\r\n    this.$fullscreen.addEventListener('click', this.onFullscreenClick, false);\r\n    // listen for fullscreen changes\r\n    document.addEventListener(\r\n      this._fullscreenchange,\r\n      this.onFullscreenChange,\r\n    );\r\n\r\n    // pointer events from time control\r\n    VideoPlayer.onDrag(this.$time, this.$timeRange, (percentage) => {\r\n      this.$media.currentTime = this.duration * Math.max(0, Math.min(1, percentage));\r\n\r\n      this.onTimeChange();\r\n    });\r\n\r\n    this.onLoadStart();\r\n  }\r\n\r\n  static _fullscreenElement() {\r\n    return document.fullscreenElement\r\n    || document.webkitFullscreenElement\r\n    // || document.mozFullScreenElement\r\n    || document.msFullscreenElement;\r\n  }\r\n\r\n  static _exitFullscreen() {\r\n    return document.exitFullscreen\r\n    || document.webkitCancelFullScreen\r\n    // || document.mozCancelFullScreen\r\n    || document.msExitFullscreen;\r\n  }\r\n\r\n  // when the play state changes\r\n  onPlayChange() {\r\n    if (this.paused !== this.$media.paused) {\r\n      this.paused = this.$media.paused;\r\n\r\n      this.$play.setAttribute(\r\n        'aria-label',\r\n        this.paused ? this.lang.play || 'play' : this.lang.pause || 'pause',\r\n      );\r\n      this.target.setAttribute(\r\n        'data-player-state',\r\n        this.paused ? 'paused' : 'playing',\r\n      );\r\n      this.$playSymbol.setAttribute('aria-hidden', !this.paused);\r\n      this.$pauseSymbol.setAttribute('aria-hidden', this.paused);\r\n\r\n      clearInterval(this.interval);\r\n\r\n      if (!this.paused) {\r\n        // listen for time changes every 30th of a second\r\n        this.interval = setInterval(this.onTimeChange, 34);\r\n      }\r\n\r\n      // dispatch new \"playchange\" event\r\n      this.$media.dispatchEvent(mediaEvents.playchange);\r\n    }\r\n  }\r\n\r\n  // when the time changes\r\n  onTimeChange() {\r\n    if (\r\n      this.currentTime !== this.$media.currentTime\r\n      || this.duration !== this.$media.duration\r\n    ) {\r\n      this.currentTime = this.$media.currentTime;\r\n      this.duration = this.$media.duration || 0;\r\n\r\n      const currentTimePercentage = this.currentTime / this.duration;\r\n      // const currentTimeCode = VideoPlayer.timeToTimecode(this.currentTime);\r\n      const currentTimeCode = getSecondsMinutesFormat(this.currentTime);\r\n      // const remainingTimeCode = VideoPlayer.timeToTimecode(\r\n      //   this.duration - Math.floor(this.currentTime),\r\n      // );\r\n\r\n      if (currentTimeCode !== this.$currentTimeText.nodeValue) {\r\n        this.$currentTimeText.nodeValue = currentTimeCode;\r\n\r\n        this.$currentTime.setAttribute(\r\n          'title',\r\n          `${VideoPlayer.timeToAural(\r\n            this.currentTime,\r\n            this.lang.minutes || 'minutes',\r\n            this.lang.seconds || 'seconds',\r\n          )}`,\r\n        );\r\n      }\r\n\r\n      // if (remainingTimeCode !== this.$remainingTimeText.nodeValue) {\r\n      //   this.$remainingTimeText.nodeValue = remainingTimeCode;\r\n\r\n      //   $(this.$remainingTime, {\r\n      //     title: `${VideoPlayer.timeToAural(\r\n      //       this.duration - this.currentTime,\r\n      //       this.lang.minutes || 'minutes',\r\n      //       this.lang.seconds || 'seconds',\r\n      //     )}`,\r\n      //   });\r\n      // }\r\n\r\n      this.$time.setAttribute('aria-valuenow', this.currentTime);\r\n      this.$time.setAttribute('aria-valuemin', 0);\r\n      this.$time.setAttribute('aria-valuemax', this.duration);\r\n\r\n      this.$timeMeter.style.width = `${currentTimePercentage * 100}%`;\r\n\r\n      // dispatch new \"timechange\" event\r\n      this.$media.dispatchEvent(mediaEvents.timechange);\r\n    }\r\n  }\r\n\r\n  // when media loads for the first time\r\n  onLoadStart() {\r\n    this.$media.removeEventListener('canplaythrough', this.onCanPlayStart);\r\n    this.$media.addEventListener('canplaythrough', this.onCanPlayStart);\r\n\r\n    this.onPlayChange();\r\n    this.onFullscreenChange();\r\n    this.onTimeChange();\r\n  }\r\n\r\n  // when the immediate current playback position is available\r\n  onLoadedData() {\r\n    this.onTimeChange();\r\n  }\r\n\r\n  // when the media can play\r\n  onCanPlayStart() {\r\n    this.$media.removeEventListener('canplaythrough', this.nCanPlayStart);\r\n\r\n    // dispatch new \"canplaystart\" event\r\n    this.$media.dispatchEvent(mediaEvents.canplaystart);\r\n\r\n\r\n    if (!this.paused || this.$media.autoplay) {\r\n      this.$media.play();\r\n    }\r\n  }\r\n\r\n  onFullscreenChange() {\r\n    const isFullscreen = this.target === VideoPlayer._fullscreenElement();\r\n\r\n    this.$fullscreen.setAttribute(\r\n      'aria-label',\r\n      isFullscreen\r\n        ? this.lang.leaveFullscreen || 'leave full screen'\r\n        : this.lang.enterFullscreen || 'enter full screen',\r\n    );\r\n    this.$enterFullscreenSymbol.setAttribute('aria-hidden', isFullscreen);\r\n    this.$leaveFullscreenSymbol.setAttribute('aria-hidden', !isFullscreen);\r\n  }\r\n\r\n  // when the play control is clicked\r\n  onPlayClick(event) {\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n\r\n    this.$media[this.$media.paused ? 'play' : 'pause']();\r\n  }\r\n\r\n  // when the time control\r\n  onTimeClick(event) {\r\n    event.stopPropagation();\r\n\r\n    // handle click if clicked without pointer\r\n    if (!event.pointerType && !event.detail) {\r\n      this.onPlayClick(event);\r\n    }\r\n  }\r\n\r\n  // click from fullscreen control\r\n  onFullscreenClick(event) {\r\n    event.stopPropagation();\r\n\r\n    if (this._requestFullscreen) {\r\n      if (this.target === VideoPlayer._fullscreenElement()) {\r\n        // exit fullscreen\r\n        VideoPlayer._exitFullscreen().call(document);\r\n      } else {\r\n        // enter fullscreen\r\n        this._requestFullscreen.call(this.target);\r\n\r\n        // maintain focus in internet explorer\r\n        this.$fullscreen.focus();\r\n\r\n        // maintain focus in safari\r\n        setTimeout(() => {\r\n          this.$fullscreen.focus();\r\n        }, 200);\r\n      }\r\n    } else if (this.$media.webkitSupportsFullscreen) {\r\n      // iOS allows fullscreen of the video itself\r\n      if (this.$media.webkitDisplayingFullscreen) {\r\n        // exit ios fullscreen\r\n        this.$media.webkitExitFullscreen();\r\n      } else {\r\n        // enter ios fullscreen\r\n        this.$media.webkitEnterFullscreen();\r\n      }\r\n\r\n      this.onFullscreenChange();\r\n    }\r\n  }\r\n\r\n  // keydown from play control or current time control\r\n  onTimeKeydown(event) {\r\n    const { keyCode, shiftKey } = event;\r\n\r\n    // 37: LEFT, 38: UP, 39: RIGHT, 40: DOWN\r\n    if (keyCode >= 37 && keyCode <= 40) {\r\n      event.preventDefault();\r\n\r\n      const offset = keyCode === 37 || keyCode === 39 ? keyCode - 38 : keyCode - 39;\r\n\r\n      this.$media.currentTime = Math.max(\r\n        0,\r\n        Math.min(\r\n          this.$media.duration,\r\n          this.$media.currentTime + offset * (shiftKey ? 10 : 1),\r\n        ),\r\n      );\r\n\r\n      this.onTimeChange();\r\n    }\r\n  }\r\n\r\n  // Handle Drag Ranges\r\n  static onDrag(target, innerTarget, listener) {\r\n    // eslint-disable-line max-params\r\n    const hasPointerEvent = undefined !== target.onpointerup;\r\n    const hasTouchEvent = undefined !== target.ontouchstart;\r\n    const pointerDown = hasPointerEvent\r\n      ? 'pointerdown'\r\n      : hasTouchEvent\r\n        ? 'touchstart'\r\n        : 'mousedown';\r\n    const pointerMove = hasPointerEvent\r\n      ? 'pointermove'\r\n      : hasTouchEvent\r\n        ? 'touchmove'\r\n        : 'mousemove';\r\n    const pointerUp = hasPointerEvent\r\n      ? 'pointerup'\r\n      : hasTouchEvent\r\n        ? 'touchend'\r\n        : 'mouseup';\r\n\r\n    // ...\r\n    const axisProp = 'clientX';\r\n\r\n    let window;\r\n    let start;\r\n    let end;\r\n\r\n    function onpointermove(event) {\r\n      // prevent browser actions on this event\r\n      event.preventDefault();\r\n\r\n      // the pointer coordinate\r\n      const position = axisProp in event\r\n        ? event[axisProp]\r\n        : (event.touches && event.touches[0] && event.touches[0][axisProp])\r\n            || 0;\r\n\r\n      // the percentage of the pointer along the container\r\n      const percentage = (position - start) / (end - start);\r\n\r\n      // call the listener with percentage\r\n      listener(percentage);\r\n    }\r\n\r\n    function onpointerdown(event) {\r\n      // window\r\n      window = target.ownerDocument.defaultView;\r\n\r\n      // client boundaries\r\n      const rect = innerTarget.getBoundingClientRect();\r\n\r\n      // the container start and end coordinates\r\n      start = rect.left;\r\n      end = rect.right;\r\n\r\n      onpointermove(event);\r\n\r\n      window.addEventListener(pointerMove, onpointermove);\r\n      window.addEventListener(pointerUp, onpointerup);\r\n    }\r\n\r\n    function onpointerup() {\r\n      window.removeEventListener(pointerMove, onpointermove);\r\n      window.removeEventListener(pointerUp, onpointerup);\r\n    }\r\n\r\n    // on pointer down\r\n    target.addEventListener(pointerDown, onpointerdown);\r\n  }\r\n\r\n  // Time To Timecode\r\n  // DEPRECATED (media.util)\r\n  // static timeToTimecode(time) {\r\n  //   return `${`0${Math.floor(time / 60)}`.slice(-2)}:${`0${Math.floor(\r\n  //     time % 60,\r\n  //   )}`.slice(-2)}`;\r\n  // }\r\n\r\n  // Time To Aural\r\n  // DEPRECATED (media.util)\r\n  static timeToAural(time, langMinutes, langSeconds) {\r\n    return `${Math.floor(time / 60)} ${langMinutes}, ${Math.floor(\r\n      time % 60,\r\n    )} ${langSeconds}`;\r\n  }\r\n}\r\n","import domLoadComponents from './dom-load';\r\nimport windowLoadComponents from './window-load';\r\n\r\n// The DOMContentLoaded event fires when parsing of the current page is complete. DOMContentLoaded is a great event to use to hookup UI functionality to complex web pages.\r\ndocument.addEventListener('DOMContentLoaded', domLoadComponents, false);\r\n\r\n// The load event fires when all files have finished loading from all resources, including ads and images.\r\nwindow.addEventListener('load', windowLoadComponents, false);\r\n","\r\nconst domLoadComponents = () => {\r\n  console.log('domLoad:components');\r\n\r\n  // instantiate\r\n\r\n  // run\r\n\r\n};\r\n\r\nexport default domLoadComponents;\r\n","/* eslint-disable no-unused-vars */\nimport MagnifyingGlass from './magnifying-glass';\nimport PhotoDetail from './photo-detail';\nimport Sortable from './sortable';\nimport SVG from './svg';\nimport SVGRadialMenu from './svg-lib/svg-radial-menu';\nimport Editor from './editor/editor';\nimport AnalyticalTable from './analytical-table';\nimport Keywords from './keywords';\nimport EditorTagsPlaceholder from './editor-tags-placeholder';\nimport TestQuiz from './test-quiz';\nimport GenericTable from './generic-table';\nimport FullscreenToggle from './fullscreen';\nimport UserText from './user-text';\nimport AudioPlayerNormal from './media/audio-player-normal';\nimport AudioPlayerSimple from './media/audio-player-simple';\nimport FakeMap from './fake-map';\nimport { stopPlayingVideoPlayers } from './media/media';\nimport VideoPlayer from './media/video';\n// import actionTypes from '../store/store-constants';\n// import storeGlobal from '../store/store-global';\n\nconst windowLoadComponents = () => {\n  console.log('windowLoad:components');\n\n  // Video player - normal\n  const $videoPlayers = Array.from(\n    document.querySelectorAll('[data-player-video]'),\n  );\n  if ($videoPlayers.length > 0) {\n    $videoPlayers.forEach(($videoPlayer) => {\n      // console.log('$videoPlayer', $videoPlayer);\n      const videoPlayer = new VideoPlayer($videoPlayer);\n    });\n\n    document.addEventListener('slide.change', () => {\n      stopPlayingVideoPlayers($videoPlayers);\n    });\n  }\n\n  // Audio player - normal\n  const $audioPlayerNormals = Array.from(\n    document.querySelectorAll('[data-player-audio=\"normal\"]'),\n  );\n  if ($audioPlayerNormals.length > 0) {\n    $audioPlayerNormals.forEach(($audioPlayerNormal) => {\n      const audioPlayerNormal = new AudioPlayerNormal($audioPlayerNormal);\n    });\n\n    // TODO > audio-player-normal.js#61\n    // document.addEventListener('slide.change', () => {\n    //   stopPlayingVideoPlayers($audioPlayerNormals);\n    // });\n  }\n\n  // Audio player — simple\n  const $audioPlayerSimples = Array.from(document.querySelectorAll(\n    '[data-player-audio=\"simple\"]',\n  ));\n  if ($audioPlayerSimples.length > 0) {\n    $audioPlayerSimples.forEach(($audioPlayerSimple) => {\n      const audioPlayerSimple = new AudioPlayerSimple($audioPlayerSimple);\n    });\n\n    document.addEventListener('slide.change', () => {\n      stopPlayingVideoPlayers($audioPlayerSimples);\n    });\n  }\n\n  // Fullscreen\n  const $fullscreenToggles = document.querySelectorAll(\n    '[data-fullscreen=\"toggle\"]',\n  );\n  if ($fullscreenToggles.length > 0) {\n    Array.from($fullscreenToggles).forEach(($fullscreenToggle) => {\n      const fullscreenToggle = new FullscreenToggle($fullscreenToggle);\n    });\n  }\n\n  // Magnifying glass\n  const $magnifyingGlass = document.querySelectorAll('[data-lupa-target]');\n  if ($magnifyingGlass.length > 0) {\n    for (let i = 0; i < $magnifyingGlass.length; i += 1) {\n      const magnifyingGlass = new MagnifyingGlass($magnifyingGlass[i]);\n    }\n  }\n\n  // Photo detail\n  const $photoDetails = document.querySelectorAll('[data-photo-detail-target]');\n  if ($photoDetails.length > 0) {\n    for (let i = 0; i < $photoDetails.length; i += 1) {\n      const photoDetail = new PhotoDetail($photoDetails[i]);\n    }\n  }\n\n  // Fake Map\n  const $fakeMaps = document.querySelectorAll('[data-fake-map=\"target\"]');\n  if ($fakeMaps.length > 0) {\n    for (let i = 0; i < $fakeMaps.length; i += 1) {\n      const fakeMap = new FakeMap($fakeMaps[i]);\n    }\n  }\n\n  //\n  // load those only in working mode\n  if (HISTORYLAB.import.done !== true) {\n    // User texts\n    const $userTexts = document.querySelectorAll('[data-textarea-target=\"\"]');\n    if ($userTexts.length > 0) {\n      Array.from($userTexts).forEach(($userText) => {\n        const userText = new UserText($userText);\n      });\n    }\n\n    // Editor\n    const $editors = document.querySelectorAll('[data-editor]');\n    if ($editors.length > 0) {\n      Array.from($editors).forEach(($editor) => {\n        const editor = new Editor($editor);\n      });\n    }\n\n    // Test Quizes\n    const $testQuizs = document.querySelectorAll('[data-target-test-quiz]');\n    if ($testQuizs.length > 0) {\n      Array.from($testQuizs).forEach(($testQuiz) => {\n        const settings = document.querySelector(\n          `[data-test-quiz-id-reference=\"${$testQuiz.getAttribute(\n            'data-test-quiz-id',\n          )}\"]`,\n        );\n\n        const testQuiz = new TestQuiz(\n          $testQuiz.getAttribute('data-test-quiz-id'),\n          $testQuiz,\n          JSON.parse(settings.getAttribute('data-module-settings')),\n        );\n        testQuiz.init();\n      });\n    }\n\n    // Analytical tables\n    const $analyticalTables = document.querySelectorAll(\n      '[data-target-analytical-table]',\n    );\n\n    if ($analyticalTables.length > 0) {\n      Array.from($analyticalTables).forEach(($analyticalTable) => {\n        const settings = document.querySelector(\n          `[data-analytical-table-id-reference=\"${$analyticalTable.getAttribute(\n            'data-analytical-table-id',\n          )}\"]`,\n        );\n        const analyticalTable = new AnalyticalTable(\n          $analyticalTable.getAttribute('data-analytical-table-id'),\n          $analyticalTable,\n          JSON.parse(settings.getAttribute('data-module-settings')),\n        );\n        analyticalTable.init();\n      });\n    }\n\n    // Generic tables\n    const $genericTables = document.querySelectorAll(\n      '[data-target-generic-table]',\n    );\n    if ($genericTables.length > 0) {\n      Array.from($genericTables).forEach(($genericTable) => {\n        const settings = document.querySelector(\n          `[data-generic-table-id-reference=\"${$genericTable.id}\"]`,\n        );\n        const genericTable = new GenericTable(\n          $genericTable,\n          JSON.parse(settings.getAttribute('data-module-settings')),\n        );\n        genericTable.init();\n      });\n    }\n\n    // SVG + Radial menu\n    const $svgs = document.querySelectorAll('[data-svg-target]');\n    if ($svgs.length > 0) {\n      // radial menu\n      const $radialMenu = document.querySelector('[data-radial-menu]');\n      if ($radialMenu) {\n        const radialMenu = new SVGRadialMenu($radialMenu, $svgs);\n      }\n\n      // svgs\n      for (let i = 0; i < $svgs.length; i += 1) {\n        const svg = new SVG($svgs[i]);\n      }\n    }\n\n    // Sortable\n    const $sortables = document.querySelectorAll('[data-sortable-target]');\n    if ($sortables.length > 0) {\n      for (let i = 0; i < $sortables.length; i += 1) {\n        const sortable = new Sortable($sortables[i]);\n      }\n    }\n\n    // Keywords selection\n    const $keywords = document.querySelectorAll('[data-keywords]');\n    if ($keywords.length > 0) {\n      Array.from($keywords).forEach(($keyword) => {\n        const settings = $keyword.hasAttribute('data-module-settings')\n          ? $keyword.getAttribute('data-module-settings')\n          : {};\n        const keywords = new Keywords($keyword, JSON.parse(settings));\n        keywords.init();\n      });\n    }\n\n    // Editor tags placeholders\n    const $editorTagsPlaceholders = document.querySelectorAll(\n      '.editor-tags-placeholder',\n    );\n    if ($editorTagsPlaceholders.length > 0) {\n      Array.from($editorTagsPlaceholders).forEach((item) => {\n        const editorTagsPlaceholder = new EditorTagsPlaceholder(item);\n        editorTagsPlaceholder.init();\n      });\n    }\n  }\n};\n\nexport default windowLoadComponents;\n"],"names":["Component","$element","target","$slide","this","closest","$buttonFeedback","querySelector","$buttonFeedbackText","showFeedback","bind","classList","contains","remove","MagnifyingGlass","document","$canvas","ctx","_this","getContext","_onStart","_onMove","_onEnd","_update","_onResize","zoomGlassSize","targetBCR","zoomed","targetZoomed","x","y","trackingTouch","_addEventListeners","_initCanvas","window","requestAnimationFrame","width","height","dPR","devicePixelRation","style","scale","getBoundingClientRect","event","preventDefault","pageX","touches","pageY","TAU","Math","PI","radius","ratioX","max","min","left","ratioY","top","scaledTargetWidth","scaledTargetHeight","platform","os","family","indexOf","name","shadowColor","shadowBlur","shadowOffsetY","clearRect","fillStyle","beginPath","arc","closePath","fill","save","clip","drawImage","restore","transform","addEventListener","__createNewCustomEvent","options","data","properties","Object","assign","bubbles","CustomEvent","detail","__isObject","item","_typeof","Array","isArray","__insertBefore","newNode","referenceNode","parentNode","insertBefore","__remove","el","removeChild","__getHTML","node","tagName","outerHTML","wrapper","createElement","appendChild","cloneNode","innerHTML","__localPosition","container","pos","d3","mouse","format","__positionTranslated","curTransform","WebKitCSSMatrix","getComputedStyle","webkitTransform","body","pageYOffset","scrollTop","pageXOffset","scrollLeft","offsetLeft","m41","offsetTop","m42","__position","elAttibutes","__toggleClass","element","cls","__hasClass","__removeClass","__addClass","className","elements","classes","_elements","_classes","querySelectorAll","split","i","length","add","j","console","log","replace","RegExp","PhotoDetail","zoomIntensity","targetContainer","parentElement","_onClick","_getImageDimensions","clientX","clientY","positionY","positionX","mediaEvents","playchange","timechange","canplaystart","stopPlayingVideoPlayers","$players","forEach","$player","$media","paused","pause","setAttribute","getSecondsMinutesFormat","seconds","duration","floor","minutes","toString","slice","AudioPlayer","$item","$audio","$playButton","$timeLeft","getAttribute","from","play","stopPropagation","innerText","currentTime","Sortable","items","droppables","placeholder","direction","before","after","x0","y0","x1","y1","dragged","clone","posRel","rect","size","siblings","prev","next","hasAttribute","offsetWidth","offsetHeight","_addPlaceholder","_onOver","right","_onDrop","bottom","_removePlaceholder","_getReference","_addEventListenerToItem","addEventListeners","minHeight","src","img","nextElementSibling","previousElementSibling","SVGDragNDrop","select","raise","classed","diff","attr","toFixed","type","SVGDraw","$svg","callback","sourceEvent","nodeName","line","curve","curveLinear","d","subject","id","active","append","datum","on","dx","dy","push","$thisPath","d3svg","canvas","localPosition","hash","foreignObject","elementPosition","call","drag","start","end","SVGText","maxLength","minLength","svgID","svgGroup","$radialMenu","orientation","focus","updateTextareaHeight","value","SVG","removeItem","$target","scrollHeight","init","svgSpecificActions","_initPath","_initCircle","_setSize","_initComicBubbles","viewbox","maxWidth","_this2","p","renderPath","createCircle","_this3","comicBubbles","selectAll","selected","$parent","allActiveSvgs","svg","deactivate","SVGRadialMenu","$svgs","$radialMenuItems","$colorItems","$textItems","$createTextItem","$removeItem","$tooltip","initialSetUp","menuRadius","parseInt","getPropertyValue","itemRadius","setUpRadialMenuItems","addEventListenersToRadialMenu","activate","deselectItem","filterMenuButtons","showRadialMenu","addEventListenersToRadialMenuItem","$items","_itemsLength","_menuRadius","_itemRadius","_menuOffset","_centerOffset","index","angle","sin","cos","onMouseLeave","hideRadialMenu","action","_this4","createText","changeColor","currentTarget","display","$activeSVG","globalPosition","__globalPosition","$activeRadialMenuItem","positionRadialMenuItems","setTimeout","_this5","mouseLeaveDelay","_this6","clearTimeout","clickedItem","$colorItem","$textItem","selectItem","color","$selected","Observer","_events","events","fn","_split","filter","current_fn","args","actionTypes","editor","ADD_TAG","DELETE_TAG","UPDATE_TAG","CHANGE","keywords","testQuiz","ADD_ANSWER","REMOVE_ANSWER","UPDATE_ANSWER","textOptions","ADD","DELETE","UPDATE","store","_data","tags","tagId","tagExists","tagContainer","_checkTagExists","Error","undefined","userSelectedNodeItems","trigger","splice","editorId","opts","key","selectedTags","objectExists","_checkExists","selectedObjs","Editor","$editor","settings","JSON","parse","__mergeDeep","source","output","keys","defaults","models","passive","interactive","withMenu","totalTagId","hasMenu","selection","lastSelectionSettings","isCollapsed","savedSelectionRange","selectionAttributes","dummyRangeElement","selectionMouseDown","selectionDirection","hasEditableContentChanged","lastPressedKey","hasToolbar","toolbar","originalContent","currentContent","_handlers","wrapLastDeletesTimeoutClass","wrapLastDeletesTimeoutFunction","wrapLastAdditionsTimeoutClass","wrapLastAdditionsTimeoutFunction","isWrappingLastText","isWriting","$groupDeleted","cache","_hasMenu","$menu","getElementsByClassName","menuClass","$menuActions","$menuClose","error","_hasToolbar","canvasClass","funkce","html","text","_generateNewTagGroupClass","$btnReset","registerEditableHandlers","initPreHighlightedTextOptions","handlerFocus","e","keycode","getSelection","keyCode","which","keyName","rangeCount","range","getRangeAt","cloneRange","setStart","startContainer","startOffset","collapse","setEnd","endContainer","endOffset","addedFragmentString","cloneContents","textContent","trim","dummyElementInner","surroundContents","removeAllRanges","addRange","dummyElement","contentEditable","newGeneratedId","_generateNewTagId","$btnClose","closeBtnClass","$nodeElement","_removeNodeKeepTextContent","getElementById","wrapLastDeletesTimeout","textToAddElement","insertNode","setStartAfter","groupDeletedId","$groupInnerDeleted","$groupInnerAdded","$groupAdded","registerMenuHandler","confirm","len","handlerMenuActions","handlerMenuClose","$textOptionsElements","$textOption","selectedClass","storeGlobal","tag","_setmenuDimensions","leftDimensions","topDimensions","menuDimensions","translated","clonedElement","visibility","nextSibling","elDimensions","elPosition","__getRealDimensions","parentTranslatedPosition","parentDimensions","isOverflowAt","menuMargin","toggleMenu","$el","command","commandName","setSelection","anchorOffset","focusOffset","_setSelectionPosition","selectionPosition","selectionDimension","$domEl","extractContents","newTagId","addTag","createTextNode","parentEl","$elClose","toggleClass","clickHandler","$closeBtn","removeEventListener","commentRef","deleteTag","$node","nodePosition","commentMargin","commentTemplate","div","commentDiv","childNodes","nodeRef","commentNewTextarea","commentDivButtonSubmit","getElementsByTagName","commentCommentsContainer","calculatedCommentPosition","_calculateCommentPosition","commentItem","_createCommentForNode","closeBtn","_createCloseBtnForElement","comments","_addCommentHandlerForElement","commentsClass","_extractAndSaveContents","showCommentsOnInit","click","resetBtnClass","nodeSelectedClass","enable","animatedClass","deselectedClass","menu","AnalyticalTable","isAdvanced","rowIndex","tableResult","tableResultBody","tableSelectedItems","tableSelectedItemsBody","activeDragged","_getRowHTML","_getAdvancedRowHTML","_registerStoreHandlers","_registerHandlers","payload","addedTagContainer","casti","sloupce","insertAdjacentHTML","letSecondCaseRunIfSame","_handlerDraggable","prototype","_handlerDrop","dataTransfer","setData","dropEffect","opacity","localName","background","nodeHTML","keywordsId","newItems","newItemsHTML","itemsHTML","Keywords","$controls","$itemsContainer","itemsContainerClassName","inherit","isInherited","itemClassName","_getHTMLFromItems","change","_getItemsFromHTML","_getItemsHTML","onInit","_regenerateItemsContainerFromInherited","_changeSizeOfKeywordItem","skala","maxLevel","setNewLevelValue","$keyword","number","feedback","oldValue","newValue","abs","$control","tempContent","temp","renameItemsIds","_eventHandler","_getItemFromDOMElement","itemsClassName","itemsArray","_getDOMElementFromItem","newDiv","contentHTML","oldId","newId","expString","EditorTagsPlaceholder","commandNames","itemSubscribeAttributeClassName","getTagsBy","content","TestQuiz","$questions","itemClass","answersCorrect","colors","questions","zpetnaVazba","map","barva","$question","questionIndex","answered","answerCorrect","$answers","optionClass","$answer","answerIndex","$answerCurrent","$answersItem","feedbackActual","find","podminka","includes","question","GenericTable","$tableResultBody","dataSettings","tasksToComplete","tasksCompleted","tasks","subscribe","join","$allRows","$newSelects","$select","taskNumber","$row","vyraz","Fullscreen","$fullscreen","$fullscreenImage","image","innerWidth","innerHeight","ratio","onload","naturalWidth","naturalHeight","FullscreenToggle","toggle","UserText","$userTexts","lengthExpected","avg","sendFeedback","valueLength","$userText","AudioPlayerNormal","$loadWave","$leftTime","$audioDuration","wavesurfer","WaveSurfer","create","waveColor","progressColor","responsive","barWidth","load","dataset","initWave","getDuration","addListenerAfterReady","time","playPause","$nextSlides","$nextSlide","AudioPlayerSimple","$duration","FakeMap","$buttons","$maps","lastActiveIndex","addEventListenerToButtons","$button","switchMap","VideoPlayer","prefix","lang","interval","$document","ownerDocument","$play","$playSymbol","$pauseSymbol","$time","$timeMeter","$timeRange","$currentTimeText","$currentTime","durationTime","$durationTime","timeToAural","$enterFullscreenSymbol","$leaveFullscreenSymbol","_fullscreenchange","_requestFullscreen","requestFullscreen","webkitRequestFullscreen","msRequestFullscreen","onCanPlayStart","onLoadStart","onLoadedData","onPlayChange","onTimeChange","onPlayClick","onTimeKeydown","onTimeClick","onFullscreenClick","onFullscreenChange","onDrag","percentage","clearInterval","setInterval","dispatchEvent","currentTimePercentage","currentTimeCode","nodeValue","nCanPlayStart","autoplay","isFullscreen","_fullscreenElement","leaveFullscreen","enterFullscreen","pointerType","_exitFullscreen","webkitSupportsFullscreen","webkitDisplayingFullscreen","webkitExitFullscreen","webkitEnterFullscreen","shiftKey","offset","fullscreenElement","webkitFullscreenElement","msFullscreenElement","exitFullscreen","webkitCancelFullScreen","msExitFullscreen","innerTarget","listener","hasPointerEvent","onpointerup","hasTouchEvent","ontouchstart","pointerDown","pointerMove","pointerUp","axisProp","onpointermove","position","defaultView","langMinutes","langSeconds","$videoPlayers","$videoPlayer","$audioPlayerNormals","$audioPlayerNormal","$audioPlayerSimples","$audioPlayerSimple","$fullscreenToggles","$fullscreenToggle","$magnifyingGlass","$photoDetails","$fakeMaps","HISTORYLAB","done","$editors","$testQuizs","$testQuiz","$analyticalTables","$analyticalTable","$genericTables","$genericTable","$sortables","$keywords","$editorTagsPlaceholders"],"mappings":"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"}