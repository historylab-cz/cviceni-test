{"version":3,"file":"components.build.js","sources":["../../../../src/js/components/dom-load.js","../../../../src/js/components/component.js","../../../../src/js/components/magnifying-glass.js","../../../../src/js/lib/utils.js","../../../../src/js/components/media/media.js","../../../../src/js/components/media/audio-player.js","../../../../src/js/components/svg-lib/svg-dragndrop.js","../../../../src/js/components/svg-lib/svg-draw.js","../../../../src/js/components/svg-lib/svg-text.js","../../../../src/js/components/svg.js","../../../../src/js/components/sortable.js","../../../../src/js/components/svg-lib/svg-radial-menu.js","../../../../src/js/store/observer.js","../../../../src/js/store/store-constants.js","../../../../src/js/store/store.js","../../../../src/js/store/store-global.js","../../../../src/js/components/editor/editor.js","../../../../src/js/components/analytical-table.js","../../../../src/js/store/store-keywords.js","../../../../src/js/components/keywords.js","../../../../src/js/components/editor-tags-placeholder.js","../../../../src/js/components/test-quiz.js","../../../../src/js/components/generic-table.js","../../../../src/js/components/fullscreen.js","../../../../src/js/components/user-text.js","../../../../src/js/components/media/audio-player-normal.js","../../../../src/js/components/media/audio-player-simple.js","../../../../src/js/components/fake-map.js","../../../../src/js/components/media/video.js","../../../../src/js/components/selectable.js","../../../../src/js/components/new-table.js","../../../../src/js/components/draggable.js","../../../../src/js/components/window-load.js","../../../../src/js/components/components.js","../../../../src/js/lib/unsupported-browsers.js"],"sourcesContent":["\nconst domLoadComponents = () => {\n  console.log('domLoad:components');\n\n  // instantiate\n\n  // run\n\n};\n\nexport default domLoadComponents;\n","export default class Component {\n  constructor($element) {\n    this.target = $element;\n    this.$slide = this.target.closest('.slide');\n    this.lang = document.documentElement.getAttribute('lang');\n\n    if (!HISTORYLAB.import.done) {\n\n      if (this.$slide) {\n        this.$buttonFeedback = this.$slide.querySelector('[data-feedback-button]');\n\n        if (this.$buttonFeedback) {\n          this.$buttonFeedbackText = this.$buttonFeedback.querySelector('span');\n        }\n      }\n\n\n      this.showFeedback = this.showFeedback.bind(this);\n    }\n  }\n\n  showFeedback() {\n    if (this.$buttonFeedback && this.$buttonFeedback.classList.contains('button-hidden')) {\n      this.$buttonFeedback.classList.remove('button-hidden');\n    }\n  }\n\n  hideFeedback() {\n    this.$buttonFeedback.classList.add('button-hidden');\n  }\n}\n","import Component from './component';\n\nexport default class MagnifyingGlass extends Component {\n  // https://www.youtube.com/watch?v=e8IwM3iqnL0\n  constructor($element) {\n    super($element);\n    // SVG lupa a ještě dynamicky měnícího se SVG,\n    // který není na počátku známé?\n    // if (el.nodeName === 'svg') {\n    //   console.log('SVG');\n    //   el.children[0].getAttribute('xlink:href')\n    // }\n    this.$element = document.querySelector('[data-lupa]');\n    this.$canvas = document.querySelector('[data-lupa-canvas]');\n    this.ctx = this.$canvas.getContext('2d');\n\n    this._onStart = this._onStart.bind(this);\n    this._onMove = this._onMove.bind(this);\n    this._onEnd = this._onEnd.bind(this);\n    this._update = this._update.bind(this);\n    this._onResize = this._onResize.bind(this);\n\n    this.zoomGlassSize = 230;\n    this.targetBCR = null;\n    this.zoomed = 0;\n    this.targetZoomed = 0;\n\n    this.x = 0;\n    this.y = 0;\n    this.trackingTouch = false;\n\n    this._addEventListeners();\n    this._initCanvas();\n    this._onResize();\n\n    window.requestAnimationFrame(this._update);\n  }\n\n  _initCanvas() {\n    const width = this.zoomGlassSize;\n    const height = this.zoomGlassSize;\n    // if retina makes canvas more dense\n    const dPR = window.devicePixelRation || 1;\n    this.$canvas.width = width * dPR;\n    this.$canvas.height = height * dPR;\n\n    this.$canvas.style.width = `${width}px`;\n    this.$canvas.style.height = `${height}px`;\n\n    this.ctx.scale(dPR, dPR);\n  }\n\n  _onResize() {\n    this.targetBCR = this.target.getBoundingClientRect();\n  }\n\n  _onStart(event) {\n    if (event.target !== this.target) {\n      return;\n    }\n\n    event.preventDefault();\n\n\n    this.x = event.pageX || event.touches[0].pageX;\n    this.y = event.pageY || event.touches[0].pageY;\n\n    this.trackingTouch = true;\n    this.targetZoomed = 1;\n    this.zoomed = 0;\n\n    window.requestAnimationFrame(this._update);\n  }\n\n  _onMove(event) {\n    if (!this.trackingTouch) {\n      return;\n    }\n\n    this.x = event.pageX || event.touches[0].pageX;\n    this.y = event.pageY || event.touches[0].pageY;\n  }\n\n  _onEnd() {\n    if (this.targetZoomed) {\n      // show OK button or feedback\n      this.showFeedback();\n    }\n\n    this.targetZoomed = 0;\n    this.trackingTouch = false;\n  }\n\n  _update() {\n    const TAU = Math.PI * 2;\n    const MAX_RADIUS = 100;\n    const radius = this.zoomed * MAX_RADIUS;\n\n    this.targetBCR = this.target.getBoundingClientRect();\n\n    // local coordinates (ratio <0,1>)\n    const ratioX =\n      // min. 0\n      Math.max(0,\n        // max. 1\n        Math.min(1, ((this.x - this.targetBCR.left) / this.targetBCR.width))\n      );\n    // console.log(ratioX);\n    const ratioY =\n      // min. 0\n      Math.max(0,\n        // max. 1\n        Math.min(1, ((this.y - this.targetBCR.top) / this.targetBCR.height))\n      );\n    // console.log(ratioY);\n\n    // actual zooming (scaling)\n    const imageScale = 2.5;\n    const scaledTargetWidth = this.targetBCR.width * imageScale;\n    const scaledTargetHeight = this.targetBCR.height * imageScale;\n\n    // Firefox on Windows has a bug because of the shadow\n    if (!(platform.os.family.indexOf('Windows') > -1 && platform.name.indexOf('Firefox') > -1)) {\n      // Shadow.\n      this.ctx.shadowColor = 'rgba(0,0,0,0.4)';\n      this.ctx.shadowBlur = 12;\n      this.ctx.shadowOffsetY = 8;\n    }\n\n    // Background.\n    this.ctx.clearRect(0, 0, this.zoomGlassSize, this.zoomGlassSize);\n    this.ctx.fillStyle = '#fff';\n    this.ctx.beginPath();\n    this.ctx.arc(\n      // x\n      this.zoomGlassSize / 2,\n      // y\n      (this.zoomGlassSize - 10) - radius,\n      // radius, startAngle, endAngle\n      radius, 0, TAU);\n    this.ctx.closePath();\n    this.ctx.fill();\n\n    // save the default state (without image)\n    this.ctx.save();\n\n    // Zoomed image.\n    this.ctx.beginPath();\n    this.ctx.arc(\n      // x\n      this.zoomGlassSize / 2,\n      // y\n      (this.zoomGlassSize - 10) - (radius + 1),\n      // radius, startAngle, endAngle\n      radius * 1.03, 0, TAU);\n    this.ctx.clip();\n    this.ctx.closePath();\n    this.ctx.drawImage(this.target,\n      // dx and dy (left and top)\n      (-ratioX * scaledTargetWidth) + (this.zoomGlassSize / 2),\n      (-ratioY * scaledTargetHeight) + (this.zoomGlassSize / 2),\n      // scaled width and height\n      scaledTargetWidth, scaledTargetHeight);\n\n    // go back to default state (without image)\n    // so next update starts fresh\n    this.ctx.restore();\n\n    // Position the parent $element.\n    this.$element.style.transform = `translate(${this.x}px, ${this.y}px)`;\n\n    // Update the zoom value.\n    this.zoomed += (this.targetZoomed - this.zoomed) / 4;\n\n    // Schedule another update if the zoom is fairly non-zero.\n    if (this.zoomed > 0.001) {\n      // if (this.zoomed > 0.001 && this.zoomed < 0.998) {\n      window.requestAnimationFrame(this._update);\n      // } else if (this.zoomed >= 0.998) {\n      //   this.zoomed = 1;\n    } else {\n      this.zoomed = 0;\n    }\n  }\n\n  _addEventListeners() {\n    // touch events\n    document.addEventListener('touchstart', this._onStart);\n    document.addEventListener('touchmove', this._onMove);\n    document.addEventListener('touchend', this._onEnd);\n    // mouse events\n    document.addEventListener('mousedown', this._onStart);\n    document.addEventListener('mousemove', this._onMove);\n    document.addEventListener('mouseup', this._onEnd);\n    // window events\n    window.addEventListener('resize', this._onResize);\n  }\n}\n","// https://stackoverflow.com/questions/901115/how-can-i-get-query-string-values-in-javascript#3855394\nexport function __getQueryStringParams() {\n  const parameters = window.location.search.substr(1).split('&');\n\n  if (parameters === '') {\n    return {};\n  }\n\n  const b = {};\n\n  for (let i = 0; i < parameters.length; i += 1) {\n    const p = parameters[i].split('=', 2);\n\n    if (p.length === 1) {\n      b[p[0]] = '';\n    } else {\n      b[p[0]] = decodeURIComponent(p[1].replace(/\\+/g, ' '));\n    }\n  }\n\n  return b;\n}\n\nexport function __createNewCustomEvent(name, options = {}, data = null) {\n  const defaults = {\n    // https://developer.mozilla.org/en-US/docs/Web/Guide/Events/Creating_and_triggering_events#Event_bubbling\n    bubbles: true,\n    // cancelBubble\n    // stopPropagation()\n    // cancelable\n    // composed\n    // currentTarget\n    // defaultPrevented\n    // preventDefault()\n    // eventPhase\n    // returnValue\n    // preventDefault()\n    // defaultPrevented\n    // target\n    // timeStamp\n    // type\n    // isTrusted\n  };\n\n  const properties = Object.assign(defaults, options);\n\n  return new CustomEvent(name, {\n    detail: data,\n    ...properties,\n  });\n}\n\nexport function __dispatchEvent($element, type, options, payload) {\n  const event = __createNewCustomEvent(type, options, payload);\n  console.log(\"dispatchEvent\", $element, type, options, payload);\n  $element.dispatchEvent(event);\n}\n\n/* https://plainjs.com/javascript/events/trigger-an-event-11/ */\nexport function __triggerEvent(el, type) {\n\n  if ('createEvent' in document) {\n    // modern browsers, IE9+\n    const e = new Event(type);\n    el.dispatchEvent(e);\n  } else {\n    // IE 8\n    const e = document.createEventObject();\n    e.eventType = type;\n    el.fireEvent('on'+e.eventType, e);\n  }\n}\n\nexport function __keycodeIsPrintableCharacter(keycode) {\n\n  const valid =\n    (keycode > 47 && keycode < 58) || // number keys\n    keycode == 32 || keycode == 13 || // spacebar & return key(s) (if you want to allow carriage returns)\n    (keycode > 64 && keycode < 91) || // letter keys\n    (keycode > 95 && keycode < 112) || // numpad keys\n    (keycode > 185 && keycode < 193) || // ;=,-./` (in order)\n    (keycode > 218 && keycode < 223); // [\\]' (in order)\n  // https://stackoverflow.com/questions/12467240/determine-if-javascript-e-keycode-is-a-printable-non-control-character#answer-12467610\n\n  return valid;\n\n}\n\nexport function __isObject(item) {\n  return (item && typeof item === 'object' && !Array.isArray(item));\n}\n\n// https://stackoverflow.com/questions/27936772/how-to-deep-merge-instead-of-shallow-merge\n// Maybe use lodash ? https://lodash.com/docs/4.17.10#defaultsDeep\nexport function __mergeDeep(target, source) {\n  const output = Object.assign({}, target);\n  if (__isObject(target) && __isObject(source)) {\n    Object.keys(source).forEach((key) => {\n      if (__isObject(source[key])) {\n        if (!(key in target)) {\n          Object.assign(output, { [key]: source[key] });\n        } else {\n          output[key] = __mergeDeep(target[key], source[key]);\n        }\n      } else {\n        Object.assign(output, { [key]: source[key] });\n      }\n    });\n  }\n  return output;\n}\n\nexport function __isObjectEmpty(object) {\n  return !Object.keys(object).length;\n}\n\nexport function __insertBefore(newNode, referenceNode) {\n  referenceNode.parentNode.insertBefore(newNode, referenceNode);\n}\n\nexport function __insertAfter(newNode, referenceNode) {\n\n  referenceNode.parentNode.insertBefore(newNode, referenceNode.nextSibling);\n\n}\n\nexport function __getRealDimensions(el, translated = true) {\n\n  const clonedElement = el.cloneNode(true);\n\n  clonedElement.style.visibility = 'hidden';\n  clonedElement.style.display = 'block';\n\n  __insertAfter(clonedElement, el);\n\n  const elDimensions = clonedElement.getBoundingClientRect();\n  const elPosition = (translated) ? __positionTranslated(clonedElement) : __position(clonedElement);\n\n\n  __remove(clonedElement);\n\n  return {\n    width: elDimensions.width,\n    height: elDimensions.height,\n    top: elPosition.top,\n    left: elPosition.left,\n  };\n\n}\n\nexport function __remove(el /* :HTMLElement */) {\n\n  el.parentNode.removeChild(el);\n\n}\n\n\nexport function __getHTML(node) {\n\n  if (!node || !node.tagName) { return; }\n  if (node.outerHTML) { return node.outerHTML; }\n\n  // polyfill:\n  const wrapper = document.createElement('div');\n  wrapper.appendChild(node.cloneNode(true));\n  return wrapper.innerHTML;\n\n}\n\nexport function __getText(el) {\n  return el.innerText || el.textContent;\n}\n\nexport function __globalPosition(event) {\n  // d3.event\n  // The current event, if any. This is set during the invocation of an event listener, and is reset after the listener terminates. Use this to access standard event fields such as event.timeStamp and methods such as event.preventDefault. While you can use the native event.pageX and event.pageY, it is often more convenient to transform the event position to the local coordinate system of the container that received the event using d3.mouse, d3.touch or d3.touches.\n  // If you use Babel, Webpack, or another ES6-to-ES5 bundler, be aware that the value of d3.event changes during an event! An import of d3.event must be a live binding, so you may need to configure the bundler to import from D3’s ES6 modules rather than from the generated UMD bundle; not all bundlers observe jsnext:main. Also beware of conflicts with the window.event global.\n  return {\n    x: event.pageX,\n    y: event.pageY,\n  };\n}\n\nexport function __localPosition(container) {\n  // d3.mouse\n  // Returns the x and y coordinates of the current event relative to the specified container. The container may be an HTML or SVG container element, such as a G element or an SVG element. The coordinates are returned as a two-element array of numbers [x, y].\n  // BUG: d3.mouse doesn’t observe CSS transform on Firefox — https://github.com/d3/d3-selection/issues/81\n  // TEMPORARY FIX: https://github.com/d3/d3-selection/issues/191#issuecomment-474987103\n\n  let position = [];\n\n  if (platform.name === 'Firefox' && d3.event.target.closest('.half-slide-active')) {\n    // this works for Firefox even in transformed container\n    // if (platform.name === 'Firefox')\n    // but creates another bug when used on top of another SVG element (with different viewbox?),\n    // so make temporary fix only of .half-slide-active to fix the orginal bug with new bug\n    // console.log(d3.event.target.closest('.half-slide-active'));\n    position = [\n      d3.event.offsetX,\n      d3.event.offsetY,\n    ];\n  } else {\n    // this works for Chrome\n    position = d3.mouse(container);\n  }\n\n  return {\n    x: d3.format('.0f')(position[0]),\n    y: d3.format('.0f')(position[1]),\n  };\n}\n\nexport function __positionTranslated(el) {\n\n\n  const curTransform = new WebKitCSSMatrix(window.getComputedStyle(el).webkitTransform);\n\n  const body = document.body;\n\n  const scrollTop = window.pageYOffset || body.scrollTop;\n  const scrollLeft = window.pageXOffset || body.scrollLeft;\n\n  return {\n    left: el.offsetLeft + curTransform.m41,\n    top: el.offsetTop + curTransform.m42,\n  };\n\n}\n\nexport function __position(el) {\n\n  const elAttibutes = el.getBoundingClientRect();\n  const body = document.body;\n\n  const scrollTop = window.pageYOffset || body.scrollTop;\n  const scrollLeft = window.pageXOffset || body.scrollLeft;\n\n  return {\n    left: elAttibutes.left + scrollLeft,\n    top: elAttibutes.top + scrollTop,\n    height: elAttibutes.height,\n    width: elAttibutes.width,\n  };\n}\n\n// TODO: check for https://github.com/vladocar/nanoJS/\nexport function __toggleClass(element, cls) {\n  if (__hasClass(element, cls)) {\n    __removeClass(element, cls);\n  } else {\n    __addClass(element, cls);\n  }\n}\n\nexport function __hasClass(element, cls) {\n  // if there are no elements or classes, we're done\n  if (!element || !cls) return false;\n  return (element.classList) ? element.classList.contains(cls) : (`${element.className} `).indexOf(`${cls} `) > -1;\n}\n\nexport function __addClass(elements, classes) {\n  let _elements = elements;\n  let _classes = classes;\n\n  // if there are no elements or classes, we're done\n  if (!_elements || !_classes) { return; }\n\n  if (typeof (_elements) === 'string') {\n    // if we have a selector, get the chosen _elements\n    _elements = document.querySelectorAll(_elements);\n  } else if (_elements.tagName) {\n    // if we have a single DOM element, make it an array to simplify behavior\n    _elements = [_elements];\n  }\n\n  if (typeof (_classes) === 'string') {\n    // make an array from string _classes\n    _classes = _classes.split(' ');\n  } else {\n    console.log('Class argument must be string with spaces in between class names.');\n    return;\n  }\n\n  // add class to all chosen _elements\n  for (let i = 0; i < _elements.length; i += 1) {\n    // check classList support\n    if (_elements[i].classList) {\n      _elements[i].classList.add(..._classes);\n    } else if (!__hasClass(_elements[i], ..._classes)) {\n      for (let j = 0; j < _classes.length; j += 1) {\n        _elements[i].classes += ` ${_classes[j]}`;\n      }\n    }\n  }\n}\n\nexport function __removeClass(elements, classes) {\n  let _elements = elements;\n  let _classes = classes;\n\n  // if there are no elements or classes, we're done\n  if (!_elements || !_classes) { return; }\n\n  if (typeof (_elements) === 'string') {\n    // if we have a selector, get the chosen _elements\n    _elements = document.querySelectorAll(_elements);\n  } else if (_elements.tagName) {\n    // if we have a single DOM element, make it an array to simplify behavior\n    _elements = [_elements];\n  }\n\n  if (typeof (_classes) === 'string') {\n    // make an array from string _classes\n    _classes = _classes.split(' ');\n  } else {\n    console.log('Class argument must be string with spaces in between class names.');\n    return;\n  }\n\n  // remove class from all chosen _elements\n  for (let i = 0; i < _elements.length; i += 1) {\n    // check classList support\n    if (_elements[i].classList) {\n      _elements[i].classList.remove(..._classes);\n    } else {\n      for (let j = 0; j < _classes.length; j += 1) {\n        _elements[i].className = _elements[i].className.replace(new RegExp(`\\\\b${classes[j]}\\\\b`, 'g'), '');\n      }\n    }\n  }\n}\n","import { __createNewCustomEvent } from '../../lib/utils';\n\nconst mediaEvents = {\n  playchange: __createNewCustomEvent('playchange'),\n  timechange: __createNewCustomEvent('timechange'),\n  canplaystart: __createNewCustomEvent('canplaystart'),\n};\n\nfunction stopPlayingVideoPlayers($players) {\n  // pause all other playing media tracks\n  $players.forEach(($player) => {\n    const $media = $player.querySelector('audio') || $player.querySelector('video');\n    if ($media && !$media.paused) {\n      $media.pause();\n      $player\n        .querySelector('[data-player-control]')\n        .setAttribute('data-player-control', 'paused');\n    }\n  });\n}\n\nfunction getSecondsMinutesFormat(seconds) {\n  const duration = {\n    seconds: Math.floor(seconds),\n    minutes: Math.floor(seconds / 60),\n  };\n\n  duration.seconds = (duration.seconds - (duration.minutes * 60)).toString(10);\n\n  return `${duration.minutes}:${(`0${duration.seconds}`).slice(-2)}`;\n}\n\nexport {\n  getSecondsMinutesFormat,\n  stopPlayingVideoPlayers,\n  mediaEvents,\n};\n","import Component from '../component';\nimport { getSecondsMinutesFormat, stopPlayingVideoPlayers } from './media';\n\nexport default class AudioPlayer extends Component {\n  // eslint-disable-next-line no-useless-constructor\n  constructor($element) {\n    super($element);\n  }\n\n  // TODO: move to audio-simple.js\n  static addEventListeners($item, showFeedback) {\n    const $players = document.querySelectorAll('[data-player-audio]');\n    const $audio = $item.querySelector('audio');\n    const $playButton = $item.querySelector('[data-player-control]');\n    const $timeLeft = $item.querySelector('[data-audio-time-left]');\n\n    $playButton.addEventListener('click', (event) => {\n      if ($playButton.getAttribute('data-player-control') === 'paused') {\n        // TODO: abstract\n        stopPlayingVideoPlayers($players);\n        $audio.play();\n        $playButton.setAttribute('data-player-control', 'playing');\n      } else {\n        // TODO: abstract\n        $audio.pause();\n        $playButton.setAttribute('data-player-control', 'paused');\n      }\n\n      showFeedback();\n\n      event.stopPropagation();\n    }, false);\n\n    // do not propagate audio control events higher into the dom\n    $playButton.addEventListener('mousedown', (event) => {\n      event.stopPropagation();\n    }, false);\n\n    $audio.addEventListener('timeupdate', () => {\n      $timeLeft.innerText = getSecondsMinutesFormat($audio.currentTime);\n    });\n\n    $audio.addEventListener('ended', () => {\n      $playButton.setAttribute('data-player-control', 'paused');\n    });\n  }\n}\n","export default class SVGDragNDrop {\n  // static drag(id) {\n  //   d3.drag()\n  //     .on('start', () => {\n  //       SVGDragNDrop.start(id);\n  //     })\n  //     .on('drag', () => {\n  //       SVGDragNDrop.dragged(id);\n  //     })\n  //     .on('end', () => {\n  //       SVGDragNDrop.end(id);\n  //     });\n  // }\n\n  static start(element) {\n    d3.select(element).raise().classed('is-dragged', true);\n  }\n\n  static dragged(element, diff) {\n\n    d3.select(element)\n      .attr('x', (d3.event.x - diff.x).toFixed())\n      .attr('y', (d3.event.y - diff.y).toFixed());\n  }\n\n  static end(element, type, diff) {\n\n    d3.select(element)\n      .attr('x', (d3.event.x - diff.x).toFixed())\n      .attr('y', (d3.event.y - diff.y).toFixed())\n      // neumožňuje v jiných funkcí s tímto objektem dále pracovat,\n      // protože pracují s id\n      // .attr('id', `${type}-${d3.event.x.toFixed()}-${d3.event.y.toFixed()}`)\n      .classed('is-dragged', false);\n  }\n}\n","import { __localPosition, __dispatchEvent } from '../../lib/utils';\n\n// import SVG from '../svg';\nimport SVGDragNDrop from './svg-dragndrop';\nimport SVG from '../svg';\n\nexport default class SVGDraw {\n  // static selectPath(svg) {\n  //   // https://bl.ocks.org/mbostock/8027637\n  // }\n\n  static renderPath($svg, callback) {\n    if (d3.event.sourceEvent.target.nodeName === 'image') {\n\n      const line = d3.line()\n        // removed smooth curve to get rid of loong decimals\n        // see https://github.com/d3/d3-path/issues/10\n        .curve(d3.curveLinear); // _dragStarted\n\n      const format = d3.format('.0f');\n      const d = d3.event.subject;\n      // origin\n      let x0 = format(d3.event.x);\n      let y0 = format(d3.event.y);\n\n      const id = `${$svg.id}_path-${x0}-${y0}`;\n\n      const active = d3.select(`#${$svg.id} .svg-view`).append('svg:path')\n        // .attr('marker-start', 'url('#marker-circle-blue')')\n        // .attr('marker-end', 'url('#marker-arrow-blue')')\n        .attr('data-svg-path', '')\n        .attr('class', 'svg-path')\n        .attr('id', id)\n        .datum(d);\n\n      // github.com/d3/d3-drag#event_on\n      d3.event\n        .on('drag', () => {\n          // current position\n          const x1 = format(d3.event.x);\n          const y1 = format(d3.event.y);\n          // distance from origin\n          const dx = x1 - x0;\n          const dy = y1 - y0;\n\n          // if the distance of drag event is too large, make new origin\n          if ((dx * dx) + (dy * dy) > 300) d.push([x0 = x1, y0 = y1]);\n          // smooth line, correct last point\n          else d[d.length - 1] = [x1, y1];\n\n          active.attr('d', line);\n        })\n        .on('end', () => {\n          const $thisPath = d3.select(`#${id}`);\n          if ($thisPath) {\n            if ($thisPath.attr('d')) {\n              if ($thisPath.attr('d').length < 40) {\n                $thisPath.remove();\n              } else {\n                // dispatch event that svg has changed\n                __dispatchEvent(document, 'svg.change', {}, {\n                  svg: {\n                    id: $svg.id,\n                    task: 'create',\n                    node: $thisPath.node(),\n                    nodeName: $thisPath.node().nodeName,\n                    contextMenu: false,\n                  },\n                });\n              }\n            } else if (!$thisPath.attr('d')) {\n              $thisPath.remove();\n            }\n          }\n\n          callback();\n        });\n\n      // add events to element\n      SVGDraw.pathEventsManager($svg, d3.select(`#${id}`).node());\n    }\n  }\n\n  // Draw a SVG circle on click\n  static createCircle($svg, color = 'blue') {\n    const d3svg = d3.select(`#${$svg.id} .svg-view`);\n    // const canvas = document.querySelector(`#${$svg.id} .svg-view`);\n    const localPosition = __localPosition($svg);\n    const id = `${$svg.id}_circle-${localPosition.x}-${localPosition.y}`;\n\n    // circle wrapper\n    const foreignObject = d3svg.append('svg:foreignObject')\n      .attr('data-svg-circle', '')\n      .attr('id', id)\n      .attr('x', localPosition.x)\n      .attr('y', localPosition.y)\n      .attr('width', 1)\n      .attr('height', 1);\n\n    const circle = foreignObject.append('xhtml:div')\n      .attr('class', 'svg-circle blue');\n\n    const $element = document.querySelector(`#${id}`);\n\n    // add events to element\n    SVGDraw.circleEventsManager($svg, $element);\n\n    // dispatch event that svg has changed\n    __dispatchEvent(document, 'svg.change', {}, {\n      svg: {\n        id: $svg.id,\n        task: 'create',\n        node: $element,\n        nodeName: $element.nodeName,\n        contextMenu: false,\n      },\n    });\n  }\n\n  static pathEventsManager($svg, $element) {\n    d3.select(`#${$element.id}`).on('click', () => {\n      // dispatch event that svg has changed\n      __dispatchEvent(document, 'svg.change', {}, {\n        svg: {\n          id: $svg.id,\n          task: 'remove',\n          node: d3.event.target,\n          nodeName: d3.event.target.nodeName,\n          contextMenu: false,\n        },\n      });\n\n      d3.select(`#${$element.id}`).remove();\n\n      d3.event.preventDefault();\n    }, false);\n  }\n\n  static circleEventsManager($svg, $element) {\n    const $canvas = document.querySelector(`#${$svg.id} .svg-view`);\n\n    // TODO:\n    // standalone function\n    // same for all draggable svg elements\n    let elementPosition = [\n      $element.getAttribute('x'),\n      $element.getAttribute('y'),\n    ];\n    let diff = {};\n\n    const selection = d3.selectAll(`#${$element.id} > div`);\n    d3.select(selection.nodes()[0]).on('click', () => {\n\n      // dispatch event that svg has changed\n      __dispatchEvent(document, 'svg.change', {}, {\n        svg: {\n          id: $svg.id,\n          task: 'remove',\n          node: $element,\n          nodeName: $element.nodeName,\n          contextMenu: false,\n        },\n      });\n\n      // dispatch event that drop item was deleted\n      const idParts = $element.id.split('_');\n      if (idParts[idParts.length - 1] === 'dropItem') {\n        __dispatchEvent(document, 'svg.drop.delete', {}, {\n          item: {\n            id: idParts[1],\n            $object: $element.firstChild,\n          },\n        });\n      }\n\n      d3.event.target.closest('foreignObject').remove();\n    })\n      .call(d3.drag()\n        .container($canvas)\n        .subject($element)\n        .on('start', () => {\n          diff = {\n            x: d3.event.x - elementPosition[0],\n            y: d3.event.y - elementPosition[1],\n          };\n\n          SVGDragNDrop.start($element);\n        })\n        .on('drag', () => {\n          SVGDragNDrop.dragged($element, diff);\n        })\n        .on('end', () => {\n          const oldXCoordinate = elementPosition[0];\n          const oldYCoordinate = elementPosition[1];\n          let taskType = 'move';\n\n          SVGDragNDrop.end($element, 'circle', diff);\n\n          elementPosition = [\n            $element.getAttribute('x'),\n            $element.getAttribute('y'),\n          ];\n\n          // if clone is changed, then dispatch create event\n          if (SVG.removeCloneConnectionManager($element)) taskType = 'create';\n\n          if (elementPosition[0] !== oldXCoordinate || elementPosition[1] !== oldYCoordinate) {\n            // dispatch event that svg has changed\n            __dispatchEvent(document, 'svg.change', {}, {\n              svg: {\n                id: $svg.id,\n                task: taskType,\n                node: $element,\n                nodeName: $element.nodeName,\n                contextMenu: false,\n              },\n            });\n          }\n        }));\n  }\n}\n","import {\n  __addClass,\n  __removeClass,\n  __hasClass,\n  __dispatchEvent,\n} from '../../lib/utils';\n\nimport SVG from '../svg';\nimport SVGDragNDrop from './svg-dragndrop';\n\nexport default class SVGText {\n  static createText(maxLength = 333, minLength = 2) {\n    const $svg = document.querySelector('[data-svg-active=\"true\"]');\n    const svgID = $svg.id;\n    const svgGroup = d3.select($svg).select('.svg-view');\n\n    // const $canvas = $svg.querySelector('.svg-view');\n    const $radialMenu = document.querySelector('[data-radial-menu]');\n    const localPosition = {\n      x: $radialMenu.getAttribute('data-local-x'),\n      y: $radialMenu.getAttribute('data-local-y'),\n    };\n    const id = `${svgID}_svg-text-${localPosition.x}-${localPosition.y}`;\n    const hash = `#${id}`;\n    const orientation = {\n      x: (svgGroup.attr('width') - localPosition.x) > 320 ? 'right' : 'left',\n      y: (svgGroup.attr('height') - localPosition.y) > 60 ? 'bottom' : 'top',\n    };\n    // let firstWrite = true;\n\n    // text wrapper\n    const foreignObject = svgGroup.append('svg:foreignObject')\n      .attr('class', `svg-text orientation-${orientation.x} orientation-${orientation.y}`)\n      .attr('data-svg-text', '')\n      .attr('x', localPosition.x)\n      .attr('y', localPosition.y)\n      .attr('width', 1)\n      .attr('height', 1);\n\n    // create visual point of interest for text input\n    foreignObject.append('xhtml:div')\n      .attr('class', 'svg-circle svg-circle-text');\n    // create text input\n    const textarea = foreignObject.append('xhtml:textarea')\n      .attr('maxlength', maxLength)\n      .attr('tabindex', '-1')\n      .attr('id', id)\n      .attr('class', 'svg-textarea')\n      .attr('data-save', '')\n      .attr('data-svg-textarea-target', svgID);\n\n    // set focus to the new text input\n    $svg.querySelector(hash).focus();\n\n    // add events to element\n    SVGText.textEventsManager($svg, textarea.node(), true, minLength);\n  }\n\n  static textEventsManager($svg, $node, isCreated, minLength = 2) {\n    const $canvas = $svg.querySelector('.svg-view');\n    const hash = `#${$node.id}`;\n    let firstWrite = isCreated;\n    let oldText = $node.value;\n\n    // TODO\n    // standalone function\n    // same for all draggable svg elements\n    const $element = $svg.querySelector(hash).parentElement;\n    let elementPosition = [\n      $element.getAttribute('x'),\n      $element.getAttribute('y'),\n    ];\n    let diff = {};\n\n    d3.select(hash)\n      // drag & drop\n      .call(d3.drag()\n        .container($canvas)\n        .subject($element)\n        .on('start', () => {\n          diff = {\n            x: d3.event.x - elementPosition[0],\n            y: d3.event.y - elementPosition[1],\n          };\n\n          SVGDragNDrop.start($element);\n        })\n        .on('drag', () => {\n          SVGDragNDrop.dragged($element, diff);\n        })\n        .on('end', () => {\n          const oldXCoordinate = elementPosition[0];\n          const oldYCoordinate = elementPosition[1];\n          let taskType = 'move';\n\n          SVGDragNDrop.end($element, 'text', diff);\n\n          elementPosition = [\n            $element.getAttribute('x'),\n            $element.getAttribute('y'),\n          ];\n\n          if (!firstWrite && (elementPosition[0] !== oldXCoordinate || elementPosition[1] !== oldYCoordinate)) {\n            // if clone is changed, then dispatch create event\n            if (SVG.removeCloneConnectionManager($element.childNodes[1])) taskType = 'create';\n\n            // dispatch event that svg has changed\n            __dispatchEvent(document, 'svg.change', {}, {\n              svg: {\n                id: $svg.id,\n                task: taskType,\n                node: $element.childNodes[1],\n                nodeName: $element.childNodes[1].nodeName,\n                contextMenu: false,\n              },\n            });\n          }\n        }))\n      // keystroke\n      // control height of the text input on every key stroke\n      .on('keyup', () => {\n        SVGText.updateTextareaHeight(d3.event.target);\n      })\n      // loss of focus\n      .on('blur', () => {\n        const $target = d3.event.target;\n        const value = $target.value;\n        let taskType;\n        let wrongBool = false;\n\n        if (value.length === 0) {\n          SVG.removeItem(false, hash);\n          return;\n        }\n        if (value.length < minLength) {\n          __addClass($target, 'is-wrong');\n          wrongBool = true;\n        } else if ((value.length >= minLength) && __hasClass($target, 'is-wrong')) {\n          __removeClass($target, 'is-wrong');\n          wrongBool = false;\n        }\n\n        if (oldText !== value) {\n          if (firstWrite) {\n            taskType = 'create';\n            firstWrite = false;\n          } else {\n            taskType = 'change';\n          }\n          oldText = value;\n          // if clone is changed, then dispatch create event\n          if (SVG.removeCloneConnectionManager($target)) taskType = 'create';\n\n          // dispatch event that svg has changed\n          __dispatchEvent(document, 'svg.change', {}, {\n            svg: {\n              id: $svg.id,\n              task: taskType,\n              node: $target,\n              nodeName: $target.nodeName,\n              isWrong: wrongBool,\n              contextMenu: false,\n            },\n          });\n        }\n\n        // update oldText\n        oldText = value;\n      })\n      // gain focus\n      .on('focus', () => {\n        d3.select($element).raise();\n      });\n  }\n\n  static updateTextareaHeight($target) {\n    $target.style.height = '1px';\n    $target.style.height = `${22 + $target.scrollHeight}px`;\n  }\n\n  static comicBubblesEventsManager($svg, $node) {\n    let firstWrite = true;\n    let oldText = $node.value;\n\n    d3.select($node).on('keyup', () => {\n      SVGText.updateTextareaHeight(d3.event.target);\n    })\n      .on('blur', () => {\n        const $target = d3.event.target;\n        const value = $target.value;\n        let taskType;\n\n        if (oldText !== value) {\n          if (firstWrite) {\n            taskType = 'create';\n            firstWrite = false;\n          } else {\n            taskType = 'change';\n            if (value.length === 0) {\n              firstWrite = true;\n            }\n          }\n          oldText = value;\n          // if clone is changed, then dispatch create event\n          if (SVG.removeCloneConnectionManager($target)) taskType = 'create';\n\n          // dispatch event that svg has changed\n          __dispatchEvent(document, 'svg.change', {}, {\n            svg: {\n              id: $svg.id,\n              task: taskType,\n              node: $target,\n              nodeName: $target.nodeName,\n              isBubble: true,\n              contextMenu: false,\n            },\n          });\n        }\n\n        // update oldText\n        oldText = value;\n      });\n  }\n}\n","/**\n * čára:\n *  - nakreslit   ( drag'n'drop )\n *  - smazat      ( left click )\n *  - radial menu ( right click)\n *    - změnit barvu\n *    - smazaní\n *    - textový komentář\n * textové pole:\n *  - vytvořit    ( right click on svg )\n *    - nic => smaže se\n *    - málo znaků => zčervená\n *    - přes řádek textu => zvětší se\n *  - změnit      ( click on and write )\n *  - smazat      ( right click on textarea )\n *  - přenést     ( drag'n'drop )\n *  - radial menu ( right click on mark )\n *    - změnit barvu\n *    - smazaní\n *    - textový komentář\n * značka:\n *  - nakreslit   ( left click on svg )\n *  - přenést     ( drag'n'drop )\n *  - smazat      ( left click on mark )\n *  - radial menu ( right click)\n *    - změnit barvu\n *    - smazaní\n *    - textový komentář\n * komiksová bublina:  ( je již vytvořena předem )\n *  - napsat dovnitř\n *    - nic => zůstane\n *    - přes řádek textu => zvětší se\n */\n/* eslint-disable brace-style */\nimport Component from './component';\nimport { __dispatchEvent, __removeClass, __addClass } from '../lib/utils';\nimport SVGDraw from './svg-lib/svg-draw';\nimport SVGText from './svg-lib/svg-text';\n\nexport default class SVG extends Component {\n  constructor($element) {\n    super($element);\n\n    this.format = d3.format('.0f');\n\n    // fix for IE\n    this._setSize();\n\n    this.init();\n    this._initWhenDone();\n  }\n\n  init() {\n    if (HISTORYLAB.import.done) return;\n\n    // duplicate source of different svg element\n    this.toDuplicate = this.target.getAttribute('data-duplicate-svg');\n\n    // make array from data-attributes (contains what kind of actions can user do on this svg)\n    const svgSpecificActions = this.target.getAttribute('data-svg-target').split(' ');\n    for (let i = 0; i < svgSpecificActions.length; i += 1) {\n      if (svgSpecificActions[i] === 'kresleni') {\n        this._initPath(this.showFeedback);\n      }\n      else if (svgSpecificActions[i] === 'znacky') {\n        this._initCircle(this.showFeedback);\n      }\n      // else if (svgSpecificActions[i] === 'text') {\n      //   this._initText();\n      // }\n    }\n\n    // this._initZoom();\n    // comic bubbles if exists\n    this._initComicBubbles();\n\n    // listen events\n    this._getEvents();\n    this._getDropEvent();\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  _initWhenDone() {\n    if (!HISTORYLAB.import.done) return;\n\n    d3.selectAll('[data-svg-text] textarea')\n      // local context needed because of `this`\n      // eslint-disable-next-line func-names\n      .on('mouseenter', function () {\n        d3.select(this.closest('foreignObject')).raise();\n      });\n  }\n\n  _setSize() {\n    // NOTE: Cannot set `width` because of change of width when on half slide.\n    // TODO: set size on window resize\n\n    // might not be needed when inside sortable or other higher level module\n    // TODO: add condition for other higher level modules\n    // if (this.target.closest('[data-sortable-target')) return false;\n\n    const viewbox = this.target.getAttribute('viewBox').split(' ');\n    const rect = this.target.getBoundingClientRect(); // max-height: 100vh\n\n    const getHeight = () => {\n      if (!rect.height) return viewbox[3];\n\n      if (rect.height > viewbox[3]) return viewbox[3];\n\n      return rect.height;\n    };\n\n    const scale = getHeight() / viewbox[3];\n    const maxWidth = viewbox[2] * scale;\n\n    const getMaxWidthAbsolute = () => {\n      if (matchMedia('screen and (min-width: 1025px)').matches) {\n        return window.innerWidth * .62; // max-width: 62vw\n      }\n\n      return window.innerWidth;\n    };\n\n    const maxWidthAbsolute = getMaxWidthAbsolute();\n\n    const setMaxWidth = scale ? `${maxWidth < maxWidthAbsolute ? maxWidth : maxWidthAbsolute}px` : '';\n\n    this.target.style.maxWidth = setMaxWidth;\n\n    // fix for svg + draggable/gallery (horizontal layout) in Chrome\n    if (\n      this.target.getAttribute('data-svg-drop')\n      && !this.target.closest('.layout-vertical')\n    ) {\n      this.target.closest('.svgs-container').style.maxWidth = setMaxWidth;\n    }\n  }\n\n  // _initZoom() {\n  //   const view = d3.select(`#${this.target.id} .svg-view`);\n  //   const size = [\n  //     view.attr('width'),\n  //     view.attr('height'),\n  //   ];\n  //   SVGZoom.zoom(this.target, view, size);\n  // }\n\n  _initPath(callback) {\n    d3.select(this.target)\n      .call(d3.drag()\n        .container(() => this.target)\n        .subject(() => {\n          const p = [d3.event.x.toFixed(), d3.event.y.toFixed()];\n\n          return [p, p];\n        })\n        .on('start', () => {\n          SVGDraw.renderPath(this.target, callback);\n        }));\n  }\n  // _initText() {\n  //   d3.select(this.target).on('click', () => {\n  //     SVGText.openTextDialog(this.target);\n  //     d3.event.preventDefault();\n  //   });\n  // }\n\n  _initCircle(callback) {\n    d3.select(this.target).on('click', () => {\n      const item = d3.event.target;\n      const nodeName = item.nodeName;\n      const validPlace = (nodeName === 'image');\n      // const isCircle = (__hasClass(item, 'svg-circle'));\n\n      if (!validPlace) {\n        return;\n      }\n\n      SVGDraw.createCircle(this.target);\n      callback();\n\n      d3.event.preventDefault();\n    }, false);\n  }\n\n  _initComicBubbles() {\n    const $comicBubbles = this.target.querySelectorAll('.svg-komiks .svg-textarea');\n\n    if ($comicBubbles) {\n      $comicBubbles.forEach(($comicBubble) => {\n        SVGText.comicBubblesEventsManager(this.target, $comicBubble);\n      });\n    }\n  }\n\n  _generateNewID(oldID) {\n    const idParts = oldID.split('_');\n    // beware if it's a error, return oldID\n    if (idParts.length < 2) {\n      console.log('Svg ID error!', oldID);\n      return oldID;\n    }\n\n    // solve thirt part of id\n    if (idParts[idParts.length - 1] !== `clone-${idParts[0]}`) {\n      idParts.push(`clone-${idParts[0]}`);\n    }\n\n    // solve first part of id\n    idParts[0] = this.target.id;\n\n    const newID = idParts.join('_');\n    return newID;\n  }\n\n  _getEvents() {\n\n    const svgDuplicateSources = this.toDuplicate ? this.toDuplicate.split(' ') : [];\n\n    if (svgDuplicateSources[0]) {\n\n      document.addEventListener('svg.change', (e) => {\n        if (svgDuplicateSources.includes(e.detail.svg.id)) {\n          const $templateNode = e.detail.svg.node;\n          const nodeName = e.detail.svg.nodeName;\n          const localNodeID = this._generateNewID($templateNode.id);\n          let $localNode = this.target.querySelector(`#${localNodeID}`);\n          let task;\n          // for creating new element or we edit the old one after created one\n          if ($localNode || e.detail.svg.task === 'create') {\n            task = e.detail.svg.task;\n          } else {\n            return;\n          }\n\n          /**\n           * 1. divided by node name\n           * 2. divided by task type\n           * path => svg lines\n           * TEXTAREA => text fields or comic bubbles\n           * foreignObject => svg circles\n           */\n          if (nodeName === 'path') {\n            switch (task) {\n              case 'create':\n                this._clonePath($templateNode, localNodeID);\n                break;\n              case 'color':\n                __removeClass($localNode, 'red blue');\n                __addClass($localNode, e.detail.svg.color);\n                break;\n              case 'remove':\n                $localNode.remove();\n                break;\n              default:\n                console.log('Nondefinated path events task. :(');\n            }\n          } else if (nodeName === 'TEXTAREA') {\n            if (e.detail.svg.isBubble) {\n              switch (task) {\n                case 'create':\n                  this._cloneComicBubbles($templateNode, localNodeID);\n                  break;\n                case 'change':\n                  if ($templateNode.value.length !== 0) {\n                    $localNode.value = $templateNode.value;\n                    // if needs resize\n                    if ($localNode.style.height !== $templateNode.style.height) {\n                      $localNode.style.height = $templateNode.style.height;\n                    }\n                  } else {\n                    $localNode.parentElement.remove();\n                  }\n                  break;\n                default:\n                  console.log('Nondefinated comicBubble events task. :(');\n              }\n            } else {\n              switch (task) {\n                case 'create':\n                  this._cloneTextField(e.detail.svg.isWrong, $templateNode, localNodeID);\n                  break;\n                case 'change':\n                  $localNode.value = $templateNode.value;\n                  // if is now wrong lenght\n                  if (e.detail.svg.isWrong) {\n                    __addClass($localNode, 'is-wrong');\n                  } else {\n                    __removeClass($localNode, 'is-wrong');\n                  }\n                  // if needs resize\n                  if ($localNode.style.height !== $templateNode.style.height) {\n                    $localNode.style.height = $templateNode.style.height;\n                  }\n                  break;\n                case 'color':\n                  $localNode = $localNode.parentElement.childNodes[0];\n                  __removeClass($localNode, 'red blue');\n                  __addClass($localNode, e.detail.svg.color);\n                  break;\n                case 'move':\n                  if ($localNode) {\n                    $localNode.parentElement.remove();\n                  }\n                  this._cloneTextField(e.detail.svg.isWrong, $templateNode, localNodeID);\n                  break;\n                case 'remove':\n                  $localNode.parentElement.remove();\n                  break;\n                default:\n                  console.log('Nondefinated textField events task. :(');\n              }\n            }\n          } else if (nodeName === 'foreignObject') {\n            switch (task) {\n              case 'create':\n                this._cloneCircle($templateNode, localNodeID);\n                break;\n              case 'color':\n                $localNode = $localNode.childNodes[0];\n                __removeClass($localNode, 'red blue');\n                __addClass($localNode, e.detail.svg.color);\n                break;\n              case 'move':\n                if ($localNode) {\n                  $localNode.remove();\n                }\n                this._cloneCircle($templateNode, localNodeID);\n                break;\n              case 'remove':\n                $localNode.remove();\n                break;\n              default:\n                console.log('Nondefinated circle events task. :(');\n            }\n          } else {\n            console.log('Nondefinated events nodeName. :(', nodeName);\n          }\n\n          // dispatch event that svg has changed\n          __dispatchEvent(document, 'svg.change', {}, {\n            svg: {\n              id: this.target.id,\n              task: e.detail.svg.task,\n              node: $templateNode,\n              nodeName,\n              contextMenu: false,\n            },\n          });\n        }\n      });\n    }\n  }\n\n  _getDropEvent() {\n    // need if we drop more than one same item\n    let idSalt = 0;\n\n    document.addEventListener('svg.drop', (event) => {\n\n      if (event.detail.svg.id === this.target.id) {\n\n        const { $node, position, type, size } = event.detail.svg;\n\n        const getMultiply = () => {\n          // make images smaller when dropped\n          if (type === 'image' || type === 'svg') return .62;\n          // make tags larger when dropped to not jump on more lines\n          if (type === 'tag') return 1.075;\n\n          return 1;\n        }\n        const multiply = getMultiply();\n\n        size.width = size.width * multiply;\n        size.height = size.height * multiply;\n\n        const $d3canvas = d3.select(`#${this.target.id} .svg-view`);\n        const $d3foreignObject = $d3canvas.append('svg:foreignObject')\n          .attr('width', size.width)\n          .attr('height', size.height)\n          .attr('x', this.format(position[0] - (size.width / 2)))\n          .attr('y', this.format(position[1] - (size.height / 2)))\n          .attr('id', `${this.target.id}_${$node.getAttribute('data-id')}_${idSalt}_dropItem`);\n          // _dropItem is important identifier\n\n        const $dropItem = document.createElement('div');\n        $dropItem.classList.add('dropped__item', `dropped__item--${type}`);\n        $dropItem.appendChild($node.firstElementChild.firstElementChild);\n\n        $d3foreignObject.append(() => $dropItem);\n\n        const $foreignObject = $d3foreignObject.node();\n\n        // increment salt\n        idSalt += 1;\n\n        // add events to element\n        SVGDraw.circleEventsManager(this.target, $foreignObject);\n\n        // dispatch event that svg has changed\n        __dispatchEvent(document, 'svg.change', {}, {\n          svg: {\n            id: this.target.id,\n            task: 'create',\n            node: $foreignObject,\n            nodeName: $foreignObject.nodeName,\n            contextMenu: false,\n          },\n        });\n      }\n    });\n  }\n\n  _clonePath($templateNode, localNodeID) {\n    const $localNode = $templateNode.cloneNode(true);\n    $localNode.id = localNodeID;\n    this.target.appendChild($localNode);\n    // add events to element\n    SVGDraw.pathEventsManager(this.target, $localNode);\n  }\n\n  _cloneTextField(isWrong, $templateNode, localNodeID) {\n    const $localNode = $templateNode.parentElement.cloneNode(true);\n    $localNode.childNodes[1].id = localNodeID;\n    this.target.appendChild($localNode);\n    if (isWrong) {\n      __addClass($localNode, 'is-wrong');\n    } else {\n      __removeClass($localNode, 'is-wrong');\n    }\n    // add events to element\n    SVGText.textEventsManager(this.target, $localNode.childNodes[1], false);\n  }\n\n  _cloneCircle($templateNode, localNodeID) {\n    const $localNode = $templateNode.cloneNode(true);\n    $localNode.id = localNodeID;\n    this.target.appendChild($localNode);\n    // add events to element\n    SVGDraw.circleEventsManager(this.target, $localNode);\n  }\n\n  _cloneComicBubbles($templateNode, localNodeID) {\n    const $localNode = $templateNode.parentElement.cloneNode(true);\n    $localNode.childNodes[1].id = localNodeID;\n    this.target.appendChild($localNode);\n    // add events to element\n    SVGText.comicBubblesEventsManager(this.target, $localNode.childNodes[1]);\n  }\n\n  static selectItem(item) {\n    item.setAttribute('data-svg-selected', 'true');\n  }\n\n  // Remove 'selected' classname from element within SVG\n  static deselectItem() {\n    // previously \"selected\" elements\n    const selected = document.querySelectorAll('[data-svg-selected=\"true\"]');\n    // unselect them\n    for (let i = 0; i < selected.length; i += 1) {\n      selected[i].setAttribute('data-svg-selected', 'false');\n    }\n  }\n\n  // Remove element from within SVG\n  // [data-svg-selected=\"true\"] marks selected element in SVG\n  static removeItem(isRadial, element = '[data-svg-selected=\"true\"]') {\n    let $element = document.querySelector(element);\n    let nodeName = $element.nodeName;\n    const $parent = $element.parentElement; // for <foreignObject>\n\n    // TEXTAREA => text field(right click in textarea)\n    // DIV => text field(click in radial menu) or circle\n    switch (nodeName) {\n      case 'path':\n        // $element = $element;\n        break;\n      case 'TEXTAREA':\n        // $element = $element;\n        break;\n      case 'DIV':\n        if ($parent.childNodes[1]) {\n          $element = $parent.childNodes[1];\n        } else {\n          $element = $parent;\n        }\n        nodeName = $element.nodeName;\n        break;\n      default:\n        console.log('Nondefinated node type. :(', nodeName);\n    }\n\n    // get svg id from object id\n    const svgID = $element.id.split('_')[0];\n\n    // dispatch event that svg has changed\n    __dispatchEvent(document, 'svg.change', {}, {\n      svg: {\n        id: svgID,\n        task: 'remove',\n        node: $element,\n        nodeName,\n        contextMenu: isRadial,\n      },\n    });\n\n    if ($parent.nodeName === 'foreignObject') {\n      d3.select($parent).remove();\n\n      // dispatch event that drop item was deleted\n      const idParts = $parent.id.split('_');\n      if (idParts[idParts.length - 1] === 'dropItem') {\n        __dispatchEvent(document, 'svg.drop.delete', {}, {\n          item: {\n            id: idParts[1],\n            $object: $element.firstChild,\n          },\n        });\n      }\n    } else {\n      d3.select($element).remove();\n    }\n  }\n\n  // Unmark all SVGs with 'svg-active' classname\n  static deactivate() {\n    const allActiveSvgs = document.querySelectorAll('[data-svg-active=\"true\"]');\n    for (let i = 0; i < allActiveSvgs.length; i += 1) {\n      allActiveSvgs[i].setAttribute('data-svg-active', 'false');\n    }\n  }\n\n  // Mark active SVG with 'svg-active' classname\n  static activate(svg) {\n    SVG.deactivate();\n    svg.setAttribute('data-svg-active', 'true');\n  }\n\n  // Remove connection between clone and template\n  // Remove third part of id if exists\n  static removeCloneConnectionManager($node) {\n    const idParts = $node.id.split('_');\n    if (idParts[idParts.length - 1].includes('clone')) {\n      idParts.pop();\n      $node.id = idParts.join('_');\n      return true;\n    }\n    return false;\n  }\n}\n","import Component from './component';\nimport AudioPlayer from './media/audio-player';\nimport SVG from './svg';\nimport { stopPlayingVideoPlayers } from './media/media';\nimport { __dispatchEvent } from '../lib/utils';\n\nexport default class Sortable extends Component {\n  constructor($element) {\n    super($element);\n    this.$settings = document.querySelector(\n      `[data-sortable-id-reference=\"${this.target.id}\"]`,\n    );\n    this.feedback = JSON.parse(this.$settings.getAttribute('data-module-zpetnavazba'));\n    this.$container = this.target;\n    this.$items = this.target.querySelectorAll('[data-sortable-drag]');\n    this.$droppables = this.target.querySelectorAll('[data-sortable-drop]');\n    this.$placeholder = () => document.querySelector('#sortable-placeholder');\n    this.$players = this.$container.querySelectorAll('[data-player-audio]');\n    this.$inheritors = document.querySelectorAll(`[data-sortable-inheritor=${this.target.id}]`);\n    this.inheritors = [];\n    this.order = [];\n\n    // get direction (type of sortable \"horizontalni\" or \"vertikalni\")\n    this.direction = this.target.getAttribute('data-sortable-target');\n    this.trackingTouch = false;\n    this.before = false;\n    this.after = false;\n    this.evaluation = undefined;\n\n    this.mouse = {\n      x: (event) => event.clientX || event.touches[0].clientX,\n      y: (event) => event.clientY || event.touches[0].clientY,\n      x0: 0,\n      y0: 0,\n      x1: 0,\n      y1: 0,\n    };\n\n    this.dragged = {\n      el: null,\n      clone: null,\n      posRel: {},\n      rect: () => this.dragged.el.getBoundingClientRect(),\n      size: {},\n      type: null,\n    };\n\n    this.siblings = {\n      prev: null,\n      next: null,\n    };\n\n    this._onStart = this._onStart.bind(this);\n    this._onMove = this._onMove.bind(this);\n    this._onEnd = this._onEnd.bind(this);\n    this._update = this._update.bind(this);\n\n    this._setupInitialOrder();\n    this._setupInheritors();\n    this._addEventListeners();\n\n\n    this.cache = {\n      answersCorrect: 0,\n      colors: [],\n    };\n\n    // get colors for all feedback variants\n    if (this.feedback) {\n      this.cache.colors = this.feedback.map((feedback) => feedback.barva);\n    }\n  }\n\n  _onStart(event) {\n    if (!event.target.hasAttribute('data-sortable-drag')) {\n      return;\n    }\n\n    // TODO: zastavit všechno audio on drag start\n    if (this.$players.length > 0) {\n      stopPlayingVideoPlayers(this.$players);\n    }\n\n\n    this.trackingTouch = true;\n\n    this.dragged.el = event.target;\n    this.dragged.type = event.target.getAttribute('data-sortable-drag');\n    this.dragged.clone = this.dragged.el.cloneNode(true);\n    this.dragged.posRel.top = this.dragged.el.offsetTop;\n    this.dragged.posRel.left = this.dragged.el.offsetLeft;\n    this.dragged.size.width = this.dragged.el.offsetWidth;\n    this.dragged.size.height = this.dragged.el.offsetHeight;\n\n    this.dragged.el.style.top = `${this.dragged.posRel.top}px`;\n    this.dragged.el.style.left = `${this.dragged.posRel.left}px`;\n    this.dragged.el.style.width = `${this.dragged.size.width}px`;\n    this.dragged.el.style.height = `${this.dragged.size.height}px`;\n    this.dragged.el.classList.add('is-dragged');\n\n    this.$container.classList.add('is-dragged');\n\n    this._addPlaceholder(this.dragged.el);\n    this._onOver();\n\n    this.mouse.x0 = this.mouse.x(event);\n    this.mouse.y0 = this.mouse.y(event);\n\n    event.preventDefault();\n  }\n\n  _onMove(event) {\n    if (!this.trackingTouch) {\n      return;\n    }\n\n    this.mouse.x1 = this.mouse.x(event) - this.mouse.x0;\n    this.mouse.y1 = this.mouse.y(event) - this.mouse.y0;\n\n    window.requestAnimationFrame(this._update);\n\n    this._onOver();\n  }\n\n  _onEnd(event) {\n    if (!this.trackingTouch) {\n      return;\n    }\n\n    this.trackingTouch = false;\n    this.$container.classList.remove('is-dragged');\n    this.dragged.el.classList.remove('is-dragged');\n    this.dragged.el.style.top = '';\n    this.dragged.el.style.left = '';\n    this.dragged.el.style.width = '';\n    this.dragged.el.style.height = '';\n    this.dragged.el.style.transform = '';\n\n    const $placeholder = this.$placeholder();\n    const rect = $placeholder.getBoundingClientRect();\n\n    switch (this.direction) {\n      case 'horizontal':\n        if (rect.left <= this.mouse.x(event) <= rect.right) {\n          this._onDrop();\n        }\n        break;\n      case 'vertical':\n        if (rect.top <= this.mouse.y(event) <= rect.bottom) {\n          this._onDrop();\n        }\n        break;\n\n      default:\n        break;\n    }\n\n    this._removePlaceholder();\n    this._updateOrder();\n    this._updateOrderInInheritors();\n    this._dispatchEvent();\n    this._checkAndResolveFeedback();\n  }\n\n  // _onEnter() {}\n\n  _onOver() {\n    this.before = false;\n    this.after = false;\n\n    this._getReference();\n\n    if (\n      this.siblings.next\n      && this.siblings.next.hasAttribute('data-sortable-drop')\n    ) {\n      const next = this.siblings.next.getBoundingClientRect();\n\n      switch (this.direction) {\n        case 'horizontal':\n          if (this.dragged.rect().right > (next.left + (next.width / 1.5))) {\n            this.after = true;\n            this._addPlaceholder(this.siblings.next);\n          }\n          break;\n        case 'vertical':\n          if (this.dragged.rect().bottom > (next.top + (next.height / 1.5))) {\n            this.after = true;\n            this._addPlaceholder(this.siblings.next);\n          }\n          break;\n\n        default:\n          break;\n      }\n    }\n\n    if (\n      this.siblings.prev\n      && this.siblings.prev.hasAttribute('data-sortable-drop')\n    ) {\n      const prev = this.siblings.prev.getBoundingClientRect();\n\n      switch (this.direction) {\n        case 'horizontal':\n          if (this.dragged.rect().left < (prev.right - (prev.width / 1.5))) {\n            this.before = true;\n            this._addPlaceholder(this.siblings.prev);\n          }\n          break;\n        case 'vertical':\n          if (this.dragged.rect().top < (prev.bottom - (prev.height / 1.5))) {\n            this.before = true;\n            this._addPlaceholder(this.siblings.prev);\n          }\n          break;\n\n        default:\n          break;\n      }\n    }\n  }\n\n  // _onLeave() {}\n\n  _onDrop() {\n    const $placeholder = this.$placeholder();\n\n    this._addEventListenerToItem(this.dragged.clone);\n    // TODO: přiřadit eventListenery audio playerům\n    if (this.dragged.clone.querySelector('[data-player-audio]')) {\n      AudioPlayer.addEventListeners(this.dragged.clone, this.showFeedback);\n    }\n\n    this.$container.insertBefore(this.dragged.clone, $placeholder);\n    this.dragged.el.parentElement.removeChild(this.dragged.el);\n  }\n\n  _update() {\n    this.dragged.el.style.transform = `translate3d(${this.mouse.x1}px, ${\n      this.mouse.y1\n    }px, 0) rotate(5deg)`;\n  }\n\n  _addPlaceholder(item) {\n    this._removePlaceholder();\n\n    const $placeholder = document.createElement('div');\n    $placeholder.classList.add('sortable-item', 'sortable-placeholder');\n    $placeholder.setAttribute('id', 'sortable-placeholder');\n    $placeholder.style.minHeight = `${this.dragged.size.height}px`;\n\n    if (this.dragged.el.querySelector('img')) {\n      const src = this.dragged.el.querySelector('img').getAttribute('src');\n      const img = document.createElement('img');\n      img.setAttribute('src', src);\n      $placeholder.appendChild(img);\n    }\n\n    if (this.after) {\n      this.$container.insertBefore($placeholder, item.nextElementSibling);\n    } else if (this.before) {\n      this.$container.insertBefore($placeholder, item);\n    } else {\n      this.$container.insertBefore($placeholder, item);\n    }\n  }\n\n  _removePlaceholder() {\n    const $placeholder = this.$placeholder();\n    if ($placeholder) $placeholder.parentElement.removeChild($placeholder);\n  }\n\n  _getReference() {\n    const $placeholder = this.$placeholder();\n    this.siblings.prev = $placeholder.previousElementSibling === this.dragged.el\n      ? this.dragged.el.previousElementSibling\n      : $placeholder.previousElementSibling;\n    this.siblings.next = $placeholder.nextElementSibling === this.dragged.el\n      ? this.dragged.el.nextElementSibling\n      : $placeholder.nextElementSibling;\n  }\n\n  _addEventListenerToItem($item) {\n    // touch events\n    $item.addEventListener('touchstart', this._onStart, false);\n    // mouse events\n    $item.addEventListener('mousedown', this._onStart, false);\n\n    if (this.dragged.type === 'svg') {\n      const svg = new SVG($item.querySelector('[data-svg-target]'));\n    }\n  }\n\n  _addEventListeners() {\n    // touch events\n    document.addEventListener('touchmove', this._onMove);\n    document.addEventListener('touchend', this._onEnd);\n    // mouse events\n    document.addEventListener('mousemove', this._onMove);\n    document.addEventListener('mouseup', this._onEnd);\n\n    this.$items.forEach(($item) => {\n      this._addEventListenerToItem($item);\n    });\n  }\n\n  _checkAndResolveFeedback() {\n    if (this.feedback) {\n      this.cache.answersCorrect = 0;\n\n      this.target.querySelectorAll('[data-sortable-drag]').forEach(($item, index) => {\n        const correctAnswerAttr = $item.getAttribute('data-sortable-spravnaodpoved');\n\n        if (parseInt(correctAnswerAttr, 10) === (index + 1)) {\n          this.cache.answersCorrect += 1;\n        }\n      });\n\n      const feedbackActual = this.feedback.find((feedback) => feedback.podminka.includes(this.cache.answersCorrect));\n      this.$buttonFeedback.classList.remove(...this.cache.colors);\n      this.$buttonFeedback.classList.add(feedbackActual.barva);\n      this.$buttonFeedbackText.innerText = feedbackActual.text;\n      this.evaluation = feedbackActual.splneno;\n    }\n\n    this.showFeedback();\n  }\n\n  _setupInitialOrder() {\n    this._updateOrder();\n  }\n\n  _setupInheritors() {\n    if (this.$inheritors.length > 0) {\n      this.inheritors = Array.from(this.$inheritors)\n        .map(($inheritor) => ({\n          $inheritor,\n          $container: $inheritor.querySelector('[data-sortable-inheritor-item]').parentElement,\n        }));\n    }\n  }\n\n  _updateOrder() {\n    this.order = Array.from(this.target.querySelectorAll('[data-sortable-drag]'))\n      .map(($item) => ({ id: parseInt($item.dataset.sortableIndex, 10) }));\n  }\n\n  _updateOrderInInheritors() {\n    if (this.$inheritors.length > 0) {\n      this.inheritors.forEach((inheritor) => {\n        this.order.forEach((item) => {\n          inheritor.$container.appendChild(\n            inheritor.$container.querySelector(`[data-sortable-inheritor-item=\"${item.id}\"]`)\n          );\n        });\n      });\n    }\n  }\n\n  _dispatchEvent() {\n    __dispatchEvent(this.target, 'sortable.change', {}, {\n      id: this.target.id,\n      evaluation: this.evaluation,\n      order: this.order,\n    });\n  }\n}\n","/* eslint-disable brace-style */\nimport {\n  __addClass,\n  __removeClass,\n  __hasClass,\n  __localPosition,\n  __globalPosition,\n  __dispatchEvent,\n} from '../../lib/utils';\nimport SVG from '../svg';\nimport SVGText from './svg-text';\n\nexport default class SVGRadialMenu {\n\n  constructor($radialMenu, $svgs) {\n    this.$radialMenu = $radialMenu;\n    this.$radialMenuItems = this.$radialMenu.querySelectorAll('[data-radial-menu-item]');\n    this.$colorItems = this.$radialMenu.querySelectorAll('.radial-menu-color');\n    this.$textItems = this.$radialMenu.querySelectorAll('.radial-menu-text');\n    this.$createTextItem = this.$radialMenu.querySelector('#create-text');\n    this.$removeItem = this.$radialMenu.querySelector('#remove-content');\n    this.$tooltip = this.$radialMenu.querySelector('[data-radial-menu-tooltip]');\n    this.$svgs = $svgs;\n\n    this.initialSetUp = true;\n\n    this.menuRadius = parseInt(window.getComputedStyle(this.$radialMenu.querySelector('.radial-menu-wrapper'), null).getPropertyValue('width'), 10) / 2;\n    this.itemRadius = parseInt(window.getComputedStyle(this.$radialMenu.querySelector('.radial-menu-item'), null).getPropertyValue('width'), 10) / 2;\n\n    this.init();\n  }\n\n  init() {\n    this.setUpRadialMenuItems();\n    this.addEventListenersToRadialMenu();\n\n    // activate radial menu when right click on svg\n    this.$svgs.forEach(($svg) => {\n      d3.select($svg).on('contextmenu', () => {\n        // mark this SVG as the active one\n        SVG.activate($svg);\n        // deselect all previously selected items\n        SVG.deselectItem();\n        // show radial menu buttons based on clicked element\n        // and .select appropriate elements based on clicked element\n        this.filterMenuButtons(d3.event.target);\n        this.showRadialMenu($svg, d3.event);\n        // prevent default 'contextmenu' event\n        d3.event.preventDefault();\n      });\n    });\n\n    this.initialSetUp = false;\n  }\n\n  setUpRadialMenuItems() {\n    // this.positionRadialMenuItems(this.$radialMenuItems);\n\n    this.$radialMenuItems.forEach(($item) => {\n      this.addEventListenersToRadialMenuItem($item);\n    });\n  }\n\n  positionRadialMenuItems($items) {\n    const _itemsLength = $items.length;\n    const _menuRadius = this.menuRadius;\n    const _itemRadius = this.itemRadius;\n    const _menuOffset = _menuRadius - _itemRadius;\n    const _interval = 0.6283185307;\n    // if more items center them\n    const _centerOffset = (-_interval / 2) + ((_itemsLength * _interval) / 2);\n\n    // make a \"flower\"\n    $items.forEach(($item, index) => {\n      // Calculate the angle at which the element will be placed.\n      // For a semicircle, we would use (index / _itemsLength) * Math.PI.\n      const angle = (Math.PI + ((index * _interval) * -1)) + _centerOffset;\n\n      // get position\n      const x = (_menuRadius * Math.sin(angle)) + _menuOffset;\n      const y = (_menuRadius * Math.cos(angle)) + _menuOffset;\n\n      // console.log('x: ' + x);\n      // console.log('y: ' + y);\n\n      $item.style.left = `${x.toFixed(1)}px`;\n      $item.style.top = `${y.toFixed(1)}px`;\n\n      // if (this.initialSetUp === true) {\n      //   this.addEventListenersToRadialMenuItem($item);\n      // }\n    });\n  }\n\n  addEventListenersToRadialMenu() {\n    this.onMouseLeave();\n\n    this.$radialMenu.addEventListener('click', (event) => {\n      this.hideRadialMenu(this.$radialMenu);\n      event.preventDefault();\n    });\n\n    this.$radialMenu.addEventListener('contextmenu', (event) => {\n      this.hideRadialMenu(this.$radialMenu);\n      event.preventDefault();\n    });\n  }\n\n  addEventListenersToRadialMenuItem(item) {\n    const $item = item;\n\n    // actions\n    const action = $item.getAttribute('data-radial-menu-item');\n    // remove item\n    if (action === 'remove-content') {\n      $item.addEventListener('click', () => {\n        SVG.removeItem(true);\n        this.hideRadialMenu();\n      }, false);\n    }\n    // create user text\n    else if (action === 'create-text') {\n      d3.select($item).on('click', () => {\n        SVGText.createText();\n        this.hideRadialMenu();\n      }, false);\n    }\n    // označit podobnost\n    else if (action === 'color-point-blue') {\n      $item.addEventListener('click', () => {\n        SVGRadialMenu.changeColor('blue');\n        this.hideRadialMenu();\n      }, false);\n    }\n    // označit rozdil\n    else if (action === 'color-point-red') {\n      $item.addEventListener('click', () => {\n        SVGRadialMenu.changeColor('red');\n        this.hideRadialMenu();\n      }, false);\n    }\n    // označit rozdil\n    else if (action === 'color-point-red') {\n      $item.addEventListener('click', () => {\n        SVGRadialMenu.changeColor('red');\n        this.hideRadialMenu();\n      }, false);\n    }\n    // přiřadit kategorii\n    // else if (action === 'category') {\n    //   const category = $item.getAttribute('data-category');\n    //   const categoryLabel = $item.getAttribute('data-radial-menu-item-tooltip');\n\n    //   $item.addEventListener('click', () => {\n    //     const $selected = document.querySelector('[data-svg-selected=\"true\"]');\n    //     const $parentForeignObject = $selected.parentElement;\n    //     let $category = $parentForeignObject.querySelector('.svg-category-label');\n\n    //     $selected.setAttribute('data-svg-category', category);\n\n    //     if (!$category) {\n    //       $category = document.createElement('div');\n    //       $category.classList.add('svg-category-label');\n    //       $parentForeignObject.prepend($category);\n    //     }\n\n    //     $category.innerText = categoryLabel;\n\n    //     this.hideRadialMenu();\n    //   }, false);\n    // }\n\n    // tooltip\n    $item.addEventListener('mouseenter', (event) => {\n      this.$tooltip.innerHTML = event.currentTarget.getAttribute('data-radial-menu-item-tooltip');\n      this.$tooltip.style.display = 'block';\n    }, false);\n    $item.addEventListener('mouseleave', () => {\n      this.$tooltip.innerHTML = '';\n      this.$tooltip.style.display = 'none';\n    }, false);\n  }\n\n  // Draw a SVG circle on click\n  static changeColor(color, element = '[data-svg-selected=\"true\"]') {\n    let $element = document.querySelector(element);\n    let nodeName = $element.nodeName;\n    let taskType = 'color';\n\n    __removeClass($element, 'red blue');\n    __addClass($element, color);\n\n    // DIV => text field  or circle\n    switch (nodeName) {\n      case 'path':\n        // $element = $element;\n        break;\n      case 'DIV':\n        if ($element.parentElement.childNodes[1]) {\n          $element = $element.parentElement.childNodes[1];\n        } else {\n          $element = $element.parentElement;\n        }\n        nodeName = $element.nodeName;\n        break;\n      default:\n        console.log('Nondefinated node type. :(', nodeName);\n    }\n\n    // if clone is changed, then dispatch create event\n    if (SVG.removeCloneConnectionManager($element)) taskType = 'create';\n\n    // get svg id from object id\n    const svgID = $element.id.split('_')[0];\n\n    // dispatch event that svg has changed\n    __dispatchEvent(document, 'svg.change', {}, {\n      svg: {\n        id: svgID,\n        task: taskType,\n        node: $element,\n        nodeName,\n        contextMenu: true,\n        color,\n      },\n    });\n  }\n\n  showRadialMenu($activeSVG, event) {\n    const $svg = $activeSVG || document.querySelector('[data-svg-active=\"true\"]');\n    // get global position of the right click event\n    const globalPosition = __globalPosition(event);\n    const localPosition = __localPosition($svg);\n    this.$radialMenu.setAttribute('data-local-x', localPosition.x);\n    this.$radialMenu.setAttribute('data-local-y', localPosition.y);\n    // set position of radial menu\n    // number of 13 is size of #radial-menu\n    this.$radialMenu.style.top = `${globalPosition.y - 7}px`;\n    this.$radialMenu.style.left = `${globalPosition.x - 7}px`;\n\n    // make a flower\n    const $activeRadialMenuItem = this.$radialMenu.querySelectorAll('.is-active');\n    this.positionRadialMenuItems($activeRadialMenuItem);\n\n    // show radial menu\n    __addClass(this.$radialMenu, 'is-active');\n\n    // return {\n    //   localPosition,\n    //   globalPosition,\n    // };\n  }\n\n  hideRadialMenu() {\n    // hide radial menu\n    __removeClass(this.$radialMenu, 'is-active');\n    // deactivate all SVGs\n    SVG.deactivate();\n    // deselect all SVG items\n    SVG.deselectItem();\n\n    // deactivate radial menu items when the menu is hidden\n    setTimeout(() => {\n      if (!__hasClass(this.$radialMenu, 'is-active')) {\n        this.$radialMenuItems.forEach(($item) => {\n          __removeClass($item, 'is-active');\n        });\n      }\n    }, 150);\n  }\n\n  onMouseLeave() {\n    let mouseLeaveDelay;\n\n    this.$radialMenu.addEventListener('mouseleave', () => {\n      mouseLeaveDelay = setTimeout(() => {\n        this.hideRadialMenu(this.$radialMenu);\n      }, 500);\n    });\n\n    this.$radialMenu.addEventListener('mouseenter', () => {\n      clearTimeout(mouseLeaveDelay);\n    });\n  }\n\n  filterMenuButtons(clickedItem) {\n    if (__hasClass(clickedItem, 'svg-path') || clickedItem.nodeName === 'path') {\n      __addClass(this.$createTextItem, 'is-active');\n      // __addClass(this.$removeItem, 'is-active');\n\n      this.$colorItems.forEach(($colorItem) => {\n        __addClass($colorItem, 'is-active');\n      });\n\n      this.$textItems.forEach(($textItem) => {\n        __removeClass($textItem, 'is-active');\n      });\n\n      // mark it as slected\n      // SVG.selectItem(clickedItem);\n    }\n    if (__hasClass(clickedItem, 'svg-circle')) {\n      __addClass(this.$createTextItem, 'is-active');\n      // __addClass(this.$removeItem, 'is-active');\n\n      this.$colorItems.forEach(($colorItem) => {\n        __addClass($colorItem, 'is-active');\n      });\n\n      this.$textItems.forEach(($textItem) => {\n        __removeClass($textItem, 'is-active');\n      });\n\n      // mark it as slected\n      // SVG.selectItem(clickedItem);\n    }\n    if (__hasClass(clickedItem, 'svg-textarea')) {\n      __removeClass(this.$createTextItem, 'is-active');\n      // __addClass(this.$removeItem, 'is-active');\n\n      if (!__hasClass(clickedItem, 'do-not-remove')) {\n        this.$colorItems.forEach(($colorItem) => {\n          __removeClass($colorItem, 'is-active');\n        });\n\n        this.$textItems.forEach(($textItem) => {\n          __addClass($textItem, 'is-active');\n        });\n      }\n\n      // mark it as slected\n      // SVG.selectItem(clickedItem);\n    }\n    if (clickedItem.nodeName === 'image') {\n      __addClass(this.$createTextItem, 'is-active');\n      __removeClass(this.$removeItem, 'is-active');\n\n      this.$colorItems.forEach(($colorItem) => {\n        __removeClass($colorItem, 'is-active');\n      });\n\n      this.$textItems.forEach(($textItem) => {\n        __removeClass($textItem, 'is-active');\n      });\n    }\n    else {\n      if (__hasClass(clickedItem, 'do-not-remove')) {\n        __removeClass(this.$removeItem, 'is-active');\n      } else {\n        __addClass(this.$createTextItem, 'is-active');\n        __addClass(this.$removeItem, 'is-active');\n      }\n      // mark it as slected\n      SVG.selectItem(clickedItem);\n    }\n  }\n}\n","export default class Observer {\n\n  constructor() {\n    this._events = [];\n  }\n\n  /**\n   * Add event listener\n   *\n   * {String} events - e.g. 'my-event-1 my-event-2'\n   * {Function} fn - event listener\n   */\n  on(events, fn) {\n\n    events = this._split(events);\n\n    events.forEach((event) => {\n\n      if (!this._events[event]) {\n        this._events[event] = [];\n      }\n\n      this._events[event].push(fn);\n    });\n\n  }\n\n  off(events, fn) {\n\n    events = this._split(events);\n\n    events.forEach((event) => {\n\n      if (!this._events[event]) { return; }\n\n      this.events[event] = this._events[event].filter((current_fn) => {\n        return current_fn !== fn;\n      });\n\n    });\n\n\n  }\n\n  // something like dispatchEvent\n  trigger(events, args) {\n\n    events = this._split(events);\n\n    console.log(events, args);\n\n    events.forEach((event) => {\n\n      if (!this._events[event]) { return; }\n\n      this._events[event].forEach((fn) => {\n        fn.call(this, event, args);\n      });\n\n    });\n\n  }\n\n  _split(events) {\n    return events.replace(/^\\s+|\\s+$/g, '').split(/\\s+/);\n  }\n\n}\n","const actionTypes = {\n  editor: {\n    id: 'editor',\n    ADD_TAG: 'editor:ADD_TAG',\n    DELETE_TAG: 'editor:DELETE_TAG',\n    UPDATE_TAG: 'editor:UPDATE_TAG',\n    CHANGE: 'editor:CHANGE',\n  },\n  keywords: {\n    id: 'keywords',\n    CHANGE: 'keywords:CHANGE',\n  },\n  testQuiz: {\n    id: 'testQuiz',\n    ADD_ANSWER: 'testQuiz:ADD_ANSWER',\n    REMOVE_ANSWER: 'testQuiz:REMOVE_ANSWER',\n    UPDATE_ANSWER: 'testQuiz:UPDATE_ANSWER',\n    CHANGE: 'testQuiz:CHANGE',\n  },\n  textOptions: {\n    id: 'textOptions',\n    ADD: 'textOptions:ADD',\n    DELETE: 'textOptions:DELETE',\n    UPDATE: 'textOptions:UPDATE',\n    CHANGE: 'textOptions:CHANGE',\n  },\n  store: {\n    id: 'store',\n    ADD: 'ADD',\n    DELETE: 'DELETE',\n    UPDATE: 'UPDATE',\n    CHANGE: 'CHANGE',\n  },\n};\n\n\nexport default actionTypes;\n","import Observer from './observer';\nimport actionTypes from './store-constants';\n\n/*\nconst tagContainer: Object = {\n  editorId?: number,\n  id: string,\n  tagName: string,\n  tag: HTMLElement,\n  data?: Object\n}\n*/\n\n\nclass Store extends Observer {\n\n  constructor() {\n    super();\n\n    /* here the global space for storing objects and data */\n    this._data = {};\n    this._data.tags = [];\n  }\n\n  _checkTagExists(tagId) {\n    let tagExists = false;\n    this._data.tags.forEach((item, i) => {\n\n      if (item.id === tagId) {\n        tagExists = { item, index: i };\n      }\n\n    });\n\n    return tagExists;\n  }\n\n  addTag(tagContainer) {\n\n    if (this._data.tags.length === 0 || !this._checkTagExists(tagContainer.id)) {\n\n      if (undefined === tagContainer.data.userSelectedNodeItems) {\n        tagContainer.data.userSelectedNodeItems = [];\n      }\n\n      this._data.tags.push(tagContainer);\n\n      store.trigger(actionTypes.editor.CHANGE, {\n        action: {\n          id: actionTypes.editor.id,\n          type: actionTypes.editor.ADD_TAG,\n          data: {\n            tagContainer,\n          },\n        },\n\n      });\n\n    } else {\n      throw new Error('Tag already exists! Will not add it.');\n    }\n\n  }\n\n  deleteTag(tagContainer) {\n\n    let tagExists = this._checkTagExists(tagContainer.id);\n\n    if (tagExists !== false) {\n\n      this._data.tags.splice(tagExists.index, 1);\n\n      store.trigger(actionTypes.editor.CHANGE, {\n        action: {\n          id: actionTypes.editor.id,\n          type: actionTypes.editor.DELETE_TAG,\n          data: {\n            tagContainer: {\n              editorId: tagContainer.editorId,\n              id: tagContainer.id,\n              tagName: tagContainer.tagName,\n              data: {},\n            },\n          },\n        },\n\n      });\n\n      return true;\n    }\n\n    throw new Error('Tag does not exist! Will not delete it.');\n  }\n\n  getAllTags(opts) {\n\n\n    if (undefined === opts || !opts.editorId) { return this._data.tags; }\n\n    const selectedTags = this._data.tags.filter((item) => item.editorId === opts.editorId);\n\n    return selectedTags;\n  }\n\n  getTagsBy(opts) {\n\n    const allowedKeys = ['editorId', 'id', 'tagName'];\n\n    if (opts === undefined) { return false; }\n    if (allowedKeys.indexOf(opts.key) === -1) { return false; }\n\n    if (!Array.isArray(opts.value)) {\n      opts.value = [opts.value];\n    }\n\n    // console.log(opts.value);\n    // console.log(this._data.tags);\n\n    const selectedTags = this._data.tags.filter((item) => (item[opts.key] === opts.value[0]) || (item[opts.key] === opts.value[1]));\n\n    return selectedTags;\n  }\n\n  getLastTag(opts) {\n\n    if (undefined === opts || !opts.editorId) {\n      return this._data.tags[this._data.tags.length - 1];\n    }\n\n    const selectedTags = this._data.tags.filter((item) => item.editorId === opts.editorId);\n\n    return selectedTags[selectedTags.length - 1];\n  }\n}\n\nconst store = new Store();\nexport default store;\n","import Observer from './observer';\nimport actionTypes from './store-constants';\n\nclass StoreGlobal extends Observer {\n\n  constructor() {\n\n    super();\n\n    /* here the global space for storing objects and data */\n    this._data = [];\n\n  }\n\n  _checkExists(id) {\n    let objectExists = false;\n    this._data.forEach((item, i) => {\n\n      if (item.id === id) {\n        objectExists = { item, index: i };\n      }\n\n    });\n\n    return objectExists;\n  }\n\n  add(data) {\n\n    // console.log('add global called');\n\n    if (this._data.length === 0 || !this._checkExists(data.id)) {\n\n      this._data.push(data);\n\n      store.trigger(actionTypes.textOptions.id, {\n        action: {\n          type: actionTypes.textOptions.ADD,\n        },\n        data,\n      });\n\n    } else {\n      throw new Error('Object already exists! Will not add it.');\n    }\n\n  }\n\n  delete(data) {\n\n    const objectExists = this._checkExists(data.id);\n\n    if (objectExists !== false) {\n\n      this._data.splice(objectExists.index, 1);\n\n      store.trigger(actionTypes.textOptions.id, {\n        action: {\n          type: actionTypes.textOptions.DELETE,\n        },\n        data,\n      });\n\n      return true;\n\n    }\n    throw new Error('Tag does not exist! Will not delete it.');\n\n\n  }\n\n  getAll(opts) {\n\n    if (undefined === opts || !opts.editor) { return this._data; }\n\n    const selectedObjs = this._data.filter((item) => item.id === opts.id);\n\n    return selectedObjs;\n  }\n\n  getBy(opts) {\n\n    const allowedKeys = ['id'];\n\n    if ((opts === undefined) || (allowedKeys.indexOf(opts.key) === -1)) {\n      return false;\n    }\n\n    if (!Array.isArray(opts.value)) {\n      opts.value = [opts.value];\n    }\n\n    const selectedObjs = this._data.filter((item) => (item[opts.key] === opts.value[0]) || (item[opts.key] === opts.value[1]));\n\n    return selectedObjs;\n\n  }\n\n  getLast(opts) {\n\n    if (undefined === opts || !opts.editor) {\n      return this._data[this._data.length - 1];\n    }\n\n    const selectedObjs = this._data.filter((item) => item.id === opts.id);\n\n    return selectedObjs[selectedObjs.length - 1];\n  }\n\n}\n\nconst store = new StoreGlobal();\nexport default store;\n","import {\n  __mergeDeep,\n  __hasClass,\n  __addClass,\n  __removeClass,\n  __position,\n  __positionTranslated,\n  __remove,\n  __getRealDimensions,\n  __insertBefore,\n  __keycodeIsPrintableCharacter,\n  __toggleClass,\n  __dispatchEvent,\n} from '../../lib/utils';\nimport store from '../../store/store';\nimport storeGlobal from '../../store/store-global';\nimport Component from '../component';\n// import actionTypes from '../store/store-constants';\n\n\nexport default class Editor extends Component {\n\n  constructor($element) {\n    super($element);\n\n    // TODO: should extend default Component class and use this.target?\n    // this.$editor is better, more readable\n    this.$editor = this.target;\n    this.id = this.$editor.id;\n    // TODO: is DOM element before/after the editor itself.. move it to the editor?\n    this.settings = JSON.parse(document.querySelector(`[data-editor-id-reference=\"${this.id}\"]`).getAttribute('data-module-settings'));\n\n    this.opts = __mergeDeep(Editor.defaults, this.settings);\n\n    this.models = {\n      passive: [\n        'cteni',\n      ],\n      interactive: [\n        'predznaceny', 'zvyraznovani', 'komentáře', 'psani',\n      ],\n      withMenu: [\n        'predznaceny', 'zvyraznovani', 'komentáře',\n      ],\n    };\n\n    this.totalTagId = 0;\n\n    this.hasMenu = true;\n\n    this.selection = null;\n    this.lastSelectionSettings = {};\n    this.isCollapsed = null;\n    this.savedSelectionRange = null;\n    this.selectionAttributes = null;\n    this.dummyRangeElement = null;\n\n    this.selectionMouseDown = false;\n    this.selectionDirection = null;\n\n    this.hasEditableContentChanged = false;\n    this.lastPressedKey = null;\n\n    this.hasToolbar = false;\n    this.toolbar = {};\n\n    this.originalContent = {};\n    this.currentContent = {};\n\n    this._handlers = [];\n\n    this.wrapLastDeletesTimeoutClass = '';\n    this.wrapLastDeletesTimeoutFunction = () => { };\n    this.wrapLastAdditionsTimeoutClass = '';\n    this.wrapLastAdditionsTimeoutFunction = () => { };\n    this.isWrappingLastText = false;\n    this.isWriting = false;\n\n    this.$groupDeleted = null;\n\n    this.cache = {\n      body: document.body,\n      window,\n    };\n\n    this.init();\n  }\n\n  init() {\n    if (Editor._hasMenu(this.opts)) {\n      try {\n        this.$menu = this.$editor.querySelector(`.${this.opts.menuClass}`);\n\n        // TODO: generalize .item class via defaults and opts\n        this.$menuActions = this.$menu.querySelector('.menu').querySelectorAll('.menu-item');\n        this.$menuClose = this.$menu.querySelector('.close');\n      } catch (error) {\n        this.hasMenu = false;\n      }\n    } else {\n      this.hasMenu = false;\n    }\n\n    if (Editor._hasToolbar(this.opts)) {\n      this.hasToolbar = true;\n    }\n\n    this.$canvas = this.$editor.querySelector(`.${this.opts.canvasClass}`);\n\n    // only if the editor is INTERACTIVE\n    if (this.opts.funkce !== 'cteni') {\n      __addClass(this.$menu, 'hidden');\n\n      // only if the editor is for WRITING\n      if (this.opts.funkce === 'psani') {\n        this.originalContent.html = this.$canvas.innerHTML;\n        this.originalContent.text = this.$canvas.innerText;\n        this.currentContent.html = this.$canvas.innerHTML;\n        this.currentContent.text = this.$canvas.innerText;\n\n        this.wrapLastDeletesTimeoutClass = this._generateNewTagGroupClass();\n        this.wrapLastAdditionsTimeoutClass = this._generateNewTagGroupClass();\n      }\n\n      // only if the editor is with extra TOOLBAR\n      if (this.hasToolbar) {\n        this.toolbar.$element = this.$editor.querySelector('.editor-toolbar');\n        this.toolbar.$btnReset = this.toolbar.$element.querySelector('.editor-toolbar-action-reset');\n      }\n\n      this.registerEditableHandlers();\n    }\n\n    // only if the editor is with PREHIGHLIGHTED text\n    if (this.opts.funkce === 'predznaceny') {\n      this.initPreHighlightedTextOptions();\n    }\n\n  }\n\n  _generateNewTagId() {\n    this.totalTagId = this.totalTagId + 1;\n    return `${this.id}-${this.totalTagId}`;\n  }\n\n  _generateNewTagGroupClass() {\n    this.totalTagId = this.totalTagId + 1;\n    return `group-${this.id}-${this.totalTagId}`;\n  }\n\n  // add all eventListeners\n  // TODO: separate special case from universal ones?\n  registerEditableHandlers() {\n\n    this.$canvas.addEventListener('mousedown', this.handlerFocus.bind(this), false);\n    this.$canvas.addEventListener('focusout ', this.handlerFocus.bind(this), false);\n\n    // Necessary when mouseup is outside the $canvas element\n    // therefore we have to capture the event outside the element through body element\n    this.cache.body.addEventListener('mouseup', this.handlerFocus.bind(this), false);\n\n\n    if (this.opts.funkce === 'psani') {\n\n      this.$canvas.addEventListener('keydown', (e) => {\n\n        const selection = window.getSelection();\n        const keyCode = e.which || e.keyCode;\n        let keyName = e.key;\n\n        // show OK button or feedback\n        this.showFeedback();\n\n        // start DELETE\n        if (keyName === 'Backspace' || keyName === 'Delete') {\n          if (selection.rangeCount) {\n            window.clearTimeout(this.wrapLastDeletesTimeoutFunction);\n\n            const range = selection.getRangeAt(0);\n            const cloneRange = range.cloneRange();\n\n            if (this.lastSelectionSettings.isCollapsed) {\n\n              try {\n                cloneRange.setStart(range.startContainer, range.startOffset - 1);\n              } catch (e) {\n                // backspace was pressed at the beginning of the node\n                cloneRange.setStart(range.startContainer, range.startOffset);\n                cloneRange.collapse(true);\n              }\n\n            } else {\n              cloneRange.setStart(range.startContainer, range.startOffset);\n\n            }\n\n            cloneRange.setEnd(range.endContainer, range.endOffset);\n\n            // do nothing when it's space\n            const addedFragment = cloneRange.cloneContents();\n            const addedFragmentString = addedFragment.textContent.trim();\n\n            if ((addedFragmentString !== '' && addedFragmentString !== '&nbsp;') || this.isWrappingLastText) {\n\n              const dummyElementInner = document.createElement('span');\n              dummyElementInner.className = `user-removed-text-inner ${this.wrapLastDeletesTimeoutClass}`;\n\n              cloneRange.surroundContents(dummyElementInner);\n\n              selection.removeAllRanges();\n              selection.addRange(range);\n\n              this.wrapLastDeletesTimeoutFunction = setTimeout(() => {\n\n                this.isWrappingLastText = false;\n\n                // wrap all previous deletes to one element\n                const dummyElement = document.createElement('span');\n                dummyElement.contentEditable = false;\n                dummyElement.className = 'user-removed-text';\n\n                const newGeneratedId = this._generateNewTagId();\n                dummyElement.id = newGeneratedId;\n\n                const $elements = document.querySelectorAll(`.${this.wrapLastDeletesTimeoutClass}`);\n\n                __insertBefore(dummyElement, $elements[0]);\n\n                $elements.forEach((el, i) => {\n                  dummyElement.appendChild(el);\n                });\n\n\n                // create close button\n                const $btnClose = document.createElement('span');\n                $btnClose.className = this.opts.closeBtnClass;\n\n                const clickHandler = (e) => {\n                  const $nodeElement = e.currentTarget.parentNode;\n                  this._removeNodeKeepTextContent($nodeElement);\n                  e.stopPropagation();\n                };\n\n                $btnClose.addEventListener('click', clickHandler.bind(this));\n\n                document.getElementById(newGeneratedId).appendChild($btnClose);\n\n                this.wrapLastDeletesTimeout = true;\n                this.wrapLastDeletesTimeoutClass = this._generateNewTagGroupClass();\n\n              }, 700);\n\n              this.isWrappingLastText = true;\n\n              e.preventDefault();\n\n            } else {\n\n              if (!this.isWrappingLastText) {\n                // we're removing spaces, do nothing use browser's default behaviour, unless the wrapping is going on\n                return;\n              }\n              e.preventDefault();\n            }\n          }\n        }\n        // end DELETE\n\n        // start WRITING\n        else if (__keycodeIsPrintableCharacter(keyCode)) {\n\n          // if nothing is selected (selection is empty)\n          if (this.lastSelectionSettings.isCollapsed) {\n\n            // if \"space\" was written\n            if (keyCode === 32) {\n              if (!this.isWrappingLastText) {\n                // we're adding spaces, do nothing use browser's default behaviour, unless the wrapping is going on\n                return;\n              }\n              // fill a space as the keyname for the spacebar\n              keyName = ' ';\n            }\n\n            // The Selection.rangeCount read-only property returns the number of ranges in the selection.\n            if (selection.rangeCount) {\n\n              window.clearTimeout(this.wrapLastAdditionsTimeoutFunction);\n\n              const range = selection.getRangeAt(0);\n              const cloneRange = range.cloneRange();\n\n              cloneRange.setStart(range.startContainer, range.startOffset);\n              cloneRange.setEnd(range.endContainer, range.endOffset);\n\n              const textToAddElement = document.createElement('span');\n              textToAddElement.contentEditable = false;\n              textToAddElement.className = `user-inserted-text-inner ${this.wrapLastAdditionsTimeoutClass}`;\n              textToAddElement.innerHTML = keyName;\n\n              cloneRange.insertNode(textToAddElement);\n\n              // move the caret after the inserted character\n              range.setStartAfter(textToAddElement);\n\n              selection.removeAllRanges();\n              selection.addRange(range);\n\n              this.wrapLastAdditionsTimeoutFunction = setTimeout(() => {\n\n                this.isWrappingLastText = false;\n\n                // wrap all previous deletes to one element\n                const dummyElement = document.createElement('span');\n                dummyElement.contentEditable = false;\n                dummyElement.className = 'user-inserted-text';\n\n                const newGeneratedId = this._generateNewTagId();\n                dummyElement.id = newGeneratedId;\n\n                const $elements = document.querySelectorAll(`.${this.wrapLastAdditionsTimeoutClass}`);\n\n                __insertBefore(dummyElement, $elements[0]);\n\n                $elements.forEach((el, i) => {\n                  dummyElement.appendChild(el);\n                });\n\n\n                // create close button\n                const $btnClose = document.createElement('span');\n                $btnClose.className = this.opts.closeBtnClass;\n\n                const clickHandler = (e) => {\n                  const $nodeElement = e.currentTarget.parentNode;\n                  __remove($nodeElement);\n                  e.stopPropagation();\n                };\n\n                $btnClose.addEventListener('click', clickHandler.bind(this));\n                document.getElementById(newGeneratedId).appendChild($btnClose);\n\n                this.wrapLastAdditionsTimeoutClass = this._generateNewTagGroupClass();\n\n              }, 700);\n\n              this.isWrappingLastText = true;\n\n            }\n\n\n            if (this.hasEditableContentChanged === false) {\n              this.hasEditableContentChanged = true;\n            }\n\n            e.preventDefault();\n          }\n\n          // writing over existing text is selected\n          else {\n            window.clearTimeout(this.wrapLastAdditionsTimeoutFunction);\n\n            const range = selection.getRangeAt(0);\n            const cloneRange = range.cloneRange();\n\n            cloneRange.setStart(range.startContainer, range.startOffset);\n            cloneRange.setEnd(range.endContainer, range.endOffset);\n\n            // 1. handle deleting the text that was selected when writing started\n            if (this.isWriting === false && selection.toString().length > 0) {\n              // add deleted text node only for the first time and only if there is some selected text\n              this.$groupDeleted = document.createElement('span');\n              this.$groupDeleted.contentEditable = false;\n              this.$groupDeleted.className = 'user-removed-text';\n\n              const groupDeletedId = this._generateNewTagId();\n              this.$groupDeleted.id = groupDeletedId;\n\n              const $groupInnerDeleted = document.createElement('span');\n              $groupInnerDeleted.className = 'user-removed-text-inner';\n\n              this.$groupDeleted.appendChild($groupInnerDeleted);\n\n              cloneRange.surroundContents(this.$groupDeleted);\n\n              // create close button\n              const $btnClose = document.createElement('span');\n              $btnClose.className = this.opts.closeBtnClass;\n\n              const clickHandler = (e) => {\n                const $nodeElement = e.currentTarget.parentNode;\n                this._removeNodeKeepTextContent($nodeElement);\n                e.stopPropagation();\n              };\n\n              $btnClose.addEventListener('click', clickHandler.bind(this));\n              this.$groupDeleted.appendChild($btnClose);\n            }\n\n\n            // 2. adding new text\n            this.isWriting = true;\n\n            const $groupInnerAdded = document.createElement('span');\n            $groupInnerAdded.contentEditable = false;\n            $groupInnerAdded.className = `user-inserted-text-inner ${this.wrapLastAdditionsTimeoutClass}`;\n\n            // add a space so there is a space between the added and removed text\n            $groupInnerAdded.innerHTML = `${keyName}`;\n\n            // TODO: error after deleted selection\n            __insertBefore($groupInnerAdded, this.$groupDeleted);\n            range.setStartAfter($groupInnerAdded);\n\n            selection.removeAllRanges();\n            selection.addRange(range);\n\n            this.wrapLastAdditionsTimeoutFunction = setTimeout(() => {\n              this.isWriting = false;\n\n              // wrap all previous deletes to one element\n              const $groupAdded = document.createElement('span');\n              $groupAdded.contentEditable = false;\n              $groupAdded.className = 'user-inserted-text';\n\n              const newGeneratedId = this._generateNewTagId();\n              $groupAdded.id = newGeneratedId;\n\n              const $elements = document.querySelectorAll(`.${this.wrapLastAdditionsTimeoutClass}`);\n\n              __insertBefore($groupAdded, $elements[0]);\n\n              $elements.forEach((el, i) => {\n                $groupAdded.appendChild(el);\n              });\n\n              const $btnClose = document.createElement('span');\n              $btnClose.className = this.opts.closeBtnClass;\n\n              const clickHandler = (e) => {\n                const $nodeElement = e.currentTarget.parentNode;\n                __remove($nodeElement);\n                e.stopPropagation();\n              };\n\n              $btnClose.addEventListener('click', clickHandler.bind(this));\n              document.getElementById(newGeneratedId).appendChild($btnClose);\n\n              this.wrapLastAdditionsTimeoutClass = this._generateNewTagGroupClass();\n\n            }, 700);\n\n            e.preventDefault();\n          }\n        }\n        // end WRITING\n      });\n    }\n\n\n    if (this.hasMenu) {\n      this.registerMenuHandler();\n    }\n\n    if (this.hasToolbar) {\n      this.toolbar.$btnReset.addEventListener('click', () => {\n\n        const isConfirmed = confirm('Opravdu chcete vrátit text do původní podoby? Vaše změny se tímto ztratí.');\n\n        if (isConfirmed) {\n          this.$canvas.innerHTML = this.originalContent.html;\n        }\n\n      });\n    }\n\n  }\n\n  registerMenuHandler() {\n    for (let i = 0, len = this.$menuActions.length; i < len; i += 1) {\n      this.$menuActions[i].addEventListener('click', this.handlerMenuActions.bind(this), false);\n    }\n\n    this.$menuClose.addEventListener('click', this.handlerMenuClose.bind(this), false);\n  }\n\n  initPreHighlightedTextOptions() {\n    // Example of data from JSON:\n    //\n    // \"predznaceni\": [\n    //     {\n    //       \"vyraz\": \"Obracíme se na vás\",\n    //       \"data\": {\n    //         \"osoba\": \"my\",\n    //         \"slovesnyZpusob\": \"oznamovací\"\n    //       }\n    //     }\n    //   ]\n    // }\n    //\n    // In PUG, object for every item is injected into `data-text-option` so this JS has access to it\n\n    const dataAttr = 'data-text-option';\n\n    // loop over updated DOM via DOM manipulation\n    this.$textOptionsElements = this.$editor.querySelectorAll(`[${dataAttr}]`);\n    this.$textOptionsElements.forEach(($textOption) => {\n\n      $textOption.addEventListener('click', () => {\n        __toggleClass($textOption, this.opts.textOptions.selectedClass);\n        const idForSend = this.id.replace('editor-', '');\n\n        if (__hasClass($textOption, this.opts.textOptions.selectedClass)) {\n          // store !!!\n          storeGlobal.add({\n            editor: this.id,\n            id: $textOption.id,\n            tag: $textOption,\n            tagData: JSON.parse($textOption.getAttribute(dataAttr)),\n          });\n\n          // dispatch event that editor has changed\n          const tagData = JSON.parse($textOption.getAttribute('data-text-option'));\n\n          __dispatchEvent(document, 'editor.change', {}, {\n            text: {\n              id: idForSend,\n              task: 'add',\n              tagData,\n              value: $textOption.cloneNode(true),\n            },\n          });\n        } else {\n          // store !!!\n          storeGlobal.delete({\n            editor: this.id,\n            id: $textOption.id,\n          });\n\n          // dispatch event that editor has changed\n          __dispatchEvent(document, 'editor.change', {}, {\n            text: {\n              id: idForSend,\n              task: 'remove',\n              value: $textOption,\n            },\n          });\n        }\n\n        // show OK button or feedback\n        this.showFeedback();\n      });\n\n    });\n\n  }\n\n  toggleMenu(clickClose = false) {\n\n    if (clickClose === true) {\n      __addClass(this.$menu, 'hidden');\n      return;\n    }\n\n    if (this.selectionMouseDown === true) {\n      __addClass(this.$menu, 'hidden');\n      return;\n    }\n\n    if (__hasClass(this.$menu, 'hidden') && this.selectionMouseDown === false) {\n      this._setmenuDimensions();\n      __removeClass(this.$menu, 'hidden');\n    }\n\n  }\n\n  _setmenuDimensions() {\n    const menuDimensions = __getRealDimensions(this.$menu);\n    const parentTranslatedPosition = __positionTranslated(this.$editor);\n    const parentDimensions = __position(this.$editor);\n\n    // let additionalSize = ( this.selectionDirection === \"right\" ) ?\n\n    const isOverflowAt = {\n      right: (this.selectionAttributes.left + this.selectionAttributes.width + menuDimensions.width + this.opts.menuMargin.x) > (parentTranslatedPosition.left + parentDimensions.width),\n      top: (this.selectionAttributes.top - menuDimensions.height - this.opts.menuMargin.y) < (parentTranslatedPosition.top),\n      bottom: (this.selectionAttributes.top + this.selectionAttributes.height + menuDimensions.height + this.opts.menuMargin.y) > (parentTranslatedPosition.top + parentDimensions.height),\n    };\n\n    let leftDimensions;\n    let topDimensions;\n\n    if (isOverflowAt.right) {\n\n      leftDimensions = this.selectionAttributes.left - menuDimensions.width - this.opts.menuMargin.x;\n\n    } else {\n\n      leftDimensions = this.selectionAttributes.left + this.selectionAttributes.width + this.opts.menuMargin.x;\n\n    }\n\n    if (isOverflowAt.top) {\n\n      topDimensions = this.selectionAttributes.top + menuDimensions.height + this.opts.menuMargin.y;\n\n    } else {\n\n      topDimensions = this.selectionAttributes.top - menuDimensions.height - this.opts.menuMargin.y;\n\n    }\n\n    this.$menu.style.left = `${leftDimensions}px`;\n    this.$menu.style.top = `${topDimensions}px`;\n\n  }\n\n  handlerMenuClose(e) {\n\n    this.toggleMenu(true);\n\n    e.preventDefault();\n\n  }\n\n  handlerMenuActions(e) {\n\n    const $el = e.currentTarget;\n    const command = $el.getAttribute('data-command');\n    const commandName = $el.getAttribute('data-command-name');\n\n    /* :TODO: Cache the options for given element to avoid JSON parsing each time */\n    const options = JSON.parse($el.getAttribute('data-command-options'));\n\n    this.setSelection(command, commandName, options);\n\n    e.preventDefault();\n\n  }\n\n  handlerFocus(e) {\n    const isMouseRightClick = e.which === 3;\n\n    if (isMouseRightClick) { return; }\n\n    if (__hasClass(e.target, 'node-close')) { return; }\n\n    if (__hasClass(e.target, 'node-selected')) { return; }\n\n    if (e.type === 'mousedown') {\n\n      // start tracking the mouse down\n      this.selectionMouseDown = true;\n\n      if (this.hasMenu === true) {\n        this.toggleMenu();\n      }\n\n    }\n\n    if (e.type === 'mouseup' && this.selectionMouseDown) {\n\n      // reset saved last selection settings\n      this.lastSelectionSettings = {};\n\n      this.selection = window.getSelection();\n      this.isCollapsed = this.lastSelectionSettings.isCollapsed = this.selection.isCollapsed;\n      this.savedSelectionRange = this.selection.getRangeAt(0);\n\n      this.selectionMouseDown = false;\n\n      this.lastSelectionSettings.anchorOffset = this.selection.anchorOffset;\n      this.lastSelectionSettings.focusOffset = this.selection.focusOffset;\n      this.lastSelectionSettings.text = this.savedSelectionRange.toString();\n\n      /* https://developer.mozilla.org/en-US/docs/Web/API/Selection/isCollapsed */\n      /* Returns a Boolean indicating whether the selection's start and end points are at the same position. */\n      /* display context menu only if the cursor is NOT at the same position */\n      if (this.selection.isCollapsed === false && this.savedSelectionRange.toString().trim() !== '') {\n\n        this.selectionDirection = (this.selection.anchorOffset <= this.selection.focusOffset) ? 'right' : 'left';\n\n        if (this.hasMenu === true) {\n\n          this._setSelectionPosition(); // :TODO: cannot be used in contentEditable editor yet\n\n          this.toggleMenu();\n        }\n\n      }\n\n    }\n\n  }\n\n  _setSelectionPosition() {\n\n    const dummyElement = document.createElement('span');\n    dummyElement.className = 'dummy-range-element';\n\n    this.savedSelectionRange.surroundContents(dummyElement);\n\n    const selectionPosition = __positionTranslated(dummyElement);\n    const selectionDimension = __position(dummyElement);\n\n    this.selectionAttributes = {\n      left: selectionPosition.left,\n      top: selectionPosition.top,\n      width: selectionDimension.width,\n      height: selectionDimension.height,\n    };\n\n    __removeClass(dummyElement, 'dummy-range-element');\n\n    this._removeNodeKeepTextContent(dummyElement);\n\n  }\n\n  _highlightContents($domEl, newTagId) {\n    $domEl.appendChild(this.savedSelectionRange.extractContents());\n    this.savedSelectionRange.insertNode($domEl);\n\n    $domEl.setAttribute('data-tag-id', newTagId);\n  }\n\n  _storeHighlightedContents($domEl, newTagId) {\n    const tagName = $domEl.getAttribute('data-command-name');\n\n    // store !!!\n    store.addTag({\n      editor: this.id,\n      id: newTagId,\n      tag: $domEl,\n      tagName,\n      data: {},\n    });\n\n    // get tag color\n    const classes = $domEl.getAttribute('class');\n    // const colors = classes.match(/(?<=node-text-)[a-z]*/g);\n    const classesArray = classes.split(' ');\n    let color = '';\n    classesArray.forEach((value) => {\n      if (value.includes('node-text-')) {\n        color = value.replace('node-text-', '');\n      }\n    });\n\n    // dispatch event that editor has changed\n    const idForSend = this.id.replace('editor-', '');\n    __dispatchEvent(document, 'editor.change', {}, {\n      text: {\n        id: idForSend,\n        task: 'add',\n        tagData: { tagName },\n        value: $domEl.cloneNode(true),\n        tagColor: color,\n      },\n    });\n  }\n\n  _removeNodeKeepTextContent(node) {\n    const text = node.textContent;\n    node.parentNode.insertBefore(document.createTextNode(text), node);\n    __remove(node);\n  }\n\n  _createCloseBtnForElement($parentEl, opts = {}) {\n\n    const $elClose = document.createElement('span');\n    $elClose.innerHTML = '×';\n    $elClose.setAttribute('class', opts.class);\n\n    const classesToToggle = opts.toggleClass.split(' ');\n\n\n    const clickHandler = (e) => {\n\n      const $closeBtn = e.currentTarget;\n      const $nodeElement = $closeBtn.parentNode;\n\n      $closeBtn.removeEventListener('click', clickHandler);\n      $nodeElement.removeChild($closeBtn);\n\n      if (undefined !== $nodeElement.commentRef) {\n\n        /* :TODO: temporary way to save the reference to the DOM element */\n        this.$editor.removeChild($nodeElement.commentRef);\n        $nodeElement.commentRef = null;\n\n      }\n\n      this._removeNodeKeepTextContent($nodeElement);\n\n      const tagName = $nodeElement.getAttribute('data-command-name');\n\n      // store !!!\n      store.deleteTag({\n        editor: this.id,\n        id: $nodeElement.getAttribute('data-tag-id'),\n        tag: $nodeElement,\n        tagName,\n        data: {},\n      });\n\n      // dispatch event that editor has changed\n      const idForSend = this.id.replace('editor-', '');\n      __dispatchEvent(document, 'editor.change', {}, {\n        text: {\n          id: idForSend,\n          task: 'remove',\n          tagData: { tagName },\n          value: $nodeElement,\n        },\n      });\n\n      e.stopPropagation();\n\n    };\n\n    $elClose.addEventListener('click', clickHandler.bind(this));\n\n    $parentEl.appendChild($elClose);\n\n  }\n\n  _calculateCommentPosition($node) /* : Object */ {\n\n    const nodePosition = __positionTranslated($node);\n\n    return {\n      left: `${nodePosition.left + parseInt($node.offsetWidth, 10) + this.opts.commentMargin.x}px`,\n      top: `${nodePosition.top + this.opts.commentMargin.y}px`,\n    };\n\n  }\n\n  _createCommentForNode($el, opts = {}) {\n\n    const commentTemplate = document.getElementById('comment-template').innerHTML;\n\n    const div = document.createElement('div');\n    div.innerHTML = commentTemplate;\n\n    const commentDiv = div.childNodes[1];\n\n    // attach js reference to the dom element\n    commentDiv.data = {};\n    commentDiv.data.nodeRef = $el;\n\n    const commentNewTextarea = commentDiv.querySelector('.comment-new-text');\n    const commentDivButtonSubmit = commentDiv.querySelector('button');\n    const commentCommentsContainer = commentDiv.querySelector('.comments-container');\n\n    const calculatedCommentPosition = this._calculateCommentPosition($el);\n\n    commentDiv.style.left = calculatedCommentPosition.left;\n    commentDiv.style.top = calculatedCommentPosition.top;\n\n    __addClass(commentDiv, opts.class);\n\n    commentDiv.addEventListener('click', (e) => {\n\n      if (__hasClass(e.target, 'close')) {\n\n        __addClass(commentDiv, 'hidden');\n        __removeClass($el, 'active');\n\n      }\n\n    });\n\n    commentDivButtonSubmit.addEventListener('click', (e) => {\n\n      if (commentNewTextarea.value !== '') {\n\n        const commentItem = document.createElement('div');\n        commentItem.className = 'comment-item';\n\n        commentItem.innerText = commentNewTextarea.value;\n\n        commentCommentsContainer.appendChild(commentItem);\n\n        commentNewTextarea.value = '';\n      }\n\n    });\n\n    this.$editor.append(commentDiv);\n\n    __addClass($el, 'comment-created');\n\n    /* :TODO: Temporary way to save the reference to the DOM element */\n    $el.commentRef = commentDiv;\n\n\n  }\n\n  _addCommentHandlerForElement($el, opts = {}) {\n\n    __addClass($el, 'has-comments');\n\n    function clickHandler(e) {\n\n      if (!__hasClass(e.target, 'node-close')) {\n\n        if (!__hasClass($el, 'comment-created')) {\n\n          this._createCommentForNode($el, opts);\n\n        } else {\n\n          /* recalculate comment div position */\n          const calculatedCommentPosition = this._calculateCommentPosition($el);\n\n          $el.commentRef.style.left = calculatedCommentPosition.left;\n          $el.commentRef.style.top = calculatedCommentPosition.top;\n\n          __removeClass($el.commentRef, 'hidden');\n\n        }\n\n        if (!__hasClass($el, 'active')) {\n\n          __addClass($el, 'active');\n\n        } else {\n\n          __removeClass($el, 'active');\n          __addClass($el.commentRef, 'hidden');\n\n        }\n\n      }\n\n      e.stopPropagation();\n\n    }\n\n    $el.addEventListener('click', clickHandler.bind(this));\n\n  }\n\n  setSelection(command, commandName, opts = {}) {\n\n    if (this.selection) {\n\n      if (command === 'toggle-class') {\n\n        const $el = document.createElement('span');\n        $el.setAttribute('class', opts.toggleClass);\n        $el.setAttribute('data-command-name', commandName);\n\n        const newTagId = this._generateNewTagId();\n\n        this._highlightContents($el, newTagId);\n\n        if (opts.closeBtn === true) {\n          this._createCloseBtnForElement($el, {\n            class: 'node-close',\n            toggleClass: opts.toggleClass,\n          });\n        }\n\n        if (opts.comments === true) {\n          this._addCommentHandlerForElement($el, {\n            class: opts.commentsClass,\n          });\n        }\n\n        this._storeHighlightedContents($el, newTagId);\n\n        if (opts.showCommentsOnInit === true) {\n          $el.click();\n        }\n\n      }\n\n      // hide context menu after selecting the action#\n      this.toggleMenu(true);\n\n      // show OK button or feedback\n      this.showFeedback();\n\n    }\n\n  }\n\n}\n\nEditor.defaults = {\n  menuClass: 'contextual-menu-component',\n  canvasClass: 'canvas',\n  resetBtnClass: 'reset',\n  closeBtnClass: 'node-close',\n  nodeSelectedClass: 'node-selected',\n  commentMargin: {\n    x: 50,\n    y: 0,\n  },\n  menuMargin: {\n    x: 15,\n    y: 15,\n  },\n  textOptions: {\n    enable: false,\n    animatedClass: 'active',\n    selectedClass: 'selected',\n    deselectedClass: 'deselected',\n  },\n\n};\n\nEditor._hasMenu = (opts) => opts.funkce !== 'cteni' && opts.funkce !== 'psani' && (opts.menu !== false && opts.menu !== undefined);\nEditor._hasToolbar = (opts) => opts.funkce === 'psani' || (opts.toolbar !== false && opts.toolbar !== undefined);\n","import { __hasClass, __getHTML, __remove } from '../lib/utils';\nimport store from '../store/store';\nimport actionTypes from '../store/store-constants';\nimport Component from './component';\n\nexport default class AnalyticalTable extends Component {\n\n  constructor(id, element, opts) {\n    super(element);\n    this.id = id;\n\n    this.opts = { ...AnalyticalTable.defaults, ...opts };\n\n    this.isAdvanced = this.opts.isAdvanced;\n\n    this.rowIndex = 0;\n\n    this.tableResult = this.target.querySelector('.table-result');\n    this.tableResultBody = this.tableResult.querySelector('.table-body');\n    this.tableSelectedItems = this.target.querySelector('.table-selected-items');\n    this.tableSelectedItemsBody = this.tableSelectedItems.querySelector('.table-body');\n\n    this.activeDragged = null;\n\n    // choose the HTML for a row according to whether we work with the advanced version of a table\n    this._getRowHTML = (this.isAdvanced) ? AnalyticalTable._getAdvancedRowHTML : AnalyticalTable._getRowHTML;\n  }\n\n  init() {\n    this._registerStoreHandlers(this.tableResultBody, this.tableSelectedItemsBody);\n    this._registerHandlers();\n  }\n\n  _registerStoreHandlers(tableResultBody, tableSelectedItemsBody) {\n\n    store.on(actionTypes.editor.CHANGE, (event, payload) => {\n\n      const action = payload.action;\n      let addedTagContainer;\n      let $node;\n      // let deletedItem;\n\n      switch (action.type) {\n\n        case actionTypes.editor.ADD_TAG:\n\n          addedTagContainer = action.data.tagContainer;\n\n          switch (addedTagContainer.tagName) {\n\n            case this.opts.casti[1].sloupce[0].tag:\n\n              tableResultBody.insertAdjacentHTML('beforeend', this._getRowHTML(__getHTML(addedTagContainer.tag), addedTagContainer.id));\n\n\n              // TODO: fix this\n              if (this.opts.letSecondCaseRunIfSame || this.opts.casti[1].sloupce[0].tag === this.opts.casti[1].sloupce[1].tag) {\n\n              } else {\n                break;\n              }\n            // break;\n\n            case this.opts.casti[1].sloupce[1].tag:\n              $node = addedTagContainer.tag.cloneNode(true);\n              $node.setAttribute('draggable', true);\n              $node.addEventListener('click', this._handlerDraggable.bind(this), false);\n              $node.addEventListener('dragstart', this._handlerDraggable.bind(this), false);\n              $node.addEventListener('dragend', this._handlerDraggable.bind(this), false);\n              $node.addEventListener('drag', this._handlerDraggable.bind(this), false);\n              tableSelectedItemsBody.appendChild($node);\n              break;\n            default:\n              break;\n\n          }\n          break;\n        case actionTypes.editor.DELETE_TAG:\n\n          addedTagContainer = action.data.tagContainer;\n\n          // console.log(\"from DELETE_TAG action\", addedTagContainer);\n\n          // simple analytical table tasks\n          // const deletedItems = document.querySelectorAll(`[data-tag-id=\"${addedTagContainer.id}\"]`);\n\n          Array.prototype.forEach.call(document.querySelectorAll(`[data-tag-id=\"${addedTagContainer.id}\"]`), ($node) => {\n\n            if (__hasClass($node.parentNode, 'cell-read-only')) {\n              // we have to remove the whole row from the table\n              // --> cell --> table-row\n              __remove($node.parentNode.parentNode);\n\n            } else {\n              __remove($node);\n            }\n          });\n\n          break;\n\n        default:\n          break;\n      }\n    });\n  }\n\n  _registerHandlers() {\n    this.target.addEventListener('dragover', this._handlerDrop.bind(this), false);\n    this.target.addEventListener('dragleave', this._handlerDrop.bind(this), false);\n    this.target.addEventListener('drop', this._handlerDrop.bind(this), false);\n  }\n\n  _handlerDraggable(e) {\n\n    if (e.type === 'dragstart') {\n      e.dataTransfer.setData('text/plain', 'node');\n      e.dataTransfer.dropEffect = '';\n      e.target.style.opacity = 0.5;\n\n      this.activeDragged = e.target.cloneNode(true);\n    }\n\n    if (e.type === 'dragend') {\n      e.target.style.opacity = 1;\n\n      // show OK button or feedback\n      this.showFeedback();\n    }\n\n    return false;\n  }\n\n  _handlerDrop(e) {\n    if (e.target.localName === 'input') {\n\n      if (e.type === 'dragover') {\n        e.preventDefault();\n        e.dataTransfer.dropEffect = 'none';\n      }\n\n      if (e.type === 'drop') {\n        e.preventDefault();\n      }\n    }\n\n    if (__hasClass(e.target, 'dashboard-canvas-widget-content')) {\n      if (e.type === 'dragover') {\n        e.preventDefault();\n\n        e.dataTransfer.dropEffect = '';\n        e.target.style.background = '#eee';\n      }\n\n      if (e.type === 'dragleave') {\n        e.target.style.background = '#fff';\n      }\n\n      if (e.type === 'drop') {\n        e.preventDefault();\n\n        e.target.style.background = '#fff';\n        this.activeDragged.style.opacity = 1;\n\n        this.activeDragged.addEventListener('click', (e) => {\n          if (__hasClass(e.target, 'node-close')) {\n            e.target.parentNode.remove();\n          }\n        });\n\n        e.target.appendChild(this.activeDragged);\n\n      }\n    }\n\n    return false;\n  }\n}\n\nAnalyticalTable.defaults = {\n  isAdvanced: false,\n};\n\n\nAnalyticalTable._getRowHTML = (nodeHTML, index = 0) => {\n\n  const tableRowTemplate = `\n    <div class=\"table-row\">\n      <div class=\"cell cell-read-only cell-border-right\">${nodeHTML}</div>\n      <div class=\"cell dashboard-canvas-widget-content\"></div>\n    </div>\n  `;\n\n  return tableRowTemplate;\n};\n\nAnalyticalTable._getAdvancedRowHTML = (nodeHTML, index = 0) => {\n\n  const tableRowTemplate = `\n    <div class=\"table-row\">\n      <div class=\"cell cell-read-only cell-border-right\">${nodeHTML}</div>\n      <div class=\"cell dashboard-canvas-widget-content cell-border-right\"></div>\n      <div class=\"cell table-input\">\n        <input id=\"table-akteri-vztahy-input-${index}\" data-input-target=\"\" data-save=\"value\" type=\"text\" placeholder=\"Vztah aktérů…\" tabindex=\"-1\">\n      </div>\n    </div>\n  `;\n\n  return tableRowTemplate;\n};\n","import Observer from './observer';\nimport actionTypes from './store-constants';\n\n/*\nconst tagContainer: Object = {\n  editorId?: number,\n  id: string,\n  tag: HTMLElement,\n  data?: Object\n}\n*/\n\n\nclass StoreKeywords extends Observer {\n\n  constructor() {\n    super();\n\n    /* here the global space for storing objects and data */\n    this._data = {};\n\n  }\n\n\n  change(keywordsId, newItems, newItemsHTML) {\n\n    if (!this._data[keywordsId]) {\n      this._data[keywordsId] = {};\n    }\n\n    this._data[keywordsId].items = newItems;\n    this._data[keywordsId].itemsHTML = newItemsHTML;\n\n    store.trigger(actionTypes.keywords.CHANGE, {\n      action: {\n        id: actionTypes.keywords.id,\n        type: actionTypes.keywords.CHANGE,\n        data: {\n          keywordsId,\n          newItems,\n          newItemsHTML,\n        },\n      },\n\n    });\n\n  }\n\n  export() {\n    return this._data;\n  }\n\n}\n\nconst store = new StoreKeywords();\nexport default store;\n","import { __toggleClass, __getHTML } from '../lib/utils';\nimport Component from './component';\nimport store from '../store/store-keywords';\nimport actionTypes from '../store/store-constants';\n\n// zoom the image\nexport default class Keywords extends Component {\n  constructor($element, opts = {}) {\n    super($element);\n    this.id = this.target.id;\n    this.function = this.target.getAttribute('data-keywords') || 'selekce';\n    this.$controls = this.target.querySelectorAll('[data-keywords-control]');\n\n    this.opts = { ...Keywords.defaults, ...opts };\n\n    this.$itemsContainer = this.target.querySelector(`.${this.opts.itemsContainerClassName}`);\n\n    if (this.opts.inherit && this.opts.inherit.from.length > 0) {\n      // console.log(this.opts.inherit.from);\n      this.isInherited = true;\n    } else {\n      this.$items = this.target.querySelectorAll(`.${this.opts.itemClassName}`);\n    }\n\n  }\n\n  init() {\n    switch (this.function) {\n      case 'selekce':\n        // we have data at the instantiation for importing\n        if (this.opts.import && this.opts.import.length > 0) {\n          this.$itemsContainer.innerHTML = Keywords._getHTMLFromItems(this.opts.import);\n        }\n\n        // save the state of all instances on Init\n        /* :TODO: a possible duplicity when the instance has the isInherited set to TRUE */\n        store.change(\n          this.id,\n          Keywords._getItemsFromHTML(this.$itemsContainer, this.opts.itemClassName),\n          Keywords._getItemsHTML(this.$itemsContainer),\n        );\n\n        // console.log(this.id, this.isInherited);\n        if (this.isInherited) {\n          // if onInit, we copy the elements\n          // by their ids into the itemsContainer of this object\n          if (this.opts.inherit.onInit) {\n            this._regenerateItemsContainerFromInherited();\n          }\n\n          this._registerStoreHandlers();\n        }\n\n        this._registerHandlers();\n        break;\n\n      case 'wordcloud':\n        this.$items.forEach(($item) => {\n          $item.setAttribute('data-keywords-item', 0);\n        });\n        this._changeSizeOfKeywordItem(this.opts.skala);\n        break;\n\n      default:\n        break;\n    }\n  }\n\n  _changeSizeOfKeywordItem(maxLevel) {\n    maxLevel = maxLevel ? parseInt(maxLevel, 10) : 4;\n\n    function setNewLevelValue($keyword, number, feedback) {\n      const oldValue = parseInt($keyword.getAttribute('data-keywords-item'), 10);\n      const newValue = oldValue + number;\n      const value = Math.abs(newValue) > maxLevel ? oldValue : newValue;\n      $keyword.setAttribute('data-keywords-item', value);\n\n      feedback();\n    }\n\n    this.$controls.forEach(($control) => {\n      const $keyword = $control.parentElement.parentElement;\n      const controlFunction = $control.getAttribute('data-keywords-control');\n\n      switch (controlFunction) {\n        case 'minus':\n          $control.addEventListener('click', (event) => {\n            setNewLevelValue($keyword, -1, this.showFeedback);\n            event.preventDefault();\n          });\n          break;\n\n        case 'plus':\n          $control.addEventListener('click', (event) => {\n            setNewLevelValue($keyword, 1, this.showFeedback);\n            event.preventDefault();\n          });\n          break;\n\n        default:\n          break;\n      }\n    });\n  }\n\n  _regenerateItemsContainerFromInherited() {\n    let tempContent = '';\n\n    this.opts.inherit.from.forEach((id) => {\n      const temp = document.getElementById(id).querySelector(`.${this.opts.itemsContainerClassName}`).innerHTML;\n      // rename ids of the original items to avoid duplicates in the DOM\n      tempContent += Keywords.renameItemsIds(id, this.id, temp);\n      // console.log(tempContent);\n    });\n\n    this.$itemsContainer.innerHTML = tempContent;\n\n    this.$items = this.target.querySelectorAll(`.${this.opts.itemClassName}`);\n\n    store.change(\n      this.id,\n      Keywords._getItemsFromHTML(this.$itemsContainer, this.opts.itemClassName),\n      Keywords._getItemsHTML(this.$itemsContainer),\n    );\n\n  }\n\n  _registerHandlers() {\n\n    this.target.querySelectorAll(`.${this.opts.itemClassName}`).forEach(($item) => {\n      $item.addEventListener('click', this._eventHandler.bind(this), true);\n    });\n\n  }\n\n  _registerStoreHandlers() {\n    store.on(actionTypes.keywords.CHANGE, (event, payload) => {\n\n      const action = payload.action;\n      const data = payload.action.data;\n\n      switch (action.type) {\n\n        case actionTypes.keywords.CHANGE:\n\n          // if there are other objects this object inherits items from, update the html\n          if (this.opts.inherit.from.indexOf(data.keywordsId) > -1) {\n            this._regenerateItemsContainerFromInherited();\n\n            // regenerate event handlers\n            this._registerHandlers();\n          }\n\n          break;\n\n        default:\n          break;\n      }\n\n    });\n\n  }\n\n\n  _eventHandler(e) {\n\n    if (e.type === 'click') {\n      // console.log(e.target, e.currentTarget);\n      __toggleClass(e.currentTarget, 'disabled');\n\n      store.change(\n        this.id,\n        Keywords._getItemsFromHTML(this.$itemsContainer, this.opts.itemClassName),\n        Keywords._getItemsHTML(this.$itemsContainer),\n      );\n\n      this.showFeedback();\n    }\n\n  }\n\n}\n\n\nKeywords._getItemFromDOMElement = ($item) => ({\n  class: $item.className,\n  id: $item.getAttribute('id'),\n  text: $item.innerText,\n});\n\nKeywords._getItemsHTML = ($itemsContainer) => $itemsContainer.innerHTML;\n\nKeywords._getItemsFromHTML = ($itemsContainer, itemsClassName) => {\n  const $items = $itemsContainer.querySelectorAll(`.${itemsClassName}`);\n  const itemsArray = [];\n\n  $items.forEach(($item) => {\n    itemsArray.push(Keywords._getItemFromDOMElement($item));\n  });\n\n\n  return itemsArray;\n\n};\n\nKeywords._getDOMElementFromItem = (item) => {\n\n  const newDiv = document.createElement('div');\n  newDiv.setAttribute('class', item.class);\n  newDiv.setAttribute('id', item.id);\n  newDiv.innerHTML = item.text;\n\n  return __getHTML(newDiv);\n\n};\n\nKeywords._getHTMLFromItems = (items) => {\n\n  let contentHTML = '';\n\n  items.forEach((item) => {\n\n    contentHTML += Keywords._getDOMElementFromItem(item);\n\n  });\n\n  return contentHTML;\n\n};\n\n\nKeywords.renameItemsIds = (oldId, newId, itemsHTML) => {\n\n  const expString = new RegExp(oldId, 'g');\n\n  return itemsHTML.replace(expString, newId);\n\n};\n\nKeywords.defaults = {\n  itemsContainerClassName: 'keywords-items-container',\n  itemClassName: 'keywords-item',\n};\n","import { __getHTML } from '../lib/utils';\n\nimport store from '../store/store';\nimport actionTypes from '../store/store-constants';\n\n// zoom the image\nexport default class EditorTagsPlaceholder {\n  constructor(element, opts = {}) {\n\n    this.$element = element;\n    this.id = this.$element.getAttribute('id');\n\n    this.opts = { ...EditorTagsPlaceholder.defaults, ...opts };\n\n    this.commandNames = JSON.parse(this.$element.getAttribute(this.opts.itemSubscribeAttributeClassName));\n    this.$itemsContainer = this.$element.querySelector(`.${this.opts.itemsContainerClassName}`);\n\n  }\n\n  init() {\n\n    this._registerStoreHandlers();\n\n  }\n\n\n  _registerStoreHandlers() {\n\n    store.on(actionTypes.editor.CHANGE, (event, payload) => {\n\n      const action = payload.action;\n      const data = payload.action.data;\n      const tagContainer = data.tagContainer;\n\n      if (this.commandNames.indexOf(tagContainer.tagName) > -1) {\n\n        const tags = store.getTagsBy({key: 'tagName', value: this.commandNames});\n\n        let content = \"\";\n\n        tags.forEach((tag) => {\n\n          content += __getHTML( tag.tag );\n\n        });\n\n        this.$itemsContainer.innerHTML = content;\n\n      }\n\n  });\n\n  }\n\n\n\n}\n\n\n\n\n\nEditorTagsPlaceholder.defaults = {\n  itemsContainerClassName: \"editor-tags-placeholder-content\",\n  itemSubscribeAttributeClassName: 'data-placeholder-editor-subscribe'\n\n};\n","import { __removeClass, __toggleClass } from '../lib/utils';\nimport Component from './component';\n// import store from '../store/store';\n// import actionTypes from '../store/store-constants';\n\n\nexport default class TestQuiz extends Component {\n\n  constructor(id, element, opts) {\n    super(element);\n\n    this.id = id;\n\n    this.opts = { ...TestQuiz.defaults, ...opts };\n\n    this.$questions = this.target.querySelectorAll(`.${this.opts.itemClass}`);\n    this.cache = {\n      answersCorrect: 0,\n      colors: [],\n      questions: [],\n    };\n\n    // get colors for all feedback variants\n    if (this.opts.zpetnaVazba) {\n      this.cache.colors = this.opts.zpetnaVazba.map((feedback) => feedback.barva);\n    }\n  }\n\n  init() {\n    // this._registerStoreHandlers();\n    this._registerHandlers();\n  }\n\n  _registerHandlers() {\n\n    this.$questions.forEach(($question, questionIndex) => {\n      // all questions are without answer by default\n      this.cache.questions.push({ answered: false });\n\n      const answerCorrect = parseInt($question.getAttribute('data-module-answer'), 10);\n      const $answers = $question.querySelectorAll(`.${this.opts.optionClass}`);\n\n      $answers.forEach(($answer, answerIndex) => {\n        $answer.addEventListener('click', () => {\n          const $answerCurrent = $answer;\n\n          // if already selected do nothing\n          if ($answerCurrent.classList.contains('selected')) {\n            return;\n          }\n\n          // remove the selection\n          $answers.forEach(($answersItem) => __removeClass($answersItem, this.opts.selectedClass));\n          // select the clicked one\n          __toggleClass($answerCurrent, this.opts.selectedClass);\n\n          // get sum of all corect answers\n          if (this.opts.zpetnaVazba) {\n            if (answerIndex === answerCorrect) {\n              this.cache.answersCorrect += 1;\n            } else if (this.cache.answersCorrect !== 0 && this.cache.questions[questionIndex].answered === true) {\n              this.cache.answersCorrect -= 1;\n            }\n            // loop through all \"zpetnaVazba\" to get the one with the fullfilled condition\n            const feedbackActual = this.opts.zpetnaVazba.find((feedback) => feedback.podminka.includes(this.cache.answersCorrect));\n\n            // show the right feedback message\n            this.$buttonFeedback.classList.remove(...this.cache.colors);\n            this.$buttonFeedback.classList.add(feedbackActual.barva);\n            this.$buttonFeedbackText.innerText = feedbackActual.text;\n          }\n\n          // note that this question has been answered (whether true or false)\n          this.cache.questions[questionIndex].answered = true;\n\n          // show OK button with feedback only when all question have been answered\n          if (this.cache.questions.find((question) => !question.answered) === undefined) {\n            this.showFeedback();\n          }\n\n        }, false);\n      });\n    });\n  }\n}\n\nTestQuiz.defaults = {\n  itemClass: 'test-quiz-item',\n  optionClass: 'option',\n  selectedClass: 'selected',\n};\n","import { __remove } from '../lib/utils';\nimport storeGlobal from '../store/store-global';\nimport actionTypes from '../store/store-constants';\nimport Component from './component';\n\nexport default class GenericTable extends Component {\n\n  constructor($element, opts) {\n    super($element);\n\n    this.id = this.target.id;\n    this.opts = { ...GenericTable.defaults, ...opts };\n\n    this.rowIndex = 0;\n\n    this.$tableResultBody = this.target.querySelector('.table-body');\n\n    this.dataSettings = this.opts.data;\n\n    this.cache = {\n      tasksToComplete: 0,\n      tasksCompleted: 0,\n      tasks: [],\n    };\n  }\n\n  init() {\n\n    if (this.dataSettings.source === 'store') {\n      this._registerStoreHandlers();\n    }\n\n    // this._registerHandlers();\n  }\n\n  _registerStoreHandlers() {\n\n    // register store event handler\n    // in tabulkaObecna JSON settings, subscribe is an array, here we need a string of strings separated by spaces\n    storeGlobal.on(this.dataSettings.subscribe.join(' '), (event, payload) => {\n      const action = payload.action;\n      const data = payload.data;\n\n      switch (action.type) {\n\n        case actionTypes[event].ADD: {\n          this.$tableResultBody.insertAdjacentHTML('beforeend', GenericTable._getRowHTML(data));\n\n          const $allRows = this.$tableResultBody.querySelectorAll('.table-row');\n          const $lastRow = $allRows[$allRows.length - 1];\n\n          const $newSelects = $lastRow.querySelectorAll('select');\n\n          this.cache.tasksToComplete += $newSelects.length;\n\n          $newSelects.forEach(($select) => {\n            this.cache.tasks.push({ answered: false });\n            const taskNumber = this.cache.tasks.length - 1;\n\n            $select.addEventListener('change', () => {\n              if (this.cache.tasks[taskNumber].answered === false) {\n                this.cache.tasksCompleted += 1;\n                this.cache.tasks[taskNumber].answered = true;\n              }\n              if (this.cache.tasksToComplete === this.cache.tasksCompleted) {\n                // show OK button or feedback\n                this.showFeedback();\n              }\n            });\n          });\n          break;\n        }\n        case actionTypes[event].DELETE: {\n          const $row = document.getElementById(`${data.id}_table`);\n          __remove($row);\n          this.cache.tasksToComplete -= $row.querySelectorAll('select').length;\n          this.cache.tasksCompleted -= $row.querySelectorAll('select').length;\n\n          if (this.cache.tasksToComplete <= this.cache.tasksCompleted) {\n            // show OK button or feedback\n            this.showFeedback();\n          }\n\n          break;\n        }\n        default:\n          break;\n      }\n    });\n  }\n}\n\nGenericTable.defaults = {};\n\n// data.data.text: editor text name\n// data.data.vyraz selected text option text value\nGenericTable._getRowHTML = (data) => {\n  const tableRowTemplate = `\n    <div class=\"table-row\" id=\"${data.id}_table\">\n      <div class=\"cell\">${data.tagData.nazev}</div>\n      <div class=\"cell\">${data.tagData.vyraz}</div>\n      <div class=\"cell\">\n        <select id=\"${data.id}-select-osoba\" name=\"osoba\" data-save=\"value\">\n          <option>Vyberte osobu</option>\n          <option>já</option>\n          <option>ty</option>\n          <option>on/ona/ono</option>\n          <option>my</option>\n          <option>vy</option>\n          <option>oni/ony/ona</option>\n          <option>infinitiv</option>\n        </select>\n      </div>\n      <div class=\"cell\">\n        <select id=\"${data.id}-select-zpusob\" name=\"zpusob\" data-save=\"value\">\n          <option>Vyberte způsob</option>\n          <option>oznamovací</option>\n          <option>podmiňovací</option>\n          <option>rozkazovací</option>\n          <option id=\"select-zpusob-infinitiv\">infinitiv</option>\n        </select>\n      </div>\n    </div>\n  `;\n\n  return tableRowTemplate;\n};\n","// [data-fullscreen]\nimport Component from './component';\n\nclass Fullscreen extends Component {\n  constructor($element) {\n    super($element);\n\n    this.$fullscreen = document.querySelector('[data-fullscreen=\"target\"]');\n    this.$fullscreenImage = this.$fullscreen.querySelector('[data-fullscreen=\"image\"]');\n\n    this.window = {};\n    this.image = {};\n\n    this.window.width = window.innerWidth;\n    this.window.height = window.innerHeight;\n    this.window.ratio = this.window.width / this.window.height;\n\n    this.$fullscreenImage.onload = () => {\n      this.image.width = this.$fullscreenImage.naturalWidth;\n      this.image.height = this.$fullscreenImage.naturalHeight;\n      this.image.ratio = this.image.width / this.image.height;\n\n      if (this.image.ratio >= this.window.ratio) {\n        this.$fullscreenImage.style.width = '100%';\n        this.$fullscreenImage.style.height = 'auto';\n      } else {\n        this.$fullscreenImage.style.width = 'auto';\n        this.$fullscreenImage.style.height = `${this.window.height}px`;\n      }\n    };\n\n  }\n}\n\nexport default class FullscreenToggle extends Fullscreen {\n  constructor($element) {\n    super($element);\n\n    this.target.addEventListener('click', (event) => {\n      this.$fullscreenImage.src = this.target.nextElementSibling.src;\n      this.$fullscreen.classList.toggle('hidden');\n\n      this.showFeedback();\n\n      event.preventDefault();\n      event.stopPropagation();\n    }, false);\n\n  }\n}\n","import Component from './component';\nimport { __dispatchEvent } from '../lib/utils';\n\nexport default class UserText extends Component {\n  constructor($element) {\n    super($element);\n    this.$userTexts = this.$slide.querySelectorAll('[data-textarea-target]');\n    this.$counter = this.target.nextElementSibling.querySelector('[data-usertext-counter]');\n    this.$wrapper = this.$counter.parentElement;\n\n    this.feedback = JSON.parse(this.target.getAttribute('data-feedback'));\n\n    this.lengthExpected = {\n      min: parseInt(this.target.getAttribute('minlength') === '0' ? 1 : this.target.getAttribute('minlength'), 10),\n      avg: null,\n      max: parseInt(this.target.getAttribute('maxlength') / 2, 10),\n    };\n    this.lengthExpected.avg = Math.floor((this.lengthExpected.max - this.lengthExpected.min) / 4 + this.lengthExpected.min);\n\n    this.cache = {\n      answersCorrect: 0,\n      colors: [\n        'color-red',\n        'color-orange',\n        'color-green',\n      ],\n      questions: [],\n    };\n\n    this.lastValue = '';\n    this.hadData = this.target.value && this.target.value.length > 0;\n    this.wasUsed = false;\n\n    if (this.hadData) {\n      this.updateCharacterCounter();\n    }\n\n    if (!HISTORYLAB.import.done) {\n      // duplicate source of different text element\n      this.toDuplicate = this.target.getAttribute('data-duplicate-text');\n      this.textDuplicateSources = this.toDuplicate ? this.toDuplicate.split(' ') : [];\n\n      // listen events\n      this.getEvents();\n      this.addEventListeners();\n    }\n  }\n\n  updateCharacterCounter(length = this.target.value.length) {\n    this.$wrapper.classList.remove(...this.cache.colors);\n    if (length < this.lengthExpected.min) this.$wrapper.classList.add(this.cache.colors[0]);\n    else if (length <= this.lengthExpected.avg) this.$wrapper.classList.add(this.cache.colors[1]);\n    else if (length > this.lengthExpected.avg) this.$wrapper.classList.add(this.cache.colors[2]);\n\n    this.$counter.innerText = length;\n    this.target.classList.add('is-used', !this.wasUsed);\n    this.wasUsed = true;\n  }\n\n  updateFeedback(length = this.target.value.length) {\n    if (!this.$buttonFeedback) return;\n\n    this.$buttonFeedback.classList.remove(...this.cache.colors);\n    if (length < this.lengthExpected.min) {\n      this.$buttonFeedback.classList.add(this.cache.colors[0]);\n      this.$buttonFeedbackText.innerText = this.feedback.none;\n    } else {\n\n      if (length <= this.lengthExpected.avg) {\n        this.$buttonFeedback.classList.add(this.cache.colors[1]);\n        this.$buttonFeedbackText.innerText = this.feedback.short;\n      }\n      else if (length > this.lengthExpected.avg) {\n        this.$buttonFeedback.classList.add(this.cache.colors[2]);\n        this.$buttonFeedbackText.innerText = this.feedback.ok;\n      }\n\n      this.target.setAttribute('data-textarea-target', 'success');\n      // check if all conditions of the same component on the same slide are met\n      const conditionAll = Array.from(this.$userTexts).find(($userText) => ($userText.getAttribute('data-textarea-target') !== 'success'));\n\n      if (conditionAll === undefined) {\n        // show OK button or feedback\n        this.showFeedback();\n      }\n    }\n  }\n\n  addEventListeners() {\n    // BLUR\n    this.target.addEventListener('blur', (event) => {\n      this.updateCharacterCounter();\n\n      if (event.target.value !== this.lastValue) {\n        const taskName = (this.lastValue === '') ? 'create' : 'change';\n        this.lastValue = event.target.value;\n\n        // dispatch event that text has changed\n        __dispatchEvent(document, 'text.change', {}, {\n          text: {\n            id: event.target.id,\n            task: taskName,\n            text: event.target.value,\n          },\n        });\n\n        // remove connection of any textfields\n        this.textDuplicateSources = [];\n      }\n    });\n\n    // KEYUP\n    this.target.addEventListener('keyup', (event) => {\n      event.stopPropagation();\n\n      const valueLength = this.target.value.length;\n      this.updateCharacterCounter(valueLength);\n      this.updateFeedback(valueLength);\n    });\n  }\n\n  getEvents() {\n    if (this.textDuplicateSources[0]) {\n\n      document.addEventListener('text.change', (e) => {\n        if (this.textDuplicateSources.includes(e.detail.text.id)) {\n\n          const taskName = (this.target.value === '') ? 'create' : 'change';\n          switch (e.detail.text.task) {\n            case 'create':\n            case 'change':\n              // if is something already there\n              if (this.target.value !== '') this.target.value += '\\n';\n\n              // if array length is one it means that can by connection line\n              if (this.textDuplicateSources.length === 1) {\n                this.target.value = e.detail.text.text;\n              } else {\n                this.target.value += `${e.detail.text.text}\\n`;\n              }\n\n              // dispatch event that text has changed\n              __dispatchEvent(document, 'text.change', {}, {\n                text: {\n                  id: this.target.id,\n                  task: taskName,\n                  text: this.target.value,\n                },\n              });\n\n              // make different first value if is need\n              this.lastValue = this.target.value;\n\n              this.updateCharacterCounter();\n              break;\n            default:\n              console.log('Nondefinated text events task. :(');\n          }\n        }\n      });\n    }\n  }\n}\n","import Component from '../component';\n\nexport default class AudioPlayerNormal extends Component {\n\n  constructor($element) {\n    super($element);\n\n    this.$playButton = this.target.querySelector('[data-player-control]');\n    this.$loadWave = this.target.querySelector('[data-audio-wave]');\n    this.$leftTime = this.target.querySelector('[data-audio-time-left]');\n    this.$audioDuration = this.target.querySelector('[data-audio-time-duration]');\n\n    this.wavesurfer = WaveSurfer.create({\n      container: this.$loadWave,\n      waveColor: '#A77977',\n      progressColor: '#FCE4E3',\n      height: 80,\n      responsive: true,\n      barWidth: 2,\n    });\n    this.wavesurfer.load(this.$loadWave.dataset.src);\n\n    this.initWave();\n  }\n\n  initWave() {\n    this.wavesurfer.on('ready', () => {\n      this.$leftTime.textContent = '0:00';\n      const duration = this.wavesurfer.getDuration();\n      const minutes = Math.floor((duration % 3600) / 60);\n      const seconds = (`00${Math.floor(duration % 60)}`).slice(-2);\n      this.$audioDuration.textContent = `${minutes}:${seconds}`;\n\n      this.addListenerAfterReady();\n    });\n  }\n\n  addListenerAfterReady() {\n    this.wavesurfer.on('audioprocess', (time) => {\n      const minutes = Math.floor((time % 3600) / 60);\n      const seconds = (`00${Math.floor(time % 60)}`).slice(-2);\n      this.$leftTime.textContent = `${minutes}:${seconds}`;\n    });\n\n    this.wavesurfer.on('finish', () => {\n      this.$playButton.setAttribute('data-player-control', 'paused');\n    });\n\n    this.$playButton.addEventListener('click', () => {\n      this.wavesurfer.playPause();\n\n      if (this.$playButton.getAttribute('data-player-control') === 'paused') {\n        this.$playButton.setAttribute('data-player-control', 'playing');\n      } else {\n        this.$playButton.setAttribute('data-player-control', 'paused');\n      }\n\n      this.showFeedback();\n    });\n\n    // stop audio prehravac kdyz se zapne dalsi slajd\n    const $nextSlides = document.querySelectorAll('[data-nav-button]');\n    $nextSlides.forEach(($nextSlide) => {\n      $nextSlide.addEventListener('click', () => {\n        if (this.$playButton.getAttribute('data-player-control') === 'playing') {\n          this.wavesurfer.playPause();\n          this.$playButton.setAttribute('data-player-control', 'paused');\n        }\n      });\n    });\n\n  }\n\n}\n","import AudioPlayer from './audio-player';\nimport { getSecondsMinutesFormat } from './media';\n\nexport default class AudioPlayerSimple extends AudioPlayer {\n  constructor($element) {\n    super($element);\n\n    this.$audio = this.target.querySelector('audio');\n    this.$timeLeft = this.target.querySelector('[data-audio-time-left]');\n    this.$duration = this.target.querySelector('[data-audio-time-duration]');\n\n    this.$duration.innerText = `/${getSecondsMinutesFormat(this.$audio.duration)}`;\n\n    AudioPlayer.addEventListeners(this.target, this.showFeedback);\n  }\n}\n","import Component from './component';\n\nexport default class FakeMap extends Component {\n  constructor($element) {\n    super($element);\n\n    this.$buttons = this.target.querySelectorAll('[data-fake-map=\"toggle\"]');\n    this.$maps = this.target.querySelectorAll('[data-fake-map=\"map\"]');\n    this.lastActiveIndex = 0;\n\n    this.addEventListenerToButtons();\n  }\n\n  switchMap($button, index) {\n    this.$maps[this.lastActiveIndex].classList.remove('active');\n    this.$buttons[this.lastActiveIndex].classList.remove('active');\n\n    this.$maps[index].classList.add('active');\n    $button.classList.add('active');\n\n    this.lastActiveIndex = index;\n  }\n\n  addEventListenerToButtons() {\n    this.$buttons.forEach(($button, index) => {\n\n      $button.addEventListener('click', (event) => {\n        this.switchMap($button, index);\n        this.showFeedback();\n\n        event.preventDefault();\n      });\n\n    });\n  }\n}\n","/* eslint-disable no-nested-ternary */\nimport Component from '../component';\nimport { getSecondsMinutesFormat, mediaEvents } from './media';\n\nexport default class VideoPlayer extends Component {\n  constructor($element, options) {\n    super($element);\n\n    this.$media = this.target.querySelector('video');\n    this.options = Object(options);\n    this.prefix = this.options.prefix || 'media';\n    this.lang = Object(this.options.lang);\n    // lang.currentTime\n    // lang.play\n    // lang.pause\n    // lang.minutes\n    // lang.seconds\n    // lang.leaveFullscreen\n    // lang.enterFullscreen\n\n    this.paused = null;\n    this.currentTime = null;\n    this.duration = null;\n    this.interval = null;\n\n    this.$document = this.target.ownerDocument;\n    this.$controls = this.target.querySelector('.media-player-controls');\n    // play/pause toggle\n    this.$play = this.$controls.querySelector('[data-player-control]');\n    this.$playSymbol = this.$play.querySelector('.media-play-symbol');\n    this.$pauseSymbol = this.$play.querySelector('.media-pause-symbol');\n    // time slider\n    this.$time = this.$controls.querySelector('[data-video-time-progress]');\n    this.$timeMeter = this.$time.querySelector('.media-meter.media-time-meter');\n    this.$timeRange = this.$time.querySelector('.media-range.media-time-range');\n\n    // current time text\n    this.$currentTimeText = this.$document.createTextNode('');\n    this.$currentTime = this.$controls.querySelector('[data-video-time-left]');\n    this.$currentTime.appendChild(this.$currentTimeText);\n\n    // duration time text\n    this.durationTime = this.$media.duration;\n    this.$durationTime = this.$controls.querySelector('[data-video-time-duration]');\n    this.$durationTime.innerText = getSecondsMinutesFormat(this.durationTime);\n    this.$durationTime.setAttribute(\n      'title',\n      `${VideoPlayer.timeToAural(\n        this.durationTime,\n        this.lang.minutes || 'minutes',\n        this.lang.seconds || 'seconds',\n      )}`,\n    );\n\n    // fullscreen button\n    this.$fullscreen = this.$controls.querySelector(\n      '.fullscreen-toggle',\n    );\n    this.$enterFullscreenSymbol = this.$fullscreen.querySelector(\n      '.media-enterFullscreen-symbol',\n    );\n    this.$leaveFullscreenSymbol = this.$fullscreen.querySelector(\n      '.media-leaveFullscreen-symbol',\n    );\n\n    // fullscreen api\n    this._fullscreenchange = 'onfullscreenchange' in this.target\n      ? 'fullscreenchange'\n      : 'onwebkitfullscreenchange' in this.target\n        ? 'webkitfullscreenchange'\n        : 'onMSFullscreenChange' in this.target\n          ? 'MSFullscreenChange'\n          : 'fullscreenchange';\n\n    this._requestFullscreen = this.target.requestFullscreen\n    || this.target.webkitRequestFullscreen\n    // || this.target.mozRequestFullScreen\n    || this.target.msRequestFullscreen;\n\n    this.onCanPlayStart = this.onCanPlayStart.bind(this);\n    this.onLoadStart = this.onLoadStart.bind(this);\n    this.onLoadedData = this.onLoadedData.bind(this);\n    this.onPlayChange = this.onPlayChange.bind(this);\n    this.onTimeChange = this.onTimeChange.bind(this);\n    this.onPlayClick = this.onPlayClick.bind(this);\n    this.onTimeKeydown = this.onTimeKeydown.bind(this);\n    this.onTimeClick = this.onTimeClick.bind(this);\n    this.onTimeKeydown = this.onTimeKeydown.bind(this);\n    this.onFullscreenClick = this.onFullscreenClick.bind(this);\n    this.onFullscreenChange = this.onFullscreenChange.bind(this);\n\n    // add event listeners\n    this.$media.addEventListener('canplaythrough', this.onCanPlayStart);\n    this.$media.addEventListener('loadstart', this.onLoadStart);\n    this.$media.addEventListener('loadeddata', this.onLoadedData);\n    this.$media.addEventListener('pause', this.onPlayChange);\n    this.$media.addEventListener('play', this.onPlayChange);\n    this.$media.addEventListener('timeupdate', this.onTimeChange);\n    this.$controls.addEventListener('click', this.onPlayClick, false);\n    // this.$play.addEventListener('click', this.onPlayClick, false);\n    this.$play.addEventListener('keydown', this.onTimeKeydown);\n    this.$time.addEventListener('click', this.onTimeClick, false);\n    this.$time.addEventListener('keydown', this.onTimeKeydown);\n    this.$fullscreen.addEventListener('click', this.onFullscreenClick, false);\n    // listen for fullscreen changes\n    document.addEventListener(\n      this._fullscreenchange,\n      this.onFullscreenChange,\n    );\n\n    // pointer events from time control\n    VideoPlayer.onDrag(this.$time, this.$timeRange, (percentage) => {\n      this.$media.currentTime = this.duration * Math.max(0, Math.min(1, percentage));\n\n      this.onTimeChange();\n    });\n\n    this.onLoadStart();\n  }\n\n  static _fullscreenElement() {\n    return document.fullscreenElement\n    || document.webkitFullscreenElement\n    // || document.mozFullScreenElement\n    || document.msFullscreenElement;\n  }\n\n  static _exitFullscreen() {\n    return document.exitFullscreen\n    || document.webkitCancelFullScreen\n    // || document.mozCancelFullScreen\n    || document.msExitFullscreen;\n  }\n\n  // when the play state changes\n  onPlayChange() {\n    if (this.paused !== this.$media.paused) {\n      this.paused = this.$media.paused;\n\n      this.$play.setAttribute(\n        'aria-label',\n        this.paused ? this.lang.play || 'play' : this.lang.pause || 'pause',\n      );\n      this.target.setAttribute(\n        'data-player-state',\n        this.paused ? 'paused' : 'playing',\n      );\n      this.$playSymbol.setAttribute('aria-hidden', !this.paused);\n      this.$pauseSymbol.setAttribute('aria-hidden', this.paused);\n\n      clearInterval(this.interval);\n\n      if (!this.paused) {\n        // listen for time changes every 30th of a second\n        this.interval = setInterval(this.onTimeChange, 34);\n      }\n\n      // dispatch new \"playchange\" event\n      this.$media.dispatchEvent(mediaEvents.playchange);\n    }\n  }\n\n  // when the time changes\n  onTimeChange() {\n    if (\n      this.currentTime !== this.$media.currentTime\n      || this.duration !== this.$media.duration\n    ) {\n      this.currentTime = this.$media.currentTime;\n      this.duration = this.$media.duration || 0;\n\n      const currentTimePercentage = this.currentTime / this.duration;\n      // const currentTimeCode = VideoPlayer.timeToTimecode(this.currentTime);\n      const currentTimeCode = getSecondsMinutesFormat(this.currentTime);\n      // const remainingTimeCode = VideoPlayer.timeToTimecode(\n      //   this.duration - Math.floor(this.currentTime),\n      // );\n\n      if (currentTimeCode !== this.$currentTimeText.nodeValue) {\n        this.$currentTimeText.nodeValue = currentTimeCode;\n\n        this.$currentTime.setAttribute(\n          'title',\n          `${VideoPlayer.timeToAural(\n            this.currentTime,\n            this.lang.minutes || 'minutes',\n            this.lang.seconds || 'seconds',\n          )}`,\n        );\n      }\n\n      // if (remainingTimeCode !== this.$remainingTimeText.nodeValue) {\n      //   this.$remainingTimeText.nodeValue = remainingTimeCode;\n\n      //   $(this.$remainingTime, {\n      //     title: `${VideoPlayer.timeToAural(\n      //       this.duration - this.currentTime,\n      //       this.lang.minutes || 'minutes',\n      //       this.lang.seconds || 'seconds',\n      //     )}`,\n      //   });\n      // }\n\n      this.$time.setAttribute('aria-valuenow', this.currentTime);\n      this.$time.setAttribute('aria-valuemin', 0);\n      this.$time.setAttribute('aria-valuemax', this.duration);\n\n      this.$timeMeter.style.width = `${currentTimePercentage * 100}%`;\n\n      // dispatch new \"timechange\" event\n      this.$media.dispatchEvent(mediaEvents.timechange);\n    }\n  }\n\n  // when media loads for the first time\n  onLoadStart() {\n    this.$media.removeEventListener('canplaythrough', this.onCanPlayStart);\n    this.$media.addEventListener('canplaythrough', this.onCanPlayStart);\n\n    this.onPlayChange();\n    this.onFullscreenChange();\n    this.onTimeChange();\n  }\n\n  // when the immediate current playback position is available\n  onLoadedData() {\n    this.onTimeChange();\n  }\n\n  // when the media can play\n  onCanPlayStart() {\n    this.$media.removeEventListener('canplaythrough', this.nCanPlayStart);\n\n    // dispatch new \"canplaystart\" event\n    this.$media.dispatchEvent(mediaEvents.canplaystart);\n\n\n    if (!this.paused || this.$media.autoplay) {\n      this.$media.play();\n    }\n  }\n\n  onFullscreenChange() {\n    const isFullscreen = this.target === VideoPlayer._fullscreenElement();\n\n    this.$fullscreen.setAttribute(\n      'aria-label',\n      isFullscreen\n        ? this.lang.leaveFullscreen || 'leave full screen'\n        : this.lang.enterFullscreen || 'enter full screen',\n    );\n    this.$enterFullscreenSymbol.setAttribute('aria-hidden', isFullscreen);\n    this.$leaveFullscreenSymbol.setAttribute('aria-hidden', !isFullscreen);\n  }\n\n  // when the play control is clicked\n  onPlayClick(event) {\n    event.preventDefault();\n    event.stopPropagation();\n\n    this.$media[this.$media.paused ? 'play' : 'pause']();\n  }\n\n  // when the time control\n  onTimeClick(event) {\n    event.stopPropagation();\n\n    // handle click if clicked without pointer\n    if (!event.pointerType && !event.detail) {\n      this.onPlayClick(event);\n    }\n  }\n\n  // click from fullscreen control\n  onFullscreenClick(event) {\n    event.stopPropagation();\n\n    if (this._requestFullscreen) {\n      if (this.target === VideoPlayer._fullscreenElement()) {\n        // exit fullscreen\n        VideoPlayer._exitFullscreen().call(document);\n      } else {\n        // enter fullscreen\n        this._requestFullscreen.call(this.target);\n\n        // maintain focus in internet explorer\n        this.$fullscreen.focus();\n\n        // maintain focus in safari\n        setTimeout(() => {\n          this.$fullscreen.focus();\n        }, 200);\n      }\n    } else if (this.$media.webkitSupportsFullscreen) {\n      // iOS allows fullscreen of the video itself\n      if (this.$media.webkitDisplayingFullscreen) {\n        // exit ios fullscreen\n        this.$media.webkitExitFullscreen();\n      } else {\n        // enter ios fullscreen\n        this.$media.webkitEnterFullscreen();\n      }\n\n      this.onFullscreenChange();\n    }\n  }\n\n  // keydown from play control or current time control\n  onTimeKeydown(event) {\n    const { keyCode, shiftKey } = event;\n\n    // 37: LEFT, 38: UP, 39: RIGHT, 40: DOWN\n    if (keyCode >= 37 && keyCode <= 40) {\n      event.preventDefault();\n\n      const offset = keyCode === 37 || keyCode === 39 ? keyCode - 38 : keyCode - 39;\n\n      this.$media.currentTime = Math.max(\n        0,\n        Math.min(\n          this.$media.duration,\n          this.$media.currentTime + offset * (shiftKey ? 10 : 1),\n        ),\n      );\n\n      this.onTimeChange();\n    }\n  }\n\n  // Handle Drag Ranges\n  static onDrag(target, innerTarget, listener) {\n    // eslint-disable-line max-params\n    const hasPointerEvent = undefined !== target.onpointerup;\n    const hasTouchEvent = undefined !== target.ontouchstart;\n    const pointerDown = hasPointerEvent\n      ? 'pointerdown'\n      : hasTouchEvent\n        ? 'touchstart'\n        : 'mousedown';\n    const pointerMove = hasPointerEvent\n      ? 'pointermove'\n      : hasTouchEvent\n        ? 'touchmove'\n        : 'mousemove';\n    const pointerUp = hasPointerEvent\n      ? 'pointerup'\n      : hasTouchEvent\n        ? 'touchend'\n        : 'mouseup';\n\n    // ...\n    const axisProp = 'clientX';\n\n    let window;\n    let start;\n    let end;\n\n    function onpointermove(event) {\n      // prevent browser actions on this event\n      event.preventDefault();\n\n      // the pointer coordinate\n      const position = axisProp in event\n        ? event[axisProp]\n        : (event.touches && event.touches[0] && event.touches[0][axisProp])\n            || 0;\n\n      // the percentage of the pointer along the container\n      const percentage = (position - start) / (end - start);\n\n      // call the listener with percentage\n      listener(percentage);\n    }\n\n    function onpointerdown(event) {\n      // window\n      window = target.ownerDocument.defaultView;\n\n      // client boundaries\n      const rect = innerTarget.getBoundingClientRect();\n\n      // the container start and end coordinates\n      start = rect.left;\n      end = rect.right;\n\n      onpointermove(event);\n\n      window.addEventListener(pointerMove, onpointermove);\n      window.addEventListener(pointerUp, onpointerup);\n    }\n\n    function onpointerup() {\n      window.removeEventListener(pointerMove, onpointermove);\n      window.removeEventListener(pointerUp, onpointerup);\n    }\n\n    // on pointer down\n    target.addEventListener(pointerDown, onpointerdown);\n  }\n\n  // Time To Timecode\n  // DEPRECATED (media.util)\n  // static timeToTimecode(time) {\n  //   return `${`0${Math.floor(time / 60)}`.slice(-2)}:${`0${Math.floor(\n  //     time % 60,\n  //   )}`.slice(-2)}`;\n  // }\n\n  // Time To Aural\n  // DEPRECATED (media.util)\n  static timeToAural(time, langMinutes, langSeconds) {\n    return `${Math.floor(time / 60)} ${langMinutes}, ${Math.floor(\n      time % 60,\n    )} ${langSeconds}`;\n  }\n}\n","/* eslint-disable linebreak-style */\nimport Component from './component';\nimport { __dispatchEvent } from '../lib/utils';\n\nexport default class Selectable extends Component {\n\n  constructor($element) {\n    super($element);\n\n    // TODO: is DOM element before/after the editor itself.. move it to the editor?\n    this.$settings = document.querySelector(`[data-selectable-id-reference=\"${this.target.id}\"]`);\n\n    this.feedback = JSON.parse(this.$settings.getAttribute('data-module-zpetnavazba'));\n    this.settings = JSON.parse(this.$settings.getAttribute('data-module-settings'));\n\n    this.$items = this.target.querySelectorAll('.selectable-item');\n\n    this.$inputs = this.target.querySelectorAll('input');\n    this.$inputs.forEach(($input) => {\n      this._changeClassIfChecked($input);\n      this._addEventListeners($input);\n    });\n\n    this.cache = {\n      answersCorrect: 0,\n      zpetnaVazba: false,\n      colors: [],\n      checkedInput: 0,\n    };\n\n    // get colors for all feedback variants\n    if (this.feedback) {\n      this.cache.zpetnaVazba = true;\n      this.cache.colors = this.feedback.map((feedback) => feedback.barva);\n    }\n\n  }\n\n  _addEventListeners($input) {\n    $input.addEventListener('change', () => {\n      this.$inputs.forEach(($input_) => {\n        this._changeClassIfChecked($input_);\n      });\n      this._checkAndResolveFeedback();\n    }, false);\n  }\n\n  /* eslint class-methods-use-this: [\"error\", { \"exceptMethods\": [\"_changeClassIfChecked\"] }] */\n  // TODO: might be possible with CSS only with `:checked` selector & sibling combinator`+` or `~`\n  _changeClassIfChecked($input) {\n    $input.parentNode.classList.toggle('is-checked', $input.checked === true);\n  }\n\n  _checkAndResolveFeedback() {\n    this.cache.answersCorrect = 0;\n    if (this.settings.viceOdpovedi) {\n      this.$items.forEach(($item, index) => {\n        if (this.$inputs[index].checked) {\n          this.cache.checkedInput += 1;\n        }\n        if (this.$inputs[index].checked && $item.hasAttribute('data-select-spravnaodpoved')) {\n          this.cache.answersCorrect += 1;\n        }\n        if (!this.$inputs[index].checked && !$item.hasAttribute('data-select-spravnaodpoved')) {\n          this.cache.answersCorrect += 1;\n        }\n      });\n    } else {\n      this.$items.forEach(($item, index) => {\n        if (this.$inputs[index].checked) {\n          this.cache.checkedInput += 1;\n        }\n        if (this.$inputs[index].checked && $item.hasAttribute('data-select-spravnaodpoved')) {\n          this.cache.answersCorrect += 1;\n        }\n      });\n    }\n\n    // Display feedback button (if no checkbox is select, the button is hidden)\n    if ((this.cache.checkedInput === 0 && !this.settings.vybrano) || (this.cache.checkedInput === this.$inputs.length && this.settings.vybrano) || this.settings.disableFeedback) {\n      this.hideFeedback();\n    } else {\n\n      if (this.cache.zpetnaVazba) {\n        const feedbackActual = this.feedback.find((feedback) => feedback.podminka.includes(this.cache.answersCorrect));\n        this.$buttonFeedback.classList.remove(...this.cache.colors);\n        this.$buttonFeedback.classList.add(feedbackActual.barva);\n        this.$buttonFeedbackText.innerText = feedbackActual.text;\n      }\n\n      this.showFeedback();\n    }\n\n    this.cache.checkedInput = 0;\n    this._dispatchEvent();\n  }\n\n  _dispatchEvent() {\n    const items = Array.from(this.$inputs).map(($input) => ({\n      checked: $input.checked,\n      id: $input.id,\n    }));\n\n    __dispatchEvent(this.target, 'selection.change', {}, {\n      id: this.target.id,\n      // task: 'change', // TODO: 'select', 'unselect' ?\n      items,\n    });\n  }\n}\n","/* eslint-disable no-case-declarations */\nimport Component from './component';\n\nexport default class NewTable extends Component {\n  constructor($element) {\n    super($element);\n    // duplicate source of different editor elements\n    this.dataFrom = this.target.parentNode.getAttribute('data-from');\n    this.dataSources = this.dataFrom ? this.dataFrom.split(' ') : [];\n    this.id = $element.getAttribute('id');\n    this.cache = {\n      tasks: [],\n    };\n\n    this.init();\n  }\n\n  init() {\n    const autofill = this.target.parentNode.getAttribute('data-autofill');\n\n    switch (autofill) {\n      case 'columns':\n        this._columnManager();\n        break;\n      case 'rows':\n        this._rowManager();\n        break;\n      case 'cells':\n        const allCells = this.target.querySelectorAll('.table-new__cell');\n\n        allCells.forEach(($cell) => {\n          const columnId = $cell.getAttribute('data-column-id');\n          const rowId = $cell.getAttribute('data-row-id');\n          // add listener only for cells in table\n          if (columnId && rowId) {\n            this._cellManager($cell, columnId, rowId);\n          }\n        });\n        break;\n      default:\n        console.log('NewTableERROR: Undefinated autofill key word!', autofill);\n    }\n  }\n\n  _rowManager() {\n    document.addEventListener('editor.change', (e) => {\n      const data = e.detail.text;\n\n      if (this.dataSources.includes(data.id)) {\n        let $tableRow;\n        let rightToAdd = true;\n\n        // get columns header\n        const $header = this.target.previousSibling;\n        const $headerCells = $header.firstChild.childNodes;\n\n        switch (data.task) {\n          case 'add':\n            $tableRow = document.createElement('div');\n            $tableRow.setAttribute('class', 'table-new__row');\n\n            $headerCells.forEach(($item) => {\n              const $rowCell = document.createElement('div');\n              $rowCell.setAttribute('class', 'table-new__cell');\n              const itemType = JSON.parse($item.getAttribute('data-type'));\n\n              // check if tagName is definated and than set variable to false\n              if (itemType.tagName && itemType.tagName !== data.tagData.tagName) {\n                rightToAdd = false;\n              }\n              else {\n                // add data to cell\n                this.fillCell(itemType, data, $rowCell);\n              }\n\n              // only add if it is right to add\n              if (rightToAdd) $tableRow.appendChild($rowCell);\n            });\n\n\n            this.target.appendChild($tableRow);\n            break;\n          case 'remove':\n            const tableRows = this.target.childNodes;\n\n            tableRows.forEach(($row) => {\n              $row.childNodes.forEach(($cell, index) => {\n                const itemType = JSON.parse($headerCells[index].getAttribute('data-type'));\n\n                if (NewTable.isRightToDeleteHelper($cell, data.value, itemType)) {\n                  $tableRow = $row;\n\n                }\n              });\n            });\n\n            // olny if row for remove exists\n            if ($tableRow) {\n              // remove tasks from cache\n              $tableRow.childNodes.forEach(($cell) => {\n                this._removeTaskFromCache($cell);\n              });\n\n              $tableRow.remove();\n            }\n            break;\n          default:\n            console.log('NewTableERROR: Undefinated task for new table! (rowManager)');\n        }\n      }\n    });\n  }\n\n  // TODO: adding just specific tags names like in rowManager\n  _columnManager() {\n    document.addEventListener('editor.change', (e) => {\n      const data = e.detail.text;\n\n      if (this.dataSources.includes(data.id)) {\n        const $rows = this.target.childNodes;\n\n        switch (data.task) {\n          case 'add':\n            $rows.forEach(($row) => {\n              const $cell = document.createElement('div');\n              $cell.setAttribute('class', 'table-new__cell');\n\n              const $firstCell = $row.firstChild;\n              const itemType = JSON.parse($firstCell.getAttribute('data-type'));\n\n              // add data to cell\n              this.fillCell(itemType, data, $cell);\n\n              $row.appendChild($cell);\n            });\n            break;\n          case 'remove':\n            let columnIndex;\n            $rows.forEach(($row) => {\n              const $firstCell = $row.firstChild;\n              const itemType = JSON.parse($firstCell.getAttribute('data-type'));\n\n              $row.childNodes.forEach(($cell, index) => {\n                if (NewTable.isRightToDeleteHelper($cell, data.value, itemType)) {\n                  columnIndex = index;\n                }\n              });\n            });\n\n            this.target.childNodes.forEach(($row) => {\n              // remove tasks from cache\n              this._removeTaskFromCache($row.childNodes[columnIndex]);\n\n              $row.childNodes[columnIndex].remove();\n            });\n            break;\n          default:\n            console.log('NewTableERROR: Undefinated task for new table! (columnManager)');\n        }\n      }\n    });\n  }\n\n  _cellManager($cell, columnId, rowId) {\n    document.addEventListener('editor.change', (e) => {\n      const data = e.detail.text;\n\n      if ((this.dataSources.includes(data.id) && (data.tagData.tagName === rowId)) || (data.tagData.tagName === columnId)) {\n\n        const itemType = JSON.parse(this._findCellType($cell));\n\n        if (!itemType.textId || itemType.textId === data.id) {\n          switch (data.task) {\n            case 'add':\n              const $tag = document.createElement('div');\n              this.fillCell(itemType, data, $cell);\n\n              $cell.appendChild($tag);\n              break;\n            case 'remove':\n              const $tags = $cell.querySelectorAll('div');\n              $tags.forEach(($elm) => {\n                if (NewTable.isRightToDeleteHelper($elm, data.value, itemType)) {\n                  $elm.remove();\n                }\n              });\n              break;\n            default:\n              console.log('NewTableERROR: Undefinated task for new table! (cellManager)');\n          }\n        }\n      }\n    });\n  }\n\n  fillCell(itemType, data, $node) {\n    let $innerItem;\n    let cacheObj;\n\n    // seed init or generate\n    let seed = 0;\n    if (this.cache.tasks.length > 0) {\n      const lastId = this.cache.tasks[this.cache.tasks.length - 1].id;\n      const idParts = lastId.split('-');\n      seed = +idParts[idParts.length - 1] + 1;\n    }\n\n    $node.classList.add(`table-new__cell--${itemType.name}`, `table-new__cell--${itemType.type}`);\n\n    switch (itemType.name) {\n      case 'dup-text':\n        $innerItem = document.createElement('div');\n        if (itemType.type === 'text') {\n          $innerItem.innerHTML = data.value.textContent;\n        }\n        else if (itemType.type === 'tag') {\n          // have to by clone, because if not it will by duplicatet do more tables it will be just in last one\n          $innerItem.appendChild(data.value.cloneNode(true));\n        }\n        break;\n      case 'select':\n        // create task in cache\n        cacheObj = { id: `${this.id}-select-${seed}`, answer: '', rightAnswer: data.tagData };\n        this.cache.tasks.push(cacheObj);\n\n        // create node in html\n        $innerItem = document.createElement(itemType.name);\n        $innerItem.setAttribute('id', cacheObj.id);\n        itemType.options.forEach((value) => {\n          const $option = document.createElement('option');\n          $option.innerHTML = value;\n          $innerItem.appendChild($option);\n        });\n\n        // add event listener\n        $innerItem.addEventListener('change', (event) => this._correctedAnswer(event, cacheObj));\n        break;\n      case 'input':\n      case 'textarea':\n        // create task in cache\n        cacheObj = { id: `${this.id}-input-${seed}`, answer: '', rightAnswer: data.tagData };\n        this.cache.tasks.push(cacheObj);\n\n        // create node in html\n        $innerItem = document.createElement(itemType.name);\n        $innerItem.setAttribute('id', cacheObj.id);\n        $innerItem.setAttribute('data-save', '');\n        $innerItem.setAttribute('tabindex', -1);\n        if (itemType.name === 'textarea') {\n          $innerItem.setAttribute('resize', cacheObj.id);\n        }\n        Object.keys(itemType.attributes).forEach((key) => {\n          $innerItem.setAttribute(key, itemType.attributes[key]);\n        });\n\n        // add event listener\n        $innerItem.addEventListener('change', (event) => this._correctedAnswer(event, cacheObj));\n        break;\n      case 'drop':\n        $innerItem = document.createElement('div');\n        const numberOfDrops = itemType.number ? itemType.number : -1;\n        // set attribute for draggable logic\n        $innerItem.setAttribute('data-drop-place', numberOfDrops);\n        break;\n      default:\n        $innerItem = document.createElement('div');\n        /*\n          if item Type name is value of data object from delivered cviceni feature\n          then use it and it's value set in table\n          else set empry value and show error\n       */\n        if (data.tagData[itemType.name]) {\n          $innerItem.innerHTML = data.tagData[itemType.name];\n        }\n        else {\n          $innerItem.innerHTML = ' ';\n          console.log('FillCellERROR: Undefinated object name.', itemType);\n        }\n    }\n    $node.appendChild($innerItem);\n  }\n\n  // prepare for more types of duplicate types\n  static isRightToDeleteHelper(elm, deliveredValue, itemType) {\n    let result;\n\n    if (itemType.name === 'dup-text') {\n      // fix for tags\n      // table div textContent include '×' as last char\n      // because it is in self span\n      let elemTextContent;\n      if (itemType.type === 'tag' && elm.textContent[elm.textContent.length - 1] === '×') {\n        elemTextContent = elm.textContent.slice(0, -1);\n      }\n      else {\n        elemTextContent = elm.textContent;\n      }\n      result = elemTextContent === deliveredValue.textContent;\n\n    } // different type then dup-text hasn't duplicate option\n    else {\n      result = false;\n    }\n\n    return result;\n  }\n\n  _findCellType($cell) {\n    const rowType = $cell.parentNode.firstChild.getAttribute('data-type');\n    if (rowType) return rowType;\n\n    // if rows header isn´t definated\n    const columnId = $cell.getAttribute('data-column-id');\n    const $columnHeader = this.target.parentNode.querySelector(`.table-new__cell--header[data-column-id=${columnId}]`);\n    if ($columnHeader) return $columnHeader.getAttribute('data-type');\n\n    return 'empty';\n  }\n\n  _correctedAnswer(event, cacheObj) {\n    this.cache.tasks.forEach((task) => {\n      if (task.id === cacheObj.id) {\n        task.answer = event.target.value;\n      }\n    });\n\n    // console.log('select change', this.cache);\n  }\n\n  _removeTaskFromCache($cell) {\n    this.cache.tasks.forEach((task, index) => {\n      if ($cell.firstChild.tagName === 'SELECT' || $cell.firstChild.tagName === 'INPUT' || $cell.firstChild.tagName === 'TEXTAREA') {\n        if ($cell.firstChild.id === task.id) {\n          this.cache.tasks.splice(index, 1);\n        }\n      }\n    });\n  }\n}\n","import Component from './component';\nimport { __dispatchEvent } from '../lib/utils';\n\n\nexport default class Draggable extends Component {\n  constructor($element) {\n    super($element);\n\n    this.idPrefix = 'drag-item';\n    // duplicate source of different editor elements\n    this.dataFrom = this.target.parentNode.getAttribute('data-from');\n    this.dataSources = this.dataFrom ? this.dataFrom.split(' ') : [];\n\n    this.position = {\n      x: 0,\n      y: 0,\n      dx: 0,\n      dy: 0,\n    };\n    this.cache = {\n      // to know if draggable item was dropped or not and how many times\n      items: {},\n    };\n\n    this.$targetPrevious = null;\n    this.$targetCurrent = null;\n    this.$draggedItem = null;\n\n    this.objWidth = null;\n    this.objHeight = null;\n\n    this.init();\n  }\n\n  init() {\n    const $dragItems = this.target.querySelectorAll('.draggable__item');\n    $dragItems.forEach(($dragItem) => {\n      // get id\n      const id = $dragItem.getAttribute('data-id');\n      // inicial drop numbers\n      this.cache.items[id] = 0;\n      // use d3 container for $dragItem\n      this.dragAndDropEvents(d3.select($dragItem), id);\n    });\n\n    // initial handler for dropped item to svg\n    this.handleDeleteItemFromSvgDrop();\n\n    // initial handler for adding tags from text\n    this.handleAddTagsFromText();\n  }\n\n  // dropToken is used for handle usecase when user drag from drop-place to drop-place\n  dragAndDropEvents($dragItem, itemId, dropToken = true) {\n    // drag & drop\n    $dragItem.call(d3.drag()\n      .container(this.$slide)\n      .on('start', () => { this.onStart($dragItem); })\n      .on('drag', () => { this.onDrag($dragItem); })\n      .on('end', () => { this.onDrop($dragItem, itemId, dropToken); }));\n  }\n\n  onStart($dragItem) {\n\n    this.$slide.classList.add('is-dragging');\n\n    this.$targetPrevious = d3.event.sourceEvent.target;\n\n    // initial position\n    this.objWidth = $dragItem.node().offsetWidth;\n    this.objHeight = $dragItem.node().offsetHeight;\n    this.position.x = $dragItem.node().offsetLeft;\n    this.position.y = $dragItem.node().offsetTop;\n    this.position.dx = 0;\n    this.position.dy = 0;\n\n    // get dragged node\n    // clone element if from DRAG place\n    if ($dragItem.node().parentNode.hasAttribute('data-drag-place')) {\n      this.$draggedItem = $dragItem.clone(true);\n    }\n    // do not clone if from DROP place\n    else {\n      this.$draggedItem = $dragItem;\n    }\n\n    this.$draggedItem\n      .classed('is-dragged', true)\n      .classed('was-dropped', false)\n      .attr('style', `top:${this.position.y}px; left:${this.position.x}px;`);\n  }\n\n  onDrag($dragItem) {\n    // console.log($dragItem.node());\n    // update position\n    this.position.dx += d3.event.dx;\n    this.position.dy += d3.event.dy;\n\n    // move with dragging element\n    this.$draggedItem.style('transform', `translate3d(${this.position.dx}px, ${this.position.dy}px, 0) rotate(5deg)`);\n\n    this.$targetCurrent = d3.event.sourceEvent.target;\n    // check for make placeholder in drop place\n    if (this.$targetPrevious !== this.$targetCurrent) {\n\n      // remove placeholder in old target\n      const $placeholderOld = this.$targetPrevious.querySelector('.draggable__item--placeholder');\n      if ($placeholderOld) $placeholderOld.remove();\n\n      // create placeholder in new target\n      if (this.$targetCurrent.hasAttribute('data-drop-place')) {\n        const numberOfPossibleDrops = this.$targetCurrent.getAttribute('data-drop-place');\n        const numberOfDropsDone = this.$targetCurrent.childElementCount;\n\n        // console.log('ondrag', numberOfDropsDone);\n\n        if (numberOfPossibleDrops === '-1' || +numberOfPossibleDrops > numberOfDropsDone) {\n          // remove this class is important for creating placeholder from dragging item from drop place\n          const $placeholderNew = $dragItem.clone(true)\n            .classed('is-dragged', false)\n            .classed('draggable__item--placeholder', true)\n            .attr('style', 'outline: 0px;')\n            .node();\n\n          this.$targetCurrent.appendChild($placeholderNew);\n        }\n      }\n\n      // update target\n      this.$targetPrevious = this.$targetCurrent;\n    }\n  }\n\n  onDrop($dragItem, itemId, dropToken) {\n    this.$targetCurrent = d3.event.sourceEvent.target;\n\n    // when dropping within droppable normal DOM node\n    if (this.$targetCurrent.hasAttribute('data-drop-place')) {\n\n      // get placeholder\n      const $dropItem = this.$targetCurrent.querySelector('.draggable__item--placeholder');\n\n      if ($dropItem) {\n\n        // remove unneeded classes for dropItem\n        $dropItem.classList.remove('draggable__item--placeholder', 'was-dropped');\n        $dropItem.classList.add('dropped__item');\n\n        // update drops num\n        if (dropToken) {\n          $dragItem.classed('was-dropped', true);\n          this.cache.items[itemId] += 1;\n        }\n\n        // add cross for remove item\n        /* const $rightElmChild = $dropItem.firstChild;\n        const $cross = document.createElement('span');\n        $cross.setAttribute('class', 'node-close');\n        $cross.innerHTML = '×';\n\n        // remove svg from frop item\n        $rightElmChild.removeChild($rightElmChild.lastChild);\n        $rightElmChild.appendChild($cross);\n\n        // remove item after click on cross\n        $cross.addEventListener('click', () => {\n          this.removeDraggableItem($dropItem, itemId, dropToken);\n        });\n        */\n\n        // add events to clone for posible dragging back\n        // dropItem has to by in d3 container\n        this.dragAndDropEvents(d3.select($dropItem), itemId, false);\n      }\n\n      // remove draggedItem from DOM\n      this.$draggedItem.remove();\n    }\n    // when dropping within SVG\n    else {\n      // get svg\n      const $svg = this.$targetCurrent.closest('svg');\n      // check drop attribute\n      const svgCanDrop = $svg ? $svg.hasAttribute('data-svg-drop') : false;\n\n      // when dropping within droppable svg node\n      if (svgCanDrop) {\n\n        // see __localPosition in ../lib/utils\n        // however d3.event.offsetX does not work here\n        const getLocalPositionBasedOnBrowser = () => {\n          const $slideActive = $svg.closest('.half-slide-active');\n\n          if (platform.name === 'Firefox' && $slideActive) {\n            // this works for Firefox even in transformed container\n            return [\n              d3.mouse($svg)[0] - ($slideActive.offsetWidth + this.objWidth),\n              d3.mouse($svg)[1],\n            ];\n          }\n\n          // this works for Chrome\n          return d3.mouse($svg);\n        };\n\n        const position = getLocalPositionBasedOnBrowser();\n        const $node = this.$draggedItem.classed('is-dragged', false)\n          .attr('style', 'outline: 0px;')\n          .node();\n\n        // update drops num\n        $dragItem.classed('was-dropped', true);\n        this.cache.items[itemId] += 1;\n\n        // add to svg\n        // dispatch event that svg has changed\n        __dispatchEvent(document, 'svg.drop', {}, {\n          svg: {\n            id: $svg.id,\n            $node,\n            type: $node.getAttribute('data-draggable-item'),\n            position,\n            size: {\n              width: this.objWidth,\n              height: this.objHeight,\n            },\n          },\n        });\n\n        this.$draggedItem.remove();\n\n      }\n      // when dropping outside of droppable area\n      else {\n        // if it's last drop then remove drop class\n        this.removeDraggableItem(this.$draggedItem, itemId, dropToken);\n      }\n\n    }\n\n    this.$slide.classList.remove('is-dragging');\n  }\n\n  handleDeleteItemFromSvgDrop() {\n\n    document.addEventListener('svg.drop.delete', (event) => {\n      const { id, $object } = event.detail.item;\n\n      // console.log('smazano', id, $object);\n      const $sameItemFromDragPlace = this.target.querySelector(`div[data-id=${id}]`);\n\n      if ($sameItemFromDragPlace) {\n        // if it's last drop then remove drop class\n        if (this.cache.items[id] === 1) {\n          $sameItemFromDragPlace.classList.remove('was-dropped');\n        }\n\n        // update drop number of concrete item\n        this.cache.items[id] -= 1;\n      }\n    });\n  }\n\n  handleAddTagsFromText() {\n    // need if we drop more than one same item\n    let idSalt = 1;\n\n    document.addEventListener('editor.change', (e) => {\n      const data = e.detail.text;\n      const concreteTagName = this.target.parentNode.getAttribute('data-tagName');\n\n      // if concreteTagName\n      if (this.dataSources.includes(data.id) && (!concreteTagName || concreteTagName === data.tagData.tagName)) {\n        let $newDaggabletItem;\n        let $tagTextSpan;\n        let textToAdd;\n        let newId;\n        let idParts;\n\n        switch (data.task) {\n          case 'add':\n            // clone hidden tag\n            $newDaggabletItem = this.target.firstChild.cloneNode(true);\n            $newDaggabletItem.classList.remove('hidden');\n\n            // find place where to add tags text\n            $tagTextSpan = $newDaggabletItem.querySelector('.keywords-item');\n\n            // get right text to add\n            textToAdd = data.value.textContent;\n            if (textToAdd[textToAdd.length - 1] === '×') {\n              textToAdd = textToAdd.slice(0, -1);\n            }\n\n            // add text\n            $tagTextSpan.firstChild.innerHTML = textToAdd;\n\n            // add color to draggable item\n            $newDaggabletItem.firstChild.classList.add(`node-text-${data.tagColor}`);\n            $tagTextSpan.classList.add(`node-text-${data.tagColor}`);\n\n            // create new id\n            newId = $newDaggabletItem.getAttribute('data-id');\n            idParts = newId.split('-');\n            idParts.splice(-1, 1, `dup-${idSalt}`);\n            newId = idParts.join('-');\n\n            // set new id\n            $newDaggabletItem.setAttribute('data-id', newId);\n\n            // add to cache\n            this.cache.items[newId] = 0;\n\n            idSalt += 1;\n            this.target.appendChild($newDaggabletItem);\n\n            // add listeners for drag'n'drop\n            this.dragAndDropEvents(d3.select($newDaggabletItem), newId);\n            break;\n          case 'remove':\n            this.target.childNodes.forEach(($cell) => {\n              if (Draggable.isRightToDeleteHelper($cell, data.value, $cell.getAttribute('data-draggable-item'))) {\n                $cell.remove();\n              }\n            });\n            break;\n          default:\n            console.log('NewTableERROR: Undefinated task for new table! (cellManager)');\n        }\n      }\n    });\n  }\n\n  removeDraggableItem($draggedItem, itemId, dropToken) {\n    // if it's last drop then remove drop class\n    if (this.cache.items[itemId] === 1) {\n      const $sameItemFromDragPlace = this.target.querySelector(`div[data-id=${itemId}]`);\n      $sameItemFromDragPlace.classList.remove('was-dropped');\n    }\n\n    // update drop number of concrete item\n    if (!dropToken) {\n      this.cache.items[itemId] -= 1;\n    }\n\n    // remove draggedItem from DOM\n    $draggedItem.remove();\n  }\n\n  // prepare for more types of duplicate types\n  static isRightToDeleteHelper(elm, deliveredValue, itemType) {\n    // fix for tags\n    // table div textContent include '×' as last char\n    // because it is in self span\n    let elemTextContent;\n    if (itemType === 'tag' && elm.textContent[elm.textContent.length - 1] === '×') {\n      elemTextContent = elm.textContent.slice(0, -1);\n    }\n    else {\n      elemTextContent = elm.textContent;\n    }\n    return elemTextContent === deliveredValue.textContent;\n  }\n}\n","/* eslint-disable no-unused-vars */\nimport MagnifyingGlass from './magnifying-glass';\nimport Sortable from './sortable';\nimport SVG from './svg';\nimport SVGRadialMenu from './svg-lib/svg-radial-menu';\nimport Editor from './editor/editor';\nimport AnalyticalTable from './analytical-table';\nimport Keywords from './keywords';\nimport EditorTagsPlaceholder from './editor-tags-placeholder';\nimport TestQuiz from './test-quiz';\nimport GenericTable from './generic-table';\nimport FullscreenToggle from './fullscreen';\nimport UserText from './user-text';\nimport AudioPlayerNormal from './media/audio-player-normal';\nimport AudioPlayerSimple from './media/audio-player-simple';\nimport FakeMap from './fake-map';\nimport { stopPlayingVideoPlayers } from './media/media';\nimport VideoPlayer from './media/video';\nimport Selectable from './selectable';\nimport NewTable from './new-table';\nimport Draggable from './draggable';\n\n// import actionTypes from '../store/store-constants';\n// import storeGlobal from '../store/store-global';\n\nconst windowLoadComponents = () => {\n  console.log('windowLoad:components');\n\n  // Video player - normal\n  const $videoPlayers = document.querySelectorAll('[data-player-video]');\n  if ($videoPlayers.length > 0) {\n    $videoPlayers.forEach(($videoPlayer) => {\n      // console.log('$videoPlayer', $videoPlayer);\n      const videoPlayer = new VideoPlayer($videoPlayer);\n    });\n\n    document.addEventListener('slide.change', () => {\n      stopPlayingVideoPlayers($videoPlayers);\n    });\n  }\n\n  // Audio player - normal\n  const $audioPlayerNormals = document.querySelectorAll('[data-player-audio=\"normal\"]');\n  if ($audioPlayerNormals.length > 0) {\n    $audioPlayerNormals.forEach(($audioPlayerNormal) => {\n      const audioPlayerNormal = new AudioPlayerNormal($audioPlayerNormal);\n    });\n\n    // TODO > audio-player-normal.js#61\n    // document.addEventListener('slide.change', () => {\n    //   stopPlayingVideoPlayers($audioPlayerNormals);\n    // });\n  }\n\n  // Audio player — simple\n  const $audioPlayerSimples = document.querySelectorAll('[data-player-audio=\"simple\"]');\n  if ($audioPlayerSimples.length > 0) {\n    $audioPlayerSimples.forEach(($audioPlayerSimple) => {\n      const audioPlayerSimple = new AudioPlayerSimple($audioPlayerSimple);\n    });\n\n    document.addEventListener('slide.change', () => {\n      stopPlayingVideoPlayers($audioPlayerSimples);\n    });\n  }\n\n  // Fullscreen\n  const $fullscreenToggles = document.querySelectorAll('[data-fullscreen=\"toggle\"]');\n  if ($fullscreenToggles.length > 0) {\n    $fullscreenToggles.forEach(($fullscreenToggle) => {\n      const fullscreenToggle = new FullscreenToggle($fullscreenToggle);\n    });\n  }\n\n  // Magnifying glass\n  const $magnifyingGlass = document.querySelectorAll('[data-lupa-target]');\n  if ($magnifyingGlass.length > 0) {\n    for (let i = 0; i < $magnifyingGlass.length; i += 1) {\n      const magnifyingGlass = new MagnifyingGlass($magnifyingGlass[i]);\n    }\n  }\n\n  // Fake Map\n  const $fakeMaps = document.querySelectorAll('[data-fake-map=\"target\"]');\n  if ($fakeMaps.length > 0) {\n    for (let i = 0; i < $fakeMaps.length; i += 1) {\n      const fakeMap = new FakeMap($fakeMaps[i]);\n    }\n  }\n\n  //\n  // load these below in working mode only\n\n  // User texts\n  // - preview/working mode logic inside the component\n  //  - show\n  const $userTexts = document.querySelectorAll('[data-textarea-target=\"\"]');\n  if ($userTexts.length > 0) {\n    $userTexts.forEach(($userText) => {\n      const userText = new UserText($userText);\n    });\n  }\n\n  // SVG + Radial menu\n  // - preview/working mode logic in side the component\n  //  - to set max-width\n  const $svgs = document.querySelectorAll('[data-svg-target]');\n  if ($svgs.length > 0) {\n\n    if (HISTORYLAB.import.done !== true) {\n      // radial menu\n      const $radialMenu = document.querySelector('[data-radial-menu]');\n      if ($radialMenu) {\n        const radialMenu = new SVGRadialMenu($radialMenu, $svgs);\n      }\n    }\n\n    // svgs\n    // setSize is needed\n    $svgs.forEach(($svg) => {\n      const svg = new SVG($svg);\n    });\n  }\n\n  if (HISTORYLAB.import.done !== true) {\n\n    // Editor\n    const $editors = document.querySelectorAll('[data-editor]');\n    if ($editors.length > 0) {\n      $editors.forEach(($editor) => {\n        const editor = new Editor($editor);\n      });\n    }\n\n    // Test Quizes\n    const $testQuizs = document.querySelectorAll('[data-target-test-quiz]');\n    if ($testQuizs.length > 0) {\n      $testQuizs.forEach(($testQuiz) => {\n        const settings = document.querySelector(\n          `[data-test-quiz-id-reference=\"${$testQuiz.getAttribute(\n            'data-test-quiz-id',\n          )}\"]`,\n        );\n\n        const testQuiz = new TestQuiz(\n          $testQuiz.getAttribute('data-test-quiz-id'),\n          $testQuiz,\n          JSON.parse(settings.getAttribute('data-module-settings')),\n        );\n        testQuiz.init();\n      });\n    }\n\n    // Analytical tables\n    const $analyticalTables = document.querySelectorAll(\n      '[data-target-analytical-table]',\n    );\n\n    if ($analyticalTables.length > 0) {\n      $analyticalTables.forEach(($analyticalTable) => {\n        const settings = document.querySelector(\n          `[data-analytical-table-id-reference=\"${$analyticalTable.getAttribute(\n            'data-analytical-table-id',\n          )}\"]`,\n        );\n        const analyticalTable = new AnalyticalTable(\n          $analyticalTable.getAttribute('data-analytical-table-id'),\n          $analyticalTable,\n          JSON.parse(settings.getAttribute('data-module-settings')),\n        );\n        analyticalTable.init();\n      });\n    }\n\n    // Generic tables\n    const $genericTables = document.querySelectorAll(\n      '[data-target-generic-table]',\n    );\n    if ($genericTables.length > 0) {\n      $genericTables.forEach(($genericTable) => {\n        const settings = document.querySelector(\n          `[data-generic-table-id-reference=\"${$genericTable.id}\"]`,\n        );\n        const genericTable = new GenericTable(\n          $genericTable,\n          JSON.parse(settings.getAttribute('data-module-settings')),\n        );\n        genericTable.init();\n      });\n    }\n\n    // New table\n    const $newTables = document.querySelectorAll('[data-new-table]');\n    if ($newTables.length > 0) {\n      $newTables.forEach(($newTable) => {\n        const newTable = new NewTable($newTable);\n      });\n    }\n\n    // Pretahovani\n    const $draggables = document.querySelectorAll('[data-draggable]');\n    if ($draggables.length > 0) {\n      $draggables.forEach(($draggable) => {\n        const draggable = new Draggable($draggable);\n      });\n    }\n\n    // Sortable\n    const $sortables = document.querySelectorAll('[data-sortable-target]');\n    if ($sortables.length > 0) {\n      $sortables.forEach(($sortable) => {\n        const sortable = new Sortable($sortable);\n      });\n    }\n\n    // Selectable\n    const $selectables = document.querySelectorAll('[data-selectable-target]');\n    if ($selectables.length > 0) {\n      $selectables.forEach(($selectable) => {\n        const selectable = new Selectable($selectable);\n      });\n    }\n\n    // Keywords selection\n    const $keywords = document.querySelectorAll('[data-keywords]');\n    if ($keywords.length > 0) {\n      $keywords.forEach(($keyword) => {\n        const settings = $keyword.hasAttribute('data-module-settings')\n          ? $keyword.getAttribute('data-module-settings')\n          : {};\n        const keywords = new Keywords($keyword, JSON.parse(settings));\n        keywords.init();\n      });\n    }\n\n    // Editor tags placeholders\n    const $editorTagsPlaceholders = document.querySelectorAll(\n      '.editor-tags-placeholder',\n    );\n    if ($editorTagsPlaceholders.length > 0) {\n      $editorTagsPlaceholders.forEach((item) => {\n        const editorTagsPlaceholder = new EditorTagsPlaceholder(item);\n        editorTagsPlaceholder.init();\n      });\n    }\n  }\n};\n\nexport default windowLoadComponents;\n","/* eslint-disable consistent-return */\nimport domLoadComponents from './dom-load';\nimport windowLoadComponents from './window-load';\nimport unsupportedBrowsers from '../lib/unsupported-browsers';\n\n(() => {\n  if (unsupportedBrowsers()) return false;\n\n  // The DOMContentLoaded event fires when parsing of the current page is complete. DOMContentLoaded is a great event to use to hookup UI functionality to complex web pages.\n  document.addEventListener('DOMContentLoaded', domLoadComponents, false);\n\n  // The load event fires when all files have finished loading from all resources, including ads and images.\n  window.addEventListener('load', windowLoadComponents, false);\n})();\n","const unsupportedBrowsers = () => {\n\n  // feature detection for unsupported browsers\n  const isUnsupported = !Array.from\n    || !Element.prototype.matches\n    || !Element.prototype.closest\n    || typeof window.CustomEvent !== 'function'\n    || typeof Object.assign !== 'function';\n\n  if (isUnsupported) {\n    console.warn('Not supported browser.');\n\n    const $unsupported = document.querySelector('#unsupported');\n    $unsupported.querySelector('#unsupported-browser').innerHTML = ` ${platform.name} ${platform.version} `;\n    $unsupported.classList.remove('is-hidden');\n\n    return true;\n  }\n\n  return false;\n};\n\nexport default unsupportedBrowsers;\n"],"names":["domLoadComponents","console","log","Component","$element","target","$slide","this","closest","lang","document","documentElement","getAttribute","HISTORYLAB","done","$buttonFeedback","querySelector","$buttonFeedbackText","showFeedback","bind","classList","contains","remove","add","MagnifyingGlass","$canvas","ctx","_this","getContext","_onStart","_onMove","_onEnd","_update","_onResize","zoomGlassSize","targetBCR","zoomed","targetZoomed","x","y","trackingTouch","_addEventListeners","_initCanvas","window","requestAnimationFrame","width","height","dPR","devicePixelRation","style","scale","getBoundingClientRect","event","preventDefault","pageX","touches","pageY","TAU","Math","PI","radius","ratioX","max","min","left","ratioY","top","scaledTargetWidth","scaledTargetHeight","platform","os","family","indexOf","name","shadowColor","shadowBlur","shadowOffsetY","clearRect","fillStyle","beginPath","arc","closePath","fill","save","clip","drawImage","restore","transform","addEventListener","__createNewCustomEvent","options","data","defaults","bubbles","properties","Object","assign","CustomEvent","detail","__dispatchEvent","type","payload","dispatchEvent","__isObject","item","_typeof","Array","isArray","__insertBefore","newNode","referenceNode","parentNode","insertBefore","__insertAfter","nextSibling","__remove","el","removeChild","__getHTML","node","tagName","outerHTML","wrapper","createElement","appendChild","cloneNode","innerHTML","__localPosition","container","position","d3","offsetX","offsetY","mouse","format","__positionTranslated","curTransform","WebKitCSSMatrix","getComputedStyle","webkitTransform","body","pageYOffset","scrollTop","pageXOffset","scrollLeft","offsetLeft","m41","offsetTop","m42","__position","elAttibutes","__toggleClass","element","cls","__hasClass","__removeClass","__addClass","className","elements","classes","_elements","_classes","querySelectorAll","split","i","length","j","replace","RegExp","mediaEvents","playchange","timechange","canplaystart","stopPlayingVideoPlayers","$players","forEach","$player","$media","paused","pause","setAttribute","getSecondsMinutesFormat","seconds","duration","floor","minutes","toString","slice","AudioPlayer","$item","$audio","$playButton","$timeLeft","play","stopPropagation","innerText","currentTime","SVGDragNDrop","select","raise","classed","diff","attr","toFixed","SVGDraw","$svg","callback","sourceEvent","nodeName","line","curve","curveLinear","d","subject","x0","y0","id","active","append","datum","on","x1","y1","dx","dy","push","$thisPath","svg","task","contextMenu","pathEventsManager","d3svg","localPosition","circleEventsManager","elementPosition","selection","selectAll","nodes","idParts","$object","firstChild","call","drag","start","dragged","oldXCoordinate","oldYCoordinate","taskType","end","SVG","removeCloneConnectionManager","SVGText","maxLength","minLength","svgID","svgGroup","$radialMenu","hash","orientation","foreignObject","textarea","focus","textEventsManager","$node","isCreated","firstWrite","oldText","value","parentElement","childNodes","updateTextareaHeight","$target","wrongBool","isWrong","removeItem","scrollHeight","isBubble","_setSize","init","_initWhenDone","toDuplicate","svgSpecificActions","_initPath","_initCircle","_initComicBubbles","_getEvents","_getDropEvent","viewbox","rect","maxWidth","maxWidthAbsolute","matchMedia","matches","innerWidth","setMaxWidth","_this2","p","renderPath","createCircle","_this3","$comicBubbles","$comicBubble","comicBubblesEventsManager","_this4","oldID","join","svgDuplicateSources","e","includes","$templateNode","localNodeID","_this5","_generateNewID","$localNode","_clonePath","color","_cloneComicBubbles","_cloneTextField","_cloneCircle","idSalt","_this6","size","multiply","$d3foreignObject","$dropItem","firstElementChild","$foreignObject","selected","isRadial","$parent","allActiveSvgs","deactivate","pop","Sortable","$settings","feedback","JSON","parse","$container","$items","$droppables","$placeholder","$inheritors","inheritors","order","direction","before","after","evaluation","undefined","clientX","clientY","clone","posRel","siblings","prev","next","_setupInitialOrder","_setupInheritors","cache","answersCorrect","colors","map","barva","hasAttribute","offsetWidth","offsetHeight","_addPlaceholder","_onOver","right","_onDrop","bottom","_removePlaceholder","_updateOrder","_updateOrderInInheritors","_dispatchEvent","_checkAndResolveFeedback","_getReference","_addEventListenerToItem","addEventListeners","minHeight","src","img","nextElementSibling","previousElementSibling","index","correctAnswerAttr","parseInt","feedbackActual","find","podminka","text","splneno","from","$inheritor","dataset","sortableIndex","inheritor","SVGRadialMenu","$svgs","$radialMenuItems","$colorItems","$textItems","$createTextItem","$removeItem","$tooltip","initialSetUp","menuRadius","getPropertyValue","itemRadius","setUpRadialMenuItems","addEventListenersToRadialMenu","activate","deselectItem","filterMenuButtons","showRadialMenu","addEventListenersToRadialMenuItem","_itemsLength","_menuRadius","_itemRadius","_menuOffset","_centerOffset","angle","sin","cos","onMouseLeave","hideRadialMenu","action","createText","changeColor","currentTarget","display","$activeSVG","globalPosition","__globalPosition","$activeRadialMenuItem","positionRadialMenuItems","setTimeout","mouseLeaveDelay","clearTimeout","clickedItem","$colorItem","$textItem","selectItem","Observer","_events","events","fn","_split","filter","current_fn","args","actionTypes","editor","ADD_TAG","DELETE_TAG","UPDATE_TAG","CHANGE","keywords","testQuiz","ADD_ANSWER","REMOVE_ANSWER","UPDATE_ANSWER","textOptions","ADD","DELETE","UPDATE","store","_data","tags","tagId","tagExists","tagContainer","_checkTagExists","Error","userSelectedNodeItems","trigger","splice","editorId","opts","key","selectedTags","objectExists","_checkExists","selectedObjs","Editor","$editor","settings","__mergeDeep","source","output","keys","models","passive","interactive","withMenu","totalTagId","hasMenu","lastSelectionSettings","isCollapsed","savedSelectionRange","selectionAttributes","dummyRangeElement","selectionMouseDown","selectionDirection","hasEditableContentChanged","lastPressedKey","hasToolbar","toolbar","originalContent","currentContent","_handlers","wrapLastDeletesTimeoutClass","wrapLastDeletesTimeoutFunction","wrapLastAdditionsTimeoutClass","wrapLastAdditionsTimeoutFunction","isWrappingLastText","isWriting","$groupDeleted","_hasMenu","$menu","menuClass","$menuActions","$menuClose","error","_hasToolbar","canvasClass","funkce","html","_generateNewTagGroupClass","$btnReset","registerEditableHandlers","initPreHighlightedTextOptions","handlerFocus","keycode","getSelection","keyCode","which","keyName","rangeCount","range","getRangeAt","cloneRange","setStart","startContainer","startOffset","collapse","setEnd","endContainer","endOffset","addedFragmentString","cloneContents","textContent","trim","dummyElementInner","surroundContents","removeAllRanges","addRange","dummyElement","contentEditable","newGeneratedId","_generateNewTagId","$elements","$btnClose","closeBtnClass","$nodeElement","_removeNodeKeepTextContent","getElementById","wrapLastDeletesTimeout","textToAddElement","insertNode","setStartAfter","groupDeletedId","$groupInnerDeleted","$groupInnerAdded","$groupAdded","registerMenuHandler","confirm","len","handlerMenuActions","handlerMenuClose","$textOptionsElements","$textOption","selectedClass","idForSend","storeGlobal","tag","tagData","clickClose","_setmenuDimensions","leftDimensions","topDimensions","menuDimensions","translated","clonedElement","visibility","elDimensions","elPosition","__getRealDimensions","parentTranslatedPosition","parentDimensions","isOverflowAt","menuMargin","toggleMenu","$el","command","commandName","setSelection","anchorOffset","focusOffset","_setSelectionPosition","selectionPosition","selectionDimension","$domEl","newTagId","extractContents","addTag","classesArray","tagColor","createTextNode","$parentEl","$elClose","toggleClass","clickHandler","$closeBtn","removeEventListener","commentRef","deleteTag","nodePosition","commentMargin","commentTemplate","div","commentDiv","nodeRef","commentNewTextarea","commentDivButtonSubmit","commentCommentsContainer","calculatedCommentPosition","_calculateCommentPosition","commentItem","_createCommentForNode","_highlightContents","closeBtn","_createCloseBtnForElement","comments","_addCommentHandlerForElement","commentsClass","_storeHighlightedContents","showCommentsOnInit","click","resetBtnClass","nodeSelectedClass","enable","animatedClass","deselectedClass","menu","AnalyticalTable","isAdvanced","rowIndex","tableResult","tableResultBody","tableSelectedItems","tableSelectedItemsBody","activeDragged","_getRowHTML","_getAdvancedRowHTML","_registerStoreHandlers","_registerHandlers","addedTagContainer","casti","sloupce","insertAdjacentHTML","letSecondCaseRunIfSame","_handlerDraggable","prototype","_handlerDrop","dataTransfer","setData","dropEffect","opacity","localName","background","nodeHTML","tableRowTemplate","keywordsId","newItems","newItemsHTML","items","itemsHTML","Keywords","$controls","$itemsContainer","itemsContainerClassName","inherit","isInherited","itemClassName","_getHTMLFromItems","change","_getItemsFromHTML","_getItemsHTML","onInit","_regenerateItemsContainerFromInherited","_changeSizeOfKeywordItem","skala","maxLevel","setNewLevelValue","$keyword","number","oldValue","newValue","abs","$control","tempContent","temp","renameItemsIds","_eventHandler","_getItemFromDOMElement","itemsClassName","itemsArray","_getDOMElementFromItem","newDiv","contentHTML","oldId","newId","expString","EditorTagsPlaceholder","commandNames","itemSubscribeAttributeClassName","getTagsBy","content","TestQuiz","$questions","itemClass","questions","zpetnaVazba","$question","questionIndex","answered","answerCorrect","$answers","optionClass","$answer","answerIndex","$answerCurrent","$answersItem","question","GenericTable","$tableResultBody","dataSettings","tasksToComplete","tasksCompleted","tasks","subscribe","$allRows","$newSelects","$select","taskNumber","$row","nazev","vyraz","FullscreenToggle","$fullscreenImage","$fullscreen","toggle","image","innerHeight","ratio","onload","naturalWidth","naturalHeight","UserText","$userTexts","$counter","$wrapper","lengthExpected","avg","lastValue","hadData","wasUsed","updateCharacterCounter","textDuplicateSources","getEvents","none","ok","conditionAll","$userText","taskName","valueLength","updateFeedback","AudioPlayerNormal","$loadWave","$leftTime","$audioDuration","wavesurfer","WaveSurfer","create","waveColor","progressColor","responsive","barWidth","load","initWave","getDuration","addListenerAfterReady","time","playPause","$nextSlide","AudioPlayerSimple","$duration","FakeMap","$buttons","$maps","lastActiveIndex","addEventListenerToButtons","$button","switchMap","VideoPlayer","prefix","interval","$document","ownerDocument","$play","$playSymbol","$pauseSymbol","$time","$timeMeter","$timeRange","$currentTimeText","$currentTime","durationTime","$durationTime","timeToAural","$enterFullscreenSymbol","$leaveFullscreenSymbol","_fullscreenchange","_requestFullscreen","requestFullscreen","webkitRequestFullscreen","msRequestFullscreen","onCanPlayStart","onLoadStart","onLoadedData","onPlayChange","onTimeChange","onPlayClick","onTimeKeydown","onTimeClick","onFullscreenClick","onFullscreenChange","onDrag","percentage","clearInterval","setInterval","currentTimePercentage","currentTimeCode","nodeValue","nCanPlayStart","autoplay","isFullscreen","_fullscreenElement","leaveFullscreen","enterFullscreen","pointerType","_exitFullscreen","webkitSupportsFullscreen","webkitDisplayingFullscreen","webkitExitFullscreen","webkitEnterFullscreen","shiftKey","offset","fullscreenElement","webkitFullscreenElement","msFullscreenElement","exitFullscreen","webkitCancelFullScreen","msExitFullscreen","innerTarget","listener","hasPointerEvent","onpointerup","hasTouchEvent","ontouchstart","pointerDown","pointerMove","pointerUp","onpointermove","defaultView","langMinutes","langSeconds","Selectable","$inputs","$input","_changeClassIfChecked","checkedInput","$input_","checked","viceOdpovedi","vybrano","disableFeedback","hideFeedback","NewTable","dataFrom","dataSources","autofill","_columnManager","_rowManager","$cell","columnId","rowId","_cellManager","$tableRow","rightToAdd","$headerCells","previousSibling","$rowCell","itemType","fillCell","isRightToDeleteHelper","_removeTaskFromCache","$rows","$firstCell","columnIndex","_findCellType","textId","$tag","$elm","$innerItem","cacheObj","seed","answer","rightAnswer","$option","_correctedAnswer","attributes","numberOfDrops","rowType","$columnHeader","_this7","elm","deliveredValue","result","Draggable","idPrefix","$targetPrevious","$targetCurrent","$draggedItem","objWidth","objHeight","$dragItem","dragAndDropEvents","handleDeleteItemFromSvgDrop","handleAddTagsFromText","itemId","dropToken","onStart","onDrop","$placeholderOld","numberOfPossibleDrops","numberOfDropsDone","childElementCount","$placeholderNew","$slideActive","removeDraggableItem","$sameItemFromDragPlace","$newDaggabletItem","$tagTextSpan","textToAdd","concreteTagName","windowLoadComponents","$videoPlayers","$videoPlayer","$audioPlayerNormals","$audioPlayerNormal","$audioPlayerSimples","$audioPlayerSimple","$fullscreenToggles","$fullscreenToggle","$magnifyingGlass","$fakeMaps","$editors","$testQuizs","$testQuiz","$analyticalTables","$analyticalTable","$genericTables","$genericTable","$newTables","$newTable","$draggables","$draggable","$sortables","$sortable","$selectables","$selectable","$keywords","$editorTagsPlaceholders","Element","warn","$unsupported","version","unsupportedBrowsers"],"mappings":"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"}