{"version":3,"file":"components.build.js","sources":["../../../../src/js/components/dom-load.js","../../../../src/js/components/component.js","../../../../src/js/components/magnifying-glass.js","../../../../src/js/lib/utils.js","../../../../src/js/components/media/media.js","../../../../src/js/components/media/audio-player.js","../../../../src/js/components/svg-lib/svg-dragndrop.js","../../../../src/js/components/svg-lib/svg-draw.js","../../../../src/js/components/svg-lib/svg-text.js","../../../../src/js/components/svg.js","../../../../src/js/components/sortable.js","../../../../src/js/components/svg-lib/svg-radial-menu.js","../../../../src/js/components/editor/editor.js","../../../../src/js/components/keywords.js","../../../../src/js/components/test-quiz.js","../../../../src/js/components/fullscreen.js","../../../../src/js/components/user-text.js","../../../../src/js/components/media/audio-player-normal.js","../../../../src/js/components/media/audio-player-simple.js","../../../../src/js/components/fake-map.js","../../../../src/js/components/media/video.js","../../../../src/js/components/selectable.js","../../../../src/js/components/new-table.js","../../../../src/js/components/draggable.js","../../../../src/js/components/gallery.js","../../../../src/js/components/window-load.js","../../../../src/js/components/components.js","../../../../src/js/lib/unsupported-browsers.js"],"sourcesContent":["\r\nconst domLoadComponents = () => {\r\n  console.log('domLoad:components');\r\n\r\n  // instantiate\r\n\r\n  // run\r\n\r\n};\r\n\r\nexport default domLoadComponents;\r\n","export default class Component {\r\n  constructor($element) {\r\n    this.target = $element;\r\n    this.$slide = this.target.closest('.slide');\r\n    this.lang = document.documentElement.getAttribute('lang');\r\n\r\n    if (!HISTORYLAB.import.done) {\r\n\r\n      if (this.$slide) {\r\n        this.$buttonFeedback = this.$slide.querySelector('[data-feedback-button]');\r\n\r\n        if (this.$buttonFeedback) {\r\n          this.$buttonFeedbackText = this.$buttonFeedback.querySelector('span');\r\n        }\r\n      }\r\n\r\n\r\n      this.showFeedback = this.showFeedback.bind(this);\r\n    }\r\n  }\r\n\r\n  showFeedback() {\r\n    if (this.$buttonFeedback && this.$buttonFeedback.classList.contains('button-hidden')) {\r\n      this.$buttonFeedback.classList.remove('button-hidden');\r\n    }\r\n  }\r\n\r\n  hideFeedback() {\r\n    this.$buttonFeedback.classList.add('button-hidden');\r\n  }\r\n}\r\n","import Component from './component';\r\n\r\nexport default class MagnifyingGlass extends Component {\r\n  // https://www.youtube.com/watch?v=e8IwM3iqnL0\r\n  constructor($element) {\r\n    super($element);\r\n    // SVG lupa a ještě dynamicky měnícího se SVG,\r\n    // který není na počátku známé?\r\n    // if (el.nodeName === 'svg') {\r\n    //   console.log('SVG');\r\n    //   el.children[0].getAttribute('xlink:href')\r\n    // }\r\n    this.$element = document.querySelector('[data-lupa]');\r\n    this.$canvas = document.querySelector('[data-lupa-canvas]');\r\n    this.ctx = this.$canvas.getContext('2d');\r\n\r\n    this._onStart = this._onStart.bind(this);\r\n    this._onMove = this._onMove.bind(this);\r\n    this._onEnd = this._onEnd.bind(this);\r\n    this._update = this._update.bind(this);\r\n    this._onResize = this._onResize.bind(this);\r\n\r\n    this.zoomGlassSize = 230;\r\n    this.targetBCR = null;\r\n    this.zoomed = 0;\r\n    this.targetZoomed = 0;\r\n\r\n    this.x = 0;\r\n    this.y = 0;\r\n    this.trackingTouch = false;\r\n\r\n    this._addEventListeners();\r\n    this._initCanvas();\r\n    this._onResize();\r\n\r\n    window.requestAnimationFrame(this._update);\r\n  }\r\n\r\n  _initCanvas() {\r\n    const width = this.zoomGlassSize;\r\n    const height = this.zoomGlassSize;\r\n    // if retina makes canvas more dense\r\n    const dPR = window.devicePixelRation || 1;\r\n    this.$canvas.width = width * dPR;\r\n    this.$canvas.height = height * dPR;\r\n\r\n    this.$canvas.style.width = `${width}px`;\r\n    this.$canvas.style.height = `${height}px`;\r\n\r\n    this.ctx.scale(dPR, dPR);\r\n  }\r\n\r\n  _onResize() {\r\n    this.targetBCR = this.target.getBoundingClientRect();\r\n  }\r\n\r\n  _onStart(event) {\r\n    if (event.target !== this.target) {\r\n      return;\r\n    }\r\n\r\n    event.preventDefault();\r\n    this.x = event.pageX || event.touches[0].pageX;\r\n    this.y = event.pageY || event.touches[0].pageY;\r\n\r\n    this.trackingTouch = true;\r\n    this.targetZoomed = 1;\r\n    this.zoomed = 0;\r\n\r\n    window.requestAnimationFrame(this._update);\r\n  }\r\n\r\n  _onMove(event) {\r\n    if (!this.trackingTouch) {\r\n      return;\r\n    }\r\n\r\n    this.x = event.pageX || event.touches[0].pageX;\r\n    this.y = event.pageY || event.touches[0].pageY;\r\n  }\r\n\r\n  _onEnd() {\r\n    if (this.targetZoomed) {\r\n      // show OK button or feedback\r\n      this.showFeedback();\r\n    }\r\n\r\n    this.targetZoomed = 0;\r\n    this.trackingTouch = false;\r\n  }\r\n\r\n  _update() {\r\n    const TAU = Math.PI * 2;\r\n    const MAX_RADIUS = 100;\r\n    const radius = this.zoomed * MAX_RADIUS;\r\n\r\n    this.targetBCR = this.target.getBoundingClientRect();\r\n\r\n    // local coordinates (ratio <0,1>)\r\n    const ratioX =\r\n      // min. 0\r\n      Math.max(0,\r\n        // max. 1\r\n        Math.min(1, ((this.x - this.targetBCR.left) / this.targetBCR.width))\r\n      );\r\n    // console.log(ratioX);\r\n    const ratioY =\r\n      // min. 0\r\n      Math.max(0,\r\n        // max. 1\r\n        Math.min(1, ((this.y - this.targetBCR.top) / this.targetBCR.height))\r\n      );\r\n    // console.log(ratioY);\r\n\r\n    // actual zooming (scaling)\r\n    const imageScale = 2.5;\r\n    const scaledTargetWidth = this.targetBCR.width * imageScale;\r\n    const scaledTargetHeight = this.targetBCR.height * imageScale;\r\n\r\n    // Firefox on Windows has a bug because of the shadow\r\n    if (!(platform.os.family.indexOf('Windows') > -1 && platform.name.indexOf('Firefox') > -1)) {\r\n      // Shadow.\r\n      this.ctx.shadowColor = 'rgba(0,0,0,0.4)';\r\n      this.ctx.shadowBlur = 12;\r\n      this.ctx.shadowOffsetY = 8;\r\n    }\r\n\r\n    // Background.\r\n    this.ctx.clearRect(0, 0, this.zoomGlassSize, this.zoomGlassSize);\r\n    this.ctx.fillStyle = '#fff';\r\n    this.ctx.beginPath();\r\n    this.ctx.arc(\r\n      // x\r\n      this.zoomGlassSize / 2,\r\n      // y\r\n      (this.zoomGlassSize - 10) - radius,\r\n      // radius, startAngle, endAngle\r\n      radius, 0, TAU);\r\n    this.ctx.closePath();\r\n    this.ctx.fill();\r\n\r\n    // save the default state (without image)\r\n    this.ctx.save();\r\n\r\n    // Zoomed image.\r\n    this.ctx.beginPath();\r\n    this.ctx.arc(\r\n      // x\r\n      this.zoomGlassSize / 2,\r\n      // y\r\n      (this.zoomGlassSize - 10) - (radius + 1),\r\n      // radius, startAngle, endAngle\r\n      radius * 1.03, 0, TAU);\r\n    this.ctx.clip();\r\n    this.ctx.closePath();\r\n    this.ctx.drawImage(this.target,\r\n      // dx and dy (left and top)\r\n      (-ratioX * scaledTargetWidth) + (this.zoomGlassSize / 2),\r\n      (-ratioY * scaledTargetHeight) + (this.zoomGlassSize / 2),\r\n      // scaled width and height\r\n      scaledTargetWidth, scaledTargetHeight);\r\n\r\n    // go back to default state (without image)\r\n    // so next update starts fresh\r\n    this.ctx.restore();\r\n\r\n    // Position the parent $element.\r\n    this._setTransformStyle(this.x, this.y);\r\n\r\n    // Update the zoom value.\r\n    this.zoomed += (this.targetZoomed - this.zoomed) / 4;\r\n\r\n    // Schedule another update if the zoom is fairly non-zero.\r\n    if (this.zoomed > 0.001) {\r\n      // if (this.zoomed > 0.001 && this.zoomed < 0.998) {\r\n      window.requestAnimationFrame(this._update);\r\n      // } else if (this.zoomed >= 0.998) {\r\n      //   this.zoomed = 1;\r\n    } else {\r\n      this.zoomed = 0;\r\n    }\r\n  }\r\n\r\n  _addEventListeners() {\r\n    // touch events\r\n    document.addEventListener('touchstart', this._onStart);\r\n    document.addEventListener('touchmove', this._onMove);\r\n    document.addEventListener('touchend', this._onEnd);\r\n    // mouse events\r\n    document.addEventListener('mousedown', this._onStart);\r\n    document.addEventListener('mousemove', this._onMove);\r\n    document.addEventListener('mouseup', this._onEnd);\r\n    // window events\r\n    window.addEventListener('resize', this._onResize);\r\n  }\r\n\r\n  _setTransformStyle(x, y) {\r\n    const halfYoomGlassSize = this.zoomGlassSize / 2;\r\n    let betterX;\r\n    let betterY;\r\n\r\n    if (x - halfYoomGlassSize < 0) {\r\n      betterX = Math.abs(x) + halfYoomGlassSize + 18;\r\n    }\r\n    else if (x + halfYoomGlassSize > window.innerWidth) {\r\n      betterX = window.innerWidth - (x - window.innerWidth) - this.zoomGlassSize;\r\n    }\r\n    else {\r\n      betterX = x;\r\n    }\r\n\r\n    if (y - this.zoomGlassSize < 0) {\r\n      betterY = Math.abs(y) + this.zoomGlassSize + 18;\r\n    }\r\n    else {\r\n      betterY = y;\r\n    }\r\n\r\n    this.$element.style.transform = `translate(${betterX}px, ${betterY}px)`;\r\n  }\r\n}\r\n","export function __isTouchEnabled() {\r\n  return ('ontouchstart' in window) ||\r\n    (navigator.maxTouchPoints > 0) ||\r\n    (navigator.msMaxTouchPoints > 0);\r\n}\r\n\r\n// Is touch: mql.matches === true\r\nexport function __isTouchOnly() {\r\n  return window.matchMedia('(hover: none)').matches;\r\n}\r\n\r\nexport function imageIsLoaded(src) {\r\n  return new Promise((resolve, reject) => {\r\n    const img = new Image();\r\n    img.onload = () => resolve(img);\r\n    img.onerror = reject;\r\n    img.src = src;\r\n  });\r\n}\r\n\r\nexport function __createNewCustomEvent(name, options = {}, data = null) {\r\n  const defaults = {\r\n    // https://developer.mozilla.org/en-US/docs/Web/Guide/Events/Creating_and_triggering_events#Event_bubbling\r\n    bubbles: true,\r\n    // cancelBubble\r\n    // stopPropagation()\r\n    // cancelable\r\n    // composed\r\n    // currentTarget\r\n    // defaultPrevented\r\n    // preventDefault()\r\n    // eventPhase\r\n    // returnValue\r\n    // preventDefault()\r\n    // defaultPrevented\r\n    // target\r\n    // timeStamp\r\n    // type\r\n    // isTrusted\r\n  };\r\n\r\n  const properties = Object.assign(defaults, options);\r\n\r\n  return new CustomEvent(name, {\r\n    detail: data,\r\n    ...properties,\r\n  });\r\n}\r\n\r\nexport function __dispatchEvent($element, type, options, payload) {\r\n  const event = __createNewCustomEvent(type, options, payload);\r\n\r\n  // console.log(event);\r\n  $element.dispatchEvent(event);\r\n}\r\n\r\n/* https://plainjs.com/javascript/events/trigger-an-event-11/ */\r\nexport function __triggerEvent(el, type) {\r\n\r\n  if ('createEvent' in document) {\r\n    // modern browsers, IE9+\r\n    const e = new Event(type);\r\n    el.dispatchEvent(e);\r\n  } else {\r\n    // IE 8\r\n    const e = document.createEventObject();\r\n    e.eventType = type;\r\n    el.fireEvent('on' + e.eventType, e);\r\n  }\r\n}\r\n\r\nexport function __keycodeIsPrintableCharacter(keycode) {\r\n\r\n  const valid =\r\n    (keycode > 47 && keycode < 58) || // number keys\r\n    keycode == 32 || keycode == 13 || // spacebar & return key(s) (if you want to allow carriage returns)\r\n    (keycode > 64 && keycode < 91) || // letter keys\r\n    (keycode > 95 && keycode < 112) || // numpad keys\r\n    (keycode > 185 && keycode < 193) || // ;=,-./` (in order)\r\n    (keycode > 218 && keycode < 223); // [\\]' (in order)\r\n  // https://stackoverflow.com/questions/12467240/determine-if-javascript-e-keycode-is-a-printable-non-control-character#answer-12467610\r\n\r\n  return valid;\r\n\r\n}\r\n\r\nexport function __isObject(item) {\r\n  return (item && typeof item === 'object' && !Array.isArray(item));\r\n}\r\n\r\n// https://stackoverflow.com/questions/27936772/how-to-deep-merge-instead-of-shallow-merge\r\n// Maybe use lodash ? https://lodash.com/docs/4.17.10#defaultsDeep\r\nexport function __mergeDeep(target, source) {\r\n  const output = Object.assign({}, target);\r\n  if (__isObject(target) && __isObject(source)) {\r\n    Object.keys(source).forEach((key) => {\r\n      if (__isObject(source[key])) {\r\n        if (!(key in target)) {\r\n          Object.assign(output, { [key]: source[key] });\r\n        } else {\r\n          output[key] = __mergeDeep(target[key], source[key]);\r\n        }\r\n      } else {\r\n        Object.assign(output, { [key]: source[key] });\r\n      }\r\n    });\r\n  }\r\n  return output;\r\n}\r\n\r\nexport function __isObjectEmpty(object) {\r\n  return !Object.keys(object).length;\r\n}\r\n\r\nexport function __insertBefore(newNode, referenceNode) {\r\n  referenceNode.parentNode.insertBefore(newNode, referenceNode);\r\n}\r\n\r\nexport function __insertAfter(newNode, referenceNode) {\r\n\r\n  referenceNode.parentNode.insertBefore(newNode, referenceNode.nextSibling);\r\n\r\n}\r\n\r\nexport function __getRealDimensions(el, translated = true) {\r\n\r\n  const clonedElement = el.cloneNode(true);\r\n\r\n  clonedElement.style.visibility = 'hidden';\r\n  clonedElement.style.display = 'block';\r\n\r\n  __insertAfter(clonedElement, el);\r\n\r\n  const elDimensions = clonedElement.getBoundingClientRect();\r\n  const elPosition = (translated) ? __positionTranslated(clonedElement) : __position(clonedElement);\r\n\r\n\r\n  __remove(clonedElement);\r\n\r\n  return {\r\n    width: elDimensions.width,\r\n    height: elDimensions.height,\r\n    top: elPosition.top,\r\n    left: elPosition.left,\r\n  };\r\n\r\n}\r\n\r\nexport function __remove(el /* :HTMLElement */) {\r\n\r\n  el.parentNode.removeChild(el);\r\n\r\n}\r\n\r\n\r\nexport function __getHTML(node) {\r\n\r\n  if (!node || !node.tagName) { return; }\r\n  if (node.outerHTML) { return node.outerHTML; }\r\n\r\n  // polyfill:\r\n  const wrapper = document.createElement('div');\r\n  wrapper.appendChild(node.cloneNode(true));\r\n  return wrapper.innerHTML;\r\n\r\n}\r\n\r\nexport function __getText(el) {\r\n  return el.innerText || el.textContent;\r\n}\r\n\r\nexport function __globalPosition(event) {\r\n  // d3.event\r\n  // The current event, if any. This is set during the invocation of an event listener, and is reset after the listener terminates. Use this to access standard event fields such as event.timeStamp and methods such as event.preventDefault. While you can use the native event.pageX and event.pageY, it is often more convenient to transform the event position to the local coordinate system of the container that received the event using d3.mouse, d3.touch or d3.touches.\r\n  // If you use Babel, Webpack, or another ES6-to-ES5 bundler, be aware that the value of d3.event changes during an event! An import of d3.event must be a live binding, so you may need to configure the bundler to import from D3’s ES6 modules rather than from the generated UMD bundle; not all bundlers observe jsnext:main. Also beware of conflicts with the window.event global.\r\n  return {\r\n    x: event.pageX,\r\n    y: event.pageY,\r\n  };\r\n}\r\n\r\nexport function __localPosition(container) {\r\n  // d3.mouse\r\n  // Returns the x and y coordinates of the current event relative to the specified container. The container may be an HTML or SVG container element, such as a G element or an SVG element. The coordinates are returned as a two-element array of numbers [x, y].\r\n  // BUG: d3.mouse doesn’t observe CSS transform on Firefox — https://github.com/d3/d3-selection/issues/81\r\n  // TEMPORARY FIX: https://github.com/d3/d3-selection/issues/191#issuecomment-474987103\r\n\r\n  let position = [];\r\n\r\n  if (platform.name === 'Firefox' && d3.event.target.closest('.half-slide-active')) {\r\n    // this works for Firefox even in transformed container\r\n    // if (platform.name === 'Firefox')\r\n    // but creates another bug when used on top of another SVG element (with different viewbox?),\r\n    // so make temporary fix only of .half-slide-active to fix the orginal bug with new bug\r\n    // console.log(d3.event.target.closest('.half-slide-active'));\r\n    position = [\r\n      d3.event.offsetX,\r\n      d3.event.offsetY,\r\n    ];\r\n  } else {\r\n    // this works for Chrome\r\n    position = d3.mouse(container);\r\n  }\r\n\r\n  return {\r\n    x: d3.format('.0f')(position[0]),\r\n    y: d3.format('.0f')(position[1]),\r\n  };\r\n}\r\n\r\nexport function __positionTranslated(el) {\r\n\r\n\r\n  const curTransform = new WebKitCSSMatrix(window.getComputedStyle(el).webkitTransform);\r\n\r\n  const body = document.body;\r\n\r\n  const scrollTop = window.pageYOffset || body.scrollTop;\r\n  const scrollLeft = window.pageXOffset || body.scrollLeft;\r\n\r\n  return {\r\n    left: el.offsetLeft + curTransform.m41,\r\n    top: el.offsetTop + curTransform.m42,\r\n  };\r\n\r\n}\r\n\r\nexport function __position(el) {\r\n\r\n  const elAttibutes = el.getBoundingClientRect();\r\n  const body = document.body;\r\n\r\n  const scrollTop = window.pageYOffset || body.scrollTop;\r\n  const scrollLeft = window.pageXOffset || body.scrollLeft;\r\n\r\n  return {\r\n    left: elAttibutes.left + scrollLeft,\r\n    top: elAttibutes.top + scrollTop,\r\n    height: elAttibutes.height,\r\n    width: elAttibutes.width,\r\n  };\r\n}\r\n\r\n// TODO: check for https://github.com/vladocar/nanoJS/\r\nexport function __toggleClass(element, cls) {\r\n  if (__hasClass(element, cls)) {\r\n    __removeClass(element, cls);\r\n  } else {\r\n    __addClass(element, cls);\r\n  }\r\n}\r\n\r\nexport function __hasClass(element, cls) {\r\n  // if there are no elements or classes, we're done\r\n  if (!element || !cls) return false;\r\n  return (element.classList) ? element.classList.contains(cls) : (`${element.className} `).indexOf(`${cls} `) > -1;\r\n}\r\n\r\nexport function __addClass(elements, classes) {\r\n  let _elements = elements;\r\n  let _classes = classes;\r\n\r\n  // if there are no elements or classes, we're done\r\n  if (!_elements || !_classes) { return; }\r\n\r\n  if (typeof (_elements) === 'string') {\r\n    // if we have a selector, get the chosen _elements\r\n    _elements = document.querySelectorAll(_elements);\r\n  } else if (_elements.tagName) {\r\n    // if we have a single DOM element, make it an array to simplify behavior\r\n    _elements = [_elements];\r\n  }\r\n\r\n  if (typeof (_classes) === 'string') {\r\n    // make an array from string _classes\r\n    _classes = _classes.split(' ');\r\n  } else {\r\n    console.log('Class argument must be string with spaces in between class names.');\r\n    return;\r\n  }\r\n\r\n  // add class to all chosen _elements\r\n  for (let i = 0; i < _elements.length; i += 1) {\r\n    // check classList support\r\n    if (_elements[i].classList) {\r\n      _elements[i].classList.add(..._classes);\r\n    } else if (!__hasClass(_elements[i], ..._classes)) {\r\n      for (let j = 0; j < _classes.length; j += 1) {\r\n        _elements[i].classes += ` ${_classes[j]}`;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport function __removeClass(elements, classes) {\r\n  let _elements = elements;\r\n  let _classes = classes;\r\n\r\n  // if there are no elements or classes, we're done\r\n  if (!_elements || !_classes) { return; }\r\n\r\n  if (typeof (_elements) === 'string') {\r\n    // if we have a selector, get the chosen _elements\r\n    _elements = document.querySelectorAll(_elements);\r\n  } else if (_elements.tagName) {\r\n    // if we have a single DOM element, make it an array to simplify behavior\r\n    _elements = [_elements];\r\n  }\r\n\r\n  if (typeof (_classes) === 'string') {\r\n    // make an array from string _classes\r\n    _classes = _classes.split(' ');\r\n  } else {\r\n    console.log('Class argument must be string with spaces in between class names.');\r\n    return;\r\n  }\r\n\r\n  // remove class from all chosen _elements\r\n  for (let i = 0; i < _elements.length; i += 1) {\r\n    // check classList support\r\n    if (_elements[i].classList) {\r\n      _elements[i].classList.remove(..._classes);\r\n    } else {\r\n      for (let j = 0; j < _classes.length; j += 1) {\r\n        _elements[i].className = _elements[i].className.replace(new RegExp(`\\\\b${classes[j]}\\\\b`, 'g'), '');\r\n      }\r\n    }\r\n  }\r\n}\r\n","import { __createNewCustomEvent } from '../../lib/utils';\r\n\r\nconst mediaEvents = {\r\n  playchange: __createNewCustomEvent('playchange'),\r\n  timechange: __createNewCustomEvent('timechange'),\r\n  canplaystart: __createNewCustomEvent('canplaystart'),\r\n};\r\n\r\nfunction stopPlayingVideoPlayers($players) {\r\n  // pause all other playing media tracks\r\n  $players.forEach(($player) => {\r\n    const $media = $player.querySelector('audio') || $player.querySelector('video');\r\n    if ($media && !$media.paused) {\r\n      $media.pause();\r\n      $player\r\n        .querySelector('[data-player-control]')\r\n        .setAttribute('data-player-control', 'paused');\r\n    }\r\n  });\r\n}\r\n\r\nfunction getSecondsMinutesFormat(seconds) {\r\n  const duration = {\r\n    seconds: Math.floor(seconds),\r\n    minutes: Math.floor(seconds / 60),\r\n  };\r\n\r\n  duration.seconds = (duration.seconds - (duration.minutes * 60)).toString(10);\r\n\r\n  return `${duration.minutes}:${(`0${duration.seconds}`).slice(-2)}`;\r\n}\r\n\r\nexport {\r\n  getSecondsMinutesFormat,\r\n  stopPlayingVideoPlayers,\r\n  mediaEvents,\r\n};\r\n","import Component from '../component';\nimport { getSecondsMinutesFormat, stopPlayingVideoPlayers } from './media';\n\nexport default class AudioPlayer extends Component {\n  // eslint-disable-next-line no-useless-constructor\n  constructor($element) {\n    super($element);\n  }\n\n  // TODO: move to audio-simple.js\n  static addEventListeners($item, showFeedback) {\n    const $players = document.querySelectorAll('[data-player-audio]');\n    const $audio = $item.querySelector('audio');\n    const $playButton = $item.querySelector('[data-player-control]');\n    const $timeLeft = $item.querySelector('[data-audio-time-left]');\n\n    $playButton.addEventListener('click', (event) => {\n      if ($playButton.getAttribute('data-player-control') === 'paused') {\n        // TODO: abstract\n        stopPlayingVideoPlayers($players);\n        $audio.play();\n        $playButton.setAttribute('data-player-control', 'playing');\n      } else {\n        // TODO: abstract\n        $audio.pause();\n        $playButton.setAttribute('data-player-control', 'paused');\n      }\n\n      showFeedback();\n\n      event.stopPropagation();\n    }, false);\n\n    // do not propagate audio control events higher into the dom\n    $playButton.addEventListener('mousedown', (event) => {\n      event.stopPropagation();\n    }, false);\n\n    $audio.addEventListener('timeupdate', () => {\n      $timeLeft.innerText = getSecondsMinutesFormat($audio.currentTime);\n    });\n\n    $audio.addEventListener('ended', () => {\n      $playButton.setAttribute('data-player-control', 'paused');\n    });\n  }\n}\n","export default class SVGDragNDrop {\r\n  // static drag(id) {\r\n  //   d3.drag()\r\n  //     .on('start', () => {\r\n  //       SVGDragNDrop.start(id);\r\n  //     })\r\n  //     .on('drag', () => {\r\n  //       SVGDragNDrop.dragged(id);\r\n  //     })\r\n  //     .on('end', () => {\r\n  //       SVGDragNDrop.end(id);\r\n  //     });\r\n  // }\r\n\r\n  static start(element) {\r\n    d3.select(element).raise().classed('is-dragged', true);\r\n  }\r\n\r\n  static dragged(element, type, diff, $node) {\r\n    let [xZarov, yZarov] = this.getJustifiedCord(element, type, diff, $node);\r\n    d3.select(element).attr('x', xZarov.toFixed()).attr('y', yZarov.toFixed());\r\n  }\r\n\r\n  static end(element, type, diff, $node) {\r\n    let [xZarov, yZarov] = this.getJustifiedCord(element, type, diff, $node);\r\n    d3.select(element)\r\n      .attr('x', xZarov.toFixed())\r\n      .attr('y', yZarov.toFixed())\r\n      // neumožňuje v jiných funkcí s tímto objektem dále pracovat,\r\n      // protože pracují s id\r\n      // .attr('id', `${type}-${d3.event.x.toFixed()}-${d3.event.y.toFixed()}`)\r\n      .classed('is-dragged', false);\r\n  }\r\n\r\n  /**\r\n   * Method which return additional offsets due the orientation of textarea\r\n   * @returns {Array} [x,y]\r\n   *\r\n   * @param {Object} orientation object of orentation of textarea against black dot\r\n   * @param {Object} elementResolution object of element resolution\r\n   */\r\n  static getOffsetOfText(orientation, elementResolution) {\r\n    if (orientation[0] === 'left' && orientation[1] === 'top') {\r\n      return [elementResolution.width - 10, elementResolution.height - 10];\r\n    }\r\n    if (orientation[0] === 'left' && orientation[1] === 'bottom') {\r\n      return [elementResolution.width - 10, 0];\r\n    }\r\n    if (orientation[0] === 'right' && orientation[1] === 'top') {\r\n      return [0, elementResolution.height - 10];\r\n    }\r\n    if (orientation[0] === 'right' && orientation[1] === 'bottom') {\r\n      return [0, 0];\r\n    }\r\n  }\r\n\r\n  static getJustifiedCord(element, type, diff, $node) {\r\n    const elementResolution = {\r\n      height: $node.offsetHeight,\r\n      width: $node.offsetWidth,\r\n    };\r\n    const svgResolution = element\r\n      .getAttribute('data-svg-resolution')\r\n      .split(', ')\r\n      .map((e) => parseInt(e, 10));\r\n\r\n    switch (type) {\r\n      case 'text':\r\n        return this.textJustified(\r\n          element,\r\n          diff,\r\n          elementResolution,\r\n          svgResolution\r\n        );\r\n      case 'pretahovani':\r\n        return this.pretahovaniJustified(\r\n          element,\r\n          diff,\r\n          elementResolution,\r\n          svgResolution\r\n        );\r\n      case 'circle':\r\n        return this.circleJustified(svgResolution, diff, elementResolution);\r\n      default:\r\n        return this.circleJustified(svgResolution, diff, elementResolution);\r\n    }\r\n  }\r\n\r\n  static textJustified(element, diff, elementResolution, svgResolution) {\r\n    const orientation = element\r\n      .getAttribute('data-svg-text-orientation')\r\n      .split(', ');\r\n    const textCenter = this.getOffsetOfText(orientation, elementResolution);\r\n    let xZarov = 0;\r\n    let yZarov = 0;\r\n\r\n    // for x\r\n    if (d3.event.x - diff.x <= 10 + textCenter[0]) {\r\n      xZarov = 10 + textCenter[0];\r\n    } else if (\r\n      d3.event.x - diff.x >\r\n      svgResolution[0] - elementResolution.width + textCenter[0]\r\n    ) {\r\n      xZarov = svgResolution[0] - elementResolution.width + textCenter[0];\r\n    } else {\r\n      xZarov = d3.event.x - diff.x;\r\n    }\r\n    // for y\r\n    if (d3.event.y - diff.y <= 10 + textCenter[1]) {\r\n      yZarov = 10 + textCenter[1];\r\n    } else if (\r\n      d3.event.y - diff.y >\r\n      svgResolution[1] - elementResolution.height + textCenter[1]\r\n    ) {\r\n      yZarov = svgResolution[1] - elementResolution.height + textCenter[1];\r\n    } else {\r\n      yZarov = d3.event.y - diff.y;\r\n    }\r\n    return [xZarov, yZarov];\r\n  }\r\n\r\n  static pretahovaniJustified(element, diff, elementResolution, svgResolution) {\r\n    elementResolution.height = element.attributes.height.value;\r\n    elementResolution.width = element.attributes.width.value;\r\n    let xZarov = 0;\r\n    let yZarov = 0;\r\n    // FOR X\r\n    // left side\r\n    if (d3.event.x - diff.x <= 0) {\r\n      xZarov = 0;\r\n    }\r\n    // right side\r\n    else if (d3.event.x - diff.x > svgResolution[0] - elementResolution.width) {\r\n      xZarov = svgResolution[0] - elementResolution.width;\r\n    }\r\n    // else for X axis\r\n    else {\r\n      xZarov = d3.event.x - diff.x;\r\n    }\r\n    // FOR Y\r\n    // upper side\r\n    if (d3.event.y - diff.y <= 0) {\r\n      yZarov = 0;\r\n    }\r\n    // down side\r\n    else if (\r\n      d3.event.y - diff.y >\r\n      svgResolution[1] - elementResolution.height\r\n    ) {\r\n      yZarov = svgResolution[1] - elementResolution.height;\r\n    }\r\n    // else for y\r\n    else {\r\n      yZarov = d3.event.y - diff.y;\r\n    }\r\n    return [xZarov, yZarov];\r\n  }\r\n\r\n  static circleJustified(svgResolution, diff, elementResolution) {\r\n    let xZarov = 0;\r\n    let yZarov = 0;\r\n    // FOR X\r\n    // left side\r\n    if (d3.event.x - diff.x <= elementResolution.width / 2) {\r\n      xZarov = elementResolution.width / 2;\r\n    }\r\n    // right side\r\n    else if (\r\n      d3.event.x - diff.x >\r\n      svgResolution[0] - elementResolution.width / 2\r\n    ) {\r\n      xZarov = svgResolution[0] - elementResolution.width / 2;\r\n    }\r\n    // else for X axis\r\n    else {\r\n      xZarov = d3.event.x - diff.x;\r\n    }\r\n    // FOR Y\r\n    // upper side\r\n    if (d3.event.y - diff.y <= elementResolution.height / 2) {\r\n      yZarov = elementResolution.height / 2;\r\n    }\r\n    // down side\r\n    else if (\r\n      d3.event.y - diff.y >\r\n      svgResolution[1] - elementResolution.height / 2\r\n    ) {\r\n      yZarov = svgResolution[1] - elementResolution.height / 2;\r\n    }\r\n    // else for y\r\n    else {\r\n      yZarov = d3.event.y - diff.y;\r\n    }\r\n    return [xZarov, yZarov];\r\n  }\r\n}\r\n","import { __localPosition, __dispatchEvent } from '../../lib/utils';\r\n\r\n// import SVG from '../svg';\r\nimport SVGDragNDrop from './svg-dragndrop';\r\nimport SVG from '../svg';\r\n\r\nexport default class SVGDraw {\r\n  // static selectPath(svg) {\r\n  //   // https://bl.ocks.org/mbostock/8027637\r\n  // }\r\n\r\n  static renderPath($svg, color, callback) {\r\n    if (d3.event.sourceEvent.target.nodeName === 'image') {\r\n\r\n      const line = d3.line()\r\n        // removed smooth curve to get rid of loong decimals\r\n        // see https://github.com/d3/d3-path/issues/10\r\n        .curve(d3.curveLinear); // _dragStarted\r\n\r\n      const format = d3.format('.0f');\r\n      const d = d3.event.subject;\r\n      // origin\r\n      let x0 = format(d3.event.x);\r\n      let y0 = format(d3.event.y);\r\n\r\n      const id = `${$svg.id}_path-${x0}-${y0}`;\r\n\r\n      const active = d3.select(`#${$svg.id} .svg-view`).append('svg:path')\r\n        // .attr('marker-start', 'url('#marker-circle-blue')')\r\n        // .attr('marker-end', 'url('#marker-arrow-blue')')\r\n        .attr('data-svg-path', '')\r\n        .attr('class', `svg-path ${color}`)\r\n        .attr('id', id)\r\n        .datum(d);\r\n\r\n      // github.com/d3/d3-drag#event_on\r\n      d3.event\r\n        .on('drag', () => {\r\n          // current position\r\n          const x1 = format(d3.event.x);\r\n          const y1 = format(d3.event.y);\r\n          // distance from origin\r\n          const dx = x1 - x0;\r\n          const dy = y1 - y0;\r\n\r\n          // if the distance of drag event is too large, make new origin\r\n          if ((dx * dx) + (dy * dy) > 300) d.push([x0 = x1, y0 = y1]);\r\n          // smooth line, correct last point\r\n          else d[d.length - 1] = [x1, y1];\r\n\r\n          active.attr('d', line);\r\n        })\r\n        .on('end', () => {\r\n          const $thisPath = d3.select(`#${id}`);\r\n          if ($thisPath) {\r\n            if ($thisPath.attr('d')) {\r\n              if ($thisPath.attr('d').length < 40) {\r\n                $thisPath.remove();\r\n              } else {\r\n                // dispatch event that svg has changed\r\n                __dispatchEvent(document, 'svg.change', {}, {\r\n                  svg: {\r\n                    id: $svg.id,\r\n                    task: 'create',\r\n                    node: $thisPath.node(),\r\n                    nodeName: $thisPath.node().nodeName,\r\n                    contextMenu: false,\r\n                  },\r\n                });\r\n              }\r\n            } else if (!$thisPath.attr('d')) {\r\n              $thisPath.remove();\r\n            }\r\n          }\r\n\r\n          callback();\r\n        });\r\n\r\n      // add events to element\r\n      SVGDraw.pathEventsManager($svg, d3.select(`#${id}`).node());\r\n    }\r\n  }\r\n\r\n  // Draw a SVG circle on click\r\n  static createCircle($svg, color) {\r\n    const svgGroup = d3.select($svg).select('.svg-view');\r\n    //d3.select(`#${$svg.id} .svg-view`);\r\n    // const canvas = document.querySelector(`#${$svg.id} .svg-view`);\r\n    const localPosition = __localPosition($svg);\r\n    const id = `${$svg.id}_circle-${localPosition.x}-${localPosition.y}`;\r\n\r\n    // circle wrapper\r\n    const foreignObject = svgGroup.append('svg:foreignObject')\r\n      .attr('data-svg-circle', '')\r\n      .attr('id', id)\r\n      .attr('x', localPosition.x)\r\n      .attr('y', localPosition.y)\r\n      .attr('data-svg-resolution', `${svgGroup.attr('width')}, ${svgGroup.attr('height')}`)\r\n      .attr('data-svg-type', 'circle')\r\n      .attr('width', 1)\r\n      .attr('height', 1);\r\n\r\n    const circle = foreignObject.append('xhtml:div')\r\n      .attr('class', `svg-circle ${color}`);\r\n\r\n    const $element = document.querySelector(`#${id}`);\r\n\r\n    const $node = $element.firstChild;\r\n    // add events to element\r\n    SVGDraw.circleEventsManager($svg, $element, $node, 'circle');\r\n\r\n    // dispatch event that svg has changed\r\n    __dispatchEvent(document, 'svg.change', {}, {\r\n      svg: {\r\n        id: $svg.id,\r\n        task: 'create',\r\n        node: $element,\r\n        nodeName: $element.nodeName,\r\n        contextMenu: false,\r\n      },\r\n    });\r\n  }\r\n\r\n  static pathEventsManager($svg, $element) {\r\n    d3.select(`#${$element.id}`).on('click', () => {\r\n      // dispatch event that svg has changed\r\n      __dispatchEvent(document, 'svg.change', {}, {\r\n        svg: {\r\n          id: $svg.id,\r\n          task: 'remove',\r\n          node: d3.event.target,\r\n          nodeName: d3.event.target.nodeName,\r\n          contextMenu: false,\r\n        },\r\n      });\r\n\r\n      d3.select(`#${$element.id}`).remove();\r\n\r\n      d3.event.preventDefault();\r\n    }, false);\r\n  }\r\n\r\n  static circleEventsManager($svg, $element, $node, type) {\r\n    const $canvas = document.querySelector(`#${$svg.id} .svg-view`);\r\n\r\n    // TODO:\r\n    // standalone function\r\n    // same for all draggable svg elements\r\n    let elementPosition = [\r\n      $element.getAttribute('x'),\r\n      $element.getAttribute('y'),\r\n    ];\r\n    let diff = {};\r\n\r\n    const selection = d3.selectAll(`#${$element.id} > div`);\r\n    d3.select(selection.nodes()[0]).on('click', () => {\r\n\r\n      // dispatch event that svg has changed\r\n      __dispatchEvent(document, 'svg.change', {}, {\r\n        svg: {\r\n          id: $svg.id,\r\n          task: 'remove',\r\n          node: $element,\r\n          nodeName: $element.nodeName,\r\n          contextMenu: false,\r\n        },\r\n      });\r\n\r\n      // dispatch event that drop item was deleted\r\n      const idParts = $element.id.split('_');\r\n      if (idParts[idParts.length - 1] === 'dropItem') {\r\n        __dispatchEvent(document, 'svg.drop.delete', {}, {\r\n          item: {\r\n            id: idParts[1],\r\n            $object: $element.firstChild,\r\n          },\r\n        });\r\n      }\r\n\r\n      d3.event.target.closest('foreignObject').remove();\r\n    })\r\n      .call(d3.drag()\r\n        .container($canvas)\r\n        .subject($element)\r\n        .on('start', () => {\r\n          diff = {\r\n            x: d3.event.x - elementPosition[0],\r\n            y: d3.event.y - elementPosition[1],\r\n          };\r\n\r\n          SVGDragNDrop.start($element);\r\n        })\r\n        .on('drag', () => {\r\n          SVGDragNDrop.dragged($element, type, diff, $node);\r\n        })\r\n        .on('end', () => {\r\n          const oldXCoordinate = elementPosition[0];\r\n          const oldYCoordinate = elementPosition[1];\r\n          let taskType = 'move';\r\n\r\n          SVGDragNDrop.end($element, type, diff,  $node);\r\n\r\n          elementPosition = [\r\n            $element.getAttribute('x'),\r\n            $element.getAttribute('y'),\r\n          ];\r\n\r\n          // if clone is changed, then dispatch create event\r\n          if (SVG.removeCloneConnectionManager($element)) taskType = 'create';\r\n\r\n          if (elementPosition[0] !== oldXCoordinate || elementPosition[1] !== oldYCoordinate) {\r\n            // dispatch event that svg has changed\r\n            __dispatchEvent(document, 'svg.change', {}, {\r\n              svg: {\r\n                id: $svg.id,\r\n                task: taskType,\r\n                node: $element,\r\n                nodeName: $element.nodeName,\r\n                contextMenu: false,\r\n              },\r\n            });\r\n          }\r\n        }));\r\n  }\r\n}\r\n","import {\r\n  __addClass,\r\n  __removeClass,\r\n  __hasClass,\r\n  __dispatchEvent,\r\n} from '../../lib/utils';\r\n\r\nimport SVG from '../svg';\r\nimport SVGDragNDrop from './svg-dragndrop';\r\n\r\nexport default class SVGText {\r\n  static createText(maxLength = 333, minLength = 2) {\r\n    const $svg = document.querySelector('[data-svg-active=\"true\"]');\r\n    const svgID = $svg.id;\r\n    const svgGroup = d3.select($svg).select('.svg-view');\r\n\r\n    // const $canvas = $svg.querySelector('.svg-view');\r\n    const $radialMenu = document.querySelector('[data-radial-menu]');\r\n    const localPosition = {\r\n      x: $radialMenu.getAttribute('data-local-x'),\r\n      y: $radialMenu.getAttribute('data-local-y'),\r\n    };\r\n    const id = `${svgID}_svg-text-${localPosition.x}-${localPosition.y}`;\r\n    const hash = `#${id}`;\r\n    const orientation = {\r\n      x: (svgGroup.attr('width') - localPosition.x) > 320 ? 'right' : 'left',\r\n      y: (svgGroup.attr('height') - localPosition.y) > 60 ? 'bottom' : 'top',\r\n    };\r\n    // let firstWrite = true;\r\n\r\n    // text wrapper\r\n    const foreignObject = svgGroup.append('svg:foreignObject')\r\n      .attr('class', `svg-text orientation-${orientation.x} orientation-${orientation.y}`)\r\n      .attr('data-svg-text', '')\r\n      .attr('x', localPosition.x)\r\n      .attr('y', localPosition.y)\r\n      .attr('data-svg-text-orientation', `${orientation.x}, ${orientation.y}`)\r\n      .attr('data-svg-resolution', `${svgGroup.attr('width')}, ${svgGroup.attr('height')}`)\r\n      .attr('width', 1)\r\n      .attr('height', 1);\r\n\r\n    // create visual point of interest for text input\r\n    foreignObject.append('xhtml:div')\r\n      .attr('class', 'svg-circle svg-circle-text');\r\n    // create text input\r\n    const textarea = foreignObject.append('xhtml:textarea')\r\n      .attr('maxlength', maxLength)\r\n      .attr('tabindex', '-1')\r\n      .attr('id', id)\r\n      .attr('class', 'svg-textarea')\r\n      .attr('data-save', '')\r\n      .attr('data-svg-textarea-target', svgID);\r\n\r\n    // set focus to the new text input\r\n    $svg.querySelector(hash).focus();\r\n\r\n    // add events to element\r\n    SVGText.textEventsManager($svg, textarea.node(), true, minLength);\r\n  }\r\n\r\n  static textEventsManager($svg, $node, isCreated, minLength = 2) {\r\n    const $canvas = $svg.querySelector('.svg-view');\r\n    const hash = `#${$node.id}`;\r\n    let firstWrite = isCreated;\r\n    let oldText = $node.value;\r\n\r\n    // TODO\r\n    // standalone function\r\n    // same for all draggable svg elements\r\n    const $element = $svg.querySelector(hash).parentElement;\r\n    let elementPosition = [\r\n      $element.getAttribute('x'),\r\n      $element.getAttribute('y'),\r\n    ];\r\n    let diff = {};\r\n\r\n    d3.select(hash)\r\n      // drag & drop\r\n      .call(d3.drag()\r\n        .container($canvas)\r\n        .subject($element)\r\n        .on('start', () => {\r\n          diff = {\r\n            x: d3.event.x - elementPosition[0],\r\n            y: d3.event.y - elementPosition[1],\r\n          };\r\n\r\n          SVGDragNDrop.start($element);\r\n        })\r\n        .on('drag', () => {\r\n          SVGDragNDrop.dragged($element, 'text', diff, $node);\r\n        })\r\n        .on('end', () => {\r\n          const oldXCoordinate = elementPosition[0];\r\n          const oldYCoordinate = elementPosition[1];\r\n          let taskType = 'move';\r\n\r\n          SVGDragNDrop.end($element, 'text', diff, $node);\r\n\r\n          elementPosition = [\r\n            $element.getAttribute('x'),\r\n            $element.getAttribute('y'),\r\n          ];\r\n\r\n          if (!firstWrite && (elementPosition[0] !== oldXCoordinate || elementPosition[1] !== oldYCoordinate)) {\r\n            // if clone is changed, then dispatch create event\r\n            if (SVG.removeCloneConnectionManager($element.childNodes[1])) taskType = 'create';\r\n\r\n            // dispatch event that svg has changed\r\n            __dispatchEvent(document, 'svg.change', {}, {\r\n              svg: {\r\n                id: $svg.id,\r\n                task: taskType,\r\n                node: $element.childNodes[1],\r\n                nodeName: $element.childNodes[1].nodeName,\r\n                contextMenu: false,\r\n              },\r\n            });\r\n          }\r\n        }))\r\n      // keystroke\r\n      // control height of the text input on every key stroke\r\n      .on('keyup', () => {\r\n        SVGText.updateTextareaHeight(d3.event.target);\r\n      })\r\n      // loss of focus\r\n      .on('blur', () => {\r\n        const $target = d3.event.target;\r\n        const { value } = $target;\r\n        let taskType;\r\n        let wrongBool = false;\r\n\r\n        if (value.length === 0) {\r\n          SVG.removeItem(false, hash);\r\n          return;\r\n        }\r\n        if (value.length < minLength) {\r\n          __addClass($target, 'is-wrong');\r\n          wrongBool = true;\r\n        } else if ((value.length >= minLength) && __hasClass($target, 'is-wrong')) {\r\n          __removeClass($target, 'is-wrong');\r\n          wrongBool = false;\r\n        }\r\n\r\n        if (oldText !== value) {\r\n          if (firstWrite) {\r\n            taskType = 'create';\r\n            firstWrite = false;\r\n          } else {\r\n            taskType = 'change';\r\n          }\r\n          oldText = value;\r\n          // if clone is changed, then dispatch create event\r\n          if (SVG.removeCloneConnectionManager($target)) taskType = 'create';\r\n\r\n          // dispatch event that svg has changed\r\n          __dispatchEvent(document, 'svg.change', {}, {\r\n            svg: {\r\n              id: $svg.id,\r\n              task: taskType,\r\n              node: $target,\r\n              nodeName: $target.nodeName,\r\n              isWrong: wrongBool,\r\n              contextMenu: false,\r\n            },\r\n          });\r\n        }\r\n\r\n        // update oldText\r\n        oldText = value;\r\n      })\r\n      // gain focus\r\n      .on('focus', () => {\r\n        d3.select($element).raise();\r\n      });\r\n  }\r\n\r\n  static updateTextareaHeight($target) {\r\n    $target.style.height = '1px';\r\n    $target.style.height = `${22 + $target.scrollHeight}px`;\r\n  }\r\n\r\n  static comicBubblesEventsManager($svg, $node) {\r\n    let firstWrite = true;\r\n    let oldText = $node.value;\r\n\r\n    d3.select($node).on('keyup', () => {\r\n      SVGText.updateTextareaHeight(d3.event.target);\r\n    })\r\n      .on('blur', () => {\r\n        const $target = d3.event.target;\r\n        const { value } = $target;\r\n        let taskType;\r\n\r\n        if (oldText !== value) {\r\n          if (firstWrite) {\r\n            taskType = 'create';\r\n            firstWrite = false;\r\n          } else {\r\n            taskType = 'change';\r\n            if (value.length === 0) {\r\n              firstWrite = true;\r\n            }\r\n          }\r\n          oldText = value;\r\n          // if clone is changed, then dispatch create event\r\n          if (SVG.removeCloneConnectionManager($target)) taskType = 'create';\r\n\r\n          // dispatch event that svg has changed\r\n          __dispatchEvent(document, 'svg.change', {}, {\r\n            svg: {\r\n              id: $svg.id,\r\n              task: taskType,\r\n              node: $target,\r\n              nodeName: $target.nodeName,\r\n              isBubble: true,\r\n              contextMenu: false,\r\n            },\r\n          });\r\n        }\r\n\r\n        // update oldText\r\n        oldText = value;\r\n      });\r\n  }\r\n}\r\n","/**\r\n * čára:\r\n *  - nakreslit   ( drag'n'drop )\r\n *  - smazat      ( left click )\r\n *  - radial menu ( right click)\r\n *    - změnit barvu\r\n *    - smazaní\r\n *    - textový komentář\r\n * textové pole:\r\n *  - vytvořit    ( right click on svg )\r\n *    - nic => smaže se\r\n *    - málo znaků => zčervená\r\n *    - přes řádek textu => zvětší se\r\n *  - změnit      ( click on and write )\r\n *  - smazat      ( right click on textarea )\r\n *  - přenést     ( drag'n'drop )\r\n *  - radial menu ( right click on mark )\r\n *    - změnit barvu\r\n *    - smazaní\r\n *    - textový komentář\r\n * značka:\r\n *  - nakreslit   ( left click on svg )\r\n *  - přenést     ( drag'n'drop )\r\n *  - smazat      ( left click on mark )\r\n *  - radial menu ( right click)\r\n *    - změnit barvu\r\n *    - smazaní\r\n *    - textový komentář\r\n * komiksová bublina:  ( je již vytvořena předem )\r\n *  - napsat dovnitř\r\n *    - nic => zůstane\r\n *    - přes řádek textu => zvětší se\r\n */\r\n/* eslint-disable brace-style */\r\nimport Component from './component';\r\nimport { __dispatchEvent, __removeClass, __addClass } from '../lib/utils';\r\nimport SVGDraw from './svg-lib/svg-draw';\r\nimport SVGText from './svg-lib/svg-text';\r\n\r\nexport default class SVG extends Component {\r\n  constructor($element) {\r\n    super($element);\r\n    this.$canvas = this.target.querySelector('.svg-view');\r\n\r\n    this.format = d3.format('.0f');\r\n\r\n    this._setSize();\r\n\r\n    this.init();\r\n    this._initWhenDone();\r\n  }\r\n\r\n  init() {\r\n    if (HISTORYLAB.import.done) return;\r\n\r\n    // duplicate source of different svg element\r\n    this.toDuplicate = this.target.getAttribute('data-duplicate-svg');\r\n\r\n    // make array from data-attributes (contains what kind of actions can user do on this svg)\r\n    const svgSpecificActions = this.target.getAttribute('data-svg-target').split(' ');\r\n\r\n    // get default color\r\n    const colors = this.target.getAttribute('data-svg-colors');\r\n\r\n    for (let i = 0; i < svgSpecificActions.length; i += 1) {\r\n      if (svgSpecificActions[i] === 'kresleni') {\r\n        const svgSpecificColor = colors ? colors.split(' ')[0] : 'yellow';\r\n        this._initPath(this.showFeedback, svgSpecificColor);\r\n      }\r\n      else if (svgSpecificActions[i] === 'znacky') {\r\n        const svgSpecificColor = colors ? colors.split(' ')[0] : 'blue';\r\n        this._initCircle(this.showFeedback, svgSpecificColor);\r\n      }\r\n      // else if (svgSpecificActions[i] === 'text') {\r\n      //   this._initText();\r\n      // }\r\n    }\r\n\r\n    // this._initZoom();\r\n    // comic bubbles if exists\r\n    this._initComicBubbles();\r\n\r\n    // listen events\r\n    this._getEvents();\r\n    this._getDropEvent();\r\n  }\r\n\r\n  // eslint-disable-next-line class-methods-use-this\r\n  _initWhenDone() {\r\n    if (!HISTORYLAB.import.done) return;\r\n\r\n    d3.selectAll('[data-svg-text] textarea')\r\n      // local context needed because of `this`\r\n      // eslint-disable-next-line func-names\r\n      .on('mouseenter', function () {\r\n        d3.select(this.closest('foreignObject')).raise();\r\n      });\r\n  }\r\n\r\n  _setSize() {\r\n    // NOTE: Cannot set `width` because of change of width when on half slide.\r\n    // TODO: set size on window resize\r\n\r\n    // might not be needed when inside sortable or other higher level module\r\n    // TODO: add condition for other higher level modules\r\n    // if (this.target.closest('[data-sortable-target')) return false;\r\n\r\n    const viewbox = this.target.getAttribute('viewBox').split(' ');\r\n    const rect = this.target.getBoundingClientRect(); // max-height: 100vh\r\n    // const getMaxWidthAbsolute = () => {\r\n    //   if (matchMedia('screen and (min-width: 1025px)').matches) {\r\n    //     return window.innerWidth * .8; // max-width: 62vw\r\n    //   }\r\n\r\n    //   return window.innerWidth;\r\n    // };\r\n    const maxWidthAbsolute = window.innerWidth;\r\n    const maxHeightAbsolute = window.innerHeight * .9;\r\n    const getHeight = () => {\r\n      if (!rect.height) return viewbox[3];\r\n      if (rect.height > viewbox[3]) return viewbox[3];\r\n\r\n      return rect.height;\r\n    };\r\n\r\n    const height = getHeight() > maxHeightAbsolute ? maxHeightAbsolute : getHeight();\r\n\r\n    const scale = height / viewbox[3];\r\n    const maxWidth = viewbox[2] * scale;\r\n    const setMaxWidth = scale ? `${maxWidth < maxWidthAbsolute ? maxWidth : maxWidthAbsolute}px` : '';\r\n\r\n    this.target.style.maxWidth = setMaxWidth;\r\n\r\n    // fix for svg + draggable/gallery (horizontal layout) in Chrome\r\n    if (\r\n      this.target.getAttribute('data-svg-drop')\r\n      && !this.target.closest('.layout-vertical')\r\n    ) {\r\n      this.target.closest('.svgs-container').style.maxWidth = setMaxWidth;\r\n    }\r\n  }\r\n\r\n  // _initZoom() {\r\n  //   const view = d3.select(`#${this.target.id} .svg-view`);\r\n  //   const size = [\r\n  //     view.attr('width'),\r\n  //     view.attr('height'),\r\n  //   ];\r\n  //   SVGZoom.zoom(this.target, view, size);\r\n  // }\r\n\r\n  _initPath(callback, color) {\r\n    d3.select(this.target)\r\n      .call(d3.drag()\r\n        .container(() => this.target)\r\n        .subject(() => {\r\n          const p = [d3.event.x.toFixed(), d3.event.y.toFixed()];\r\n\r\n          return [p, p];\r\n        })\r\n        .on('start', () => {\r\n          SVGDraw.renderPath(this.target, color, callback);\r\n        }));\r\n  }\r\n  // _initText() {\r\n  //   d3.select(this.target).on('click', () => {\r\n  //     SVGText.openTextDialog(this.target);\r\n  //     d3.event.preventDefault();\r\n  //   });\r\n  // }\r\n\r\n  _initCircle(callback, color) {\r\n    d3.select(this.target).on('click', () => {\r\n      const item = d3.event.target;\r\n      const nodeName = item.nodeName;\r\n      const validPlace = (nodeName === 'image');\r\n      // const isCircle = (__hasClass(item, 'svg-circle'));\r\n\r\n      if (!validPlace) {\r\n        return;\r\n      }\r\n\r\n      SVGDraw.createCircle(this.target, color);\r\n      callback();\r\n\r\n      d3.event.preventDefault();\r\n    }, false);\r\n  }\r\n\r\n  _initComicBubbles() {\r\n    const $comicBubbles = this.target.querySelectorAll('.svg-komiks .svg-textarea');\r\n\r\n    if ($comicBubbles) {\r\n      $comicBubbles.forEach(($comicBubble) => {\r\n        SVGText.comicBubblesEventsManager(this.target, $comicBubble);\r\n      });\r\n    }\r\n  }\r\n\r\n  _generateNewID(oldID) {\r\n    const idParts = oldID.split('_');\r\n    // beware if it's a error, return oldID\r\n    if (idParts.length < 2) {\r\n      console.log('Svg ID error!', oldID);\r\n      return oldID;\r\n    }\r\n\r\n    // solve thirt part of id\r\n    if (idParts[idParts.length - 1] !== `clone-${idParts[0]}`) {\r\n      idParts.push(`clone-${idParts[0]}`);\r\n    }\r\n\r\n    // solve first part of id\r\n    idParts[0] = this.target.id;\r\n\r\n    const newID = idParts.join('_');\r\n    return newID;\r\n  }\r\n\r\n  _getEvents() {\r\n\r\n    const svgDuplicateSources = this.toDuplicate ? this.toDuplicate.split(' ') : [];\r\n\r\n    if (svgDuplicateSources[0]) {\r\n\r\n      document.addEventListener('svg.change', (e) => {\r\n        if (svgDuplicateSources.includes(e.detail.svg.id)) {\r\n          const $templateNode = e.detail.svg.node;\r\n          const nodeName = e.detail.svg.nodeName;\r\n          const localNodeID = this._generateNewID($templateNode.id);\r\n          let $localNode = this.target.querySelector(`#${localNodeID}`);\r\n          let task;\r\n          // for creating new element or we edit the old one after created one\r\n          if ($localNode || e.detail.svg.task === 'create') {\r\n            task = e.detail.svg.task;\r\n          } else {\r\n            return;\r\n          }\r\n\r\n          /**\r\n           * 1. divided by node name\r\n           * 2. divided by task type\r\n           * path => svg lines\r\n           * TEXTAREA => text fields or comic bubbles\r\n           * foreignObject => svg circles\r\n           */\r\n          if (nodeName === 'path') {\r\n            switch (task) {\r\n              case 'create':\r\n                this._clonePath($templateNode, localNodeID);\r\n                break;\r\n              case 'color':\r\n                __removeClass($localNode, 'red blue');\r\n                __addClass($localNode, e.detail.svg.color);\r\n                break;\r\n              case 'remove':\r\n                $localNode.remove();\r\n                break;\r\n              default:\r\n                console.log('Nondefinated path events task. :(');\r\n            }\r\n          } else if (nodeName === 'TEXTAREA') {\r\n            if (e.detail.svg.isBubble) {\r\n              switch (task) {\r\n                case 'create':\r\n                  this._cloneComicBubbles($templateNode, localNodeID);\r\n                  break;\r\n                case 'change':\r\n                  if ($templateNode.value.length !== 0) {\r\n                    $localNode.value = $templateNode.value;\r\n                    // if needs resize\r\n                    if ($localNode.style.height !== $templateNode.style.height) {\r\n                      $localNode.style.height = $templateNode.style.height;\r\n                    }\r\n                  } else {\r\n                    $localNode.parentElement.remove();\r\n                  }\r\n                  break;\r\n                default:\r\n                  console.log('Nondefinated comicBubble events task. :(');\r\n              }\r\n            } else {\r\n              switch (task) {\r\n                case 'create':\r\n                  this._cloneTextField(e.detail.svg.isWrong, $templateNode, localNodeID);\r\n                  break;\r\n                case 'change':\r\n                  $localNode.value = $templateNode.value;\r\n                  // if is now wrong lenght\r\n                  if (e.detail.svg.isWrong) {\r\n                    __addClass($localNode, 'is-wrong');\r\n                  } else {\r\n                    __removeClass($localNode, 'is-wrong');\r\n                  }\r\n                  // if needs resize\r\n                  if ($localNode.style.height !== $templateNode.style.height) {\r\n                    $localNode.style.height = $templateNode.style.height;\r\n                  }\r\n                  break;\r\n                case 'color':\r\n                  $localNode = $localNode.parentElement.childNodes[0];\r\n                  __removeClass($localNode, 'red blue');\r\n                  __addClass($localNode, e.detail.svg.color);\r\n                  break;\r\n                case 'move':\r\n                  if ($localNode) {\r\n                    $localNode.parentElement.remove();\r\n                  }\r\n                  this._cloneTextField(e.detail.svg.isWrong, $templateNode, localNodeID);\r\n                  break;\r\n                case 'remove':\r\n                  $localNode.parentElement.remove();\r\n                  break;\r\n                default:\r\n                  console.log('Nondefinated textField events task. :(');\r\n              }\r\n            }\r\n          } else if (nodeName === 'foreignObject') {\r\n            switch (task) {\r\n              case 'create':\r\n                this._cloneCircle($templateNode, localNodeID);\r\n                break;\r\n              case 'color':\r\n                $localNode = $localNode.childNodes[0];\r\n                __removeClass($localNode, 'red blue');\r\n                __addClass($localNode, e.detail.svg.color);\r\n                break;\r\n              case 'move':\r\n                if ($localNode) {\r\n                  $localNode.remove();\r\n                }\r\n                this._cloneCircle($templateNode, localNodeID);\r\n                break;\r\n              case 'remove':\r\n                $localNode.remove();\r\n                break;\r\n              default:\r\n                console.log('Nondefinated circle events task. :(');\r\n            }\r\n          } else {\r\n            console.log('Nondefinated events nodeName. :(', nodeName);\r\n          }\r\n\r\n          // dispatch event that svg has changed\r\n          __dispatchEvent(document, 'svg.change', {}, {\r\n            svg: {\r\n              id: this.target.id,\r\n              task: e.detail.svg.task,\r\n              node: $templateNode,\r\n              nodeName,\r\n              contextMenu: false,\r\n            },\r\n          });\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  _getDropEvent() {\r\n    // need if we drop more than one same item\r\n    let idSalt = 0;\r\n\r\n    document.addEventListener('svg.drop', (event) => {\r\n\r\n      if (event.detail.svg.id === this.target.id) {\r\n\r\n        const { $node, position, type, size } = event.detail.svg;\r\n\r\n        const getMultiply = () => {\r\n          // make images smaller when dropped\r\n          if (type === 'image' || type === 'svg') return .62;\r\n          // make tags larger when dropped to not jump on more lines\r\n          if (type === 'tag') return 1.075;\r\n\r\n          return 1;\r\n        }\r\n        const multiply = getMultiply();\r\n\r\n        size.width = size.width * multiply;\r\n        size.height = size.height * multiply;\r\n\r\n        const $d3canvas = d3.select(`#${this.target.id} .svg-view`);\r\n        const $d3foreignObject = $d3canvas.append('svg:foreignObject')\r\n          .attr('width', size.width)\r\n          .attr('height', size.height)\r\n          .attr('x', this.format(position[0] - (size.width / 2)))\r\n          .attr('y', this.format(position[1] - (size.height / 2)))\r\n          .attr('data-svg-resolution', `${$d3canvas.attr('width')}, ${$d3canvas.attr('height')}`)\r\n          .attr('data-svg-type', 'pretahovani')\r\n          .attr('id', `${this.target.id}_${$node.getAttribute('data-id')}_${idSalt}_dropItem`);\r\n          // _dropItem is important identifier\r\n\r\n        const $dropItem = document.createElement('div');\r\n        $dropItem.classList.add('dropped__item', `dropped__item--${type}`);\r\n        $dropItem.appendChild($node.firstElementChild.firstElementChild);\r\n\r\n        $d3foreignObject.append(() => $dropItem);\r\n\r\n        const $foreignObject = $d3foreignObject.node();\r\n\r\n        // increment salt\r\n        idSalt += 1;\r\n\r\n        // add events to element\r\n        SVGDraw.circleEventsManager(this.target, $foreignObject, $node, 'pretahovani');\r\n\r\n        // dispatch event that svg has changed\r\n        __dispatchEvent(document, 'svg.change', {}, {\r\n          svg: {\r\n            id: this.target.id,\r\n            task: 'create',\r\n            node: $foreignObject,\r\n            nodeName: $foreignObject.nodeName,\r\n            contextMenu: false,\r\n          },\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  _clonePath($templateNode, localNodeID) {\r\n    const $localNode = $templateNode.cloneNode(true);\r\n    $localNode.id = localNodeID;\r\n    this.$canvas.appendChild($localNode);\r\n    // add events to element\r\n    SVGDraw.pathEventsManager(this.target, $localNode);\r\n  }\r\n\r\n  _cloneTextField(isWrong, $templateNode, localNodeID) {\r\n    const $localNode = $templateNode.parentElement.cloneNode(true);\r\n    $localNode.childNodes[1].id = localNodeID;\r\n    this.$canvas.appendChild($localNode);\r\n    if (isWrong) {\r\n      __addClass($localNode, 'is-wrong');\r\n    } else {\r\n      __removeClass($localNode, 'is-wrong');\r\n    }\r\n    // add events to element\r\n    SVGText.textEventsManager(this.target, $localNode.childNodes[1], false);\r\n  }\r\n\r\n  _cloneCircle($templateNode, localNodeID) {\r\n    const $localNode = $templateNode.cloneNode(true);\r\n    $localNode.id = localNodeID;\r\n    this.$canvas.appendChild($localNode);\r\n    // add events to element\r\n    const $node = $localNode.firstChild;\r\n    SVGDraw.circleEventsManager(this.target, $localNode, $node, $templateNode.getAttribute('data-svg-type'));\r\n  }\r\n\r\n  _cloneComicBubbles($templateNode, localNodeID) {\r\n    const $localNode = $templateNode.parentElement.cloneNode(true);\r\n    $localNode.childNodes[1].id = localNodeID;\r\n    this.$canvas.appendChild($localNode);\r\n    // add events to element\r\n    SVGText.comicBubblesEventsManager(this.target, $localNode.childNodes[1]);\r\n  }\r\n\r\n  static selectItem(item) {\r\n    item.setAttribute('data-svg-selected', 'true');\r\n  }\r\n\r\n  // Remove 'selected' classname from element within SVG\r\n  static deselectItem() {\r\n    // previously \"selected\" elements\r\n    const selected = document.querySelectorAll('[data-svg-selected=\"true\"]');\r\n    // unselect them\r\n    for (let i = 0; i < selected.length; i += 1) {\r\n      selected[i].setAttribute('data-svg-selected', 'false');\r\n    }\r\n  }\r\n\r\n  // Remove element from within SVG\r\n  // [data-svg-selected=\"true\"] marks selected element in SVG\r\n  static removeItem(isRadial, element = '[data-svg-selected=\"true\"]') {\r\n    let $element = document.querySelector(element);\r\n    let nodeName = $element.nodeName;\r\n    const $parent = $element.parentElement; // for <foreignObject>\r\n\r\n    // TEXTAREA => text field(right click in textarea)\r\n    // DIV => text field(click in radial menu) or circle\r\n    switch (nodeName) {\r\n      case 'path':\r\n        // $element = $element;\r\n        break;\r\n      case 'TEXTAREA':\r\n        // $element = $element;\r\n        break;\r\n      case 'DIV':\r\n        if ($parent.childNodes[1]) {\r\n          $element = $parent.childNodes[1];\r\n        } else {\r\n          $element = $parent;\r\n        }\r\n        nodeName = $element.nodeName;\r\n        break;\r\n      default:\r\n        console.log('Nondefinated node type. :(', nodeName);\r\n    }\r\n\r\n    // get svg id from object id\r\n    const svgID = $element.id.split('_')[0];\r\n\r\n    // dispatch event that svg has changed\r\n    __dispatchEvent(document, 'svg.change', {}, {\r\n      svg: {\r\n        id: svgID,\r\n        task: 'remove',\r\n        node: $element,\r\n        nodeName,\r\n        contextMenu: isRadial,\r\n      },\r\n    });\r\n\r\n    if ($parent.nodeName === 'foreignObject') {\r\n      d3.select($parent).remove();\r\n\r\n      // dispatch event that drop item was deleted\r\n      const idParts = $parent.id.split('_');\r\n      if (idParts[idParts.length - 1] === 'dropItem') {\r\n        __dispatchEvent(document, 'svg.drop.delete', {}, {\r\n          item: {\r\n            id: idParts[1],\r\n            $object: $element.firstChild,\r\n          },\r\n        });\r\n      }\r\n    } else {\r\n      d3.select($element).remove();\r\n    }\r\n  }\r\n\r\n  // Unmark all SVGs with 'svg-active' classname\r\n  static deactivate() {\r\n    const allActiveSvgs = document.querySelectorAll('[data-svg-active=\"true\"]');\r\n    for (let i = 0; i < allActiveSvgs.length; i += 1) {\r\n      allActiveSvgs[i].setAttribute('data-svg-active', 'false');\r\n    }\r\n  }\r\n\r\n  // Mark active SVG with 'svg-active' classname\r\n  static activate(svg) {\r\n    SVG.deactivate();\r\n    svg.setAttribute('data-svg-active', 'true');\r\n  }\r\n\r\n  // Remove connection between clone and template\r\n  // Remove third part of id if exists\r\n  static removeCloneConnectionManager($node) {\r\n    const idParts = $node.id.split('_');\r\n    if (idParts[idParts.length - 1].includes('clone')) {\r\n      idParts.pop();\r\n      $node.id = idParts.join('_');\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n}\r\n","import Component from './component';\r\nimport AudioPlayer from './media/audio-player';\r\nimport SVG from './svg';\r\nimport { stopPlayingVideoPlayers } from './media/media';\r\nimport { __dispatchEvent } from '../lib/utils';\r\n\r\nexport default class Sortable extends Component {\r\n  constructor($element) {\r\n    super($element);\r\n    this.$settings = document.querySelector(\r\n      `[data-sortable-id-reference=\"${this.target.id}\"]`,\r\n    );\r\n    this.feedback = JSON.parse(\r\n      this.$settings.getAttribute('data-module-zpetnavazba'),\r\n    );\r\n    this.$container = this.target;\r\n    this.$items = this.target.querySelectorAll('[data-sortable-drag]');\r\n    this.$droppables = this.target.querySelectorAll('[data-sortable-drop]');\r\n    this.$placeholder = () => document.querySelector('#sortable-placeholder');\r\n    this.$players = this.$container.querySelectorAll('[data-player-audio]');\r\n    this.$inheritors = document.querySelectorAll(\r\n      `[data-sortable-inheritor=${this.target.id}]`,\r\n    );\r\n    this.inheritors = [];\r\n    this.order = [];\r\n\r\n    // get direction (type of sortable \"horizontalni\" or \"vertikalni\")\r\n    this.direction = this.target.getAttribute('data-sortable-target');\r\n    this.trackingTouch = false;\r\n    this.before = false;\r\n    this.after = false;\r\n    this.evaluation = undefined;\r\n\r\n    this.mouse = {\r\n      x: (event) => event.clientX || event.touches[0].clientX,\r\n      y: (event) => event.clientY || event.touches[0].clientY,\r\n      x0: 0,\r\n      y0: 0,\r\n      x1: 0,\r\n      y1: 0,\r\n    };\r\n\r\n    this.dragged = {\r\n      el: null,\r\n      clone: null,\r\n      posRel: {},\r\n      rect: () => this.dragged.el.getBoundingClientRect(),\r\n      size: {},\r\n      type: null,\r\n    };\r\n\r\n    this.siblings = {\r\n      prev: null,\r\n      next: null,\r\n    };\r\n\r\n    this._onStart = this._onStart.bind(this);\r\n    this._onMove = this._onMove.bind(this);\r\n    this._onEnd = this._onEnd.bind(this);\r\n    this._update = this._update.bind(this);\r\n\r\n    this._setupInitialOrder();\r\n    this._setupInheritors();\r\n    this._addEventListeners();\r\n\r\n    this.cache = {\r\n      colors: []\r\n    };\r\n\r\n    // get colors for all feedback variants\r\n    if (this.feedback) {\r\n      this.cache.colors = this.feedback.map(feedback => feedback.barva);\r\n    }\r\n  }\r\n\r\n  _onStart(event) {\r\n    if (!event.target.hasAttribute('data-sortable-drag')) {\r\n      return;\r\n    }\r\n\r\n    // TODO: zastavit všechno audio on drag start\r\n    if (this.$players.length > 0) {\r\n      stopPlayingVideoPlayers(this.$players);\r\n    }\r\n\r\n    this.trackingTouch = true;\r\n\r\n    this.dragged.el = event.target;\r\n    this.dragged.type = event.target.getAttribute('data-sortable-drag');\r\n    this.dragged.clone = this.dragged.el.cloneNode(true);\r\n    this.dragged.posRel.top = this.dragged.el.offsetTop;\r\n    this.dragged.posRel.left = this.dragged.el.offsetLeft;\r\n    this.dragged.size.width = this.dragged.el.offsetWidth;\r\n    this.dragged.size.height = this.dragged.el.offsetHeight;\r\n\r\n    this.dragged.el.style.top = `${this.dragged.posRel.top}px`;\r\n    this.dragged.el.style.left = `${this.dragged.posRel.left}px`;\r\n    this.dragged.el.style.width = `${this.dragged.size.width}px`;\r\n    this.dragged.el.style.height = `${this.dragged.size.height}px`;\r\n    this.dragged.el.classList.add('is-dragged');\r\n\r\n    this.$container.classList.add('is-dragged');\r\n\r\n    this._addPlaceholder(this.dragged.el);\r\n    this._onOver();\r\n\r\n    this.mouse.x0 = this.mouse.x(event);\r\n    this.mouse.y0 = this.mouse.y(event);\r\n\r\n    event.preventDefault();\r\n  }\r\n\r\n  _onMove(event) {\r\n    if (!this.trackingTouch) {\r\n      return;\r\n    }\r\n\r\n    this.mouse.x1 = this.mouse.x(event) - this.mouse.x0;\r\n    this.mouse.y1 = this.mouse.y(event) - this.mouse.y0;\r\n\r\n    window.requestAnimationFrame(this._update);\r\n\r\n    this._onOver();\r\n  }\r\n\r\n  _onEnd(event) {\r\n    if (!this.trackingTouch) {\r\n      return;\r\n    }\r\n\r\n    this.trackingTouch = false;\r\n    this.$container.classList.remove('is-dragged');\r\n    this.dragged.el.classList.remove('is-dragged');\r\n    this.dragged.el.style.top = '';\r\n    this.dragged.el.style.left = '';\r\n    this.dragged.el.style.width = '';\r\n    this.dragged.el.style.height = '';\r\n    this.dragged.el.style.transform = '';\r\n\r\n    const $placeholder = this.$placeholder();\r\n    const rect = $placeholder.getBoundingClientRect();\r\n\r\n    switch (this.direction) {\r\n      case 'horizontal':\r\n        if (rect.left <= this.mouse.x(event) <= rect.right) {\r\n          this._onDrop();\r\n        }\r\n        break;\r\n      case 'vertical':\r\n        if (rect.top <= this.mouse.y(event) <= rect.bottom) {\r\n          this._onDrop();\r\n        }\r\n        break;\r\n\r\n      default:\r\n        break;\r\n    }\r\n\r\n    this._removePlaceholder();\r\n    this._updateOrder();\r\n    this._updateOrderInInheritors();\r\n    this._dispatchEvent();\r\n    this._checkAndResolveFeedback();\r\n  }\r\n\r\n  // _onEnter() {}\r\n\r\n  _onOver() {\r\n    this.before = false;\r\n    this.after = false;\r\n\r\n    this._getReference();\r\n\r\n    if (\r\n      this.siblings.next\r\n      && this.siblings.next.hasAttribute('data-sortable-drop')\r\n    ) {\r\n      const next = this.siblings.next.getBoundingClientRect();\r\n\r\n      switch (this.direction) {\r\n        case 'horizontal':\r\n          if (this.dragged.rect().right > next.left + next.width / 1.5) {\r\n            this.after = true;\r\n            this._addPlaceholder(this.siblings.next);\r\n          }\r\n          break;\r\n        case 'vertical':\r\n          if (this.dragged.rect().bottom > next.top + next.height / 1.5) {\r\n            this.after = true;\r\n            this._addPlaceholder(this.siblings.next);\r\n          }\r\n          break;\r\n\r\n        default:\r\n          break;\r\n      }\r\n    }\r\n\r\n    if (\r\n      this.siblings.prev\r\n      && this.siblings.prev.hasAttribute('data-sortable-drop')\r\n    ) {\r\n      const prev = this.siblings.prev.getBoundingClientRect();\r\n\r\n      switch (this.direction) {\r\n        case 'horizontal':\r\n          if (this.dragged.rect().left < prev.right - prev.width / 1.5) {\r\n            this.before = true;\r\n            this._addPlaceholder(this.siblings.prev);\r\n          }\r\n          break;\r\n        case 'vertical':\r\n          if (this.dragged.rect().top < prev.bottom - prev.height / 1.5) {\r\n            this.before = true;\r\n            this._addPlaceholder(this.siblings.prev);\r\n          }\r\n          break;\r\n\r\n        default:\r\n          break;\r\n      }\r\n    }\r\n  }\r\n\r\n  // _onLeave() {}\r\n\r\n  _onDrop() {\r\n    const $placeholder = this.$placeholder();\r\n\r\n    this._addEventListenerToItem(this.dragged.clone);\r\n    // TODO: přiřadit eventListenery audio playerům\r\n    if (this.dragged.clone.querySelector('[data-player-audio]')) {\r\n      AudioPlayer.addEventListeners(this.dragged.clone, this.showFeedback);\r\n    }\r\n\r\n    this.$container.insertBefore(this.dragged.clone, $placeholder);\r\n    this.dragged.el.parentElement.removeChild(this.dragged.el);\r\n  }\r\n\r\n  _update() {\r\n    this.dragged.el.style.transform = `translate3d(${this.mouse.x1}px, ${this.mouse.y1}px, 0) rotate(5deg)`;\r\n  }\r\n\r\n  _addPlaceholder(item) {\r\n    this._removePlaceholder();\r\n\r\n    const $placeholder = document.createElement('div');\r\n    $placeholder.classList.add('sortable-item', 'sortable-placeholder');\r\n    $placeholder.setAttribute('id', 'sortable-placeholder');\r\n    $placeholder.style.minHeight = `${this.dragged.size.height}px`;\r\n\r\n    if (this.dragged.el.querySelector('img')) {\r\n      const src = this.dragged.el.querySelector('img').getAttribute('src');\r\n      const img = document.createElement('img');\r\n      img.setAttribute('src', src);\r\n      $placeholder.appendChild(img);\r\n    }\r\n\r\n    if (this.after) {\r\n      this.$container.insertBefore($placeholder, item.nextElementSibling);\r\n    } else if (this.before) {\r\n      this.$container.insertBefore($placeholder, item);\r\n    } else {\r\n      this.$container.insertBefore($placeholder, item);\r\n    }\r\n  }\r\n\r\n  _removePlaceholder() {\r\n    const $placeholder = this.$placeholder();\r\n    if ($placeholder) $placeholder.parentElement.removeChild($placeholder);\r\n  }\r\n\r\n  _getReference() {\r\n    const $placeholder = this.$placeholder();\r\n    this.siblings.prev =\r\n      $placeholder.previousElementSibling === this.dragged.el\r\n        ? this.dragged.el.previousElementSibling\r\n        : $placeholder.previousElementSibling;\r\n    this.siblings.next =\r\n      $placeholder.nextElementSibling === this.dragged.el\r\n        ? this.dragged.el.nextElementSibling\r\n        : $placeholder.nextElementSibling;\r\n  }\r\n\r\n  _addEventListenerToItem($item) {\r\n    // touch events\r\n    $item.addEventListener('touchstart', this._onStart, false);\r\n    // mouse events\r\n    $item.addEventListener('mousedown', this._onStart, false);\r\n\r\n    if (this.dragged.type === 'svg') {\r\n      const svg = new SVG($item.querySelector('[data-svg-target]'));\r\n    }\r\n  }\r\n\r\n  _addEventListeners() {\r\n    // touch events\r\n    document.addEventListener('touchmove', this._onMove);\r\n    document.addEventListener('touchend', this._onEnd);\r\n    // mouse events\r\n    document.addEventListener('mousemove', this._onMove);\r\n    document.addEventListener('mouseup', this._onEnd);\r\n\r\n    this.$items.forEach(($item) => {\r\n      this._addEventListenerToItem($item);\r\n    });\r\n  }\r\n\r\n  // Methods for check if the array is sorted or not\r\n  // Return True: array is in the right state, False: array is NOT in the right state\r\n  // Array looks like: [1,2,3,4]\r\n  // eslint-disable-next-line class-methods-use-this\r\n  checkIfTheArrayIsGood(array) {\r\n    // condition for function some(), return if there is item in array which is not in right position\r\n    const elementInWrongPosition = (element, index) => index !== (element - 1);\r\n    // all has to be negate, to return the right condition (true: sorted, false:not sorted)\r\n    return !array.some(elementInWrongPosition);\r\n  }\r\n\r\n  // Method which check how many steps needs to be done to sort array\r\n  // Return: 0 -> 0 steps, array is sorted\r\n  //        1 -> 1 steps is needed for sort the array\r\n  //        2 -> 2 and more steps is needed for sort the array\r\n  // Array looks like: [1,2,3,4]\r\n  oneMove(array) {\r\n    if (this.checkIfTheArrayIsGood(array)) return 0; // Check if the array is sorted\r\n    for (let i = 0; i < array.length; i += 1) {\r\n      if (array[i] !== i + 1) {\r\n        const changedArray = [...array];\r\n        const element = changedArray[i];\r\n        changedArray.splice(i, 1);\r\n        changedArray.splice(element - 1, 0, element);\r\n\r\n        if (this.checkIfTheArrayIsGood(changedArray)) return 1; // Check if the array after 1 step is sorted\r\n      }\r\n    }\r\n    return 2; // In every other results the array needs more than 2 steps to be sorted\r\n  }\r\n\r\n  // After interaction with modul razeni this method is called to resolve a feedback button\r\n  _checkAndResolveFeedback() {\r\n    if (this.feedback) {\r\n      // Get the array of items (gets only their correct position - in int), example -> [1,3,4,2]\r\n      const arrayOfItems = [\r\n        ...this.target.querySelectorAll('[data-sortable-drag]'),\r\n      ].map((item) => parseInt(item.dataset.sortableSpravnaodpoved, 10));\r\n\r\n      // variable to map a feedback which is got from condition in JSON\r\n      let feedbackResult = 0;\r\n\r\n      // Check if the zpetnaVazba is 2 or 3 conditional\r\n      if (this.feedback.length === 2) {\r\n        if (!this.checkIfTheArrayIsGood(arrayOfItems)) {\r\n          feedbackResult = 1;\r\n        }\r\n      }\r\n      else {\r\n        feedbackResult = this.oneMove(arrayOfItems);\r\n      }\r\n\r\n      // map feedback via feedbackResult\r\n      const feedbackActual = this.feedback.find((feedback) => feedback.podminka === feedbackResult);\r\n\r\n      this.$buttonFeedback.classList.remove(...this.cache.colors);\r\n      this.$buttonFeedback.classList.add(feedbackActual.barva);\r\n      this.$buttonFeedbackText.innerText = feedbackActual.text;\r\n      this.evaluation = feedbackActual.splneno;\r\n    }\r\n    this.showFeedback();\r\n  }\r\n\r\n  _setupInitialOrder() {\r\n    this._updateOrder();\r\n  }\r\n\r\n  _setupInheritors() {\r\n    if (this.$inheritors.length > 0) {\r\n      this.inheritors = Array.from(this.$inheritors).map(($inheritor) => ({\r\n        $inheritor,\r\n        $container: $inheritor.querySelector('[data-sortable-inheritor-item]')\r\n          .parentElement,\r\n      }));\r\n    }\r\n  }\r\n\r\n  _updateOrder() {\r\n    this.order = Array.from(\r\n      this.target.querySelectorAll('[data-sortable-drag]'),\r\n    ).map(($item) => ({ id: parseInt($item.dataset.sortableIndex, 10) }));\r\n  }\r\n\r\n  _updateOrderInInheritors() {\r\n    if (this.$inheritors.length > 0) {\r\n      this.inheritors.forEach((inheritor) => {\r\n        this.order.forEach((item) => {\r\n          inheritor.$container.appendChild(\r\n            inheritor.$container.querySelector(\r\n              `[data-sortable-inheritor-item=\"${item.id}\"]`,\r\n            ),\r\n          );\r\n        });\r\n      });\r\n    }\r\n  }\r\n\r\n  _dispatchEvent() {\r\n    __dispatchEvent(\r\n      this.target,\r\n      'sortable.change',\r\n      {},\r\n      {\r\n        id: this.target.id,\r\n        evaluation: this.evaluation,\r\n        order: this.order,\r\n      },\r\n    );\r\n  }\r\n}\r\n","/* eslint-disable brace-style */\r\nimport {\r\n  __addClass,\r\n  __removeClass,\r\n  __hasClass,\r\n  __localPosition,\r\n  __globalPosition,\r\n  __dispatchEvent,\r\n} from '../../lib/utils';\r\nimport SVG from '../svg';\r\nimport SVGText from './svg-text';\r\n\r\nexport default class SVGRadialMenu {\r\n\r\n  constructor($radialMenu, $svgs) {\r\n    this.$radialMenu = $radialMenu;\r\n    this.$radialMenuItems = this.$radialMenu.querySelectorAll('[data-radial-menu-item]');\r\n    this.$colorItems = this.$radialMenu.querySelectorAll('.radial-menu-color');\r\n    this.$textItems = this.$radialMenu.querySelectorAll('.radial-menu-text');\r\n    this.$createTextItem = this.$radialMenu.querySelector('#create-text');\r\n    this.$removeItem = this.$radialMenu.querySelector('#remove-content');\r\n    this.$tooltip = this.$radialMenu.querySelector('[data-radial-menu-tooltip]');\r\n    this.$svgs = $svgs;\r\n\r\n    this.initialSetUp = true;\r\n\r\n    this.menuRadius = parseInt(window.getComputedStyle(this.$radialMenu.querySelector('.radial-menu-wrapper'), null).getPropertyValue('width'), 10) / 2;\r\n    this.itemRadius = parseInt(window.getComputedStyle(this.$radialMenu.querySelector('.radial-menu-item'), null).getPropertyValue('width'), 10) / 2;\r\n\r\n    this.init();\r\n  }\r\n\r\n  init() {\r\n    this.setUpRadialMenuItems();\r\n    this.addEventListenersToRadialMenu();\r\n\r\n    // activate radial menu when right click on svg\r\n    this.$svgs.forEach(($svg) => {\r\n      //define functions\r\n      const svgSpecificActions = $svg.getAttribute('data-svg-target').split(' ');\r\n      const colors = $svg.getAttribute('data-svg-colors');\r\n      const svgSpecificColor = colors ? colors.split(' ') : undefined;\r\n      const hasText = svgSpecificActions.includes('text');\r\n      const hasMoreColors = (svgSpecificColor && svgSpecificColor.length > 1) || !colors;\r\n\r\n      d3.select($svg).on('contextmenu', () => {\r\n        // mark this SVG as the active one\r\n        SVG.activate($svg);\r\n        // deselect all previously selected items\r\n        SVG.deselectItem();\r\n        // show radial menu buttons based on clicked element\r\n        // and .select appropriate elements based on clicked element\r\n        this.filterMenuButtons(d3.event.target, hasText, hasMoreColors);\r\n        this.showRadialMenu($svg, d3.event);\r\n        // prevent default 'contextmenu' event\r\n        d3.event.preventDefault();\r\n      });\r\n    });\r\n\r\n    this.initialSetUp = false;\r\n  }\r\n\r\n  setUpRadialMenuItems() {\r\n    // this.positionRadialMenuItems(this.$radialMenuItems);\r\n\r\n    this.$radialMenuItems.forEach(($item) => {\r\n      this.addEventListenersToRadialMenuItem($item);\r\n    });\r\n  }\r\n\r\n  positionRadialMenuItems($items) {\r\n    const _itemsLength = $items.length;\r\n    const _menuRadius = this.menuRadius;\r\n    const _itemRadius = this.itemRadius;\r\n    const _menuOffset = _menuRadius - _itemRadius;\r\n    const _interval = 0.6283185307;\r\n    // if more items center them\r\n    const _centerOffset = (-_interval / 2) + ((_itemsLength * _interval) / 2);\r\n\r\n    // make a \"flower\"\r\n    $items.forEach(($item, index) => {\r\n      // Calculate the angle at which the element will be placed.\r\n      // For a semicircle, we would use (index / _itemsLength) * Math.PI.\r\n      const angle = (Math.PI + ((index * _interval) * -1)) + _centerOffset;\r\n\r\n      // get position\r\n      const x = (_menuRadius * Math.sin(angle)) + _menuOffset;\r\n      const y = (_menuRadius * Math.cos(angle)) + _menuOffset;\r\n\r\n      // console.log('x: ' + x);\r\n      // console.log('y: ' + y);\r\n\r\n      $item.style.left = `${x.toFixed(1)}px`;\r\n      $item.style.top = `${y.toFixed(1)}px`;\r\n\r\n      // if (this.initialSetUp === true) {\r\n      //   this.addEventListenersToRadialMenuItem($item);\r\n      // }\r\n    });\r\n  }\r\n\r\n  addEventListenersToRadialMenu() {\r\n    this.onMouseLeave();\r\n\r\n    this.$radialMenu.addEventListener('click', (event) => {\r\n      this.hideRadialMenu(this.$radialMenu);\r\n      event.preventDefault();\r\n    });\r\n\r\n    this.$radialMenu.addEventListener('contextmenu', (event) => {\r\n      this.hideRadialMenu(this.$radialMenu);\r\n      event.preventDefault();\r\n    });\r\n  }\r\n\r\n  addEventListenersToRadialMenuItem(item) {\r\n    const $item = item;\r\n\r\n    // actions\r\n    const action = $item.getAttribute('data-radial-menu-item');\r\n    // remove item\r\n    if (action === 'remove-content') {\r\n      $item.addEventListener('click', () => {\r\n        SVG.removeItem(true);\r\n        this.hideRadialMenu();\r\n      }, false);\r\n    }\r\n    // create user text\r\n    else if (action === 'create-text') {\r\n      d3.select($item).on('click', () => {\r\n        SVGText.createText();\r\n        this.hideRadialMenu();\r\n      }, false);\r\n    }\r\n    // označit podobnost\r\n    else if (action === 'color-point-blue') {\r\n      $item.addEventListener('click', () => {\r\n        SVGRadialMenu.changeColor('blue');\r\n        this.hideRadialMenu();\r\n      }, false);\r\n    }\r\n    // označit rozdil\r\n    else if (action === 'color-point-red') {\r\n      $item.addEventListener('click', () => {\r\n        SVGRadialMenu.changeColor('red');\r\n        this.hideRadialMenu();\r\n      }, false);\r\n    }\r\n    // označit rozdil\r\n    else if (action === 'color-point-red') {\r\n      $item.addEventListener('click', () => {\r\n        SVGRadialMenu.changeColor('red');\r\n        this.hideRadialMenu();\r\n      }, false);\r\n    }\r\n    // přiřadit kategorii\r\n    // else if (action === 'category') {\r\n    //   const category = $item.getAttribute('data-category');\r\n    //   const categoryLabel = $item.getAttribute('data-radial-menu-item-tooltip');\r\n\r\n    //   $item.addEventListener('click', () => {\r\n    //     const $selected = document.querySelector('[data-svg-selected=\"true\"]');\r\n    //     const $parentForeignObject = $selected.parentElement;\r\n    //     let $category = $parentForeignObject.querySelector('.svg-category-label');\r\n\r\n    //     $selected.setAttribute('data-svg-category', category);\r\n\r\n    //     if (!$category) {\r\n    //       $category = document.createElement('div');\r\n    //       $category.classList.add('svg-category-label');\r\n    //       $parentForeignObject.prepend($category);\r\n    //     }\r\n\r\n    //     $category.innerText = categoryLabel;\r\n\r\n    //     this.hideRadialMenu();\r\n    //   }, false);\r\n    // }\r\n\r\n    // tooltip\r\n    $item.addEventListener('mouseenter', (event) => {\r\n      this.$tooltip.innerHTML = event.currentTarget.getAttribute('data-radial-menu-item-tooltip');\r\n      this.$tooltip.style.display = 'block';\r\n    }, false);\r\n    $item.addEventListener('mouseleave', () => {\r\n      this.$tooltip.innerHTML = '';\r\n      this.$tooltip.style.display = 'none';\r\n    }, false);\r\n  }\r\n\r\n  // Draw a SVG circle on click\r\n  static changeColor(color, element = '[data-svg-selected=\"true\"]') {\r\n    let $element = document.querySelector(element);\r\n    let nodeName = $element.nodeName;\r\n    let taskType = 'color';\r\n\r\n    __removeClass($element, 'red blue');\r\n    __addClass($element, color);\r\n\r\n    // DIV => text field  or circle\r\n    switch (nodeName) {\r\n      case 'path':\r\n        // $element = $element;\r\n        break;\r\n      case 'DIV':\r\n        if ($element.parentElement.childNodes[1]) {\r\n          $element = $element.parentElement.childNodes[1];\r\n        } else {\r\n          $element = $element.parentElement;\r\n        }\r\n        nodeName = $element.nodeName;\r\n        break;\r\n      default:\r\n        console.log('Nondefinated node type. :(', nodeName);\r\n    }\r\n\r\n    // if clone is changed, then dispatch create event\r\n    if (SVG.removeCloneConnectionManager($element)) taskType = 'create';\r\n\r\n    // get svg id from object id\r\n    const svgID = $element.id.split('_')[0];\r\n\r\n    // dispatch event that svg has changed\r\n    __dispatchEvent(document, 'svg.change', {}, {\r\n      svg: {\r\n        id: svgID,\r\n        task: taskType,\r\n        node: $element,\r\n        nodeName,\r\n        contextMenu: true,\r\n        color,\r\n      },\r\n    });\r\n  }\r\n\r\n  showRadialMenu($activeSVG, event) {\r\n    const $svg = $activeSVG || document.querySelector('[data-svg-active=\"true\"]');\r\n    // get global position of the right click event\r\n    const globalPosition = __globalPosition(event);\r\n    const localPosition = __localPosition($svg);\r\n    this.$radialMenu.setAttribute('data-local-x', localPosition.x);\r\n    this.$radialMenu.setAttribute('data-local-y', localPosition.y);\r\n    // set position of radial menu\r\n    // number of 13 is size of #radial-menu\r\n    this.$radialMenu.style.top = `${globalPosition.y - 7}px`;\r\n    this.$radialMenu.style.left = `${globalPosition.x - 7}px`;\r\n\r\n    // make a flower\r\n    const $activeRadialMenuItem = this.$radialMenu.querySelectorAll('.is-active');\r\n    this.positionRadialMenuItems($activeRadialMenuItem);\r\n\r\n    // show radial menu\r\n    __addClass(this.$radialMenu, 'is-active');\r\n\r\n    // return {\r\n    //   localPosition,\r\n    //   globalPosition,\r\n    // };\r\n  }\r\n\r\n  hideRadialMenu() {\r\n    // hide radial menu\r\n    __removeClass(this.$radialMenu, 'is-active');\r\n    // deactivate all SVGs\r\n    SVG.deactivate();\r\n    // deselect all SVG items\r\n    SVG.deselectItem();\r\n\r\n    // deactivate radial menu items when the menu is hidden\r\n    setTimeout(() => {\r\n      if (!__hasClass(this.$radialMenu, 'is-active')) {\r\n        this.$radialMenuItems.forEach(($item) => {\r\n          __removeClass($item, 'is-active');\r\n        });\r\n      }\r\n    }, 150);\r\n  }\r\n\r\n  onMouseLeave() {\r\n    let mouseLeaveDelay;\r\n\r\n    this.$radialMenu.addEventListener('mouseleave', () => {\r\n      mouseLeaveDelay = setTimeout(() => {\r\n        this.hideRadialMenu(this.$radialMenu);\r\n      }, 500);\r\n    });\r\n\r\n    this.$radialMenu.addEventListener('mouseenter', () => {\r\n      clearTimeout(mouseLeaveDelay);\r\n    });\r\n  }\r\n\r\n  filterMenuButtons(clickedItem, hasText, hasMoreColors) {\r\n    if (__hasClass(clickedItem, 'svg-path') || clickedItem.nodeName === 'path') {\r\n      if (hasText) {\r\n        __addClass(this.$createTextItem, 'is-active');\r\n      } else {\r\n        __removeClass(this.$createTextItem, 'is-active');\r\n      }\r\n      // __addClass(this.$removeItem, 'is-active');\r\n\r\n      if (hasMoreColors) {\r\n        this.$colorItems.forEach(($colorItem) => {\r\n          __addClass($colorItem, 'is-active');\r\n        });\r\n      }\r\n\r\n      this.$textItems.forEach(($textItem) => {\r\n        __removeClass($textItem, 'is-active');\r\n      });\r\n\r\n      // mark it as slected\r\n      // SVG.selectItem(clickedItem);\r\n    }\r\n    if (__hasClass(clickedItem, 'svg-circle')) {\r\n      if (hasText) {\r\n        __addClass(this.$createTextItem, 'is-active');\r\n      } else {\r\n        __removeClass(this.$createTextItem, 'is-active');\r\n      }\r\n      // __addClass(this.$removeItem, 'is-active');\r\n\r\n      if (hasMoreColors) {\r\n        this.$colorItems.forEach(($colorItem) => {\r\n          __addClass($colorItem, 'is-active');\r\n        });\r\n      }\r\n\r\n      this.$textItems.forEach(($textItem) => {\r\n        __removeClass($textItem, 'is-active');\r\n      });\r\n\r\n      // mark it as slected\r\n      // SVG.selectItem(clickedItem);\r\n    }\r\n    if (__hasClass(clickedItem, 'svg-textarea')) {\r\n      __removeClass(this.$createTextItem, 'is-active');\r\n      // __addClass(this.$removeItem, 'is-active');\r\n\r\n      if (!__hasClass(clickedItem, 'do-not-remove')) {\r\n        this.$colorItems.forEach(($colorItem) => {\r\n          __removeClass($colorItem, 'is-active');\r\n        });\r\n\r\n        this.$textItems.forEach(($textItem) => {\r\n          __addClass($textItem, 'is-active');\r\n        });\r\n      }\r\n\r\n      // mark it as slected\r\n      // SVG.selectItem(clickedItem);\r\n    }\r\n    if (clickedItem.nodeName === 'image') {\r\n      if (hasText) {\r\n        __addClass(this.$createTextItem, 'is-active');\r\n      } else {\r\n        __removeClass(this.$createTextItem, 'is-active');\r\n      }\r\n\r\n      __removeClass(this.$removeItem, 'is-active');\r\n\r\n      this.$colorItems.forEach(($colorItem) => {\r\n        __removeClass($colorItem, 'is-active');\r\n      });\r\n\r\n      this.$textItems.forEach(($textItem) => {\r\n        __removeClass($textItem, 'is-active');\r\n      });\r\n    }\r\n    else {\r\n      if (__hasClass(clickedItem, 'do-not-remove')) {\r\n        __removeClass(this.$removeItem, 'is-active');\r\n      } else {\r\n        if (hasText) {\r\n          __addClass(this.$createTextItem, 'is-active');\r\n        } else {\r\n          __removeClass(this.$createTextItem, 'is-active');\r\n        }\r\n        __addClass(this.$removeItem, 'is-active');\r\n      }\r\n      // mark it as slected\r\n      SVG.selectItem(clickedItem);\r\n    }\r\n  }\r\n}\r\n","import {\r\n  __mergeDeep,\r\n  __hasClass,\r\n  __addClass,\r\n  __removeClass,\r\n  __position,\r\n  __positionTranslated,\r\n  __remove,\r\n  __getRealDimensions,\r\n  __insertBefore,\r\n  __keycodeIsPrintableCharacter,\r\n  __toggleClass,\r\n  __dispatchEvent,\r\n  __isTouchEnabled,\r\n  __isTouchOnly,\r\n} from '../../lib/utils';\r\nimport Component from '../component';\r\n\r\n\r\nexport default class Editor extends Component {\r\n\r\n  constructor($element) {\r\n    super($element);\r\n\r\n    // TODO: should extend default Component class and use this.target?\r\n    // this.$editor is better, more readable\r\n    this.$editor = this.target;\r\n    this.id = this.$editor.id;\r\n    // TODO: is DOM element before/after the editor itself.. move it to the editor?\r\n    this.settings = JSON.parse(document.querySelector(`[data-editor-id-reference=\"${this.id}\"]`).getAttribute('data-module-settings'));\r\n\r\n    this.opts = __mergeDeep(Editor.defaults, this.settings);\r\n\r\n    this.models = {\r\n      passive: [\r\n        'cteni',\r\n      ],\r\n      interactive: [\r\n        'predznaceny', 'zvyraznovani', 'komentáře', 'psani',\r\n      ],\r\n      withMenu: [\r\n        'predznaceny', 'zvyraznovani', 'komentáře',\r\n      ],\r\n    };\r\n\r\n    this.totalTagId = 0;\r\n\r\n    this.hasMenu = true;\r\n\r\n    this.selection = null;\r\n    this.lastSelectionSettings = {};\r\n    this.isCollapsed = null;\r\n    this.savedSelectionRange = null;\r\n    this.selectionAttributes = null;\r\n    this.dummyRangeElement = null;\r\n\r\n    this.selectionMouseDown = false;\r\n    this.selectionDirection = null;\r\n\r\n    this.hasEditableContentChanged = false;\r\n    this.lastPressedKey = null;\r\n\r\n    this.hasToolbar = false;\r\n    this.toolbar = {};\r\n\r\n    this.originalContent = {};\r\n    this.currentContent = {};\r\n\r\n    this._handlers = [];\r\n\r\n    this.wrapLastDeletesTimeoutClass = '';\r\n    this.wrapLastDeletesTimeoutFunction = () => { };\r\n    this.wrapLastAdditionsTimeoutClass = '';\r\n    this.wrapLastAdditionsTimeoutFunction = () => { };\r\n    this.isWrappingLastText = false;\r\n    this.isWriting = false;\r\n\r\n    this.$groupDeleted = null;\r\n\r\n    this.cache = {\r\n      body: document.body,\r\n      window,\r\n    };\r\n\r\n    this.init();\r\n  }\r\n\r\n  init() {\r\n    if (Editor._hasMenu(this.opts)) {\r\n      try {\r\n        this.$menu = this.$editor.querySelector(`.${this.opts.menuClass}`);\r\n\r\n        // TODO: generalize .item class via defaults and opts\r\n        this.$menuActions = this.$menu.querySelector('.menu').querySelectorAll('.menu-item');\r\n        this.$menuClose = this.$menu.querySelector('.close');\r\n      } catch (error) {\r\n        this.hasMenu = false;\r\n      }\r\n    } else {\r\n      this.hasMenu = false;\r\n    }\r\n\r\n    if (Editor._hasToolbar(this.opts)) {\r\n      this.hasToolbar = true;\r\n    }\r\n\r\n    this.$canvas = this.$editor.querySelector(`.${this.opts.canvasClass}`);\r\n\r\n    // only if the editor is INTERACTIVE\r\n    if (this.opts.funkce !== 'cteni') {\r\n      __addClass(this.$menu, 'hidden');\r\n\r\n      // only if the editor is for WRITING\r\n      if (this.opts.funkce === 'psani') {\r\n        this.originalContent.html = this.$canvas.innerHTML;\r\n        this.originalContent.text = this.$canvas.innerText;\r\n        this.currentContent.html = this.$canvas.innerHTML;\r\n        this.currentContent.text = this.$canvas.innerText;\r\n\r\n        this.wrapLastDeletesTimeoutClass = this._generateNewTagGroupClass();\r\n        this.wrapLastAdditionsTimeoutClass = this._generateNewTagGroupClass();\r\n      }\r\n\r\n      // only if the editor is with extra TOOLBAR\r\n      if (this.hasToolbar) {\r\n        this.toolbar.$element = this.$editor.querySelector('.editor-toolbar');\r\n        this.toolbar.$btnReset = this.toolbar.$element.querySelector('.editor-toolbar-action-reset');\r\n      }\r\n\r\n      this.registerEditableHandlers();\r\n    }\r\n\r\n    // only if the editor is with PREHIGHLIGHTED text\r\n    if (this.opts.funkce === 'predznaceny') {\r\n      this.initPreHighlightedTextOptions();\r\n    }\r\n\r\n  }\r\n\r\n  _generateNewTagId() {\r\n    this.totalTagId = this.totalTagId + 1;\r\n    return `${this.id}-${this.totalTagId}`;\r\n  }\r\n\r\n  _generateNewTagGroupClass() {\r\n    this.totalTagId = this.totalTagId + 1;\r\n    return `group-${this.id}-${this.totalTagId}`;\r\n  }\r\n\r\n  // add all eventListeners\r\n  // TODO: separate special case from universal ones?\r\n  registerEditableHandlers() {\r\n\r\n    this.$canvas.addEventListener('mousedown', this.handlerFocus.bind(this), false);\r\n    this.$canvas.addEventListener('touchstart', this.handlerFocus.bind(this), false);\r\n    this.$canvas.addEventListener('focusout ', this.handlerFocus.bind(this), false);\r\n\r\n    // Necessary when mouseup is outside the $canvas element\r\n    // therefore we have to capture the event outside the element through body element\r\n    this.cache.body.addEventListener('mouseup', this.handlerFocus.bind(this), false);\r\n    this.cache.body.addEventListener('touchend', this.handlerFocus.bind(this), false);\r\n\r\n    if (\r\n      __isTouchOnly()\r\n      || (window.innerWidth <= 1024 && __isTouchEnabled())\r\n    ) {\r\n      this.$canvas.addEventListener('contextmenu', (event) => {\r\n        event.preventDefault();\r\n        event.stopPropagation();\r\n      });\r\n    }\r\n\r\n    if (this.opts.funkce === 'psani') {\r\n\r\n      this.$canvas.addEventListener('keydown', (e) => {\r\n\r\n        const selection = window.getSelection();\r\n        const keyCode = e.which || e.keyCode;\r\n        let keyName = e.key;\r\n\r\n        // show OK button or feedback\r\n        this.showFeedback();\r\n\r\n        // start DELETE\r\n        if (keyName === 'Backspace' || keyName === 'Delete') {\r\n          if (selection.rangeCount) {\r\n            window.clearTimeout(this.wrapLastDeletesTimeoutFunction);\r\n\r\n            const range = selection.getRangeAt(0);\r\n            const cloneRange = range.cloneRange();\r\n\r\n            if (this.lastSelectionSettings.isCollapsed) {\r\n\r\n              try {\r\n                cloneRange.setStart(range.startContainer, range.startOffset - 1);\r\n              } catch (e) {\r\n                // backspace was pressed at the beginning of the node\r\n                cloneRange.setStart(range.startContainer, range.startOffset);\r\n                cloneRange.collapse(true);\r\n              }\r\n\r\n            } else {\r\n              cloneRange.setStart(range.startContainer, range.startOffset);\r\n\r\n            }\r\n\r\n            cloneRange.setEnd(range.endContainer, range.endOffset);\r\n\r\n            // do nothing when it's space\r\n            const addedFragment = cloneRange.cloneContents();\r\n            const addedFragmentString = addedFragment.textContent.trim();\r\n\r\n            if ((addedFragmentString !== '' && addedFragmentString !== '&nbsp;') || this.isWrappingLastText) {\r\n\r\n              const dummyElementInner = document.createElement('span');\r\n              dummyElementInner.className = `user-removed-text-inner ${this.wrapLastDeletesTimeoutClass}`;\r\n\r\n              cloneRange.surroundContents(dummyElementInner);\r\n\r\n              selection.removeAllRanges();\r\n              selection.addRange(range);\r\n\r\n              this.wrapLastDeletesTimeoutFunction = setTimeout(() => {\r\n\r\n                this.isWrappingLastText = false;\r\n\r\n                // wrap all previous deletes to one element\r\n                const dummyElement = document.createElement('span');\r\n                dummyElement.contentEditable = false;\r\n                dummyElement.className = 'user-removed-text';\r\n\r\n                const newGeneratedId = this._generateNewTagId();\r\n                dummyElement.id = newGeneratedId;\r\n\r\n                const $elements = document.querySelectorAll(`.${this.wrapLastDeletesTimeoutClass}`);\r\n\r\n                __insertBefore(dummyElement, $elements[0]);\r\n\r\n                $elements.forEach((el, i) => {\r\n                  dummyElement.appendChild(el);\r\n                });\r\n\r\n\r\n                // create close button\r\n                const $btnClose = document.createElement('span');\r\n                $btnClose.className = this.opts.closeBtnClass;\r\n\r\n                const clickHandler = (e) => {\r\n                  const $nodeElement = e.currentTarget.parentNode;\r\n                  this._removeNodeKeepTextContent($nodeElement);\r\n                  e.stopPropagation();\r\n                };\r\n\r\n                $btnClose.addEventListener('click', clickHandler.bind(this));\r\n\r\n                document.getElementById(newGeneratedId).appendChild($btnClose);\r\n\r\n                this.wrapLastDeletesTimeout = true;\r\n                this.wrapLastDeletesTimeoutClass = this._generateNewTagGroupClass();\r\n\r\n              }, 700);\r\n\r\n              this.isWrappingLastText = true;\r\n\r\n              e.preventDefault();\r\n\r\n            } else {\r\n\r\n              if (!this.isWrappingLastText) {\r\n                // we're removing spaces, do nothing use browser's default behaviour, unless the wrapping is going on\r\n                return;\r\n              }\r\n              e.preventDefault();\r\n            }\r\n          }\r\n        }\r\n        // end DELETE\r\n\r\n        // start WRITING\r\n        else if (__keycodeIsPrintableCharacter(keyCode)) {\r\n\r\n          // if nothing is selected (selection is empty)\r\n          if (this.lastSelectionSettings.isCollapsed) {\r\n\r\n            // if \"space\" was written\r\n            if (keyCode === 32) {\r\n              if (!this.isWrappingLastText) {\r\n                // we're adding spaces, do nothing use browser's default behaviour, unless the wrapping is going on\r\n                return;\r\n              }\r\n              // fill a space as the keyname for the spacebar\r\n              keyName = ' ';\r\n            }\r\n\r\n            // The Selection.rangeCount read-only property returns the number of ranges in the selection.\r\n            if (selection.rangeCount) {\r\n\r\n              window.clearTimeout(this.wrapLastAdditionsTimeoutFunction);\r\n\r\n              const range = selection.getRangeAt(0);\r\n              const cloneRange = range.cloneRange();\r\n\r\n              cloneRange.setStart(range.startContainer, range.startOffset);\r\n              cloneRange.setEnd(range.endContainer, range.endOffset);\r\n\r\n              const textToAddElement = document.createElement('span');\r\n              textToAddElement.contentEditable = false;\r\n              textToAddElement.className = `user-inserted-text-inner ${this.wrapLastAdditionsTimeoutClass}`;\r\n              textToAddElement.innerHTML = keyName;\r\n\r\n              cloneRange.insertNode(textToAddElement);\r\n\r\n              // move the caret after the inserted character\r\n              range.setStartAfter(textToAddElement);\r\n\r\n              selection.removeAllRanges();\r\n              selection.addRange(range);\r\n\r\n              this.wrapLastAdditionsTimeoutFunction = setTimeout(() => {\r\n\r\n                this.isWrappingLastText = false;\r\n\r\n                // wrap all previous deletes to one element\r\n                const dummyElement = document.createElement('span');\r\n                dummyElement.contentEditable = false;\r\n                dummyElement.className = 'user-inserted-text';\r\n\r\n                const newGeneratedId = this._generateNewTagId();\r\n                dummyElement.id = newGeneratedId;\r\n\r\n                const $elements = document.querySelectorAll(`.${this.wrapLastAdditionsTimeoutClass}`);\r\n\r\n                __insertBefore(dummyElement, $elements[0]);\r\n\r\n                $elements.forEach((el, i) => {\r\n                  dummyElement.appendChild(el);\r\n                });\r\n\r\n\r\n                // create close button\r\n                const $btnClose = document.createElement('span');\r\n                $btnClose.className = this.opts.closeBtnClass;\r\n\r\n                const clickHandler = (e) => {\r\n                  const $nodeElement = e.currentTarget.parentNode;\r\n                  __remove($nodeElement);\r\n                  e.stopPropagation();\r\n                };\r\n\r\n                $btnClose.addEventListener('click', clickHandler.bind(this));\r\n                document.getElementById(newGeneratedId).appendChild($btnClose);\r\n\r\n                this.wrapLastAdditionsTimeoutClass = this._generateNewTagGroupClass();\r\n\r\n              }, 700);\r\n\r\n              this.isWrappingLastText = true;\r\n\r\n            }\r\n\r\n\r\n            if (this.hasEditableContentChanged === false) {\r\n              this.hasEditableContentChanged = true;\r\n            }\r\n\r\n            e.preventDefault();\r\n          }\r\n\r\n          // writing over existing text is selected\r\n          else {\r\n            window.clearTimeout(this.wrapLastAdditionsTimeoutFunction);\r\n\r\n            const range = selection.getRangeAt(0);\r\n            const cloneRange = range.cloneRange();\r\n\r\n            cloneRange.setStart(range.startContainer, range.startOffset);\r\n            cloneRange.setEnd(range.endContainer, range.endOffset);\r\n\r\n            // 1. handle deleting the text that was selected when writing started\r\n            if (this.isWriting === false && selection.toString().length > 0) {\r\n              // add deleted text node only for the first time and only if there is some selected text\r\n              this.$groupDeleted = document.createElement('span');\r\n              this.$groupDeleted.contentEditable = false;\r\n              this.$groupDeleted.className = 'user-removed-text';\r\n\r\n              const groupDeletedId = this._generateNewTagId();\r\n              this.$groupDeleted.id = groupDeletedId;\r\n\r\n              const $groupInnerDeleted = document.createElement('span');\r\n              $groupInnerDeleted.className = 'user-removed-text-inner';\r\n\r\n              this.$groupDeleted.appendChild($groupInnerDeleted);\r\n\r\n              cloneRange.surroundContents(this.$groupDeleted);\r\n\r\n              // create close button\r\n              const $btnClose = document.createElement('span');\r\n              $btnClose.className = this.opts.closeBtnClass;\r\n\r\n              const clickHandler = (e) => {\r\n                const $nodeElement = e.currentTarget.parentNode;\r\n                this._removeNodeKeepTextContent($nodeElement);\r\n                e.stopPropagation();\r\n              };\r\n\r\n              $btnClose.addEventListener('click', clickHandler.bind(this));\r\n              this.$groupDeleted.appendChild($btnClose);\r\n            }\r\n\r\n\r\n            // 2. adding new text\r\n            this.isWriting = true;\r\n\r\n            const $groupInnerAdded = document.createElement('span');\r\n            $groupInnerAdded.contentEditable = false;\r\n            $groupInnerAdded.className = `user-inserted-text-inner ${this.wrapLastAdditionsTimeoutClass}`;\r\n\r\n            // add a space so there is a space between the added and removed text\r\n            $groupInnerAdded.innerHTML = `${keyName}`;\r\n\r\n            // TODO: error after deleted selection\r\n            __insertBefore($groupInnerAdded, this.$groupDeleted);\r\n            range.setStartAfter($groupInnerAdded);\r\n\r\n            selection.removeAllRanges();\r\n            selection.addRange(range);\r\n\r\n            this.wrapLastAdditionsTimeoutFunction = setTimeout(() => {\r\n              this.isWriting = false;\r\n\r\n              // wrap all previous deletes to one element\r\n              const $groupAdded = document.createElement('span');\r\n              $groupAdded.contentEditable = false;\r\n              $groupAdded.className = 'user-inserted-text';\r\n\r\n              const newGeneratedId = this._generateNewTagId();\r\n              $groupAdded.id = newGeneratedId;\r\n\r\n              const $elements = document.querySelectorAll(`.${this.wrapLastAdditionsTimeoutClass}`);\r\n\r\n              __insertBefore($groupAdded, $elements[0]);\r\n\r\n              $elements.forEach((el, i) => {\r\n                $groupAdded.appendChild(el);\r\n              });\r\n\r\n              const $btnClose = document.createElement('span');\r\n              $btnClose.className = this.opts.closeBtnClass;\r\n\r\n              const clickHandler = (e) => {\r\n                const $nodeElement = e.currentTarget.parentNode;\r\n                __remove($nodeElement);\r\n                e.stopPropagation();\r\n              };\r\n\r\n              $btnClose.addEventListener('click', clickHandler.bind(this));\r\n              document.getElementById(newGeneratedId).appendChild($btnClose);\r\n\r\n              this.wrapLastAdditionsTimeoutClass = this._generateNewTagGroupClass();\r\n\r\n            }, 700);\r\n\r\n            e.preventDefault();\r\n          }\r\n        }\r\n        // end WRITING\r\n      });\r\n    }\r\n\r\n\r\n    if (this.hasMenu) {\r\n      this.registerMenuHandler();\r\n    }\r\n\r\n    if (this.hasToolbar) {\r\n      this.toolbar.$btnReset.addEventListener('click', () => {\r\n\r\n        const isConfirmed = confirm('Opravdu chcete vrátit text do původní podoby? Vaše změny se tímto ztratí.');\r\n\r\n        if (isConfirmed) {\r\n          this.$canvas.innerHTML = this.originalContent.html;\r\n        }\r\n\r\n      });\r\n    }\r\n\r\n  }\r\n\r\n  registerMenuHandler() {\r\n    for (let i = 0, len = this.$menuActions.length; i < len; i += 1) {\r\n      this.$menuActions[i].addEventListener('click', this.handlerMenuActions.bind(this), false);\r\n    }\r\n\r\n    this.$menuClose.addEventListener('click', this.handlerMenuClose.bind(this), false);\r\n  }\r\n\r\n  initPreHighlightedTextOptions() {\r\n    // Example of data from JSON:\r\n    //\r\n    // \"predznaceni\": [\r\n    //     {\r\n    //       \"vyraz\": \"Obracíme se na vás\",\r\n    //       \"data\": {\r\n    //         \"osoba\": \"my\",\r\n    //         \"slovesnyZpusob\": \"oznamovací\"\r\n    //       }\r\n    //     }\r\n    //   ]\r\n    // }\r\n    //\r\n    // In PUG, object for every item is injected into `data-text-option` so this JS has access to it\r\n\r\n    const dataAttr = 'data-text-option';\r\n\r\n    // loop over updated DOM via DOM manipulation\r\n    this.$textOptionsElements = this.$editor.querySelectorAll(`[${dataAttr}]`);\r\n    this.$textOptionsElements.forEach(($textOption) => {\r\n\r\n      $textOption.addEventListener('click', () => {\r\n        __toggleClass($textOption, this.opts.textOptions.selectedClass);\r\n        const idForSend = this.id.replace('editor-', '');\r\n\r\n        if (__hasClass($textOption, this.opts.textOptions.selectedClass)) {\r\n\r\n          // dispatch event that editor has changed\r\n          const tagData = JSON.parse($textOption.getAttribute('data-text-option'));\r\n          tagData.tagName = 'vyznacena-pasaz';\r\n\r\n          __dispatchEvent(document, 'editor.change', {}, {\r\n            text: {\r\n              id: idForSend,\r\n              task: 'add',\r\n              tagData,\r\n              value: $textOption.cloneNode(true),\r\n            },\r\n          });\r\n        } else {\r\n          // dispatch event that editor has changed\r\n          __dispatchEvent(document, 'editor.change', {}, {\r\n            text: {\r\n              id: idForSend,\r\n              task: 'remove',\r\n              tagData: { tagName: 'vyznacena-pasaz' },\r\n              value: $textOption,\r\n            },\r\n          });\r\n        }\r\n\r\n        // show OK button or feedback\r\n        this.showFeedback();\r\n      });\r\n\r\n    });\r\n\r\n  }\r\n\r\n  toggleMenu(clickClose = false) {\r\n\r\n    if (clickClose === true) {\r\n      __addClass(this.$menu, 'hidden');\r\n      return;\r\n    }\r\n\r\n    if (this.selectionMouseDown === true) {\r\n      __addClass(this.$menu, 'hidden');\r\n      return;\r\n    }\r\n\r\n    if (__hasClass(this.$menu, 'hidden') && this.selectionMouseDown === false) {\r\n      this._setmenuDimensions();\r\n      __removeClass(this.$menu, 'hidden');\r\n    }\r\n\r\n  }\r\n\r\n  _setmenuDimensions() {\r\n    const menuDimensions = __getRealDimensions(this.$menu);\r\n    const parentTranslatedPosition = __positionTranslated(this.$editor);\r\n    const parentDimensions = __position(this.$editor);\r\n\r\n    // let additionalSize = ( this.selectionDirection === \"right\" ) ?\r\n\r\n    const isOverflowAt = {\r\n      right: (this.selectionAttributes.left + this.selectionAttributes.width + menuDimensions.width + this.opts.menuMargin.x) > (parentTranslatedPosition.left + parentDimensions.width),\r\n      top: (this.selectionAttributes.top - menuDimensions.height - this.opts.menuMargin.y) < (parentTranslatedPosition.top),\r\n      bottom: (this.selectionAttributes.top + this.selectionAttributes.height + menuDimensions.height + this.opts.menuMargin.y) > (parentTranslatedPosition.top + parentDimensions.height),\r\n    };\r\n\r\n    let leftDimensions;\r\n    let topDimensions;\r\n\r\n    if (isOverflowAt.right) {\r\n\r\n      leftDimensions = this.selectionAttributes.left - menuDimensions.width - this.opts.menuMargin.x;\r\n\r\n    } else {\r\n\r\n      leftDimensions = this.selectionAttributes.left + this.selectionAttributes.width + this.opts.menuMargin.x;\r\n\r\n    }\r\n\r\n    if (isOverflowAt.top) {\r\n\r\n      topDimensions = this.selectionAttributes.top + menuDimensions.height + this.opts.menuMargin.y;\r\n\r\n    } else {\r\n\r\n      topDimensions = this.selectionAttributes.top - menuDimensions.height - this.opts.menuMargin.y;\r\n\r\n    }\r\n\r\n    this.$menu.style.left = `${leftDimensions}px`;\r\n    this.$menu.style.top = `${topDimensions}px`;\r\n\r\n  }\r\n\r\n  handlerMenuClose(e) {\r\n\r\n    this.toggleMenu(true);\r\n\r\n    e.preventDefault();\r\n\r\n  }\r\n\r\n  handlerMenuActions(e) {\r\n\r\n    const $el = e.currentTarget;\r\n    const command = $el.getAttribute('data-command');\r\n    const commandName = $el.getAttribute('data-command-name');\r\n\r\n    /* :TODO: Cache the options for given element to avoid JSON parsing each time */\r\n    const options = JSON.parse($el.getAttribute('data-command-options'));\r\n\r\n    this.setSelection(command, commandName, options);\r\n\r\n    e.preventDefault();\r\n\r\n  }\r\n\r\n  handlerFocus(e) {\r\n    if (e.target.closest('.canvas') === null) return;\r\n\r\n    const isMouseRightClick = e.which === 3;\r\n\r\n    if (isMouseRightClick) { return; }\r\n\r\n    if (__hasClass(e.target, 'node-close')) { return; }\r\n\r\n    if (__hasClass(e.target, 'node-selected')) { return; }\r\n\r\n    if (e.type === 'mousedown' || e.type === 'touchstart') {\r\n\r\n      // start tracking the mouse down\r\n      this.selectionMouseDown = true;\r\n\r\n      if (this.hasMenu === true) {\r\n        this.toggleMenu();\r\n      }\r\n\r\n    }\r\n\r\n    if ((e.type === 'mouseup' || e.type === 'touchend') && this.selectionMouseDown) {\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n\r\n      // reset saved last selection settings\r\n      this.lastSelectionSettings = {};\r\n\r\n      this.selection = window.getSelection();\r\n      this.isCollapsed = this.selection.isCollapsed;\r\n      this.lastSelectionSettings.isCollapsed = this.selection.isCollapsed;\r\n      this.savedSelectionRange = this.selection.getRangeAt(0);\r\n\r\n      this.selectionMouseDown = false;\r\n\r\n      this.lastSelectionSettings.anchorOffset = this.selection.anchorOffset;\r\n      this.lastSelectionSettings.focusOffset = this.selection.focusOffset;\r\n      this.lastSelectionSettings.text = this.savedSelectionRange.toString();\r\n\r\n      /* https://developer.mozilla.org/en-US/docs/Web/API/Selection/isCollapsed */\r\n      /* Returns a Boolean indicating whether the selection's start and end points are at the same position. */\r\n      /* display context menu only if the cursor is NOT at the same position */\r\n      if (this.selection.isCollapsed === false && this.savedSelectionRange.toString().trim() !== '') {\r\n\r\n        this.selectionDirection = (this.selection.anchorOffset <= this.selection.focusOffset) ? 'right' : 'left';\r\n\r\n        if (this.hasMenu === true) {\r\n\r\n          this._setSelectionPosition(); // :TODO: cannot be used in contentEditable editor yet\r\n\r\n          this.toggleMenu();\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  _setSelectionPosition() {\r\n\r\n    const dummyElement = document.createElement('span');\r\n    dummyElement.className = 'dummy-range-element';\r\n\r\n    this.savedSelectionRange.surroundContents(dummyElement);\r\n\r\n    const selectionPosition = __positionTranslated(dummyElement);\r\n    const selectionDimension = __position(dummyElement);\r\n\r\n    this.selectionAttributes = {\r\n      left: selectionPosition.left,\r\n      top: selectionPosition.top,\r\n      width: selectionDimension.width,\r\n      height: selectionDimension.height,\r\n    };\r\n\r\n    __removeClass(dummyElement, 'dummy-range-element');\r\n\r\n    this._removeNodeKeepTextContent(dummyElement);\r\n\r\n  }\r\n\r\n  _highlightContents($domEl, newTagId) {\r\n    $domEl.appendChild(this.savedSelectionRange.extractContents());\r\n    this.savedSelectionRange.insertNode($domEl);\r\n\r\n    $domEl.setAttribute('data-tag-id', newTagId);\r\n  }\r\n\r\n  _storeHighlightedContents($domEl, newTagId) {\r\n    const tagName = $domEl.getAttribute('data-command-name');\r\n\r\n    // get tag color\r\n    const classes = $domEl.getAttribute('class');\r\n    // const colors = classes.match(/(?<=node-text-)[a-z]*/g);\r\n    const classesArray = classes.split(' ');\r\n    let color = '';\r\n    classesArray.forEach((value) => {\r\n      if (value.includes('node-text-')) {\r\n        color = value.replace('node-text-', '');\r\n      }\r\n    });\r\n\r\n    // dispatch event that editor has changed\r\n    const idForSend = this.id.replace('editor-', '');\r\n    __dispatchEvent(document, 'editor.change', {}, {\r\n      text: {\r\n        id: idForSend,\r\n        task: 'add',\r\n        tagData: { tagName },\r\n        value: $domEl.cloneNode(true),\r\n        tagColor: color,\r\n      },\r\n    });\r\n  }\r\n\r\n  // eslint-disable-next-line class-methods-use-this\r\n  _removeNodeKeepTextContent(node) {\r\n    const text = node.textContent;\r\n    node.parentNode.insertBefore(document.createTextNode(text), node);\r\n    __remove(node);\r\n  }\r\n\r\n  _createCloseBtnForElement($parentEl, opts = {}) {\r\n\r\n    const $elClose = document.createElement('span');\r\n    $elClose.innerHTML = '×';\r\n    $elClose.setAttribute('class', opts.class);\r\n\r\n    const classesToToggle = opts.toggleClass.split(' ');\r\n\r\n\r\n    const clickHandler = (e) => {\r\n\r\n      const $closeBtn = e.currentTarget;\r\n      const $nodeElement = $closeBtn.parentNode;\r\n\r\n      $closeBtn.removeEventListener('click', clickHandler);\r\n      $nodeElement.removeChild($closeBtn);\r\n\r\n      if (undefined !== $nodeElement.commentRef) {\r\n\r\n        /* :TODO: temporary way to save the reference to the DOM element */\r\n        this.$editor.removeChild($nodeElement.commentRef);\r\n        $nodeElement.commentRef = null;\r\n\r\n      }\r\n\r\n      this._removeNodeKeepTextContent($nodeElement);\r\n\r\n      const tagName = $nodeElement.getAttribute('data-command-name');\r\n\r\n      // dispatch event that editor has changed\r\n      const idForSend = this.id.replace('editor-', '');\r\n      __dispatchEvent(document, 'editor.change', {}, {\r\n        text: {\r\n          id: idForSend,\r\n          task: 'remove',\r\n          tagData: { tagName },\r\n          value: $nodeElement,\r\n        },\r\n      });\r\n\r\n      e.stopPropagation();\r\n\r\n    };\r\n\r\n    $elClose.addEventListener('click', clickHandler.bind(this));\r\n\r\n    $parentEl.appendChild($elClose);\r\n\r\n  }\r\n\r\n  _calculateCommentPosition($node) /* : Object */ {\r\n\r\n    const nodePosition = __positionTranslated($node);\r\n\r\n    return {\r\n      left: `${nodePosition.left + parseInt($node.offsetWidth, 10) + this.opts.commentMargin.x}px`,\r\n      top: `${nodePosition.top + this.opts.commentMargin.y}px`,\r\n    };\r\n\r\n  }\r\n\r\n  _createCommentForNode($el, opts = {}) {\r\n\r\n    const commentTemplate = document.getElementById('comment-template').innerHTML;\r\n\r\n    const div = document.createElement('div');\r\n    div.innerHTML = commentTemplate;\r\n\r\n    const commentDiv = div.childNodes[1];\r\n\r\n    // attach js reference to the dom element\r\n    commentDiv.data = {};\r\n    commentDiv.data.nodeRef = $el;\r\n\r\n    const commentNewTextarea = commentDiv.querySelector('.comment-new-text');\r\n    const commentDivButtonSubmit = commentDiv.querySelector('button');\r\n    const commentCommentsContainer = commentDiv.querySelector('.comments-container');\r\n\r\n    const calculatedCommentPosition = this._calculateCommentPosition($el);\r\n\r\n    commentDiv.style.left = calculatedCommentPosition.left;\r\n    commentDiv.style.top = calculatedCommentPosition.top;\r\n\r\n    __addClass(commentDiv, opts.class);\r\n\r\n    commentDiv.addEventListener('click', (e) => {\r\n\r\n      if (__hasClass(e.target, 'close')) {\r\n\r\n        __addClass(commentDiv, 'hidden');\r\n        __removeClass($el, 'active');\r\n\r\n      }\r\n\r\n    });\r\n\r\n    commentDivButtonSubmit.addEventListener('click', (e) => {\r\n\r\n      if (commentNewTextarea.value !== '') {\r\n\r\n        const commentItem = document.createElement('div');\r\n        commentItem.className = 'comment-item';\r\n\r\n        commentItem.innerText = commentNewTextarea.value;\r\n\r\n        commentCommentsContainer.appendChild(commentItem);\r\n\r\n        commentNewTextarea.value = '';\r\n      }\r\n\r\n    });\r\n\r\n    this.$editor.append(commentDiv);\r\n\r\n    __addClass($el, 'comment-created');\r\n\r\n    /* :TODO: Temporary way to save the reference to the DOM element */\r\n    $el.commentRef = commentDiv;\r\n\r\n\r\n  }\r\n\r\n  _addCommentHandlerForElement($el, opts = {}) {\r\n\r\n    __addClass($el, 'has-comments');\r\n\r\n    function clickHandler(e) {\r\n\r\n      if (!__hasClass(e.target, 'node-close')) {\r\n\r\n        if (!__hasClass($el, 'comment-created')) {\r\n\r\n          this._createCommentForNode($el, opts);\r\n\r\n        } else {\r\n\r\n          /* recalculate comment div position */\r\n          const calculatedCommentPosition = this._calculateCommentPosition($el);\r\n\r\n          $el.commentRef.style.left = calculatedCommentPosition.left;\r\n          $el.commentRef.style.top = calculatedCommentPosition.top;\r\n\r\n          __removeClass($el.commentRef, 'hidden');\r\n\r\n        }\r\n\r\n        if (!__hasClass($el, 'active')) {\r\n\r\n          __addClass($el, 'active');\r\n\r\n        } else {\r\n\r\n          __removeClass($el, 'active');\r\n          __addClass($el.commentRef, 'hidden');\r\n\r\n        }\r\n\r\n      }\r\n\r\n      e.stopPropagation();\r\n\r\n    }\r\n\r\n    $el.addEventListener('click', clickHandler.bind(this));\r\n\r\n  }\r\n\r\n  setSelection(command, commandName, opts = {}) {\r\n\r\n    if (this.selection) {\r\n\r\n      if (command === 'toggle-class') {\r\n\r\n        const $el = document.createElement('span');\r\n        $el.setAttribute('class', opts.toggleClass);\r\n        $el.setAttribute('data-command-name', commandName);\r\n\r\n        const newTagId = this._generateNewTagId();\r\n\r\n        this._highlightContents($el, newTagId);\r\n\r\n        if (opts.closeBtn === true) {\r\n          this._createCloseBtnForElement($el, {\r\n            class: 'node-close',\r\n            toggleClass: opts.toggleClass,\r\n          });\r\n        }\r\n\r\n        if (opts.comments === true) {\r\n          this._addCommentHandlerForElement($el, {\r\n            class: opts.commentsClass,\r\n          });\r\n        }\r\n\r\n        this._storeHighlightedContents($el, newTagId);\r\n\r\n        if (opts.showCommentsOnInit === true) {\r\n          $el.click();\r\n        }\r\n\r\n      }\r\n\r\n      // hide context menu after selecting the action#\r\n      this.toggleMenu(true);\r\n\r\n      // show OK button or feedback\r\n      this.showFeedback();\r\n\r\n    }\r\n\r\n  }\r\n\r\n}\r\n\r\nEditor.defaults = {\r\n  menuClass: 'contextual-menu-component',\r\n  canvasClass: 'canvas',\r\n  resetBtnClass: 'reset',\r\n  closeBtnClass: 'node-close',\r\n  nodeSelectedClass: 'node-selected',\r\n  commentMargin: {\r\n    x: 50,\r\n    y: 0,\r\n  },\r\n  menuMargin: {\r\n    x: 15,\r\n    y: 15,\r\n  },\r\n  textOptions: {\r\n    enable: false,\r\n    animatedClass: 'active',\r\n    selectedClass: 'selected',\r\n    deselectedClass: 'deselected',\r\n  },\r\n\r\n};\r\n\r\nEditor._hasMenu = (opts) => opts.funkce !== 'cteni' && opts.funkce !== 'psani' && (opts.menu !== false && opts.menu !== undefined);\r\nEditor._hasToolbar = (opts) => opts.funkce === 'psani' || (opts.toolbar !== false && opts.toolbar !== undefined);\r\n","import { __toggleClass, __getHTML, __dispatchEvent } from '../lib/utils';\r\nimport Component from './component';\r\n\r\n// zoom the image\r\nexport default class Keywords extends Component {\r\n  constructor($element, opts = {}) {\r\n    super($element);\r\n    this.id = this.target.id;\r\n    this.function = this.target.getAttribute('data-keywords') || 'selekce-' || 'selekce+';\r\n    this.$controls = this.target.querySelectorAll('[data-keywords-control]');\r\n\r\n    this.opts = { ...Keywords.defaults, ...opts };\r\n\r\n    this.$itemsContainer = this.target.querySelector(`.${this.opts.itemsContainerClassName}`);\r\n\r\n    if (this.opts.inherit && this.opts.inherit.from.length > 0) {\r\n      // console.log(this.opts.inherit.from);\r\n      this.isInherited = true;\r\n    }\r\n    else {\r\n      this.$items = this.target.querySelectorAll(`.${this.opts.itemClassName}`);\r\n    }\r\n\r\n  }\r\n\r\n  init() {\r\n    switch (this.function) {\r\n      case 'selekce-':\r\n      case 'selekce+':\r\n        // we have data at the instantiation for importing\r\n        if (this.opts.import && this.opts.import.length > 0) {\r\n          this.$itemsContainer.innerHTML = Keywords._getHTMLFromItems(this.opts.import);\r\n        }\r\n\r\n        // console.log(this.id, this.isInherited);\r\n        if (this.isInherited) {\r\n          // if onInit, we copy the elements\r\n          // by their ids into the itemsContainer of this object\r\n          if (this.opts.inherit.onInit) {\r\n            this._regenerateItemsContainerFromInherited();\r\n          }\r\n        }\r\n\r\n        this._registerHandlers();\r\n        break;\r\n      case 'wordcloud':\r\n        this.$items.forEach(($item) => {\r\n          $item.setAttribute('data-keywords-item', 0);\r\n        });\r\n        this._changeSizeOfKeywordItem(this.opts.skala);\r\n        break;\r\n\r\n      default:\r\n        break;\r\n    }\r\n  }\r\n\r\n  _changeSizeOfKeywordItem(maxLevel) {\r\n    maxLevel = maxLevel ? parseInt(maxLevel, 10) : 4;\r\n\r\n    function setNewLevelValue($keyword, number, feedback) {\r\n      const oldValue = parseInt($keyword.getAttribute('data-keywords-item'), 10);\r\n      const newValue = oldValue + number;\r\n      const value = Math.abs(newValue) > maxLevel ? oldValue : newValue;\r\n      $keyword.setAttribute('data-keywords-item', value);\r\n\r\n      feedback();\r\n    }\r\n\r\n    this.$controls.forEach(($control) => {\r\n      const $keyword = $control.parentElement.parentElement;\r\n      const controlFunction = $control.getAttribute('data-keywords-control');\r\n\r\n      switch (controlFunction) {\r\n        case 'minus':\r\n          $control.addEventListener('click', (event) => {\r\n            setNewLevelValue($keyword, -1, this.showFeedback);\r\n            event.preventDefault();\r\n          });\r\n          break;\r\n\r\n        case 'plus':\r\n          $control.addEventListener('click', (event) => {\r\n            setNewLevelValue($keyword, 1, this.showFeedback);\r\n            event.preventDefault();\r\n          });\r\n          break;\r\n\r\n        default:\r\n          break;\r\n      }\r\n    });\r\n  }\r\n\r\n  _regenerateItemsContainerFromInherited() {\r\n    let tempContent = '';\r\n\r\n    this.opts.inherit.from.forEach((id) => {\r\n      const temp = document.getElementById(id).querySelector(`.${this.opts.itemsContainerClassName}`).innerHTML;\r\n      // rename ids of the original items to avoid duplicates in the DOM\r\n      tempContent += Keywords.renameItemsIds(id, this.id, temp);\r\n      // console.log(tempContent);\r\n    });\r\n\r\n    this.$itemsContainer.innerHTML = tempContent;\r\n\r\n    this.$items = this.target.querySelectorAll(`.${this.opts.itemClassName}`);\r\n  }\r\n\r\n  _registerHandlers() {\r\n\r\n    // this.target.querySelectorAll(`.${this.opts.itemClassName}`).forEach(($item) => {\r\n    this.$items.forEach(($item) => {\r\n      $item.addEventListener('click', this._clickEventHandler.bind(this), true);\r\n      document.addEventListener('keyword.change', (e) => { this._dispatchEventHandler(e, $item); }, false);\r\n    });\r\n\r\n  }\r\n\r\n\r\n  _clickEventHandler(e) {\r\n\r\n    if (e.type === 'click') {\r\n\r\n      __toggleClass(e.currentTarget, 'disabled');\r\n\r\n      // dispatch event that keyword has changed\r\n      __dispatchEvent(document, 'keyword.change', {}, {\r\n        keywords: {\r\n          id: this.id,\r\n          node: e.currentTarget,\r\n        },\r\n      });\r\n\r\n      this.showFeedback();\r\n    }\r\n  }\r\n\r\n  _dispatchEventHandler(e, $item) {\r\n    const { id, node } = e.detail.keywords;\r\n\r\n    if (this.isInherited && this.opts.inherit.from.includes(id)) {\r\n      const currentId = $item.id;\r\n      const nodeId = node.id;\r\n      const removeFeatureIdFromCurrentId = currentId.replace(this.id, '');\r\n      const removeFeatureIdFromNodeId = nodeId.replace(id, '');\r\n\r\n      if (removeFeatureIdFromCurrentId === removeFeatureIdFromNodeId) {\r\n        __toggleClass($item, 'disabled');\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n\r\nKeywords._getItemFromDOMElement = ($item) => ({\r\n  class: $item.className,\r\n  id: $item.getAttribute('id'),\r\n  text: $item.innerText,\r\n});\r\n\r\nKeywords._getItemsHTML = ($itemsContainer) => $itemsContainer.innerHTML;\r\n\r\nKeywords._getItemsFromHTML = ($itemsContainer, itemsClassName) => {\r\n  const $items = $itemsContainer.querySelectorAll(`.${itemsClassName}`);\r\n  const itemsArray = [];\r\n\r\n  $items.forEach(($item) => {\r\n    itemsArray.push(Keywords._getItemFromDOMElement($item));\r\n  });\r\n\r\n\r\n  return itemsArray;\r\n\r\n};\r\n\r\nKeywords._getDOMElementFromItem = (item) => {\r\n\r\n  const newDiv = document.createElement('div');\r\n  newDiv.setAttribute('class', item.class);\r\n  newDiv.setAttribute('id', item.id);\r\n  newDiv.innerHTML = item.text;\r\n\r\n  return __getHTML(newDiv);\r\n\r\n};\r\n\r\nKeywords._getHTMLFromItems = (items) => {\r\n\r\n  let contentHTML = '';\r\n\r\n  items.forEach((item) => {\r\n\r\n    contentHTML += Keywords._getDOMElementFromItem(item);\r\n\r\n  });\r\n\r\n  return contentHTML;\r\n\r\n};\r\n\r\n\r\nKeywords.renameItemsIds = (oldId, newId, itemsHTML) => {\r\n\r\n  const expString = new RegExp(oldId, 'g');\r\n\r\n  return itemsHTML.replace(expString, newId);\r\n\r\n};\r\n\r\nKeywords.defaults = {\r\n  itemsContainerClassName: 'keywords-items-container',\r\n  itemClassName: 'keywords-item',\r\n};\r\n","import { __removeClass, __toggleClass } from '../lib/utils';\r\nimport Component from './component';\r\n\r\n\r\nexport default class TestQuiz extends Component {\r\n\r\n  constructor(id, element, opts) {\r\n    super(element);\r\n\r\n    this.id = id;\r\n\r\n    this.opts = { ...TestQuiz.defaults, ...opts };\r\n\r\n    this.$questions = this.target.querySelectorAll(`.${this.opts.itemClass}`);\r\n    this.cache = {\r\n      answersCorrect: 0,\r\n      colors: [],\r\n      questions: [],\r\n    };\r\n\r\n    // get colors for all feedback variants\r\n    if (this.opts.zpetnaVazba) {\r\n      this.cache.colors = this.opts.zpetnaVazba.map((feedback) => feedback.barva);\r\n    }\r\n  }\r\n\r\n  init() {\r\n    this._registerHandlers();\r\n  }\r\n\r\n  _registerHandlers() {\r\n\r\n    this.$questions.forEach(($question, questionIndex) => {\r\n      // all questions are without answer by default\r\n      this.cache.questions.push({ answered: false });\r\n\r\n      const answerCorrect = parseInt($question.getAttribute('data-module-answer'), 10);\r\n      const $answers = $question.querySelectorAll(`.${this.opts.optionClass}`);\r\n\r\n      $answers.forEach(($answer, answerIndex) => {\r\n        $answer.addEventListener('click', () => {\r\n          const $answerCurrent = $answer;\r\n\r\n          // if already selected do nothing\r\n          if ($answerCurrent.classList.contains('selected')) {\r\n            return;\r\n          }\r\n\r\n          // remove the selection\r\n          $answers.forEach(($answersItem) => __removeClass($answersItem, this.opts.selectedClass));\r\n          // select the clicked one\r\n          __toggleClass($answerCurrent, this.opts.selectedClass);\r\n\r\n          // get sum of all corect answers\r\n          if (this.opts.zpetnaVazba) {\r\n            if (answerIndex === answerCorrect) {\r\n              this.cache.answersCorrect += 1;\r\n            } else if (this.cache.answersCorrect !== 0 && this.cache.questions[questionIndex].answered === true) {\r\n              this.cache.answersCorrect -= 1;\r\n            }\r\n            // loop through all \"zpetnaVazba\" to get the one with the fullfilled condition\r\n            const feedbackActual = this.opts.zpetnaVazba.find((feedback) => feedback.podminka.includes(this.cache.answersCorrect));\r\n\r\n            // show the right feedback message\r\n            this.$buttonFeedback.classList.remove(...this.cache.colors);\r\n            this.$buttonFeedback.classList.add(feedbackActual.barva);\r\n            this.$buttonFeedbackText.innerText = feedbackActual.text;\r\n          }\r\n\r\n          // note that this question has been answered (whether true or false)\r\n          this.cache.questions[questionIndex].answered = true;\r\n\r\n          // show OK button with feedback only when all question have been answered\r\n          if (this.cache.questions.find((question) => !question.answered) === undefined) {\r\n            this.showFeedback();\r\n          }\r\n\r\n        }, false);\r\n      });\r\n    });\r\n  }\r\n}\r\n\r\nTestQuiz.defaults = {\r\n  itemClass: 'test-quiz-item',\r\n  optionClass: 'option',\r\n  selectedClass: 'selected',\r\n};\r\n","/* eslint-disable max-classes-per-file */\r\n// [data-fullscreen]\r\nimport Component from './component';\r\nimport MagnifyingGlass from './magnifying-glass';\r\nimport { imageIsLoaded } from '../lib/utils';\r\n\r\nclass Fullscreen extends Component {\r\n  constructor($element) {\r\n    super($element);\r\n\r\n    this.$fullscreen = document.querySelector('[data-fullscreen=\"fullscreen\"]');\r\n    this.$fullscreenContainer = this.$fullscreen.querySelector('[data-fullscreen=\"container\"]');\r\n    this.$fullscreenTarget = this.$fullscreen.querySelector('[data-fullscreen=\"target\"]');\r\n\r\n    this.window = {};\r\n    this.image = {};\r\n\r\n    this.window.width = window.innerWidth;\r\n    this.window.height = window.innerHeight;\r\n    this.window.ratio = this.window.width / this.window.height;\r\n  }\r\n}\r\n\r\nexport default class FullscreenToggle extends Fullscreen {\r\n  constructor($element) {\r\n    super($element);\r\n\r\n    this.imageAlternative = this.target.getAttribute('data-fullscreen-image');\r\n\r\n    // TODO: do not rely on DOM .nextElementSibling, .firstElementChild, etc…\r\n    this.target.addEventListener('click', (event) => {\r\n      // Check if there is different image for zvetseni\r\n      if (this.imageAlternative) {\r\n        this.$fullscreenContainer.innerHTML = this.target.nextElementSibling.nextElementSibling.outerHTML;\r\n        this.$fullscreenTarget = this.$fullscreenContainer.firstElementChild;\r\n        this.$fullscreenTarget.classList.remove('is-hidden');\r\n      }\r\n      else {\r\n        this.$fullscreenContainer.innerHTML = this.target.nextElementSibling.outerHTML;\r\n        this.$fullscreenTarget = this.$fullscreenContainer.firstElementChild;\r\n      }\r\n\r\n      this.$fullscreenTarget.removeAttribute('style');\r\n      this.$fullscreenTarget.removeAttribute('id');\r\n\r\n      switch (this.target.nextElementSibling.nodeName.toLowerCase()) {\r\n        case 'img':\r\n          setTimeout(() => {\r\n            imageIsLoaded(this.$fullscreenTarget.currentSrc)\r\n              .then(() => {\r\n                this.image.width = this.$fullscreenTarget.naturalWidth;\r\n                this.image.height = this.$fullscreenTarget.naturalHeight;\r\n                this.image.ratio = this.image.width / this.image.height;\r\n\r\n                this.setSize();\r\n\r\n                const magnifyingGlass = new MagnifyingGlass(this.$fullscreenTarget);\r\n              });\r\n          }, 10);\r\n          break;\r\n\r\n        case 'svg':\r\n          // eslint-disable-next-line no-case-declarations\r\n          const viewbox = this.$fullscreenTarget.getAttribute('viewBox').split(' ');\r\n\r\n          [, , this.image.width, this.image.height] = viewbox;\r\n          this.image.ratio = this.image.width / this.image.height;\r\n\r\n          this.setSize();\r\n\r\n          // eslint-disable-next-line no-case-declarations\r\n          const $svgTexts = this.$fullscreenTarget.querySelectorAll('textarea');\r\n          if ($svgTexts.length > 0) {\r\n            $svgTexts.forEach(($svgText) => {\r\n              const { id } = $svgText;\r\n              $svgText.removeAttribute('id');\r\n              $svgText.value = document.getElementById(id).value;\r\n              $svgText.readOnly = true;\r\n            });\r\n          }\r\n          break;\r\n\r\n        default:\r\n          break;\r\n      }\r\n\r\n      this.$fullscreen.classList.toggle('hidden');\r\n\r\n      this.showFeedback();\r\n\r\n      event.preventDefault();\r\n      event.stopPropagation();\r\n    }, false);\r\n\r\n  }\r\n\r\n  setSize() {\r\n    if (this.image.ratio >= this.window.ratio) {\r\n      this.$fullscreenTarget.style.width = '100%';\r\n      this.$fullscreenTarget.style.height = 'auto';\r\n    }\r\n    else {\r\n      this.$fullscreenTarget.style.width = 'auto';\r\n      this.$fullscreenTarget.style.height = `${this.window.height}px`;\r\n    }\r\n  }\r\n}\r\n","import Component from './component';\r\nimport { __dispatchEvent } from '../lib/utils';\r\n\r\nexport default class UserText extends Component {\r\n  constructor($element) {\r\n    super($element);\r\n\r\n    this.$item = this.target.closest('.user-text');\r\n    this.$counter = this.$item.querySelector('[data-usertext-counter]');\r\n    this.$counterWrapper = this.$item.querySelector('.user-text__counter');\r\n    this.$instruction = this.$item.querySelector('.user-text__question');\r\n\r\n    this.$userTexts = this.$slide.querySelectorAll('[data-textarea-target]');\r\n\r\n    this.feedback = JSON.parse(this.target.getAttribute('data-feedback'));\r\n\r\n    this.lengthExpected = {\r\n      min: parseInt(this.target.getAttribute('minlength') === '0' ? 1 : this.target.getAttribute('minlength'), 10),\r\n      avg: null,\r\n      max: parseInt(this.target.getAttribute('maxlength') / 2, 10),\r\n    };\r\n    this.lengthExpected.avg = Math.floor((this.lengthExpected.max - this.lengthExpected.min) / 4 + this.lengthExpected.min);\r\n\r\n    this.cache = {\r\n      answersCorrect: 0,\r\n      colors: [\r\n        'color-red',\r\n        'color-orange',\r\n        'color-green',\r\n      ],\r\n      questions: [],\r\n    };\r\n\r\n    this.lastValue = '';\r\n    this.hadData = this.target.value && this.target.value.length > 0;\r\n    this.wasUsed = false;\r\n\r\n    if (this.hadData) {\r\n      this.updateCharacterCounter();\r\n    }\r\n\r\n    if (!HISTORYLAB.import.done) {\r\n      // duplicate source of different text element\r\n      this.toDuplicate = this.target.getAttribute('data-duplicate-text');\r\n      this.textDuplicateSources = this.toDuplicate ? this.toDuplicate.split(' ') : [];\r\n\r\n      // listen events\r\n      this.getEvents();\r\n      this.addEventListeners();\r\n    }\r\n  }\r\n\r\n  updateCharacterCounter(length = this.target.value.length) {\r\n    this.$counterWrapper.classList.remove(...this.cache.colors);\r\n    if (length < this.lengthExpected.min) this.$counterWrapper.classList.add(this.cache.colors[0]);\r\n    else if (length <= this.lengthExpected.avg) this.$counterWrapper.classList.add(this.cache.colors[1]);\r\n    else if (length > this.lengthExpected.avg) this.$counterWrapper.classList.add(this.cache.colors[2]);\r\n\r\n    this.$counter.innerText = length;\r\n    this.target.classList.add('is-used', !this.wasUsed);\r\n    this.wasUsed = true;\r\n  }\r\n\r\n  updateFeedback(length = this.target.value.length) {\r\n    if (!this.$buttonFeedback) return;\r\n\r\n    this.$buttonFeedback.classList.remove(...this.cache.colors);\r\n    if (length < this.lengthExpected.min) {\r\n      this.$buttonFeedback.classList.add(this.cache.colors[0]);\r\n      this.$buttonFeedbackText.innerText = this.feedback.none;\r\n    } else {\r\n\r\n      if (length <= this.lengthExpected.avg) {\r\n        this.$buttonFeedback.classList.add(this.cache.colors[1]);\r\n        this.$buttonFeedbackText.innerText = this.feedback.short;\r\n      }\r\n      else if (length > this.lengthExpected.avg) {\r\n        this.$buttonFeedback.classList.add(this.cache.colors[2]);\r\n        this.$buttonFeedbackText.innerText = this.feedback.ok;\r\n      }\r\n\r\n      this.target.setAttribute('data-textarea-target', 'success');\r\n      // check if all conditions of the same component on the same slide are met\r\n      const conditionAll = Array.from(this.$userTexts).find(($userText) => ($userText.getAttribute('data-textarea-target') !== 'success'));\r\n\r\n      if (conditionAll === undefined) {\r\n        // show OK button or feedback\r\n        this.showFeedback();\r\n      }\r\n    }\r\n  }\r\n\r\n  addEventListeners() {\r\n    // BLUR\r\n    this.target.addEventListener('blur', (event) => {\r\n      this.updateCharacterCounter();\r\n\r\n      if (event.target.value !== this.lastValue) {\r\n        const taskName = (this.lastValue === '') ? 'create' : 'change';\r\n        this.lastValue = event.target.value;\r\n\r\n        // dispatch event that text has changed\r\n        __dispatchEvent(document, 'text.change', {}, {\r\n          text: {\r\n            id: event.target.id,\r\n            task: taskName,\r\n            text: event.target.value,\r\n          },\r\n        });\r\n\r\n        // remove connection of any textfields\r\n        this.textDuplicateSources = [];\r\n      }\r\n    });\r\n\r\n    // KEYUP\r\n    this.target.addEventListener('keyup', (event) => {\r\n      event.stopPropagation();\r\n\r\n      const valueLength = this.target.value.length;\r\n      this.updateCharacterCounter(valueLength);\r\n      this.updateFeedback(valueLength);\r\n    });\r\n  }\r\n\r\n  getEvents() {\r\n    // when Selectable module modify question in user text\r\n    if (this.$instruction && this.$instruction.hasAttribute('data-from')) {\r\n      const fromId = this.$instruction.getAttribute('data-from');\r\n\r\n      document.addEventListener('selection.change', (e) => {\r\n        if (fromId === e.detail.id && e.detail.itemData && typeof e.detail.itemData === 'string') {\r\n          this.$instruction.innerText = e.detail.itemData;\r\n        }\r\n      });\r\n    }\r\n\r\n    // when textarea value is taken from other textarea\r\n    if (this.textDuplicateSources[0]) {\r\n\r\n      document.addEventListener('text.change', (e) => {\r\n        if (this.textDuplicateSources.includes(e.detail.text.id)) {\r\n\r\n          const taskName = (this.target.value === '') ? 'create' : 'change';\r\n          switch (e.detail.text.task) {\r\n            case 'create':\r\n            case 'change':\r\n              // if is something already there\r\n              if (this.target.value !== '') this.target.value += '\\n';\r\n\r\n              // if array length is one it means that can by connection line\r\n              if (this.textDuplicateSources.length === 1) {\r\n                this.target.value = e.detail.text.text;\r\n              } else {\r\n                this.target.value += `${e.detail.text.text}\\n`;\r\n              }\r\n\r\n              // dispatch event that text has changed\r\n              __dispatchEvent(document, 'text.change', {}, {\r\n                text: {\r\n                  id: this.target.id,\r\n                  task: taskName,\r\n                  text: this.target.value,\r\n                },\r\n              });\r\n\r\n              // make different first value if is need\r\n              this.lastValue = this.target.value;\r\n\r\n              this.updateCharacterCounter();\r\n              break;\r\n            default:\r\n              console.log('Nondefinated text events task. :(');\r\n          }\r\n        }\r\n      });\r\n    }\r\n  }\r\n}\r\n","import Component from '../component';\r\n\r\nexport default class AudioPlayerNormal extends Component {\r\n\r\n  constructor($element) {\r\n    super($element);\r\n\r\n    this.$playButton = this.target.querySelector('[data-player-control]');\r\n    this.$loadWave = this.target.querySelector('[data-audio-wave]');\r\n    this.$leftTime = this.target.querySelector('[data-audio-time-left]');\r\n    this.$audioDuration = this.target.querySelector('[data-audio-time-duration]');\r\n\r\n    this.wavesurfer = WaveSurfer.create({\r\n      container: this.$loadWave,\r\n      waveColor: '#A77977',\r\n      progressColor: '#FCE4E3',\r\n      height: 80,\r\n      responsive: true,\r\n      barWidth: 2,\r\n    });\r\n    this.wavesurfer.load(this.$loadWave.dataset.src);\r\n\r\n    this.initWave();\r\n  }\r\n\r\n  initWave() {\r\n    this.wavesurfer.on('ready', () => {\r\n      this.$leftTime.textContent = '0:00';\r\n      const duration = this.wavesurfer.getDuration();\r\n      const minutes = Math.floor((duration % 3600) / 60);\r\n      const seconds = (`00${Math.floor(duration % 60)}`).slice(-2);\r\n      this.$audioDuration.textContent = `${minutes}:${seconds}`;\r\n\r\n      this.addListenerAfterReady();\r\n    });\r\n  }\r\n\r\n  addListenerAfterReady() {\r\n    this.wavesurfer.on('audioprocess', (time) => {\r\n      const minutes = Math.floor((time % 3600) / 60);\r\n      const seconds = (`00${Math.floor(time % 60)}`).slice(-2);\r\n      this.$leftTime.textContent = `${minutes}:${seconds}`;\r\n    });\r\n\r\n    this.wavesurfer.on('finish', () => {\r\n      this.$playButton.setAttribute('data-player-control', 'paused');\r\n    });\r\n\r\n    this.$playButton.addEventListener('click', () => {\r\n      this.wavesurfer.playPause();\r\n\r\n      if (this.$playButton.getAttribute('data-player-control') === 'paused') {\r\n        this.$playButton.setAttribute('data-player-control', 'playing');\r\n      } else {\r\n        this.$playButton.setAttribute('data-player-control', 'paused');\r\n      }\r\n\r\n      this.showFeedback();\r\n    });\r\n\r\n    // stop audio prehravac kdyz se zapne dalsi slajd\r\n    const $nextSlides = document.querySelectorAll('[data-nav-button]');\r\n    $nextSlides.forEach(($nextSlide) => {\r\n      $nextSlide.addEventListener('click', () => {\r\n        if (this.$playButton.getAttribute('data-player-control') === 'playing') {\r\n          this.wavesurfer.playPause();\r\n          this.$playButton.setAttribute('data-player-control', 'paused');\r\n        }\r\n      });\r\n    });\r\n\r\n  }\r\n\r\n}\r\n","import AudioPlayer from './audio-player';\r\nimport { getSecondsMinutesFormat } from './media';\r\n\r\nexport default class AudioPlayerSimple extends AudioPlayer {\r\n  constructor($element) {\r\n    super($element);\r\n\r\n    this.$audio = this.target.querySelector('audio');\r\n    this.$timeLeft = this.target.querySelector('[data-audio-time-left]');\r\n    this.$duration = this.target.querySelector('[data-audio-time-duration]');\r\n\r\n    this.$duration.innerText = `/${getSecondsMinutesFormat(this.$audio.duration)}`;\r\n\r\n    AudioPlayer.addEventListeners(this.target, this.showFeedback);\r\n  }\r\n}\r\n","import Component from './component';\r\n\r\nexport default class FakeMap extends Component {\r\n  constructor($element) {\r\n    super($element);\r\n\r\n    this.$buttons = this.target.querySelectorAll('[data-fake-map=\"toggle\"]');\r\n    this.$maps = this.target.querySelectorAll('[data-fake-map=\"map\"]');\r\n    this.lastActiveIndex = 0;\r\n\r\n    this.addEventListenerToButtons();\r\n  }\r\n\r\n  switchMap($button, index) {\r\n    this.$maps[this.lastActiveIndex].classList.remove('active');\r\n    this.$buttons[this.lastActiveIndex].classList.remove('active');\r\n\r\n    this.$maps[index].classList.add('active');\r\n    $button.classList.add('active');\r\n\r\n    this.lastActiveIndex = index;\r\n  }\r\n\r\n  addEventListenerToButtons() {\r\n    this.$buttons.forEach(($button, index) => {\r\n\r\n      $button.addEventListener('click', (event) => {\r\n        this.switchMap($button, index);\r\n        this.showFeedback();\r\n\r\n        event.preventDefault();\r\n      });\r\n\r\n    });\r\n  }\r\n}\r\n","/* eslint-disable no-nested-ternary */\r\nimport Component from '../component';\r\nimport { getSecondsMinutesFormat, mediaEvents } from './media';\r\n\r\nexport default class VideoPlayer extends Component {\r\n  constructor($element, options) {\r\n    super($element);\r\n\r\n    this.$media = this.target.querySelector('video');\r\n    this.options = Object(options);\r\n    this.prefix = this.options.prefix || 'media';\r\n    this.lang = Object(this.options.lang);\r\n    // lang.currentTime\r\n    // lang.play\r\n    // lang.pause\r\n    // lang.minutes\r\n    // lang.seconds\r\n    // lang.leaveFullscreen\r\n    // lang.enterFullscreen\r\n\r\n    this.paused = null;\r\n    this.currentTime = null;\r\n    this.duration = null;\r\n    this.interval = null;\r\n\r\n    this.$document = this.target.ownerDocument;\r\n    this.$controls = this.target.querySelector('.media-player-controls');\r\n    // play/pause toggle\r\n    this.$play = this.$controls.querySelector('[data-player-control]');\r\n    this.$playSymbol = this.$play.querySelector('.media-play-symbol');\r\n    this.$pauseSymbol = this.$play.querySelector('.media-pause-symbol');\r\n    // time slider\r\n    this.$time = this.$controls.querySelector('[data-video-time-progress]');\r\n    this.$timeMeter = this.$time.querySelector('.media-meter.media-time-meter');\r\n    this.$timeRange = this.$time.querySelector('.media-range.media-time-range');\r\n\r\n    // current time text\r\n    this.$currentTimeText = this.$document.createTextNode('');\r\n    this.$currentTime = this.$controls.querySelector('[data-video-time-left]');\r\n    this.$currentTime.appendChild(this.$currentTimeText);\r\n\r\n    // duration time text\r\n    this.durationTime = this.$media.duration;\r\n    this.$durationTime = this.$controls.querySelector('[data-video-time-duration]');\r\n    this.$durationTime.innerText = getSecondsMinutesFormat(this.durationTime);\r\n    this.$durationTime.setAttribute(\r\n      'title',\r\n      `${VideoPlayer.timeToAural(\r\n        this.durationTime,\r\n        this.lang.minutes || 'minutes',\r\n        this.lang.seconds || 'seconds',\r\n      )}`,\r\n    );\r\n\r\n    // fullscreen button\r\n    this.$fullscreen = this.$controls.querySelector(\r\n      '.fullscreen-toggle',\r\n    );\r\n    this.$enterFullscreenSymbol = this.$fullscreen.querySelector(\r\n      '.media-enterFullscreen-symbol',\r\n    );\r\n    this.$leaveFullscreenSymbol = this.$fullscreen.querySelector(\r\n      '.media-leaveFullscreen-symbol',\r\n    );\r\n\r\n    // fullscreen api\r\n    this._fullscreenchange = 'onfullscreenchange' in this.target\r\n      ? 'fullscreenchange'\r\n      : 'onwebkitfullscreenchange' in this.target\r\n        ? 'webkitfullscreenchange'\r\n        : 'onMSFullscreenChange' in this.target\r\n          ? 'MSFullscreenChange'\r\n          : 'fullscreenchange';\r\n\r\n    this._requestFullscreen = this.target.requestFullscreen\r\n    || this.target.webkitRequestFullscreen\r\n    // || this.target.mozRequestFullScreen\r\n    || this.target.msRequestFullscreen;\r\n\r\n    this.onCanPlayStart = this.onCanPlayStart.bind(this);\r\n    this.onLoadStart = this.onLoadStart.bind(this);\r\n    this.onLoadedData = this.onLoadedData.bind(this);\r\n    this.onPlayChange = this.onPlayChange.bind(this);\r\n    this.onTimeChange = this.onTimeChange.bind(this);\r\n    this.onPlayClick = this.onPlayClick.bind(this);\r\n    this.onTimeKeydown = this.onTimeKeydown.bind(this);\r\n    this.onTimeClick = this.onTimeClick.bind(this);\r\n    this.onTimeKeydown = this.onTimeKeydown.bind(this);\r\n    this.onFullscreenClick = this.onFullscreenClick.bind(this);\r\n    this.onFullscreenChange = this.onFullscreenChange.bind(this);\r\n\r\n    // add event listeners\r\n    this.$media.addEventListener('canplaythrough', this.onCanPlayStart);\r\n    this.$media.addEventListener('loadstart', this.onLoadStart);\r\n    this.$media.addEventListener('loadeddata', this.onLoadedData);\r\n    this.$media.addEventListener('pause', this.onPlayChange);\r\n    this.$media.addEventListener('play', this.onPlayChange);\r\n    this.$media.addEventListener('timeupdate', this.onTimeChange);\r\n    this.$controls.addEventListener('click', this.onPlayClick, false);\r\n    // this.$play.addEventListener('click', this.onPlayClick, false);\r\n    this.$play.addEventListener('keydown', this.onTimeKeydown);\r\n    this.$time.addEventListener('click', this.onTimeClick, false);\r\n    this.$time.addEventListener('keydown', this.onTimeKeydown);\r\n    this.$fullscreen.addEventListener('click', this.onFullscreenClick, false);\r\n    // listen for fullscreen changes\r\n    document.addEventListener(\r\n      this._fullscreenchange,\r\n      this.onFullscreenChange,\r\n    );\r\n\r\n    // pointer events from time control\r\n    VideoPlayer.onDrag(this.$time, this.$timeRange, (percentage) => {\r\n      this.$media.currentTime = this.duration * Math.max(0, Math.min(1, percentage));\r\n\r\n      this.onTimeChange();\r\n    });\r\n\r\n    this.onLoadStart();\r\n  }\r\n\r\n  static _fullscreenElement() {\r\n    return document.fullscreenElement\r\n    || document.webkitFullscreenElement\r\n    // || document.mozFullScreenElement\r\n    || document.msFullscreenElement;\r\n  }\r\n\r\n  static _exitFullscreen() {\r\n    return document.exitFullscreen\r\n    || document.webkitCancelFullScreen\r\n    // || document.mozCancelFullScreen\r\n    || document.msExitFullscreen;\r\n  }\r\n\r\n  // when the play state changes\r\n  onPlayChange() {\r\n    if (this.paused !== this.$media.paused) {\r\n      this.paused = this.$media.paused;\r\n\r\n      this.$play.setAttribute(\r\n        'aria-label',\r\n        this.paused ? this.lang.play || 'play' : this.lang.pause || 'pause',\r\n      );\r\n      this.target.setAttribute(\r\n        'data-player-state',\r\n        this.paused ? 'paused' : 'playing',\r\n      );\r\n      this.$playSymbol.setAttribute('aria-hidden', !this.paused);\r\n      this.$pauseSymbol.setAttribute('aria-hidden', this.paused);\r\n\r\n      clearInterval(this.interval);\r\n\r\n      if (!this.paused) {\r\n        // listen for time changes every 30th of a second\r\n        this.interval = setInterval(this.onTimeChange, 34);\r\n      }\r\n\r\n      // dispatch new \"playchange\" event\r\n      this.$media.dispatchEvent(mediaEvents.playchange);\r\n    }\r\n  }\r\n\r\n  // when the time changes\r\n  onTimeChange() {\r\n    if (\r\n      this.currentTime !== this.$media.currentTime\r\n      || this.duration !== this.$media.duration\r\n    ) {\r\n      this.currentTime = this.$media.currentTime;\r\n      this.duration = this.$media.duration || 0;\r\n\r\n      const currentTimePercentage = this.currentTime / this.duration;\r\n      // const currentTimeCode = VideoPlayer.timeToTimecode(this.currentTime);\r\n      const currentTimeCode = getSecondsMinutesFormat(this.currentTime);\r\n      // const remainingTimeCode = VideoPlayer.timeToTimecode(\r\n      //   this.duration - Math.floor(this.currentTime),\r\n      // );\r\n\r\n      if (currentTimeCode !== this.$currentTimeText.nodeValue) {\r\n        this.$currentTimeText.nodeValue = currentTimeCode;\r\n\r\n        this.$currentTime.setAttribute(\r\n          'title',\r\n          `${VideoPlayer.timeToAural(\r\n            this.currentTime,\r\n            this.lang.minutes || 'minutes',\r\n            this.lang.seconds || 'seconds',\r\n          )}`,\r\n        );\r\n      }\r\n\r\n      // if (remainingTimeCode !== this.$remainingTimeText.nodeValue) {\r\n      //   this.$remainingTimeText.nodeValue = remainingTimeCode;\r\n\r\n      //   $(this.$remainingTime, {\r\n      //     title: `${VideoPlayer.timeToAural(\r\n      //       this.duration - this.currentTime,\r\n      //       this.lang.minutes || 'minutes',\r\n      //       this.lang.seconds || 'seconds',\r\n      //     )}`,\r\n      //   });\r\n      // }\r\n\r\n      this.$time.setAttribute('aria-valuenow', this.currentTime);\r\n      this.$time.setAttribute('aria-valuemin', 0);\r\n      this.$time.setAttribute('aria-valuemax', this.duration);\r\n\r\n      this.$timeMeter.style.width = `${currentTimePercentage * 100}%`;\r\n\r\n      // dispatch new \"timechange\" event\r\n      this.$media.dispatchEvent(mediaEvents.timechange);\r\n    }\r\n  }\r\n\r\n  // when media loads for the first time\r\n  onLoadStart() {\r\n    this.$media.removeEventListener('canplaythrough', this.onCanPlayStart);\r\n    this.$media.addEventListener('canplaythrough', this.onCanPlayStart);\r\n\r\n    this.onPlayChange();\r\n    this.onFullscreenChange();\r\n    this.onTimeChange();\r\n  }\r\n\r\n  // when the immediate current playback position is available\r\n  onLoadedData() {\r\n    this.onTimeChange();\r\n  }\r\n\r\n  // when the media can play\r\n  onCanPlayStart() {\r\n    this.$media.removeEventListener('canplaythrough', this.nCanPlayStart);\r\n\r\n    // dispatch new \"canplaystart\" event\r\n    this.$media.dispatchEvent(mediaEvents.canplaystart);\r\n\r\n\r\n    if (!this.paused || this.$media.autoplay) {\r\n      this.$media.play();\r\n    }\r\n  }\r\n\r\n  onFullscreenChange() {\r\n    const isFullscreen = this.target === VideoPlayer._fullscreenElement();\r\n\r\n    this.$fullscreen.setAttribute(\r\n      'aria-label',\r\n      isFullscreen\r\n        ? this.lang.leaveFullscreen || 'leave full screen'\r\n        : this.lang.enterFullscreen || 'enter full screen',\r\n    );\r\n    this.$enterFullscreenSymbol.setAttribute('aria-hidden', isFullscreen);\r\n    this.$leaveFullscreenSymbol.setAttribute('aria-hidden', !isFullscreen);\r\n  }\r\n\r\n  // when the play control is clicked\r\n  onPlayClick(event) {\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n\r\n    this.$media[this.$media.paused ? 'play' : 'pause']();\r\n  }\r\n\r\n  // when the time control\r\n  onTimeClick(event) {\r\n    event.stopPropagation();\r\n\r\n    // handle click if clicked without pointer\r\n    if (!event.pointerType && !event.detail) {\r\n      this.onPlayClick(event);\r\n    }\r\n  }\r\n\r\n  // click from fullscreen control\r\n  onFullscreenClick(event) {\r\n    event.stopPropagation();\r\n\r\n    if (this._requestFullscreen) {\r\n      if (this.target === VideoPlayer._fullscreenElement()) {\r\n        // exit fullscreen\r\n        VideoPlayer._exitFullscreen().call(document);\r\n      } else {\r\n        // enter fullscreen\r\n        this._requestFullscreen.call(this.target);\r\n\r\n        // maintain focus in internet explorer\r\n        this.$fullscreen.focus();\r\n\r\n        // maintain focus in safari\r\n        setTimeout(() => {\r\n          this.$fullscreen.focus();\r\n        }, 200);\r\n      }\r\n    } else if (this.$media.webkitSupportsFullscreen) {\r\n      // iOS allows fullscreen of the video itself\r\n      if (this.$media.webkitDisplayingFullscreen) {\r\n        // exit ios fullscreen\r\n        this.$media.webkitExitFullscreen();\r\n      } else {\r\n        // enter ios fullscreen\r\n        this.$media.webkitEnterFullscreen();\r\n      }\r\n\r\n      this.onFullscreenChange();\r\n    }\r\n  }\r\n\r\n  // keydown from play control or current time control\r\n  onTimeKeydown(event) {\r\n    const { keyCode, shiftKey } = event;\r\n\r\n    // 37: LEFT, 38: UP, 39: RIGHT, 40: DOWN\r\n    if (keyCode >= 37 && keyCode <= 40) {\r\n      event.preventDefault();\r\n\r\n      const offset = keyCode === 37 || keyCode === 39 ? keyCode - 38 : keyCode - 39;\r\n\r\n      this.$media.currentTime = Math.max(\r\n        0,\r\n        Math.min(\r\n          this.$media.duration,\r\n          this.$media.currentTime + offset * (shiftKey ? 10 : 1),\r\n        ),\r\n      );\r\n\r\n      this.onTimeChange();\r\n    }\r\n  }\r\n\r\n  // Handle Drag Ranges\r\n  static onDrag(target, innerTarget, listener) {\r\n    // eslint-disable-line max-params\r\n    const hasPointerEvent = undefined !== target.onpointerup;\r\n    const hasTouchEvent = undefined !== target.ontouchstart;\r\n    const pointerDown = hasPointerEvent\r\n      ? 'pointerdown'\r\n      : hasTouchEvent\r\n        ? 'touchstart'\r\n        : 'mousedown';\r\n    const pointerMove = hasPointerEvent\r\n      ? 'pointermove'\r\n      : hasTouchEvent\r\n        ? 'touchmove'\r\n        : 'mousemove';\r\n    const pointerUp = hasPointerEvent\r\n      ? 'pointerup'\r\n      : hasTouchEvent\r\n        ? 'touchend'\r\n        : 'mouseup';\r\n\r\n    // ...\r\n    const axisProp = 'clientX';\r\n\r\n    let window;\r\n    let start;\r\n    let end;\r\n\r\n    function onpointermove(event) {\r\n      // prevent browser actions on this event\r\n      event.preventDefault();\r\n\r\n      // the pointer coordinate\r\n      const position = axisProp in event\r\n        ? event[axisProp]\r\n        : (event.touches && event.touches[0] && event.touches[0][axisProp])\r\n            || 0;\r\n\r\n      // the percentage of the pointer along the container\r\n      const percentage = (position - start) / (end - start);\r\n\r\n      // call the listener with percentage\r\n      listener(percentage);\r\n    }\r\n\r\n    function onpointerdown(event) {\r\n      // window\r\n      window = target.ownerDocument.defaultView;\r\n\r\n      // client boundaries\r\n      const rect = innerTarget.getBoundingClientRect();\r\n\r\n      // the container start and end coordinates\r\n      start = rect.left;\r\n      end = rect.right;\r\n\r\n      onpointermove(event);\r\n\r\n      window.addEventListener(pointerMove, onpointermove);\r\n      window.addEventListener(pointerUp, onpointerup);\r\n    }\r\n\r\n    function onpointerup() {\r\n      window.removeEventListener(pointerMove, onpointermove);\r\n      window.removeEventListener(pointerUp, onpointerup);\r\n    }\r\n\r\n    // on pointer down\r\n    target.addEventListener(pointerDown, onpointerdown);\r\n  }\r\n\r\n  // Time To Timecode\r\n  // DEPRECATED (media.util)\r\n  // static timeToTimecode(time) {\r\n  //   return `${`0${Math.floor(time / 60)}`.slice(-2)}:${`0${Math.floor(\r\n  //     time % 60,\r\n  //   )}`.slice(-2)}`;\r\n  // }\r\n\r\n  // Time To Aural\r\n  // DEPRECATED (media.util)\r\n  static timeToAural(time, langMinutes, langSeconds) {\r\n    return `${Math.floor(time / 60)} ${langMinutes}, ${Math.floor(\r\n      time % 60,\r\n    )} ${langSeconds}`;\r\n  }\r\n}\r\n","/* eslint-disable linebreak-style */\r\nimport Component from './component';\r\nimport { __dispatchEvent } from '../lib/utils';\r\n\r\nexport default class Selectable extends Component {\r\n\r\n  constructor($element) {\r\n    super($element);\r\n\r\n    // TODO: is DOM element before/after the editor itself.. move it to the editor?\r\n    this.$settings = document.querySelector(`[data-selectable-id-reference=\"${this.target.id}\"]`);\r\n\r\n    this.feedback = JSON.parse(this.$settings.getAttribute('data-module-zpetnavazba'));\r\n    this.settings = JSON.parse(this.$settings.getAttribute('data-module-settings'));\r\n\r\n    this.$items = this.target.querySelectorAll('.selectable-item');\r\n\r\n    this.cache = {\r\n      answersCorrect: 0,\r\n      zpetnaVazba: false,\r\n      colors: [],\r\n      checkedInput: 0,\r\n    };\r\n\r\n    this.$inputs = this.target.querySelectorAll('input');\r\n    this.$inputs.forEach(($input) => {\r\n      this._changeClassIfChecked($input);\r\n      this._addEventListeners($input);\r\n    });\r\n\r\n    // get colors for all feedback variants\r\n    if (this.feedback) {\r\n      this.cache.zpetnaVazba = true;\r\n      this.cache.colors = this.feedback.map((feedback) => feedback.barva);\r\n    }\r\n\r\n  }\r\n\r\n  _addEventListeners($input) {\r\n    $input.addEventListener('change', () => {\r\n\r\n      this.$inputs.forEach(($input_) => {\r\n        this._changeClassIfChecked($input_);\r\n      });\r\n\r\n      this._checkAndResolveFeedback();\r\n\r\n      this._dispatchEvent($input);\r\n    }, false);\r\n  }\r\n\r\n  /* eslint class-methods-use-this: [\"error\", { \"exceptMethods\": [\"_changeClassIfChecked\"] }] */\r\n  // TODO: might be possible with CSS only with `:checked` selector & sibling combinator`+` or `~`\r\n  _changeClassIfChecked($input) {\r\n    $input.closest('.selectable-item').classList.toggle('is-checked', $input.checked === true);\r\n  }\r\n\r\n  _checkAndResolveFeedback() {\r\n    this.cache.answersCorrect = 0;\r\n\r\n    if (this.settings.viceOdpovedi) {\r\n      this.$items.forEach(($item, index) => {\r\n        if (this.$inputs[index].checked) {\r\n          this.cache.checkedInput += 1;\r\n        }\r\n        if (this.$inputs[index].checked && $item.hasAttribute('data-select-spravnaodpoved')) {\r\n          this.cache.answersCorrect += 1;\r\n        }\r\n        if (!this.$inputs[index].checked && !$item.hasAttribute('data-select-spravnaodpoved')) {\r\n          this.cache.answersCorrect += 1;\r\n        }\r\n      });\r\n    }\r\n    else {\r\n      this.$items.forEach(($item, index) => {\r\n        if (this.$inputs[index].checked) {\r\n          this.cache.checkedInput += 1;\r\n        }\r\n        if (this.$inputs[index].checked && $item.hasAttribute('data-select-spravnaodpoved')) {\r\n          this.cache.answersCorrect += 1;\r\n        }\r\n      });\r\n    }\r\n\r\n    // Display feedback button (if no checkbox is select, the button is hidden)\r\n    if ((this.cache.checkedInput === 0 && !this.settings.vybrano) || (this.cache.checkedInput === this.$inputs.length && this.settings.vybrano) || this.settings.disableFeedback) {\r\n      this.hideFeedback();\r\n    } else {\r\n\r\n      if (this.cache.zpetnaVazba) {\r\n        const feedbackActual = this.feedback.find((feedback) => feedback.podminka.includes(this.cache.answersCorrect));\r\n        this.$buttonFeedback.classList.remove(...this.cache.colors);\r\n        this.$buttonFeedback.classList.add(feedbackActual.barva);\r\n        this.$buttonFeedbackText.innerText = feedbackActual.text;\r\n      }\r\n\r\n      this.showFeedback();\r\n    }\r\n\r\n    this.target.classList.toggle('has-checked', this.cache.checkedInput > 0);\r\n\r\n    this.cache.checkedInput = 0;\r\n  }\r\n\r\n  _dispatchEvent($input) {\r\n    // const items = Array.from(this.$inputs).map(($input) => ({\r\n    //   checked: $input.checked,\r\n    //   id: $input.id,\r\n    // }));\r\n    const $label = $input.parentNode.querySelector('label');\r\n    let task;\r\n\r\n    if ($input.type === 'radio') {\r\n      task = 'change';\r\n    }\r\n    else if ($input.type === 'checkbox') {\r\n      task = ($input.checked) ? 'select' : 'unselect';\r\n    }\r\n    else {\r\n      console.error('ERROR: Undefinated input type.');\r\n    }\r\n\r\n    __dispatchEvent(this.target, 'selection.change', {}, {\r\n      id: this.target.id,\r\n      task,\r\n      itemId: $input.id,\r\n      itemData: $input.getAttribute('data-selectable-data'),\r\n      $node: $label.firstChild,\r\n    });\r\n  }\r\n}\r\n","/* eslint-disable no-case-declarations */\r\nimport Component from './component';\r\n\r\nexport default class NewTable extends Component {\r\n  constructor($element) {\r\n    super($element);\r\n    // duplicate source of different editor elements\r\n    this.dataFrom = this.target.parentNode.getAttribute('data-from');\r\n    this.dataSources = this.dataFrom ? this.dataFrom.split(' ') : [];\r\n    this.id = $element.getAttribute('id');\r\n    this.cache = {\r\n      tasks: [],\r\n    };\r\n\r\n    this.init();\r\n  }\r\n\r\n  init() {\r\n    const autofill = this.target.parentNode.getAttribute('data-autofill');\r\n\r\n    switch (autofill) {\r\n      case 'columns':\r\n        this._columnManager();\r\n        break;\r\n      case 'rows':\r\n        this._rowManager();\r\n        break;\r\n      case 'cells':\r\n        const allCells = this.target.querySelectorAll('.table-new__cell');\r\n\r\n        allCells.forEach(($cell) => {\r\n          const columnId = $cell.getAttribute('data-column-id');\r\n          const rowId = $cell.getAttribute('data-row-id');\r\n          // add listener only for cells in table\r\n          if (columnId && rowId) {\r\n            this._cellManager($cell, columnId, rowId);\r\n          }\r\n        });\r\n        break;\r\n      default:\r\n        console.log('NewTableERROR: Undefinated autofill key word!', autofill);\r\n    }\r\n  }\r\n\r\n  _rowManager() {\r\n    document.addEventListener('editor.change', (e) => {\r\n      const data = e.detail.text;\r\n\r\n      if (this.dataSources.includes(data.id)) {\r\n        let $tableRow;\r\n        let rightToAdd = true;\r\n\r\n        // get columns header\r\n        const $header = this.target.previousSibling;\r\n        const $headerCells = $header.firstChild.childNodes;\r\n\r\n        switch (data.task) {\r\n          case 'add':\r\n            $tableRow = document.createElement('div');\r\n            $tableRow.setAttribute('class', 'table-new__row');\r\n\r\n            $headerCells.forEach(($item) => {\r\n              const $rowCell = document.createElement('div');\r\n              $rowCell.setAttribute('class', 'table-new__cell');\r\n              const itemType = JSON.parse($item.getAttribute('data-type'));\r\n\r\n              // check if tagName is definated and than set variable to false\r\n              if (itemType.tagName && itemType.tagName !== data.tagData.tagName) {\r\n                rightToAdd = false;\r\n              }\r\n              else {\r\n                // add data to cell\r\n                this.fillCell(itemType, data, $rowCell);\r\n              }\r\n\r\n              // only add if it is right to add\r\n              if (rightToAdd) $tableRow.appendChild($rowCell);\r\n            });\r\n\r\n            // only add if it is right to add\r\n            if (rightToAdd) this.target.appendChild($tableRow);\r\n            break;\r\n          case 'remove':\r\n            const tableRows = this.target.childNodes;\r\n\r\n            tableRows.forEach(($row) => {\r\n              $row.childNodes.forEach(($cell, index) => {\r\n                const itemType = JSON.parse($headerCells[index].getAttribute('data-type'));\r\n\r\n                if (NewTable.isRightToDeleteHelper($cell, data.value, itemType)) {\r\n                  $tableRow = $row;\r\n\r\n                }\r\n              });\r\n            });\r\n\r\n            // olny if row for remove exists\r\n            if ($tableRow) {\r\n              // remove tasks from cache\r\n              $tableRow.childNodes.forEach(($cell) => {\r\n                this._removeTaskFromCache($cell);\r\n              });\r\n\r\n              $tableRow.remove();\r\n            }\r\n            break;\r\n          default:\r\n            console.log('NewTableERROR: Undefinated task for new table! (rowManager)');\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  // TODO: adding just specific tags names like in rowManager\r\n  _columnManager() {\r\n    document.addEventListener('editor.change', (e) => {\r\n      const data = e.detail.text;\r\n\r\n      if (this.dataSources.includes(data.id)) {\r\n        const $rows = this.target.childNodes;\r\n\r\n        switch (data.task) {\r\n          case 'add':\r\n            $rows.forEach(($row) => {\r\n              const $cell = document.createElement('div');\r\n              $cell.setAttribute('class', 'table-new__cell');\r\n\r\n              const $firstCell = $row.firstChild;\r\n              const itemType = JSON.parse($firstCell.getAttribute('data-type'));\r\n\r\n              // add data to cell\r\n              this.fillCell(itemType, data, $cell);\r\n\r\n              $row.appendChild($cell);\r\n            });\r\n            break;\r\n          case 'remove':\r\n            let columnIndex;\r\n            $rows.forEach(($row) => {\r\n              const $firstCell = $row.firstChild;\r\n              const itemType = JSON.parse($firstCell.getAttribute('data-type'));\r\n\r\n              $row.childNodes.forEach(($cell, index) => {\r\n                if (NewTable.isRightToDeleteHelper($cell, data.value, itemType)) {\r\n                  columnIndex = index;\r\n                }\r\n              });\r\n            });\r\n\r\n            this.target.childNodes.forEach(($row) => {\r\n              // remove tasks from cache\r\n              this._removeTaskFromCache($row.childNodes[columnIndex]);\r\n\r\n              $row.childNodes[columnIndex].remove();\r\n            });\r\n            break;\r\n          default:\r\n            console.log('NewTableERROR: Undefinated task for new table! (columnManager)');\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  _cellManager($cell, columnId, rowId) {\r\n    const itemType = JSON.parse(this._findCellType($cell));\r\n    const cellController = (data) => {\r\n      switch (data.task) {\r\n        case 'add':\r\n          const $tag = document.createElement('div');\r\n          this.fillCell(itemType, data, $cell);\r\n\r\n          $cell.appendChild($tag);\r\n          break;\r\n        case 'remove':\r\n          const $tags = $cell.querySelectorAll('div');\r\n          let removed = false;\r\n          for (let i = 0; i < $tags.length; i += 1) {\r\n            if (!removed && NewTable.isRightToDeleteHelper($tags[i], data.value, itemType)) {\r\n              // TODO: remove only childrens of $elm => empty div is still there\r\n              $tags[i].remove();\r\n              removed = true;\r\n            }\r\n          }\r\n          break;\r\n        default:\r\n          console.log('NewTableERROR: Undefinated task for new table! (cellManager)');\r\n      }\r\n    };\r\n\r\n    document.addEventListener('editor.change', (e) => {\r\n      const data = e.detail.text;\r\n      console.log(data, this.dataSources.includes(data.id), data.tagData.tagName, rowId, data.tagData.tagName, columnId);\r\n      if (this.dataSources.includes(data.id) && (data.tagData.tagName === rowId || data.tagData.tagName === columnId)) {\r\n\r\n        if (!itemType.textId || itemType.textId === data.id) {\r\n          cellController(data);\r\n        }\r\n      }\r\n    });\r\n    document.addEventListener('draggable.drop', (e) => {\r\n      const data = e.detail;\r\n\r\n      if (this.dataSources.includes(data.id) && e.detail.columnId === columnId) {\r\n        // get text\r\n        const $span = data.$node.querySelector('span').cloneNode(true);\r\n        $span.classList.add('node-selected', 'node-text-gray');\r\n        $span.setAttribute('data-by', 'table-drop');\r\n\r\n        cellController({ task: data.task, value: $span });\r\n      }\r\n    });\r\n  }\r\n\r\n  fillCell(itemType, data, $node) {\r\n    let $innerItem;\r\n    let cacheObj;\r\n\r\n    // seed init or generate\r\n    let seed = 0;\r\n    if (this.cache.tasks.length > 0) {\r\n      const lastId = this.cache.tasks[this.cache.tasks.length - 1].id;\r\n      const idParts = lastId.split('-');\r\n      seed = +idParts[idParts.length - 1] + 1;\r\n    }\r\n\r\n    $node.classList.add(`table-new__cell--${itemType.name}`, `table-new__cell--${itemType.type}`);\r\n\r\n    switch (itemType.name) {\r\n      case 'dup-text':\r\n        $innerItem = document.createElement('div');\r\n        if (itemType.type === 'text') {\r\n          $innerItem.innerHTML = data.value.textContent;\r\n        }\r\n        else if (itemType.type === 'tag') {\r\n          // have to by clone, because if not it will by duplicatet do more tables it will be just in last one\r\n          $innerItem.appendChild(data.value.cloneNode(true));\r\n        }\r\n        break;\r\n      case 'select':\r\n        // create task in cache\r\n        cacheObj = { id: `${this.id}-select-${seed}`, answer: '', rightAnswer: data.tagData };\r\n        this.cache.tasks.push(cacheObj);\r\n\r\n        // create node in html\r\n        $innerItem = document.createElement(itemType.name);\r\n\r\n        $innerItem.setAttribute('id', cacheObj.id);\r\n        $innerItem.setAttribute('data-save', 'value');\r\n        $innerItem.setAttribute('tabindex', -1);\r\n\r\n        itemType.options.forEach((value) => {\r\n          const $option = document.createElement('option');\r\n          $option.innerHTML = value;\r\n          $innerItem.appendChild($option);\r\n        });\r\n\r\n        // add event listener\r\n        $innerItem.addEventListener('change', (event) => this._correctedAnswer(event, cacheObj));\r\n        break;\r\n      case 'input':\r\n      case 'textarea':\r\n        // create task in cache\r\n        cacheObj = { id: `${this.id}-input-${seed}`, answer: '', rightAnswer: data.tagData };\r\n        this.cache.tasks.push(cacheObj);\r\n\r\n        // create node in html\r\n        $innerItem = document.createElement(itemType.name);\r\n\r\n        $innerItem.setAttribute('id', cacheObj.id);\r\n        $innerItem.setAttribute('data-save', 'value');\r\n        $innerItem.setAttribute('tabindex', -1);\r\n\r\n        if (itemType.name === 'textarea') {\r\n          $innerItem.setAttribute('resize', cacheObj.id);\r\n        }\r\n\r\n        Object.keys(itemType.attributes).forEach((key) => {\r\n          $innerItem.setAttribute(key, itemType.attributes[key]);\r\n        });\r\n\r\n        // add event listener\r\n        $innerItem.addEventListener('change', (event) => this._correctedAnswer(event, cacheObj));\r\n        break;\r\n      case 'drop':\r\n        $innerItem = document.createElement('div');\r\n        const numberOfDrops = itemType.number ? itemType.number : -1;\r\n        // set attribute for draggable logic\r\n        $innerItem.setAttribute('data-drop-place', numberOfDrops);\r\n        break;\r\n      default:\r\n        $innerItem = document.createElement('div');\r\n        /*\r\n          if item Type name is value of data object from delivered cviceni feature\r\n          then use it and it's value set in table\r\n          else set empry value and show error\r\n       */\r\n        if (data.tagData[itemType.name]) {\r\n          $innerItem.innerHTML = data.tagData[itemType.name];\r\n        }\r\n        else {\r\n          $innerItem.innerHTML = ' ';\r\n          console.log('FillCellERROR: Undefinated object name.', itemType);\r\n        }\r\n    }\r\n    $node.appendChild($innerItem);\r\n  }\r\n\r\n  // prepare for more types of duplicate types\r\n  static isRightToDeleteHelper(elm, deliveredValue, itemType) {\r\n    let result;\r\n\r\n    if (itemType.name === 'dup-text') {\r\n      // fix for tags\r\n      // table div textContent include '×' as last char\r\n      // because it is in self span\r\n      let elemTextContent;\r\n      if (itemType.type === 'tag' && elm.textContent[elm.textContent.length - 1] === '×') {\r\n        elemTextContent = elm.textContent.slice(0, -1);\r\n      }\r\n      else {\r\n        elemTextContent = elm.textContent;\r\n      }\r\n      result = elemTextContent === deliveredValue.textContent;\r\n\r\n    } // different type then dup-text hasn't duplicate option\r\n    else {\r\n      result = false;\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  _findCellType($cell) {\r\n    const rowType = $cell.parentNode.firstChild.getAttribute('data-type');\r\n    if (rowType) return rowType;\r\n\r\n    // if rows header isn´t definated\r\n    const columnId = $cell.getAttribute('data-column-id');\r\n    const $columnHeader = this.target.parentNode.querySelector(`.table-new__cell--header[data-column-id=${columnId}]`);\r\n    if ($columnHeader) return $columnHeader.getAttribute('data-type');\r\n\r\n    return 'empty';\r\n  }\r\n\r\n  _correctedAnswer(event, cacheObj) {\r\n    this.cache.tasks.forEach((task) => {\r\n      if (task.id === cacheObj.id) {\r\n        task.answer = event.target.value;\r\n      }\r\n    });\r\n\r\n    // console.log('select change', this.cache);\r\n  }\r\n\r\n  _removeTaskFromCache($cell) {\r\n    this.cache.tasks.forEach((task, index) => {\r\n      if ($cell.firstChild.tagName === 'SELECT' || $cell.firstChild.tagName === 'INPUT' || $cell.firstChild.tagName === 'TEXTAREA') {\r\n        if ($cell.firstChild.id === task.id) {\r\n          this.cache.tasks.splice(index, 1);\r\n        }\r\n      }\r\n    });\r\n  }\r\n}\r\n","import Component from './component';\r\nimport { __dispatchEvent } from '../lib/utils';\r\n\r\n\r\nexport default class Draggable extends Component {\r\n  constructor($element) {\r\n    super($element);\r\n\r\n    this.idPrefix = 'drag-item';\r\n    // duplicate source of different editor elements\r\n    this.dataFrom = this.target.getAttribute('data-from');\r\n    this.dataSources = this.dataFrom ? this.dataFrom.split(' ') : [];\r\n\r\n    this.position = {\r\n      x: 0,\r\n      y: 0,\r\n      dx: 0,\r\n      dy: 0,\r\n    };\r\n    this.cache = {\r\n      // to know if draggable item was dropped or not and how many times\r\n      items: {},\r\n    };\r\n\r\n    this.$targetPrevious = null;\r\n    this.$targetCurrent = null;\r\n    this.$draggedItem = null;\r\n\r\n    this.objWidth = null;\r\n    this.objHeight = null;\r\n\r\n    this.init();\r\n  }\r\n\r\n  init() {\r\n    const $dragItems = this.target.querySelectorAll('.draggable__item');\r\n    $dragItems.forEach(($dragItem) => {\r\n      // get id\r\n      const id = $dragItem.getAttribute('data-id');\r\n      // inicial drop numbers\r\n      this.cache.items[id] = 0;\r\n      // use d3 container for $dragItem\r\n      this.dragAndDropEvents(d3.select($dragItem), id);\r\n    });\r\n\r\n    // initial handler for dropped item to svg\r\n    this.handleDeleteItemFromSvgDrop();\r\n\r\n    // initial handler for adding tags from text\r\n    this.handleAddTagsFromText();\r\n  }\r\n\r\n  // dropToken is used for handle usecase when user drag from drop-place to drop-place\r\n  dragAndDropEvents($dragItem, itemId, dropToken = true) {\r\n    // drag & drop\r\n    $dragItem.call(d3.drag()\r\n      .container(this.$slide)\r\n      .on('start', () => { this.onStart($dragItem); })\r\n      .on('drag', () => { this.onDrag($dragItem); })\r\n      .on('end', () => { this.onDrop($dragItem, itemId, dropToken); }));\r\n  }\r\n\r\n  onStart($dragItem) {\r\n\r\n    this.$slide.classList.add('is-dragging');\r\n\r\n    this.$targetPrevious = d3.event.sourceEvent.target;\r\n\r\n    // in this method is better to have classic html node\r\n    const $dragItemHTML = $dragItem.node();\r\n\r\n    // initial position\r\n    this.objWidth = $dragItemHTML.offsetWidth;\r\n    this.objHeight = $dragItemHTML.offsetHeight;\r\n    this.position.x = d3.event.sourceEvent.clientX - d3.event.sourceEvent.offsetX;\r\n    this.position.y = d3.event.sourceEvent.clientY - d3.event.sourceEvent.offsetY;\r\n    this.position.dx = 0;\r\n    this.position.dy = 0;\r\n\r\n    // get dragged node\r\n    // clone element if from DRAG place\r\n    if ($dragItemHTML.parentNode.hasAttribute('data-drag-place')) {\r\n      this.$draggedItem = $dragItemHTML.cloneNode(true);\r\n    }\r\n    // do not clone if from DROP place\r\n    else {\r\n      this.$draggedItem = $dragItemHTML;\r\n\r\n      // get table data\r\n      const $table = $dragItemHTML.closest('.table-new__body');\r\n      const $cell = $dragItemHTML.closest('.table-new__cell');\r\n      const columnId = $cell.getAttribute('data-column-id');\r\n\r\n      // dispatch event that item has been removed from drop place\r\n      __dispatchEvent(document, 'draggable.drop', {}, {\r\n        id: $table.id,\r\n        task: 'remove',\r\n        columnId,\r\n        // type: itemType,\r\n        $node: $dragItemHTML,\r\n      });\r\n    }\r\n\r\n    // add to body\r\n    document.body.appendChild(this.$draggedItem);\r\n    // convert back to d3 container\r\n    this.$draggedItem = d3.select(this.$draggedItem);\r\n\r\n    this.$draggedItem\r\n      .classed('is-dragged', true)\r\n      .classed('was-dropped', false)\r\n      .attr('style', `top:${this.position.y}px; left:${this.position.x}px;`);\r\n  }\r\n\r\n  onDrag($dragItem) {\r\n    // console.log($dragItem.node());\r\n    // update position\r\n    this.position.dx += d3.event.dx;\r\n    this.position.dy += d3.event.dy;\r\n\r\n    // move with dragging element\r\n    this.$draggedItem.style('transform', `translate3d(${this.position.dx}px, ${this.position.dy}px, 0) rotate(5deg)`);\r\n\r\n    this.$targetCurrent = d3.event.sourceEvent.target;\r\n    // check for make placeholder in drop place\r\n    if (this.$targetPrevious !== this.$targetCurrent) {\r\n\r\n      // remove placeholder in old target\r\n      const $placeholderOld = this.$targetPrevious.querySelector('.draggable__item--placeholder');\r\n      if ($placeholderOld) $placeholderOld.remove();\r\n\r\n      // create placeholder in new target\r\n      if (this.$targetCurrent.hasAttribute('data-drop-place')) {\r\n        const numberOfPossibleDrops = this.$targetCurrent.getAttribute('data-drop-place');\r\n        const numberOfDropsDone = this.$targetCurrent.childElementCount;\r\n\r\n        // console.log('ondrag', numberOfDropsDone);\r\n\r\n        if (numberOfPossibleDrops === '-1' || +numberOfPossibleDrops > numberOfDropsDone) {\r\n          // remove this class is important for creating placeholder from dragging item from drop place\r\n          const $placeholderNew = $dragItem.clone(true)\r\n            .classed('is-dragged', false)\r\n            .classed('draggable__item--placeholder', true)\r\n            .attr('style', 'outline: 0px;')\r\n            .node();\r\n\r\n          this.$targetCurrent.appendChild($placeholderNew);\r\n        }\r\n      }\r\n\r\n      // update target\r\n      this.$targetPrevious = this.$targetCurrent;\r\n    }\r\n  }\r\n\r\n  onDrop($dragItem, itemId, dropToken) {\r\n    this.$targetCurrent = d3.event.sourceEvent.target;\r\n\r\n    // when dropping within droppable normal DOM node\r\n    if (this.$targetCurrent.hasAttribute('data-drop-place')) {\r\n\r\n      // get placeholder\r\n      let $dropItem = this.$targetCurrent.querySelector('.draggable__item--placeholder');\r\n\r\n      if ($dropItem) {\r\n        const itemType = $dropItem.getAttribute('data-draggable-item');\r\n\r\n        // remove unneeded classes for dropItem\r\n        $dropItem.classList.remove('draggable__item--placeholder', 'was-dropped');\r\n        $dropItem.classList.add('dropped__item');\r\n\r\n        // update drops num\r\n        if (dropToken) {\r\n          $dragItem.classed('was-dropped', true);\r\n          this.cache.items[itemId] += 1;\r\n        }\r\n\r\n        if (itemType === 'svg') {\r\n          const $fullScreenIcon = $dropItem.querySelector('[data-fullscreen=\"toggle\"]');\r\n          // replaced svg don't have full screen icon\r\n          if ($fullScreenIcon) {\r\n            $fullScreenIcon.remove();\r\n          }\r\n        }\r\n        else {\r\n          // add cross for remove item\r\n          const $rightElmChild = $dropItem.firstElementChild;\r\n          const $cross = document.createElement('span');\r\n          $cross.classList.add('node-close');\r\n          $cross.innerText = '×';\r\n\r\n          // remove svg from frop item\r\n          $rightElmChild.removeChild($rightElmChild.lastElementChild);\r\n          $rightElmChild.appendChild($cross);\r\n\r\n          // remove item after click on cross\r\n          $cross.addEventListener('click', () => {\r\n            this.removeDraggableItem($dropItem, itemId, dropToken);\r\n          });\r\n        }\r\n\r\n        // add events to clone for posible dragging back\r\n        // dropItem has to by in d3 container\r\n        this.dragAndDropEvents(d3.select($dropItem), itemId, false);\r\n      } // only click on drop item\r\n      else {\r\n        $dropItem = $dragItem.clone(true)\r\n          .classed('is-dragged', false)\r\n          .attr('style', 'outline: 0px;')\r\n          .node();\r\n\r\n        this.$targetCurrent.appendChild($dropItem);\r\n\r\n        // add events to clone for posible dragging back\r\n        // dropItem has to by in d3 container\r\n        this.dragAndDropEvents(d3.select($dropItem), itemId, false);\r\n      }\r\n\r\n      // get table data\r\n      const $table = this.$targetCurrent.closest('.table-new__body');\r\n      const $cell = this.$targetCurrent.closest('.table-new__cell');\r\n      const columnId = $cell.getAttribute('data-column-id');\r\n\r\n      // dispatch event that item has been dropped\r\n      __dispatchEvent(document, 'draggable.drop', {}, {\r\n        id: $table.id,\r\n        task: 'add',\r\n        columnId,\r\n        // type: itemType,\r\n        $node: $dropItem,\r\n      });\r\n\r\n      // remove draggedItem from DOM\r\n      this.$draggedItem.remove();\r\n    }\r\n    // when dropping within SVG\r\n    else {\r\n      // get svg\r\n      const $svg = this.$targetCurrent.closest('svg');\r\n      // check drop attribute\r\n      const svgCanDrop = $svg ? $svg.hasAttribute('data-svg-drop') : false;\r\n\r\n      // when dropping within droppable svg node\r\n      if (svgCanDrop) {\r\n\r\n        // see __localPosition in ../lib/utils\r\n        // however d3.event.offsetX does not work here\r\n        const getLocalPositionBasedOnBrowser = () => {\r\n          const $slideActive = $svg.closest('.half-slide-active');\r\n\r\n          if (platform.name === 'Firefox' && $slideActive) {\r\n            // this works for Firefox even in transformed container\r\n            return [\r\n              d3.mouse($svg)[0] - ($slideActive.offsetWidth + this.objWidth),\r\n              d3.mouse($svg)[1],\r\n            ];\r\n          }\r\n\r\n          // this works for Chrome\r\n          return d3.mouse($svg);\r\n        };\r\n\r\n        const position = getLocalPositionBasedOnBrowser();\r\n        const $node = this.$draggedItem.classed('is-dragged', false)\r\n          .attr('style', 'outline: 0px;')\r\n          .node();\r\n\r\n        // update drops num\r\n        $dragItem.classed('was-dropped', true);\r\n        this.cache.items[itemId] += 1;\r\n\r\n        // add to svg\r\n        // dispatch event that svg has changed\r\n        __dispatchEvent(document, 'svg.drop', {}, {\r\n          svg: {\r\n            id: $svg.id,\r\n            $node,\r\n            type: $node.getAttribute('data-draggable-item'),\r\n            position,\r\n            size: {\r\n              width: this.objWidth,\r\n              height: this.objHeight,\r\n            },\r\n          },\r\n        });\r\n\r\n        this.$draggedItem.remove();\r\n\r\n      }\r\n      // when dropping outside of droppable area\r\n      else {\r\n        // if it's last drop then remove drop class\r\n        this.removeDraggableItem(this.$draggedItem, itemId, dropToken);\r\n      }\r\n\r\n    }\r\n\r\n    this.$slide.classList.remove('is-dragging');\r\n  }\r\n\r\n  handleDeleteItemFromSvgDrop() {\r\n\r\n    document.addEventListener('svg.drop.delete', (event) => {\r\n      const { id, $object } = event.detail.item;\r\n\r\n      // console.log('smazano', id, $object);\r\n      const $sameItemFromDragPlace = this.target.querySelector(`div[data-id=${id}]`);\r\n\r\n      if ($sameItemFromDragPlace) {\r\n        // if it's last drop then remove drop class\r\n        if (this.cache.items[id] === 1) {\r\n          $sameItemFromDragPlace.classList.remove('was-dropped');\r\n        }\r\n\r\n        // update drop number of concrete item\r\n        this.cache.items[id] -= 1;\r\n      }\r\n    });\r\n  }\r\n\r\n  handleAddTagsFromText() {\r\n    // need if we drop more than one same item\r\n    let idSalt = 1;\r\n\r\n    document.addEventListener('editor.change', (e) => {\r\n      const data = e.detail.text;\r\n      const concreteTagName = this.target.getAttribute('data-tagName');\r\n\r\n      // if concreteTagName\r\n      if (this.dataSources.includes(data.id) && (!concreteTagName || concreteTagName === data.tagData.tagName)) {\r\n        let $newDaggabletItem;\r\n        let $tagTextSpan;\r\n        let textToAdd;\r\n        let newId;\r\n        let idParts;\r\n\r\n        switch (data.task) {\r\n          case 'add':\r\n            // clone hidden tag\r\n            $newDaggabletItem = this.target.firstElementChild.cloneNode(true);\r\n            $newDaggabletItem.classList.remove('hidden');\r\n\r\n            // find place where to add tags text\r\n            $tagTextSpan = $newDaggabletItem.querySelector('.keywords-item');\r\n\r\n            // get right text to add\r\n            textToAdd = data.value.textContent;\r\n            if (textToAdd[textToAdd.length - 1] === '×') {\r\n              textToAdd = textToAdd.slice(0, -1);\r\n            }\r\n\r\n            // add text\r\n            $tagTextSpan.firstElementChild.innerHTML = textToAdd;\r\n\r\n            // add color to draggable item\r\n            $newDaggabletItem.firstElementChild.classList.add(`node-text-${data.tagColor}`);\r\n            $tagTextSpan.classList.add(`node-text-${data.tagColor}`);\r\n\r\n            // create new id\r\n            newId = $newDaggabletItem.getAttribute('data-id');\r\n            idParts = newId.split('-');\r\n            idParts.splice(-1, 1, `dup-${idSalt}`);\r\n            newId = idParts.join('-');\r\n\r\n            // set new id\r\n            $newDaggabletItem.setAttribute('data-id', newId);\r\n\r\n            // add to cache\r\n            this.cache.items[newId] = 0;\r\n\r\n            idSalt += 1;\r\n            this.target.appendChild($newDaggabletItem);\r\n\r\n            // add listeners for drag'n'drop\r\n            this.dragAndDropEvents(d3.select($newDaggabletItem), newId);\r\n            break;\r\n          case 'remove':\r\n            this.target.childNodes.forEach(($cell) => {\r\n              if (Draggable.isRightToDeleteHelper($cell, data.value, $cell.getAttribute('data-draggable-item'))) {\r\n                $cell.remove();\r\n              }\r\n            });\r\n            break;\r\n          default:\r\n            console.log('NewTableERROR: Undefinated task for new table! (cellManager)');\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  removeDraggableItem($draggedItem, itemId, dropToken) {\r\n    // if it's last drop then remove drop class\r\n    if (this.cache.items[itemId] === 1) {\r\n      const $sameItemFromDragPlace = this.target.querySelector(`div[data-id=${itemId}]`);\r\n      $sameItemFromDragPlace.classList.remove('was-dropped');\r\n    }\r\n\r\n    // update drop number of concrete item\r\n    if (!dropToken) {\r\n      this.cache.items[itemId] -= 1;\r\n    }\r\n\r\n    // remove draggedItem from DOM\r\n    $draggedItem.remove();\r\n  }\r\n\r\n  // prepare for more types of duplicate types\r\n  static isRightToDeleteHelper(elm, deliveredValue, itemType) {\r\n    // fix for tags\r\n    // table div textContent include '×' as last char\r\n    // because it is in self span\r\n    let elemTextContent;\r\n    if (itemType === 'tag' && elm.textContent[elm.textContent.length - 1] === '×') {\r\n      elemTextContent = elm.textContent.slice(0, -1);\r\n    }\r\n    else {\r\n      elemTextContent = elm.textContent;\r\n    }\r\n    return elemTextContent === deliveredValue.textContent;\r\n  }\r\n}\r\n","import Component from './component';\r\nimport AudioPlayer from './media/audio-player';\r\n\r\nexport default class Gallery extends Component {\r\n  constructor($element) {\r\n    super($element);\r\n\r\n    // select all right gallery items\r\n    const $selectableItemss = this.target.querySelectorAll('.selected-item');\r\n\r\n    // set events for all found items\r\n    $selectableItemss.forEach(($item) => Gallery.setEvents($item));\r\n  }\r\n\r\n  static setEvents($item) {\r\n    const selectedId = $item.id;\r\n    const $placeholder = $item.querySelector('.selected-item__placeholder');\r\n\r\n    document.addEventListener('selection.change', (e) => {\r\n      if (selectedId === e.detail.id) {\r\n        const data = e.detail;\r\n        const idTail = '-duplicated';\r\n\r\n        switch (data.task) {\r\n          // singlechoice\r\n          case 'change':\r\n            Gallery.removeItemFromSelect($item);\r\n            Gallery.addItemFromSelect($item, idTail, data);\r\n            break;\r\n\r\n          // multichoice\r\n          case 'select':\r\n            // hide placeholder\r\n            $placeholder.classList.add('is-hidden');\r\n\r\n            Gallery.addItemFromSelect($item, idTail, data);\r\n            break;\r\n\r\n          case 'unselect':\r\n            Gallery.removeItemFromSelect($item, data.itemId + idTail);\r\n\r\n            // show placeholder if its have to\r\n            if ($item.childElementCount === 1) {\r\n              $placeholder.classList.remove('is-hidden');\r\n            }\r\n            break;\r\n\r\n          default:\r\n            console.error('ERROR: Undefinated task type.');\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  static addItemFromSelect($item, idTail, data) {\r\n    const $dupNode = data.$node.cloneNode(true);\r\n    $dupNode.setAttribute('data-id', data.itemId + idTail);\r\n\r\n    // add listeners to audio\r\n    if ($dupNode.hasAttribute('data-player-audio')) {\r\n      AudioPlayer.addEventListeners($dupNode, () => {});\r\n    }\r\n\r\n    $item.appendChild($dupNode);\r\n  }\r\n\r\n  static removeItemFromSelect($item, dataId = undefined) {\r\n    if (dataId) {\r\n      const $dupNode = $item.querySelector(`[data-id=${dataId}]`);\r\n      $dupNode.remove();\r\n    }\r\n    else {\r\n      $item.firstChild.remove();\r\n    }\r\n  }\r\n}\r\n","/* eslint-disable no-unused-vars */\r\nimport MagnifyingGlass from './magnifying-glass';\r\nimport Sortable from './sortable';\r\nimport SVG from './svg';\r\nimport SVGRadialMenu from './svg-lib/svg-radial-menu';\r\nimport Editor from './editor/editor';\r\nimport Keywords from './keywords';\r\nimport TestQuiz from './test-quiz';\r\nimport FullscreenToggle from './fullscreen';\r\nimport UserText from './user-text';\r\nimport AudioPlayerNormal from './media/audio-player-normal';\r\nimport AudioPlayerSimple from './media/audio-player-simple';\r\nimport FakeMap from './fake-map';\r\nimport { stopPlayingVideoPlayers } from './media/media';\r\nimport VideoPlayer from './media/video';\r\nimport Selectable from './selectable';\r\nimport NewTable from './new-table';\r\nimport Draggable from './draggable';\r\nimport Gallery from './gallery';\r\n\r\nconst windowLoadComponents = () => {\r\n  console.log('windowLoad:components');\r\n\r\n  // Video player - normal\r\n  const $videoPlayers = document.querySelectorAll('[data-player-video]');\r\n  if ($videoPlayers.length > 0) {\r\n    $videoPlayers.forEach(($videoPlayer) => {\r\n      // console.log('$videoPlayer', $videoPlayer);\r\n      const videoPlayer = new VideoPlayer($videoPlayer);\r\n    });\r\n\r\n    document.addEventListener('slide.change', () => {\r\n      stopPlayingVideoPlayers($videoPlayers);\r\n    });\r\n  }\r\n\r\n  // Audio player - normal\r\n  const $audioPlayerNormals = document.querySelectorAll('[data-player-audio=\"normal\"]');\r\n  if ($audioPlayerNormals.length > 0) {\r\n    $audioPlayerNormals.forEach(($audioPlayerNormal) => {\r\n      const audioPlayerNormal = new AudioPlayerNormal($audioPlayerNormal);\r\n    });\r\n\r\n    // TODO > audio-player-normal.js#61\r\n    // document.addEventListener('slide.change', () => {\r\n    //   stopPlayingVideoPlayers($audioPlayerNormals);\r\n    // });\r\n  }\r\n\r\n  // Audio player — simple\r\n  const $audioPlayerSimples = document.querySelectorAll('[data-player-audio=\"simple\"]');\r\n  if ($audioPlayerSimples.length > 0) {\r\n    $audioPlayerSimples.forEach(($audioPlayerSimple) => {\r\n      const audioPlayerSimple = new AudioPlayerSimple($audioPlayerSimple);\r\n    });\r\n\r\n    document.addEventListener('slide.change', () => {\r\n      stopPlayingVideoPlayers($audioPlayerSimples);\r\n    });\r\n  }\r\n\r\n  // Fullscreen\r\n  const $fullscreenToggles = document.querySelectorAll('[data-fullscreen=\"toggle\"]');\r\n  if ($fullscreenToggles.length > 0) {\r\n    $fullscreenToggles.forEach(($fullscreenToggle) => {\r\n      const fullscreenToggle = new FullscreenToggle($fullscreenToggle);\r\n    });\r\n  }\r\n\r\n  // Magnifying glass\r\n  const $magnifyingGlass = document.querySelectorAll('[data-lupa-target]');\r\n  if ($magnifyingGlass.length > 0) {\r\n    for (let i = 0; i < $magnifyingGlass.length; i += 1) {\r\n      const magnifyingGlass = new MagnifyingGlass($magnifyingGlass[i]);\r\n    }\r\n  }\r\n\r\n  // Fake Map\r\n  const $fakeMaps = document.querySelectorAll('[data-fake-map=\"target\"]');\r\n  if ($fakeMaps.length > 0) {\r\n    for (let i = 0; i < $fakeMaps.length; i += 1) {\r\n      const fakeMap = new FakeMap($fakeMaps[i]);\r\n    }\r\n  }\r\n\r\n  //\r\n  // load these below in working mode only\r\n\r\n  // User texts\r\n  // - preview/working mode logic inside the component\r\n  //  - show\r\n  const $userTexts = document.querySelectorAll('[data-textarea-target=\"\"]');\r\n  if ($userTexts.length > 0) {\r\n    $userTexts.forEach(($userText) => {\r\n      const userText = new UserText($userText);\r\n    });\r\n  }\r\n\r\n  // SVG + Radial menu\r\n  // - preview/working mode logic in side the component\r\n  //  - to set max-width\r\n  const $svgs = document.querySelectorAll('[data-svg-target]');\r\n  if ($svgs.length > 0) {\r\n\r\n    if (HISTORYLAB.import.done !== true) {\r\n      // radial menu\r\n      const $radialMenu = document.querySelector('[data-radial-menu]');\r\n      if ($radialMenu) {\r\n        const radialMenu = new SVGRadialMenu($radialMenu, $svgs);\r\n      }\r\n    }\r\n\r\n    // svgs\r\n    // setSize is needed\r\n    $svgs.forEach(($svg) => {\r\n      const svg = new SVG($svg);\r\n    });\r\n  }\r\n\r\n  if (HISTORYLAB.import.done !== true) {\r\n\r\n    // Editor\r\n    const $editors = document.querySelectorAll('[data-editor]');\r\n    if ($editors.length > 0) {\r\n      $editors.forEach(($editor) => {\r\n        const editor = new Editor($editor);\r\n      });\r\n    }\r\n\r\n    // Test Quizes\r\n    const $testQuizs = document.querySelectorAll('[data-target-test-quiz]');\r\n    if ($testQuizs.length > 0) {\r\n      $testQuizs.forEach(($testQuiz) => {\r\n        const settings = document.querySelector(\r\n          `[data-test-quiz-id-reference=\"${$testQuiz.getAttribute(\r\n            'data-test-quiz-id',\r\n          )}\"]`,\r\n        );\r\n\r\n        const testQuiz = new TestQuiz(\r\n          $testQuiz.getAttribute('data-test-quiz-id'),\r\n          $testQuiz,\r\n          JSON.parse(settings.getAttribute('data-module-settings')),\r\n        );\r\n        testQuiz.init();\r\n      });\r\n    }\r\n\r\n    // New table\r\n    const $newTables = document.querySelectorAll('[data-new-table]');\r\n    if ($newTables.length > 0) {\r\n      $newTables.forEach(($newTable) => {\r\n        const newTable = new NewTable($newTable);\r\n      });\r\n    }\r\n\r\n    // Pretahovani\r\n    const $draggables = document.querySelectorAll('[data-draggable]');\r\n    if ($draggables.length > 0) {\r\n      $draggables.forEach(($draggable) => {\r\n        const draggable = new Draggable($draggable);\r\n      });\r\n    }\r\n\r\n    // Sortable\r\n    const $sortables = document.querySelectorAll('[data-sortable-target]');\r\n    if ($sortables.length > 0) {\r\n      $sortables.forEach(($sortable) => {\r\n        const sortable = new Sortable($sortable);\r\n      });\r\n    }\r\n\r\n    // Selectable\r\n    const $selectables = document.querySelectorAll('[data-selectable-target]');\r\n    if ($selectables.length > 0) {\r\n      $selectables.forEach(($selectable) => {\r\n        const selectable = new Selectable($selectable);\r\n      });\r\n    }\r\n\r\n    // Keywords selection\r\n    const $keywords = document.querySelectorAll('[data-keywords]');\r\n    if ($keywords.length > 0) {\r\n      $keywords.forEach(($keyword) => {\r\n        const settings = $keyword.hasAttribute('data-module-settings')\r\n          ? $keyword.getAttribute('data-module-settings')\r\n          : {};\r\n        const keywords = new Keywords($keyword, JSON.parse(settings));\r\n        keywords.init();\r\n      });\r\n    }\r\n\r\n    // Gallery listener\r\n    const $galleries = document.querySelectorAll('[data-gallery]');\r\n    if ($galleries.length > 0) {\r\n      $galleries.forEach(($gallery) => {\r\n        const gallery = new Gallery($gallery);\r\n      });\r\n    }\r\n  }\r\n};\r\n\r\nexport default windowLoadComponents;\r\n","/* eslint-disable consistent-return */\r\nimport domLoadComponents from './dom-load';\r\nimport windowLoadComponents from './window-load';\r\nimport unsupportedBrowsers from '../lib/unsupported-browsers';\r\n\r\n(() => {\r\n  if (unsupportedBrowsers()) return false;\r\n\r\n  // The DOMContentLoaded event fires when parsing of the current page is complete. DOMContentLoaded is a great event to use to hookup UI functionality to complex web pages.\r\n  document.addEventListener('DOMContentLoaded', domLoadComponents, false);\r\n\r\n  // The load event fires when all files have finished loading from all resources, including ads and images.\r\n  window.addEventListener('load', windowLoadComponents, false);\r\n})();\r\n","const unsupportedBrowsers = () => {\r\n\r\n  // feature detection for unsupported browsers\r\n  const isUnsupported = !Array.from\r\n    || !Element.prototype.matches\r\n    || !Element.prototype.closest\r\n    || typeof window.CustomEvent !== 'function'\r\n    || typeof Object.assign !== 'function';\r\n\r\n  if (isUnsupported) {\r\n    console.warn('Not supported browser.');\r\n\r\n    const $unsupported = document.querySelector('#unsupported');\r\n    $unsupported.querySelector('#unsupported-browser').innerHTML = ` ${platform.name} ${platform.version} `;\r\n    $unsupported.classList.remove('is-hidden');\r\n\r\n    return true;\r\n  }\r\n\r\n  return false;\r\n};\r\n\r\nexport default unsupportedBrowsers;\r\n"],"names":["domLoadComponents","console","log","Component","$element","target","$slide","this","closest","lang","document","documentElement","getAttribute","HISTORYLAB","done","$buttonFeedback","querySelector","$buttonFeedbackText","showFeedback","bind","classList","contains","remove","add","MagnifyingGlass","$canvas","ctx","_this","getContext","_onStart","_onMove","_onEnd","_update","_onResize","zoomGlassSize","targetBCR","zoomed","targetZoomed","x","y","trackingTouch","_addEventListeners","_initCanvas","window","requestAnimationFrame","width","height","dPR","devicePixelRation","style","scale","getBoundingClientRect","event","preventDefault","pageX","touches","pageY","TAU","Math","PI","radius","ratioX","max","min","left","ratioY","top","scaledTargetWidth","scaledTargetHeight","platform","os","family","indexOf","name","shadowColor","shadowBlur","shadowOffsetY","clearRect","fillStyle","beginPath","arc","closePath","fill","save","clip","drawImage","restore","_setTransformStyle","addEventListener","betterX","betterY","halfYoomGlassSize","abs","innerWidth","transform","__createNewCustomEvent","options","data","defaults","bubbles","properties","Object","assign","CustomEvent","detail","__dispatchEvent","type","payload","dispatchEvent","__isObject","item","_typeof","Array","isArray","__mergeDeep","source","output","keys","forEach","key","__insertBefore","newNode","referenceNode","parentNode","insertBefore","__insertAfter","nextSibling","__remove","el","removeChild","__localPosition","container","position","d3","offsetX","offsetY","mouse","format","__positionTranslated","curTransform","WebKitCSSMatrix","getComputedStyle","webkitTransform","body","pageYOffset","scrollTop","pageXOffset","scrollLeft","offsetLeft","m41","offsetTop","m42","__position","elAttibutes","__toggleClass","element","cls","__hasClass","__removeClass","__addClass","className","elements","classes","_elements","_classes","querySelectorAll","tagName","split","i","length","j","replace","RegExp","mediaEvents","playchange","timechange","canplaystart","stopPlayingVideoPlayers","$players","$player","$media","paused","pause","setAttribute","getSecondsMinutesFormat","seconds","duration","floor","minutes","toString","slice","AudioPlayer","$item","$audio","$playButton","$timeLeft","play","stopPropagation","innerText","currentTime","SVGDragNDrop","select","raise","classed","diff","$node","getJustifiedCord","xZarov","yZarov","attr","toFixed","orientation","elementResolution","offsetHeight","offsetWidth","svgResolution","map","e","parseInt","textJustified","pretahovaniJustified","circleJustified","textCenter","getOffsetOfText","attributes","value","SVGDraw","$svg","color","callback","sourceEvent","nodeName","line","curve","curveLinear","d","subject","x0","y0","id","active","append","datum","on","x1","y1","dx","dy","push","$thisPath","svg","task","node","contextMenu","pathEventsManager","svgGroup","localPosition","firstChild","circleEventsManager","elementPosition","selection","selectAll","nodes","idParts","$object","call","drag","start","dragged","oldXCoordinate","oldYCoordinate","taskType","end","SVG","removeCloneConnectionManager","SVGText","maxLength","minLength","svgID","$radialMenu","hash","foreignObject","textarea","focus","textEventsManager","isCreated","firstWrite","oldText","parentElement","childNodes","updateTextareaHeight","$target","wrongBool","isWrong","removeItem","scrollHeight","isBubble","_setSize","init","_initWhenDone","toDuplicate","svgSpecificActions","colors","svgSpecificColor","_initPath","_initCircle","_initComicBubbles","_getEvents","_getDropEvent","viewbox","rect","maxWidthAbsolute","maxHeightAbsolute","innerHeight","getHeight","maxWidth","setMaxWidth","_this2","p","renderPath","createCircle","_this3","$comicBubbles","$comicBubble","comicBubblesEventsManager","_this4","oldID","join","svgDuplicateSources","includes","$templateNode","localNodeID","_this5","_generateNewID","$localNode","_clonePath","_cloneComicBubbles","_cloneTextField","_cloneCircle","idSalt","_this6","size","multiply","$d3canvas","$d3foreignObject","$dropItem","createElement","appendChild","firstElementChild","$foreignObject","cloneNode","selected","isRadial","$parent","allActiveSvgs","deactivate","pop","Sortable","$settings","feedback","JSON","parse","$container","$items","$droppables","$placeholder","$inheritors","inheritors","order","direction","before","after","evaluation","undefined","clientX","clientY","clone","posRel","siblings","prev","next","_setupInitialOrder","_setupInheritors","cache","barva","hasAttribute","_addPlaceholder","_onOver","right","_onDrop","bottom","_removePlaceholder","_updateOrder","_updateOrderInInheritors","_dispatchEvent","_checkAndResolveFeedback","_getReference","_addEventListenerToItem","addEventListeners","minHeight","src","img","nextElementSibling","previousElementSibling","array","some","index","checkIfTheArrayIsGood","changedArray","splice","arrayOfItems","_toConsumableArray","dataset","sortableSpravnaodpoved","feedbackResult","oneMove","feedbackActual","find","podminka","text","splneno","from","$inheritor","sortableIndex","inheritor","SVGRadialMenu","$svgs","$radialMenuItems","$colorItems","$textItems","$createTextItem","$removeItem","$tooltip","initialSetUp","menuRadius","getPropertyValue","itemRadius","setUpRadialMenuItems","addEventListenersToRadialMenu","hasText","hasMoreColors","activate","deselectItem","filterMenuButtons","showRadialMenu","addEventListenersToRadialMenuItem","_itemsLength","_menuRadius","_itemRadius","_menuOffset","_interval","_centerOffset","angle","sin","cos","onMouseLeave","hideRadialMenu","action","createText","changeColor","innerHTML","currentTarget","display","$activeSVG","globalPosition","__globalPosition","$activeRadialMenuItem","positionRadialMenuItems","setTimeout","mouseLeaveDelay","clearTimeout","clickedItem","$colorItem","$textItem","selectItem","Editor","$editor","settings","opts","models","passive","interactive","withMenu","totalTagId","hasMenu","lastSelectionSettings","isCollapsed","savedSelectionRange","selectionAttributes","dummyRangeElement","selectionMouseDown","selectionDirection","hasEditableContentChanged","lastPressedKey","hasToolbar","toolbar","originalContent","currentContent","_handlers","wrapLastDeletesTimeoutClass","wrapLastDeletesTimeoutFunction","wrapLastAdditionsTimeoutClass","wrapLastAdditionsTimeoutFunction","isWrappingLastText","isWriting","$groupDeleted","_hasMenu","$menu","menuClass","$menuActions","$menuClose","error","_hasToolbar","canvasClass","funkce","html","_generateNewTagGroupClass","$btnReset","registerEditableHandlers","initPreHighlightedTextOptions","handlerFocus","matchMedia","matches","navigator","maxTouchPoints","msMaxTouchPoints","keycode","getSelection","keyCode","which","keyName","rangeCount","range","getRangeAt","cloneRange","setStart","startContainer","startOffset","collapse","setEnd","endContainer","endOffset","addedFragmentString","cloneContents","textContent","trim","dummyElementInner","surroundContents","removeAllRanges","addRange","dummyElement","contentEditable","newGeneratedId","_generateNewTagId","$elements","$btnClose","closeBtnClass","$nodeElement","_removeNodeKeepTextContent","getElementById","wrapLastDeletesTimeout","textToAddElement","insertNode","setStartAfter","groupDeletedId","$groupInnerDeleted","$groupInnerAdded","$groupAdded","registerMenuHandler","confirm","len","handlerMenuActions","handlerMenuClose","$textOptionsElements","$textOption","textOptions","selectedClass","idForSend","tagData","clickClose","_setmenuDimensions","leftDimensions","topDimensions","menuDimensions","translated","clonedElement","visibility","elDimensions","elPosition","__getRealDimensions","parentTranslatedPosition","parentDimensions","isOverflowAt","menuMargin","toggleMenu","$el","command","commandName","setSelection","anchorOffset","focusOffset","_setSelectionPosition","selectionPosition","selectionDimension","$domEl","newTagId","extractContents","classesArray","tagColor","createTextNode","$parentEl","$elClose","toggleClass","clickHandler","$closeBtn","removeEventListener","commentRef","nodePosition","commentMargin","commentTemplate","div","commentDiv","nodeRef","commentNewTextarea","commentDivButtonSubmit","commentCommentsContainer","calculatedCommentPosition","_calculateCommentPosition","commentItem","_createCommentForNode","_highlightContents","closeBtn","_createCloseBtnForElement","comments","_addCommentHandlerForElement","commentsClass","_storeHighlightedContents","showCommentsOnInit","click","resetBtnClass","nodeSelectedClass","enable","animatedClass","deselectedClass","menu","Keywords","$controls","$itemsContainer","itemsContainerClassName","inherit","isInherited","itemClassName","_getHTMLFromItems","onInit","_regenerateItemsContainerFromInherited","_registerHandlers","_changeSizeOfKeywordItem","skala","maxLevel","setNewLevelValue","$keyword","number","oldValue","newValue","$control","tempContent","temp","renameItemsIds","_clickEventHandler","_dispatchEventHandler","keywords","currentId","nodeId","_getItemFromDOMElement","_getItemsHTML","_getItemsFromHTML","itemsClassName","itemsArray","_getDOMElementFromItem","newDiv","outerHTML","wrapper","__getHTML","items","contentHTML","oldId","newId","itemsHTML","expString","TestQuiz","$questions","itemClass","answersCorrect","questions","zpetnaVazba","$question","questionIndex","answered","answerCorrect","$answers","optionClass","$answer","answerIndex","$answerCurrent","$answersItem","question","FullscreenToggle","imageAlternative","$fullscreenContainer","$fullscreenTarget","removeAttribute","toLowerCase","currentSrc","Promise","resolve","reject","Image","onload","onerror","then","image","naturalWidth","naturalHeight","ratio","setSize","$svgTexts","$svgText","readOnly","$fullscreen","toggle","UserText","$counter","$counterWrapper","$instruction","$userTexts","lengthExpected","avg","lastValue","hadData","wasUsed","updateCharacterCounter","textDuplicateSources","getEvents","none","ok","conditionAll","$userText","taskName","valueLength","updateFeedback","fromId","itemData","AudioPlayerNormal","$loadWave","$leftTime","$audioDuration","wavesurfer","WaveSurfer","create","waveColor","progressColor","responsive","barWidth","load","initWave","getDuration","addListenerAfterReady","time","playPause","$nextSlide","AudioPlayerSimple","$duration","FakeMap","$buttons","$maps","lastActiveIndex","addEventListenerToButtons","$button","switchMap","VideoPlayer","prefix","interval","$document","ownerDocument","$play","$playSymbol","$pauseSymbol","$time","$timeMeter","$timeRange","$currentTimeText","$currentTime","durationTime","$durationTime","timeToAural","$enterFullscreenSymbol","$leaveFullscreenSymbol","_fullscreenchange","_requestFullscreen","requestFullscreen","webkitRequestFullscreen","msRequestFullscreen","onCanPlayStart","onLoadStart","onLoadedData","onPlayChange","onTimeChange","onPlayClick","onTimeKeydown","onTimeClick","onFullscreenClick","onFullscreenChange","onDrag","percentage","clearInterval","setInterval","currentTimePercentage","currentTimeCode","nodeValue","nCanPlayStart","autoplay","isFullscreen","_fullscreenElement","leaveFullscreen","enterFullscreen","pointerType","_exitFullscreen","webkitSupportsFullscreen","webkitDisplayingFullscreen","webkitExitFullscreen","webkitEnterFullscreen","shiftKey","offset","fullscreenElement","webkitFullscreenElement","msFullscreenElement","exitFullscreen","webkitCancelFullScreen","msExitFullscreen","innerTarget","listener","hasPointerEvent","onpointerup","hasTouchEvent","ontouchstart","pointerDown","pointerMove","pointerUp","axisProp","onpointermove","defaultView","langMinutes","langSeconds","Selectable","checkedInput","$inputs","$input","_changeClassIfChecked","$input_","checked","viceOdpovedi","vybrano","disableFeedback","hideFeedback","$label","itemId","NewTable","dataFrom","dataSources","tasks","autofill","_columnManager","_rowManager","$cell","columnId","rowId","_cellManager","$tableRow","rightToAdd","$headerCells","previousSibling","$rowCell","itemType","fillCell","$row","isRightToDeleteHelper","_removeTaskFromCache","$rows","$firstCell","columnIndex","_findCellType","cellController","$tag","$tags","removed","textId","$span","$innerItem","cacheObj","seed","answer","rightAnswer","$option","_correctedAnswer","numberOfDrops","rowType","$columnHeader","_this7","elm","deliveredValue","result","Draggable","idPrefix","$targetPrevious","$targetCurrent","$draggedItem","objWidth","objHeight","$dragItem","dragAndDropEvents","handleDeleteItemFromSvgDrop","handleAddTagsFromText","dropToken","onStart","onDrop","$dragItemHTML","$table","$placeholderOld","numberOfPossibleDrops","numberOfDropsDone","childElementCount","$placeholderNew","$slideActive","$fullScreenIcon","$rightElmChild","$cross","lastElementChild","removeDraggableItem","$sameItemFromDragPlace","$newDaggabletItem","$tagTextSpan","textToAdd","concreteTagName","Gallery","setEvents","selectedId","idTail","removeItemFromSelect","addItemFromSelect","$dupNode","dataId","windowLoadComponents","$videoPlayers","$videoPlayer","$audioPlayerNormals","$audioPlayerNormal","$audioPlayerSimples","$audioPlayerSimple","$fullscreenToggles","$fullscreenToggle","$magnifyingGlass","$fakeMaps","$editors","$testQuizs","$testQuiz","$newTables","$newTable","$draggables","$draggable","$sortables","$sortable","$selectables","$selectable","$keywords","$galleries","$gallery","Element","prototype","warn","$unsupported","version","unsupportedBrowsers"],"mappings":"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"}