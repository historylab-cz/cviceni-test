{"version":3,"file":"components.build.js","sources":["../../../../src/js/components/component.js","../../../../src/js/components/magnifying-glass.js","../../../../src/js/lib/utils.js","../../../../src/js/components/media/media.js","../../../../src/js/components/media/audio-player.js","../../../../src/js/components/sortable.js","../../../../src/js/components/svg-lib/svg-dragndrop.js","../../../../src/js/components/svg-lib/svg-draw.js","../../../../src/js/components/svg-lib/svg-text.js","../../../../src/js/components/svg.js","../../../../src/js/components/svg-lib/svg-radial-menu.js","../../../../src/js/store/observer.js","../../../../src/js/store/store-constants.js","../../../../src/js/store/store.js","../../../../src/js/store/store-global.js","../../../../src/js/components/editor/editor.js","../../../../src/js/components/analytical-table.js","../../../../src/js/store/store-keywords.js","../../../../src/js/components/keywords.js","../../../../src/js/components/editor-tags-placeholder.js","../../../../src/js/components/test-quiz.js","../../../../src/js/components/generic-table.js","../../../../src/js/components/fullscreen.js","../../../../src/js/components/user-text.js","../../../../src/js/components/media/audio-player-normal.js","../../../../src/js/components/media/audio-player-simple.js","../../../../src/js/components/fake-map.js","../../../../src/js/components/media/video.js","../../../../src/js/components/selectable.js","../../../../src/js/components/new-table.js","../../../../src/js/components/components.js","../../../../src/js/components/dom-load.js","../../../../src/js/components/window-load.js"],"sourcesContent":["export default class Component {\r\n  constructor($element) {\r\n    this.target = $element;\r\n    this.$slide = this.target.closest('.slide');\r\n    this.lang = document.documentElement.getAttribute('lang');\r\n\r\n    if (this.$slide) {\r\n      this.$buttonFeedback = this.$slide.querySelector('[data-feedback-button]');\r\n      this.$buttonFeedbackText = this.$buttonFeedback.querySelector('span');\r\n    }\r\n\r\n    this.showFeedback = this.showFeedback.bind(this);\r\n  }\r\n\r\n  showFeedback() {\r\n    if (this.$buttonFeedback && this.$buttonFeedback.classList.contains('button-hidden')) {\r\n      this.$buttonFeedback.classList.remove('button-hidden');\r\n    }\r\n  }\r\n\r\n  hideFeedback() {\r\n    this.$buttonFeedback.classList.add('button-hidden');\r\n  }\r\n}\r\n","import Component from './component';\r\n\r\nexport default class MagnifyingGlass extends Component {\r\n  // https://www.youtube.com/watch?v=e8IwM3iqnL0\r\n  constructor($element) {\r\n    super($element);\r\n    // SVG lupa a ještě dynamicky měnícího se SVG,\r\n    // který není na počátku známé?\r\n    // if (el.nodeName === 'svg') {\r\n    //   console.log('SVG');\r\n    //   el.children[0].getAttribute('xlink:href')\r\n    // }\r\n    this.$element = document.querySelector('[data-lupa]');\r\n    this.$canvas = document.querySelector('[data-lupa-canvas]');\r\n    this.ctx = this.$canvas.getContext('2d');\r\n\r\n    this._onStart = this._onStart.bind(this);\r\n    this._onMove = this._onMove.bind(this);\r\n    this._onEnd = this._onEnd.bind(this);\r\n    this._update = this._update.bind(this);\r\n    this._onResize = this._onResize.bind(this);\r\n\r\n    this.zoomGlassSize = 230;\r\n    this.targetBCR = null;\r\n    this.zoomed = 0;\r\n    this.targetZoomed = 0;\r\n\r\n    this.x = 0;\r\n    this.y = 0;\r\n    this.trackingTouch = false;\r\n\r\n    this._addEventListeners();\r\n    this._initCanvas();\r\n    this._onResize();\r\n\r\n    window.requestAnimationFrame(this._update);\r\n  }\r\n\r\n  _initCanvas() {\r\n    const width = this.zoomGlassSize;\r\n    const height = this.zoomGlassSize;\r\n    // if retina makes canvas more dense\r\n    const dPR = window.devicePixelRation || 1;\r\n    this.$canvas.width = width * dPR;\r\n    this.$canvas.height = height * dPR;\r\n\r\n    this.$canvas.style.width = `${width}px`;\r\n    this.$canvas.style.height = `${height}px`;\r\n\r\n    this.ctx.scale(dPR, dPR);\r\n  }\r\n\r\n  _onResize() {\r\n    this.targetBCR = this.target.getBoundingClientRect();\r\n  }\r\n\r\n  _onStart(event) {\r\n    if (event.target !== this.target) {\r\n      return;\r\n    }\r\n\r\n    event.preventDefault();\r\n\r\n\r\n    this.x = event.pageX || event.touches[0].pageX;\r\n    this.y = event.pageY || event.touches[0].pageY;\r\n\r\n    this.trackingTouch = true;\r\n    this.targetZoomed = 1;\r\n    this.zoomed = 0;\r\n\r\n    window.requestAnimationFrame(this._update);\r\n  }\r\n\r\n  _onMove(event) {\r\n    if (!this.trackingTouch) {\r\n      return;\r\n    }\r\n\r\n    this.x = event.pageX || event.touches[0].pageX;\r\n    this.y = event.pageY || event.touches[0].pageY;\r\n  }\r\n\r\n  _onEnd() {\r\n    if (this.targetZoomed) {\r\n      // show OK button or feedback\r\n      this.showFeedback();\r\n    }\r\n\r\n    this.targetZoomed = 0;\r\n    this.trackingTouch = false;\r\n  }\r\n\r\n  _update() {\r\n    const TAU = Math.PI * 2;\r\n    const MAX_RADIUS = 100;\r\n    const radius = this.zoomed * MAX_RADIUS;\r\n\r\n    this.targetBCR = this.target.getBoundingClientRect();\r\n\r\n    // local coordinates (ratio <0,1>)\r\n    const ratioX =\r\n      // min. 0\r\n      Math.max(0,\r\n        // max. 1\r\n        Math.min(1, ((this.x - this.targetBCR.left) / this.targetBCR.width))\r\n      );\r\n    // console.log(ratioX);\r\n    const ratioY =\r\n      // min. 0\r\n      Math.max(0,\r\n        // max. 1\r\n        Math.min(1, ((this.y - this.targetBCR.top) / this.targetBCR.height))\r\n      );\r\n    // console.log(ratioY);\r\n\r\n    // actual zooming (scaling)\r\n    const imageScale = 2.5;\r\n    const scaledTargetWidth = this.targetBCR.width * imageScale;\r\n    const scaledTargetHeight = this.targetBCR.height * imageScale;\r\n\r\n    // Firefox on Windows has a bug because of the shadow\r\n    if (!(platform.os.family.indexOf('Windows') > -1 && platform.name.indexOf('Firefox') > -1)) {\r\n      // Shadow.\r\n      this.ctx.shadowColor = 'rgba(0,0,0,0.4)';\r\n      this.ctx.shadowBlur = 12;\r\n      this.ctx.shadowOffsetY = 8;\r\n    }\r\n\r\n    // Background.\r\n    this.ctx.clearRect(0, 0, this.zoomGlassSize, this.zoomGlassSize);\r\n    this.ctx.fillStyle = '#fff';\r\n    this.ctx.beginPath();\r\n    this.ctx.arc(\r\n      // x\r\n      this.zoomGlassSize / 2,\r\n      // y\r\n      (this.zoomGlassSize - 10) - radius,\r\n      // radius, startAngle, endAngle\r\n      radius, 0, TAU);\r\n    this.ctx.closePath();\r\n    this.ctx.fill();\r\n\r\n    // save the default state (without image)\r\n    this.ctx.save();\r\n\r\n    // Zoomed image.\r\n    this.ctx.beginPath();\r\n    this.ctx.arc(\r\n      // x\r\n      this.zoomGlassSize / 2,\r\n      // y\r\n      (this.zoomGlassSize - 10) - (radius + 1),\r\n      // radius, startAngle, endAngle\r\n      radius * 1.03, 0, TAU);\r\n    this.ctx.clip();\r\n    this.ctx.closePath();\r\n    this.ctx.drawImage(this.target,\r\n      // dx and dy (left and top)\r\n      (-ratioX * scaledTargetWidth) + (this.zoomGlassSize / 2),\r\n      (-ratioY * scaledTargetHeight) + (this.zoomGlassSize / 2),\r\n      // scaled width and height\r\n      scaledTargetWidth, scaledTargetHeight);\r\n\r\n    // go back to default state (without image)\r\n    // so next update starts fresh\r\n    this.ctx.restore();\r\n\r\n    // Position the parent $element.\r\n    this.$element.style.transform = `translate(${this.x}px, ${this.y}px)`;\r\n\r\n    // Update the zoom value.\r\n    this.zoomed += (this.targetZoomed - this.zoomed) / 4;\r\n\r\n    // Schedule another update if the zoom is fairly non-zero.\r\n    if (this.zoomed > 0.001) {\r\n      // if (this.zoomed > 0.001 && this.zoomed < 0.998) {\r\n      window.requestAnimationFrame(this._update);\r\n      // } else if (this.zoomed >= 0.998) {\r\n      //   this.zoomed = 1;\r\n    } else {\r\n      this.zoomed = 0;\r\n    }\r\n  }\r\n\r\n  _addEventListeners() {\r\n    // touch events\r\n    document.addEventListener('touchstart', this._onStart);\r\n    document.addEventListener('touchmove', this._onMove);\r\n    document.addEventListener('touchend', this._onEnd);\r\n    // mouse events\r\n    document.addEventListener('mousedown', this._onStart);\r\n    document.addEventListener('mousemove', this._onMove);\r\n    document.addEventListener('mouseup', this._onEnd);\r\n    // window events\r\n    window.addEventListener('resize', this._onResize);\r\n  }\r\n}\r\n","// https://stackoverflow.com/questions/901115/how-can-i-get-query-string-values-in-javascript#3855394\r\nexport function __getQueryStringParams() {\r\n  const parameters = window.location.search.substr(1).split('&');\r\n\r\n  if (parameters === '') {\r\n    return {};\r\n  }\r\n\r\n  const b = {};\r\n\r\n  for (let i = 0; i < parameters.length; i += 1) {\r\n    const p = parameters[i].split('=', 2);\r\n\r\n    if (p.length === 1) {\r\n      b[p[0]] = '';\r\n    } else {\r\n      b[p[0]] = decodeURIComponent(p[1].replace(/\\+/g, ' '));\r\n    }\r\n  }\r\n\r\n  return b;\r\n}\r\n\r\nexport function __createNewCustomEvent(name, options = {}, data = null) {\r\n  const defaults = {\r\n    // https://developer.mozilla.org/en-US/docs/Web/Guide/Events/Creating_and_triggering_events#Event_bubbling\r\n    bubbles: true,\r\n    // cancelBubble\r\n    // stopPropagation()\r\n    // cancelable\r\n    // composed\r\n    // currentTarget\r\n    // defaultPrevented\r\n    // preventDefault()\r\n    // eventPhase\r\n    // returnValue\r\n    // preventDefault()\r\n    // defaultPrevented\r\n    // target\r\n    // timeStamp\r\n    // type\r\n    // isTrusted\r\n  };\r\n\r\n  const properties = Object.assign(defaults, options);\r\n\r\n  return new CustomEvent(name, {\r\n    detail: data,\r\n    ...properties,\r\n  });\r\n}\r\n\r\nexport function __dispatchEvent($element, type, options, payload) {\r\n  const event = __createNewCustomEvent(type, options, payload);\r\n\r\n  $element.dispatchEvent(event);\r\n}\r\n\r\n/* https://plainjs.com/javascript/events/trigger-an-event-11/ */\r\nexport function __triggerEvent(el, type) {\r\n\r\n  if ('createEvent' in document) {\r\n    // modern browsers, IE9+\r\n    const e = new Event(type);\r\n    el.dispatchEvent(e);\r\n  } else {\r\n    // IE 8\r\n    const e = document.createEventObject();\r\n    e.eventType = type;\r\n    el.fireEvent('on'+e.eventType, e);\r\n  }\r\n}\r\n\r\nexport function __keycodeIsPrintableCharacter(keycode) {\r\n\r\n  const valid =\r\n    (keycode > 47 && keycode < 58) || // number keys\r\n    keycode == 32 || keycode == 13 || // spacebar & return key(s) (if you want to allow carriage returns)\r\n    (keycode > 64 && keycode < 91) || // letter keys\r\n    (keycode > 95 && keycode < 112) || // numpad keys\r\n    (keycode > 185 && keycode < 193) || // ;=,-./` (in order)\r\n    (keycode > 218 && keycode < 223); // [\\]' (in order)\r\n  // https://stackoverflow.com/questions/12467240/determine-if-javascript-e-keycode-is-a-printable-non-control-character#answer-12467610\r\n\r\n  return valid;\r\n\r\n}\r\n\r\nexport function __isObject(item) {\r\n  return (item && typeof item === 'object' && !Array.isArray(item));\r\n}\r\n\r\n// https://stackoverflow.com/questions/27936772/how-to-deep-merge-instead-of-shallow-merge\r\n// Maybe use lodash ? https://lodash.com/docs/4.17.10#defaultsDeep\r\nexport function __mergeDeep(target, source) {\r\n  const output = Object.assign({}, target);\r\n  if (__isObject(target) && __isObject(source)) {\r\n    Object.keys(source).forEach((key) => {\r\n      if (__isObject(source[key])) {\r\n        if (!(key in target)) {\r\n          Object.assign(output, { [key]: source[key] });\r\n        } else {\r\n          output[key] = __mergeDeep(target[key], source[key]);\r\n        }\r\n      } else {\r\n        Object.assign(output, { [key]: source[key] });\r\n      }\r\n    });\r\n  }\r\n  return output;\r\n}\r\n\r\nexport function __isObjectEmpty(object) {\r\n  return !Object.keys(object).length;\r\n}\r\n\r\nexport function __insertBefore(newNode, referenceNode) {\r\n  referenceNode.parentNode.insertBefore(newNode, referenceNode);\r\n}\r\n\r\nexport function __insertAfter(newNode, referenceNode) {\r\n\r\n  referenceNode.parentNode.insertBefore(newNode, referenceNode.nextSibling);\r\n\r\n}\r\n\r\nexport function __getRealDimensions(el, translated = true) {\r\n\r\n  const clonedElement = el.cloneNode(true);\r\n\r\n  clonedElement.style.visibility = 'hidden';\r\n  clonedElement.style.display = 'block';\r\n\r\n  __insertAfter(clonedElement, el);\r\n\r\n  const elDimensions = clonedElement.getBoundingClientRect();\r\n  const elPosition = (translated) ? __positionTranslated(clonedElement) : __position(clonedElement);\r\n\r\n\r\n  __remove(clonedElement);\r\n\r\n  return {\r\n    width: elDimensions.width,\r\n    height: elDimensions.height,\r\n    top: elPosition.top,\r\n    left: elPosition.left,\r\n  };\r\n\r\n}\r\n\r\nexport function __remove(el /* :HTMLElement */) {\r\n\r\n  el.parentNode.removeChild(el);\r\n\r\n}\r\n\r\n\r\nexport function __getHTML(node) {\r\n\r\n  if (!node || !node.tagName) { return; }\r\n  if (node.outerHTML) { return node.outerHTML; }\r\n\r\n  // polyfill:\r\n  const wrapper = document.createElement('div');\r\n  wrapper.appendChild(node.cloneNode(true));\r\n  return wrapper.innerHTML;\r\n\r\n}\r\n\r\nexport function __getText(el) {\r\n  return el.innerText || el.textContent;\r\n}\r\n\r\nexport function __globalPosition(event) {\r\n  // d3.event\r\n  // The current event, if any. This is set during the invocation of an event listener, and is reset after the listener terminates. Use this to access standard event fields such as event.timeStamp and methods such as event.preventDefault. While you can use the native event.pageX and event.pageY, it is often more convenient to transform the event position to the local coordinate system of the container that received the event using d3.mouse, d3.touch or d3.touches.\r\n  // If you use Babel, Webpack, or another ES6-to-ES5 bundler, be aware that the value of d3.event changes during an event! An import of d3.event must be a live binding, so you may need to configure the bundler to import from D3’s ES6 modules rather than from the generated UMD bundle; not all bundlers observe jsnext:main. Also beware of conflicts with the window.event global.\r\n  return {\r\n    x: event.pageX,\r\n    y: event.pageY,\r\n  };\r\n}\r\n\r\nexport function __localPosition(container) {\r\n  // d3.mouse\r\n  // Returns the x and y coordinates of the current event relative to the specified container. The container may be an HTML or SVG container element, such as a G element or an SVG element. The coordinates are returned as a two-element array of numbers [x, y].\r\n  // BUG: d3.mouse doesn’t observe CSS transform on Firefox — https://github.com/d3/d3-selection/issues/81\r\n  const pos = d3.mouse(container);\r\n  return {\r\n    x: d3.format('.0f')(pos[0]),\r\n    y: d3.format('.0f')(pos[1]),\r\n  };\r\n}\r\n\r\nexport function __positionTranslated(el) {\r\n\r\n\r\n  const curTransform = new WebKitCSSMatrix(window.getComputedStyle(el).webkitTransform);\r\n\r\n  const body = document.body;\r\n\r\n  const scrollTop = window.pageYOffset || body.scrollTop;\r\n  const scrollLeft = window.pageXOffset || body.scrollLeft;\r\n\r\n  return {\r\n    left: el.offsetLeft + curTransform.m41,\r\n    top: el.offsetTop + curTransform.m42,\r\n  };\r\n\r\n}\r\n\r\nexport function __position(el) {\r\n\r\n  const elAttibutes = el.getBoundingClientRect();\r\n  const body = document.body;\r\n\r\n  const scrollTop = window.pageYOffset || body.scrollTop;\r\n  const scrollLeft = window.pageXOffset || body.scrollLeft;\r\n\r\n  return {\r\n    left: elAttibutes.left + scrollLeft,\r\n    top: elAttibutes.top + scrollTop,\r\n    height: elAttibutes.height,\r\n    width: elAttibutes.width,\r\n  };\r\n}\r\n\r\n// TODO: check for https://github.com/vladocar/nanoJS/\r\nexport function __toggleClass(element, cls) {\r\n  if (__hasClass(element, cls)) {\r\n    __removeClass(element, cls);\r\n  } else {\r\n    __addClass(element, cls);\r\n  }\r\n}\r\n\r\nexport function __hasClass(element, cls) {\r\n  // if there are no elements or classes, we're done\r\n  if (!element || !cls) return false;\r\n  return (element.classList) ? element.classList.contains(cls) : (`${element.className} `).indexOf(`${cls} `) > -1;\r\n}\r\n\r\nexport function __addClass(elements, classes) {\r\n  let _elements = elements;\r\n  let _classes = classes;\r\n\r\n  // if there are no elements or classes, we're done\r\n  if (!_elements || !_classes) { return; }\r\n\r\n  if (typeof (_elements) === 'string') {\r\n    // if we have a selector, get the chosen _elements\r\n    _elements = document.querySelectorAll(_elements);\r\n  } else if (_elements.tagName) {\r\n    // if we have a single DOM element, make it an array to simplify behavior\r\n    _elements = [_elements];\r\n  }\r\n\r\n  if (typeof (_classes) === 'string') {\r\n    // make an array from string _classes\r\n    _classes = _classes.split(' ');\r\n  } else {\r\n    console.log('Class argument must be string with spaces in between class names.');\r\n    return;\r\n  }\r\n\r\n  // add class to all chosen _elements\r\n  for (let i = 0; i < _elements.length; i += 1) {\r\n    // check classList support\r\n    if (_elements[i].classList) {\r\n      _elements[i].classList.add(..._classes);\r\n    } else if (!__hasClass(_elements[i], ..._classes)) {\r\n      for (let j = 0; j < _classes.length; j += 1) {\r\n        _elements[i].classes += ` ${_classes[j]}`;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport function __removeClass(elements, classes) {\r\n  let _elements = elements;\r\n  let _classes = classes;\r\n\r\n  // if there are no elements or classes, we're done\r\n  if (!_elements || !_classes) { return; }\r\n\r\n  if (typeof (_elements) === 'string') {\r\n    // if we have a selector, get the chosen _elements\r\n    _elements = document.querySelectorAll(_elements);\r\n  } else if (_elements.tagName) {\r\n    // if we have a single DOM element, make it an array to simplify behavior\r\n    _elements = [_elements];\r\n  }\r\n\r\n  if (typeof (_classes) === 'string') {\r\n    // make an array from string _classes\r\n    _classes = _classes.split(' ');\r\n  } else {\r\n    console.log('Class argument must be string with spaces in between class names.');\r\n    return;\r\n  }\r\n\r\n  // remove class from all chosen _elements\r\n  for (let i = 0; i < _elements.length; i += 1) {\r\n    // check classList support\r\n    if (_elements[i].classList) {\r\n      _elements[i].classList.remove(..._classes);\r\n    } else {\r\n      for (let j = 0; j < _classes.length; j += 1) {\r\n        _elements[i].className = _elements[i].className.replace(new RegExp(`\\\\b${classes[j]}\\\\b`, 'g'), '');\r\n      }\r\n    }\r\n  }\r\n}\r\n","import { __createNewCustomEvent } from '../../lib/utils';\r\n\r\nconst mediaEvents = {\r\n  playchange: __createNewCustomEvent('playchange'),\r\n  timechange: __createNewCustomEvent('timechange'),\r\n  canplaystart: __createNewCustomEvent('canplaystart'),\r\n};\r\n\r\nfunction stopPlayingVideoPlayers($players) {\r\n  // pause all other playing media tracks\r\n  $players.forEach(($player) => {\r\n    const $media = $player.querySelector('audio') || $player.querySelector('video');\r\n    if ($media && !$media.paused) {\r\n      $media.pause();\r\n      $player\r\n        .querySelector('[data-player-control]')\r\n        .setAttribute('data-player-control', 'paused');\r\n    }\r\n  });\r\n}\r\n\r\nfunction getSecondsMinutesFormat(seconds) {\r\n  const duration = {\r\n    seconds: Math.floor(seconds),\r\n    minutes: Math.floor(seconds / 60),\r\n  };\r\n\r\n  duration.seconds = (duration.seconds - (duration.minutes * 60)).toString(10);\r\n\r\n  return `${duration.minutes}:${(`0${duration.seconds}`).slice(-2)}`;\r\n}\r\n\r\nexport {\r\n  getSecondsMinutesFormat,\r\n  stopPlayingVideoPlayers,\r\n  mediaEvents,\r\n};\r\n","import Component from '../component';\r\nimport { getSecondsMinutesFormat, stopPlayingVideoPlayers } from './media';\r\n\r\nexport default class AudioPlayer extends Component {\r\n  // eslint-disable-next-line no-useless-constructor\r\n  constructor($element) {\r\n    super($element);\r\n  }\r\n\r\n  // TODO: move to audio-simple.js\r\n  static addEventListeners($item, showFeedback) {\r\n    const $players = document.querySelectorAll('[data-player-audio]');\r\n    const $audio = $item.querySelector('audio');\r\n    const $playButton = $item.querySelector('[data-player-control]');\r\n    const $timeLeft = $item.querySelector('[data-audio-time-left]');\r\n\r\n    $playButton.addEventListener('click', (event) => {\r\n      if ($playButton.getAttribute('data-player-control') === 'paused') {\r\n        // TODO: abstract\r\n        stopPlayingVideoPlayers(Array.from($players));\r\n        $audio.play();\r\n        $playButton.setAttribute('data-player-control', 'playing');\r\n      } else {\r\n        // TODO: abstract\r\n        $audio.pause();\r\n        $playButton.setAttribute('data-player-control', 'paused');\r\n      }\r\n\r\n      showFeedback();\r\n\r\n      event.stopPropagation();\r\n    }, false);\r\n\r\n    // do not propagate audio control events higher into the dom\r\n    $playButton.addEventListener('mousedown', (event) => {\r\n      event.stopPropagation();\r\n    }, false);\r\n\r\n    $audio.addEventListener('timeupdate', () => {\r\n      $timeLeft.innerText = getSecondsMinutesFormat($audio.currentTime);\r\n    });\r\n\r\n    $audio.addEventListener('ended', () => {\r\n      $playButton.setAttribute('data-player-control', 'paused');\r\n    });\r\n  }\r\n}\r\n","import Component from './component';\r\nimport AudioPlayer from './media/audio-player';\r\nimport { stopPlayingVideoPlayers } from './media/media';\r\nimport { __dispatchEvent } from '../lib/utils';\r\n\r\nexport default class Sortable extends Component {\r\n  constructor($element) {\r\n    super($element);\r\n    this.$settings = document.querySelector(\r\n      `[data-sortable-id-reference=\"${this.target.id}\"]`,\r\n    );\r\n    this.feedback = JSON.parse(this.$settings.getAttribute('data-module-zpetnavazba'));\r\n\r\n    this.container = this.target;\r\n    this.$items = this.target.querySelectorAll('[data-sortable-drag]');\r\n    this.$droppables = this.target.querySelectorAll('[data-sortable-drop]');\r\n    this.$placeholder = () => document.querySelector('#sortable-placeholder');\r\n    this.$players = this.container.querySelectorAll('[data-player-audio]');\r\n\r\n    // get direction (type of sortable \"horizontalni\" or \"vertikalni\")\r\n    this.direction = this.target.getAttribute('data-sortable-target');\r\n    this.trackingTouch = false;\r\n    this.before = false;\r\n    this.after = false;\r\n    this.evaluation = undefined;\r\n\r\n    this.mouse = {\r\n      x: event => event.clientX || event.touches[0].clientX,\r\n      y: event => event.clientY || event.touches[0].clientY,\r\n      x0: 0,\r\n      y0: 0,\r\n      x1: 0,\r\n      y1: 0,\r\n    };\r\n\r\n    this.dragged = {\r\n      el: null,\r\n      clone: null,\r\n      posRel: {},\r\n      rect: () => this.dragged.el.getBoundingClientRect(),\r\n      size: {},\r\n    };\r\n\r\n    this.siblings = {\r\n      prev: null,\r\n      next: null,\r\n    };\r\n\r\n    this._onStart = this._onStart.bind(this);\r\n    this._onMove = this._onMove.bind(this);\r\n    this._onEnd = this._onEnd.bind(this);\r\n    this._update = this._update.bind(this);\r\n\r\n    this._addEventListeners();\r\n\r\n\r\n    this.cache = {\r\n      answersCorrect: 0,\r\n      colors: [],\r\n    };\r\n\r\n    // get colors for all feedback variants\r\n    if (this.feedback) {\r\n      this.cache.colors = this.feedback.map(feedback => feedback.barva);\r\n    }\r\n  }\r\n\r\n  _onStart(event) {\r\n    if (!event.target.hasAttribute('data-sortable-drag')) {\r\n      return;\r\n    }\r\n\r\n    // TODO: zastavit všechno audio on drag start\r\n    if (this.$players.length > 0) {\r\n      stopPlayingVideoPlayers(this.$players);\r\n    }\r\n\r\n\r\n    this.trackingTouch = true;\r\n\r\n    this.dragged.el = event.target;\r\n    this.dragged.clone = this.dragged.el.cloneNode(true);\r\n    this.dragged.posRel.top = this.dragged.el.offsetTop;\r\n    this.dragged.posRel.left = this.dragged.el.offsetLeft;\r\n    this.dragged.size.width = this.dragged.el.offsetWidth;\r\n    this.dragged.size.height = this.dragged.el.offsetHeight;\r\n\r\n    this.dragged.el.style.top = `${this.dragged.posRel.top}px`;\r\n    this.dragged.el.style.left = `${this.dragged.posRel.left}px`;\r\n    this.dragged.el.style.width = `${this.dragged.size.width}px`;\r\n    this.dragged.el.style.height = `${this.dragged.size.height}px`;\r\n    this.dragged.el.classList.add('is-dragged');\r\n\r\n    this.container.classList.add('is-dragged');\r\n\r\n    this._addPlaceholder(this.dragged.el);\r\n    this._onOver();\r\n\r\n    this.mouse.x0 = this.mouse.x(event);\r\n    this.mouse.y0 = this.mouse.y(event);\r\n\r\n    event.preventDefault();\r\n  }\r\n\r\n  _onMove(event) {\r\n    if (!this.trackingTouch) {\r\n      return;\r\n    }\r\n\r\n    this.mouse.x1 = this.mouse.x(event) - this.mouse.x0;\r\n    this.mouse.y1 = this.mouse.y(event) - this.mouse.y0;\r\n\r\n    window.requestAnimationFrame(this._update);\r\n\r\n    this._onOver();\r\n  }\r\n\r\n  _onEnd(event) {\r\n    if (!this.trackingTouch) {\r\n      return;\r\n    }\r\n\r\n    this.trackingTouch = false;\r\n    this.container.classList.remove('is-dragged');\r\n    this.dragged.el.classList.remove('is-dragged');\r\n    this.dragged.el.style.top = '';\r\n    this.dragged.el.style.left = '';\r\n    this.dragged.el.style.width = '';\r\n    this.dragged.el.style.height = '';\r\n    this.dragged.el.style.transform = '';\r\n\r\n    const $placeholder = this.$placeholder();\r\n    const rect = $placeholder.getBoundingClientRect();\r\n\r\n    switch (this.direction) {\r\n      case 'horizontal':\r\n        if (rect.left <= this.mouse.x(event) <= rect.right) {\r\n          this._onDrop();\r\n        }\r\n        break;\r\n      case 'vertical':\r\n        if (rect.top <= this.mouse.y(event) <= rect.bottom) {\r\n          this._onDrop();\r\n        }\r\n        break;\r\n\r\n      default:\r\n        break;\r\n    }\r\n\r\n    this._removePlaceholder();\r\n    this._dispatchEvent();\r\n    this._checkAndResolveFeedback();\r\n  }\r\n\r\n  // _onEnter() {}\r\n\r\n  _onOver() {\r\n    this.before = false;\r\n    this.after = false;\r\n\r\n    this._getReference();\r\n\r\n    if (\r\n      this.siblings.next\r\n      && this.siblings.next.hasAttribute('data-sortable-drop')\r\n    ) {\r\n      const next = this.siblings.next.getBoundingClientRect();\r\n\r\n      switch (this.direction) {\r\n        case 'horizontal':\r\n          if (this.dragged.rect().right > (next.left + (next.width / 1.5))) {\r\n            this.after = true;\r\n            this._addPlaceholder(this.siblings.next);\r\n          }\r\n          break;\r\n        case 'vertical':\r\n          if (this.dragged.rect().bottom > (next.top + (next.height / 1.5))) {\r\n            this.after = true;\r\n            this._addPlaceholder(this.siblings.next);\r\n          }\r\n          break;\r\n\r\n        default:\r\n          break;\r\n      }\r\n    }\r\n\r\n    if (\r\n      this.siblings.prev\r\n      && this.siblings.prev.hasAttribute('data-sortable-drop')\r\n    ) {\r\n      const prev = this.siblings.prev.getBoundingClientRect();\r\n\r\n      switch (this.direction) {\r\n        case 'horizontal':\r\n          if (this.dragged.rect().left < (prev.right - (prev.width / 1.5))) {\r\n            this.before = true;\r\n            this._addPlaceholder(this.siblings.prev);\r\n          }\r\n          break;\r\n        case 'vertical':\r\n          if (this.dragged.rect().top < (prev.bottom - (prev.height / 1.5))) {\r\n            this.before = true;\r\n            this._addPlaceholder(this.siblings.prev);\r\n          }\r\n          break;\r\n\r\n        default:\r\n          break;\r\n      }\r\n    }\r\n  }\r\n\r\n  // _onLeave() {}\r\n\r\n  _onDrop() {\r\n    const $placeholder = this.$placeholder();\r\n\r\n    this._addEventListenerToItem(this.dragged.clone);\r\n    // TODO: přiřadit eventListenery audio playerům\r\n    if (this.dragged.clone.querySelector('[data-player-audio]')) {\r\n      AudioPlayer.addEventListeners(this.dragged.clone, this.showFeedback);\r\n    }\r\n\r\n    this.container.insertBefore(this.dragged.clone, $placeholder);\r\n    this.dragged.el.parentElement.removeChild(this.dragged.el);\r\n  }\r\n\r\n  _update() {\r\n    this.dragged.el.style.transform = `translate3d(${this.mouse.x1}px, ${\r\n      this.mouse.y1\r\n    }px, 0) rotate(5deg)`;\r\n  }\r\n\r\n  _addPlaceholder(item) {\r\n    this._removePlaceholder();\r\n\r\n    const $placeholder = document.createElement('div');\r\n    $placeholder.classList.add('sortable-item', 'sortable-placeholder');\r\n    $placeholder.setAttribute('id', 'sortable-placeholder');\r\n    $placeholder.style.minHeight = `${this.dragged.size.height}px`;\r\n\r\n    if (this.dragged.el.querySelector('img')) {\r\n      const src = this.dragged.el.querySelector('img').getAttribute('src');\r\n      const img = document.createElement('img');\r\n      img.setAttribute('src', src);\r\n      $placeholder.appendChild(img);\r\n    }\r\n\r\n    if (this.after) {\r\n      this.container.insertBefore($placeholder, item.nextElementSibling);\r\n    } else if (this.before) {\r\n      this.container.insertBefore($placeholder, item);\r\n    } else {\r\n      this.container.insertBefore($placeholder, item);\r\n    }\r\n  }\r\n\r\n  _removePlaceholder() {\r\n    const $placeholder = this.$placeholder();\r\n    if ($placeholder) $placeholder.parentElement.removeChild($placeholder);\r\n  }\r\n\r\n  _getReference() {\r\n    const $placeholder = this.$placeholder();\r\n    this.siblings.prev = $placeholder.previousElementSibling === this.dragged.el\r\n      ? this.dragged.el.previousElementSibling\r\n      : $placeholder.previousElementSibling;\r\n    this.siblings.next = $placeholder.nextElementSibling === this.dragged.el\r\n      ? this.dragged.el.nextElementSibling\r\n      : $placeholder.nextElementSibling;\r\n  }\r\n\r\n  _addEventListenerToItem($item) {\r\n    // touch events\r\n    $item.addEventListener('touchstart', this._onStart, false);\r\n    // mouse events\r\n    $item.addEventListener('mousedown', this._onStart, false);\r\n  }\r\n\r\n  _addEventListeners() {\r\n    // touch events\r\n    document.addEventListener('touchmove', this._onMove);\r\n    document.addEventListener('touchend', this._onEnd);\r\n    // mouse events\r\n    document.addEventListener('mousemove', this._onMove);\r\n    document.addEventListener('mouseup', this._onEnd);\r\n\r\n    this.$items.forEach(($item) => {\r\n      this._addEventListenerToItem($item);\r\n    });\r\n  }\r\n\r\n  _checkAndResolveFeedback() {\r\n    if (this.feedback) {\r\n      this.cache.answersCorrect = 0;\r\n\r\n      this.target.querySelectorAll('[data-sortable-drag]').forEach(($item, index) => {\r\n        const correctAnswerAttr = $item.getAttribute('data-sortable-spravnaodpoved');\r\n\r\n        if (parseInt(correctAnswerAttr, 10) === (index + 1)) {\r\n          this.cache.answersCorrect += 1;\r\n        }\r\n      });\r\n\r\n      const feedbackActual = this.feedback.find(feedback => feedback.podminka.includes(this.cache.answersCorrect));\r\n      this.$buttonFeedback.classList.remove(...this.cache.colors);\r\n      this.$buttonFeedback.classList.add(feedbackActual.barva);\r\n      this.$buttonFeedbackText.innerText = feedbackActual.text;\r\n      this.evaluation = feedbackActual.splneno;\r\n    }\r\n\r\n    this.showFeedback();\r\n  }\r\n\r\n  _dispatchEvent() {\r\n    const items = Array.from(this.target.querySelectorAll('[data-sortable-drag]')).map($item => ({\r\n      id: $item.id,\r\n    }));\r\n\r\n    __dispatchEvent(this.target, 'sortable.change', {}, {\r\n      id: this.target.id,\r\n      evaluation: this.evaluation,\r\n      items,\r\n    });\r\n  }\r\n}\r\n","export default class SVGDragNDrop {\r\n  // static drag(id) {\r\n  //   d3.drag()\r\n  //     .on('start', () => {\r\n  //       SVGDragNDrop.start(id);\r\n  //     })\r\n  //     .on('drag', () => {\r\n  //       SVGDragNDrop.dragged(id);\r\n  //     })\r\n  //     .on('end', () => {\r\n  //       SVGDragNDrop.end(id);\r\n  //     });\r\n  // }\r\n\r\n  static start(element) {\r\n    d3.select(element).raise().classed('is-dragged', true);\r\n  }\r\n\r\n  static dragged(element, diff) {\r\n\r\n    d3.select(element)\r\n      .attr('x', (d3.event.x - diff.x).toFixed())\r\n      .attr('y', (d3.event.y - diff.y).toFixed());\r\n  }\r\n\r\n  static end(element, type, diff) {\r\n\r\n    d3.select(element)\r\n      .attr('x', (d3.event.x - diff.x).toFixed())\r\n      .attr('y', (d3.event.y - diff.y).toFixed())\r\n      // neumožňuje v jiných funkcí s tímto objektem dále pracovat,\r\n      // protože pracují s id\r\n      // .attr('id', `${type}-${d3.event.x.toFixed()}-${d3.event.y.toFixed()}`)\r\n      .classed('is-dragged', false);\r\n  }\r\n}\r\n","import { __localPosition, __dispatchEvent } from '../../lib/utils';\r\n\r\n// import SVG from '../svg';\r\nimport SVGDragNDrop from './svg-dragndrop';\r\nimport SVG from '../svg';\r\n\r\nexport default class SVGDraw {\r\n  // static selectPath(svg) {\r\n  //   // https://bl.ocks.org/mbostock/8027637\r\n  // }\r\n\r\n  static renderPath($svg, callback) {\r\n    if (d3.event.sourceEvent.target.nodeName === 'image') {\r\n\r\n      const line = d3.line()\r\n        // removed smooth curve to get rid of loong decimals\r\n        // see https://github.com/d3/d3-path/issues/10\r\n        .curve(d3.curveLinear); // _dragStarted\r\n\r\n      const format = d3.format('.0f');\r\n      const d = d3.event.subject;\r\n      // origin\r\n      let x0 = format(d3.event.x);\r\n      let y0 = format(d3.event.y);\r\n\r\n      const id = `${$svg.id}_path-${x0}-${y0}`;\r\n\r\n      const active = d3.select(`#${$svg.id} .svg-view`).append('svg:path')\r\n        // .attr('marker-start', 'url('#marker-circle-blue')')\r\n        // .attr('marker-end', 'url('#marker-arrow-blue')')\r\n        .attr('data-svg-path', '')\r\n        .attr('class', 'svg-path')\r\n        .attr('id', id)\r\n        .datum(d);\r\n\r\n      // github.com/d3/d3-drag#event_on\r\n      d3.event\r\n        .on('drag', () => {\r\n          // current position\r\n          const x1 = format(d3.event.x);\r\n          const y1 = format(d3.event.y);\r\n          // distance from origin\r\n          const dx = x1 - x0;\r\n          const dy = y1 - y0;\r\n\r\n          // if the distance of drag event is too large, make new origin\r\n          if ((dx * dx) + (dy * dy) > 300) d.push([x0 = x1, y0 = y1]);\r\n          // smooth line, correct last point\r\n          else d[d.length - 1] = [x1, y1];\r\n\r\n          active.attr('d', line);\r\n        })\r\n        .on('end', () => {\r\n          const $thisPath = d3.select(`#${id}`);\r\n          if ($thisPath) {\r\n            if ($thisPath.attr('d')) {\r\n              if ($thisPath.attr('d').length < 40) {\r\n                $thisPath.remove();\r\n              } else {\r\n                // dispatch event that svg has changed\r\n                __dispatchEvent(document, 'svg.change', {}, {\r\n                  svg: {\r\n                    id: $svg.id,\r\n                    task: 'create',\r\n                    node: $thisPath.node(),\r\n                    nodeName: $thisPath.node().nodeName,\r\n                    contextMenu: false,\r\n                  },\r\n                });\r\n              }\r\n            } else if (!$thisPath.attr('d')) {\r\n              $thisPath.remove();\r\n            }\r\n          }\r\n\r\n          callback();\r\n        });\r\n\r\n      // add events to element\r\n      SVGDraw.pathEventsManager($svg, d3.select(`#${id}`).node());\r\n    }\r\n  }\r\n\r\n  // Draw a SVG circle on click\r\n  static createCircle($svg, color = 'blue') {\r\n    const d3svg = d3.select(`#${$svg.id} .svg-view`);\r\n    // const canvas = document.querySelector(`#${$svg.id} .svg-view`);\r\n    const localPosition = __localPosition($svg);\r\n    const id = `${$svg.id}_circle-${localPosition.x}-${localPosition.y}`;\r\n\r\n    // circle wrapper\r\n    const foreignObject = d3svg.append('svg:foreignObject')\r\n      .attr('data-svg-circle', '')\r\n      .attr('id', id)\r\n      .attr('x', localPosition.x)\r\n      .attr('y', localPosition.y)\r\n      .attr('width', 1)\r\n      .attr('height', 1);\r\n\r\n    const circle = foreignObject.append('xhtml:div')\r\n      .attr('class', 'svg-circle blue');\r\n\r\n    const $element = document.querySelector(`#${id}`);\r\n\r\n    // add events to element\r\n    SVGDraw.circleEventsManager($svg, $element);\r\n\r\n    // dispatch event that svg has changed\r\n    __dispatchEvent(document, 'svg.change', {}, {\r\n      svg: {\r\n        id: $svg.id,\r\n        task: 'create',\r\n        node: $element,\r\n        nodeName: $element.nodeName,\r\n        contextMenu: false,\r\n      },\r\n    });\r\n  }\r\n\r\n  static pathEventsManager($svg, $element) {\r\n    d3.select(`#${$element.id}`).on('click', () => {\r\n      // dispatch event that svg has changed\r\n      __dispatchEvent(document, 'svg.change', {}, {\r\n        svg: {\r\n          id: $svg.id,\r\n          task: 'remove',\r\n          node: d3.event.target,\r\n          nodeName: d3.event.target.nodeName,\r\n          contextMenu: false,\r\n        },\r\n      });\r\n\r\n      d3.select(`#${$element.id}`).remove();\r\n\r\n      d3.event.preventDefault();\r\n    }, false);\r\n  }\r\n\r\n  static circleEventsManager($svg, $element) {\r\n    const $canvas = document.querySelector(`#${$svg.id} .svg-view`);\r\n\r\n    // TODO:\r\n    // standalone function\r\n    // same for all draggable svg elements\r\n    let elementPosition = [\r\n      $element.getAttribute('x'),\r\n      $element.getAttribute('y'),\r\n    ];\r\n    let diff = {};\r\n\r\n    const selection = d3.selectAll(`#${$element.id} > div`);\r\n    d3.select(selection.nodes()[0]).on('click', () => {\r\n\r\n      // dispatch event that svg has changed\r\n      __dispatchEvent(document, 'svg.change', {}, {\r\n        svg: {\r\n          id: $svg.id,\r\n          task: 'remove',\r\n          node: $element,\r\n          nodeName: $element.nodeName,\r\n          contextMenu: false,\r\n        },\r\n      });\r\n\r\n      d3.select(d3.event.target.parentNode).remove();\r\n    })\r\n      .call(d3.drag()\r\n        .container($canvas)\r\n        .subject($element)\r\n        .on('start', () => {\r\n          diff = {\r\n            x: d3.event.x - elementPosition[0],\r\n            y: d3.event.y - elementPosition[1],\r\n          };\r\n\r\n          SVGDragNDrop.start($element);\r\n        })\r\n        .on('drag', () => {\r\n          SVGDragNDrop.dragged($element, diff);\r\n        })\r\n        .on('end', () => {\r\n          const oldXCoordinate = elementPosition[0];\r\n          const oldYCoordinate = elementPosition[1];\r\n          let taskType = 'move';\r\n\r\n          SVGDragNDrop.end($element, 'circle', diff);\r\n\r\n          elementPosition = [\r\n            $element.getAttribute('x'),\r\n            $element.getAttribute('y'),\r\n          ];\r\n\r\n          // if clone is changed, then dispatch create event\r\n          if (SVG.removeCloneConnectionManager($element)) taskType = 'create';\r\n\r\n          if (elementPosition[0] !== oldXCoordinate || elementPosition[1] !== oldYCoordinate) {\r\n            // dispatch event that svg has changed\r\n            __dispatchEvent(document, 'svg.change', {}, {\r\n              svg: {\r\n                id: $svg.id,\r\n                task: taskType,\r\n                node: $element,\r\n                nodeName: $element.nodeName,\r\n                contextMenu: false,\r\n              },\r\n            });\r\n          }\r\n        }));\r\n  }\r\n}\r\n","import {\r\n  __addClass,\r\n  __removeClass,\r\n  __hasClass,\r\n  __dispatchEvent,\r\n} from '../../lib/utils';\r\n\r\nimport SVG from '../svg';\r\nimport SVGDragNDrop from './svg-dragndrop';\r\n\r\nexport default class SVGText {\r\n  static createText(maxLength = 333, minLength = 2) {\r\n    const $svg = document.querySelector('[data-svg-active=\"true\"]');\r\n    const svgID = $svg.id;\r\n    const svgGroup = d3.select($svg).select('.svg-view');\r\n\r\n    // const $canvas = $svg.querySelector('.svg-view');\r\n    const $radialMenu = document.querySelector('[data-radial-menu]');\r\n    const localPosition = {\r\n      x: $radialMenu.getAttribute('data-local-x'),\r\n      y: $radialMenu.getAttribute('data-local-y'),\r\n    };\r\n    const id = `${svgID}_svg-text-${localPosition.x}-${localPosition.y}`;\r\n    const hash = `#${id}`;\r\n    const orientation = {\r\n      x: (svgGroup.attr('width') - localPosition.x) > 320 ? 'right' : 'left',\r\n      y: (svgGroup.attr('height') - localPosition.y) > 60 ? 'bottom' : 'top',\r\n    };\r\n    // let firstWrite = true;\r\n\r\n    // text wrapper\r\n    const foreignObject = svgGroup.append('svg:foreignObject')\r\n      .attr('class', `svg-text orientation-${orientation.x} orientation-${orientation.y}`)\r\n      .attr('data-svg-text', '')\r\n      .attr('x', localPosition.x)\r\n      .attr('y', localPosition.y)\r\n      .attr('width', 1)\r\n      .attr('height', 1);\r\n\r\n    // create visual point of interest for text input\r\n    foreignObject.append('xhtml:div')\r\n      .attr('class', 'svg-circle svg-circle-text');\r\n    // create text input\r\n    const textarea = foreignObject.append('xhtml:textarea')\r\n      .attr('maxlength', maxLength)\r\n      .attr('tabindex', '-1')\r\n      .attr('id', id)\r\n      .attr('class', 'svg-textarea')\r\n      .attr('data-save', '')\r\n      .attr('data-svg-textarea-target', svgID);\r\n\r\n    // set focus to the new text input\r\n    $svg.querySelector(`${hash}`).focus();\r\n\r\n    // add events to element\r\n    SVGText.textEventsManager($svg, textarea.node(), true, minLength);\r\n  }\r\n\r\n  static textEventsManager($svg, $node, isCreated, minLength = 2) {\r\n    const $canvas = $svg.querySelector('.svg-view');\r\n    const hash = `#${$node.id}`;\r\n    let firstWrite = isCreated;\r\n    let oldText = $node.value;\r\n\r\n    // TODO\r\n    // standalone function\r\n    // same for all draggable svg elements\r\n    const $element = $svg.querySelector(hash).parentElement;\r\n    let elementPosition = [\r\n      $element.getAttribute('x'),\r\n      $element.getAttribute('y'),\r\n    ];\r\n    let diff = {};\r\n\r\n    d3.select(`${hash}`)\r\n      // drag & drop\r\n      .call(d3.drag()\r\n        .container($canvas)\r\n        .subject($element)\r\n        .on('start', () => {\r\n          diff = {\r\n            x: d3.event.x - elementPosition[0],\r\n            y: d3.event.y - elementPosition[1],\r\n          };\r\n\r\n          SVGDragNDrop.start($element);\r\n        })\r\n        .on('drag', () => {\r\n          SVGDragNDrop.dragged($element, diff);\r\n        })\r\n        .on('end', () => {\r\n          const oldXCoordinate = elementPosition[0];\r\n          const oldYCoordinate = elementPosition[1];\r\n          let taskType = 'move';\r\n\r\n          SVGDragNDrop.end($element, 'text', diff);\r\n\r\n          elementPosition = [\r\n            $element.getAttribute('x'),\r\n            $element.getAttribute('y'),\r\n          ];\r\n\r\n          if (!firstWrite && (elementPosition[0] !== oldXCoordinate || elementPosition[1] !== oldYCoordinate)) {\r\n            // if clone is changed, then dispatch create event\r\n            if (SVG.removeCloneConnectionManager($element.childNodes[1])) taskType = 'create';\r\n\r\n            // dispatch event that svg has changed\r\n            __dispatchEvent(document, 'svg.change', {}, {\r\n              svg: {\r\n                id: $svg.id,\r\n                task: taskType,\r\n                node: $element.childNodes[1],\r\n                nodeName: $element.childNodes[1].nodeName,\r\n                contextMenu: false,\r\n              },\r\n            });\r\n          }\r\n        }))\r\n      // keystroke\r\n      // control height of the text input on every key stroke\r\n      .on('keyup', () => {\r\n        SVGText.updateTextareaHeight(d3.event.target);\r\n      })\r\n      // loss of focus\r\n      .on('blur', () => {\r\n        const $target = d3.event.target;\r\n        const value = $target.value;\r\n        let taskType;\r\n        let wrongBool = false;\r\n\r\n        if (value.length === 0) {\r\n          SVG.removeItem(false, hash);\r\n          return;\r\n        }\r\n        if (value.length < minLength) {\r\n          __addClass($target, 'is-wrong');\r\n          wrongBool = true;\r\n        } else if ((value.length >= minLength) && __hasClass($target, 'is-wrong')) {\r\n          __removeClass($target, 'is-wrong');\r\n          wrongBool = false;\r\n        }\r\n\r\n        if (oldText !== value) {\r\n          if (firstWrite) {\r\n            taskType = 'create';\r\n            firstWrite = false;\r\n          } else {\r\n            taskType = 'change';\r\n          }\r\n          oldText = value;\r\n          // if clone is changed, then dispatch create event\r\n          if (SVG.removeCloneConnectionManager($target)) taskType = 'create';\r\n\r\n          // dispatch event that svg has changed\r\n          __dispatchEvent(document, 'svg.change', {}, {\r\n            svg: {\r\n              id: $svg.id,\r\n              task: taskType,\r\n              node: $target,\r\n              nodeName: $target.nodeName,\r\n              isWrong: wrongBool,\r\n              contextMenu: false,\r\n            },\r\n          });\r\n        }\r\n\r\n        // update oldText\r\n        oldText = value;\r\n      })\r\n      // gain focus\r\n      .on('focus', () => {\r\n        d3.select($element).raise();\r\n      });\r\n  }\r\n\r\n  static updateTextareaHeight($target) {\r\n    $target.style.height = '1px';\r\n    $target.style.height = `${22 + $target.scrollHeight}px`;\r\n  }\r\n\r\n  static comicBubblesEventsManager($svg, $node) {\r\n    let firstWrite = true;\r\n    let oldText = $node.value;\r\n\r\n    d3.select($node).on('keyup', () => {\r\n      SVGText.updateTextareaHeight(d3.event.target);\r\n    })\r\n      .on('blur', () => {\r\n        const $target = d3.event.target;\r\n        const value = $target.value;\r\n        let taskType;\r\n\r\n        if (oldText !== value) {\r\n          if (firstWrite) {\r\n            taskType = 'create';\r\n            firstWrite = false;\r\n          } else {\r\n            taskType = 'change';\r\n            if (value.length === 0) {\r\n              firstWrite = true;\r\n            }\r\n          }\r\n          oldText = value;\r\n          // if clone is changed, then dispatch create event\r\n          if (SVG.removeCloneConnectionManager($target)) taskType = 'create';\r\n\r\n          // dispatch event that svg has changed\r\n          __dispatchEvent(document, 'svg.change', {}, {\r\n            svg: {\r\n              id: $svg.id,\r\n              task: taskType,\r\n              node: $target,\r\n              nodeName: $target.nodeName,\r\n              isBubble: true,\r\n              contextMenu: false,\r\n            },\r\n          });\r\n        }\r\n\r\n        // update oldText\r\n        oldText = value;\r\n      });\r\n  }\r\n}\r\n","/**\r\n * čára:\r\n *  - nakreslit   ( drag'n'drop )\r\n *  - smazat      ( left click )\r\n *  - radial menu ( right click)\r\n *    - změnit barvu\r\n *    - smazaní\r\n *    - textový komentář\r\n * textové pole:\r\n *  - vytvořit    ( right click on svg )\r\n *    - nic => smaže se\r\n *    - málo znaků => zčervená\r\n *    - přes řádek textu => zvětší se\r\n *  - změnit      ( click on and write )\r\n *  - smazat      ( right click on textarea )\r\n *  - přenést     ( drag'n'drop )\r\n *  - radial menu ( right click on mark )\r\n *    - změnit barvu\r\n *    - smazaní\r\n *    - textový komentář\r\n * značka:\r\n *  - nakreslit   ( left click on svg )\r\n *  - přenést     ( drag'n'drop )\r\n *  - smazat      ( left click on mark )\r\n *  - radial menu ( right click)\r\n *    - změnit barvu\r\n *    - smazaní\r\n *    - textový komentář\r\n * komiksová bublina:  ( je již vytvořena předem )\r\n *  - napsat dovnitř\r\n *    - nic => zůstane\r\n *    - přes řádek textu => zvětší se\r\n */\r\n/* eslint-disable brace-style */\r\nimport Component from './component';\r\nimport { __dispatchEvent, __removeClass, __addClass } from '../lib/utils';\r\nimport SVGDraw from './svg-lib/svg-draw';\r\nimport SVGText from './svg-lib/svg-text';\r\n\r\nexport default class SVG extends Component {\r\n  constructor($element) {\r\n    super($element);\r\n\r\n    // fix for IE\r\n    this._setSize();\r\n\r\n    if (!HISTORYLAB.import.done) {\r\n      this.init();\r\n    }\r\n  }\r\n\r\n  init() {\r\n    // duplicate source of different svg element\r\n    this.toDuplicate = this.target.getAttribute('data-duplicate-svg');\r\n\r\n    // make array from data-attributes (contains what kind of actions can user do on this svg)\r\n    const svgSpecificActions = this.target.getAttribute('data-svg-target').split(' ');\r\n    for (let i = 0; i < svgSpecificActions.length; i += 1) {\r\n      if (svgSpecificActions[i] === 'kresleni') {\r\n        this._initPath(this.showFeedback);\r\n      }\r\n      else if (svgSpecificActions[i] === 'znacky') {\r\n        this._initCircle(this.showFeedback);\r\n      }\r\n      // else if (svgSpecificActions[i] === 'text') {\r\n      //   this._initText();\r\n      // }\r\n    }\r\n\r\n    // this._initZoom();\r\n    // comic bubbles if exists\r\n    this._initComicBubbles();\r\n\r\n    // listen events\r\n    this._getEvents();\r\n  }\r\n\r\n  _setSize() {\r\n    // TODO: set size on window resize\r\n    const viewbox = this.target.getAttribute('viewBox').split(' ');\r\n    const height = this.target.getBoundingClientRect().height;\r\n    const scale = height / viewbox[3];\r\n\r\n    this.target.style.maxWidth = scale ? `${viewbox[2] * scale}px` : '';\r\n\r\n    if (!height) {\r\n      console.warn('Wrong `max-width` SVG calculation;');\r\n    }\r\n  }\r\n\r\n  // _initZoom() {\r\n  //   const view = d3.select(`#${this.target.id} .svg-view`);\r\n  //   const size = [\r\n  //     view.attr('width'),\r\n  //     view.attr('height'),\r\n  //   ];\r\n  //   SVGZoom.zoom(this.target, view, size);\r\n  // }\r\n\r\n  _initPath(callback) {\r\n    d3.select(this.target)\r\n      .call(d3.drag()\r\n        .container(() => this.target)\r\n        .subject(() => {\r\n          const p = [d3.event.x.toFixed(), d3.event.y.toFixed()];\r\n\r\n          return [p, p];\r\n        })\r\n        .on('start', () => {\r\n          SVGDraw.renderPath(this.target, callback);\r\n        }));\r\n  }\r\n  // _initText() {\r\n  //   d3.select(this.target).on('click', () => {\r\n  //     SVGText.openTextDialog(this.target);\r\n  //     d3.event.preventDefault();\r\n  //   });\r\n  // }\r\n\r\n  _initCircle(callback) {\r\n    d3.select(this.target).on('click', () => {\r\n      const item = d3.event.target;\r\n      const nodeName = item.nodeName;\r\n      const validPlace = (nodeName === 'image');\r\n      // const isCircle = (__hasClass(item, 'svg-circle'));\r\n\r\n      if (!validPlace) {\r\n        return;\r\n      }\r\n\r\n      SVGDraw.createCircle(this.target);\r\n      callback();\r\n\r\n      d3.event.preventDefault();\r\n    }, false);\r\n  }\r\n\r\n  _initComicBubbles() {\r\n    const $comicBubbles = this.target.querySelectorAll('.svg-komiks .svg-textarea');\r\n\r\n    if ($comicBubbles) {\r\n      $comicBubbles.forEach(($comicBubble) => {\r\n        SVGText.comicBubblesEventsManager(this.target, $comicBubble);\r\n      });\r\n    }\r\n  }\r\n\r\n  _generateNewID(oldID) {\r\n    const idParts = oldID.split('_');\r\n    // beware if it's a error, return oldID\r\n    if (idParts.length < 2) {\r\n      console.log('Svg ID error!', oldID);\r\n      return oldID;\r\n    }\r\n\r\n    // solve thirt part of id\r\n    if (idParts[idParts.length - 1] !== `clone-${idParts[0]}`) {\r\n      idParts.push(`clone-${idParts[0]}`);\r\n    }\r\n\r\n    // solve first part of id\r\n    idParts[0] = this.target.id;\r\n\r\n    const newID = idParts.join('_');\r\n    return newID;\r\n  }\r\n\r\n  _getEvents() {\r\n\r\n    const svgDuplicateSources = this.toDuplicate ? this.toDuplicate.split(' ') : [];\r\n\r\n    if (svgDuplicateSources[0]) {\r\n\r\n      document.addEventListener('svg.change', (e) => {\r\n        if (svgDuplicateSources.includes(e.detail.svg.id)) {\r\n          const $templateNode = e.detail.svg.node;\r\n          const nodeName = e.detail.svg.nodeName;\r\n          const localNodeID = this._generateNewID($templateNode.id);\r\n          let $localNode = this.target.querySelector(`#${localNodeID}`);\r\n          let task;\r\n          // for creating new element or we edit the old one after created one\r\n          if ($localNode || e.detail.svg.task === 'create') {\r\n            task = e.detail.svg.task;\r\n          } else {\r\n            return;\r\n          }\r\n\r\n          /**\r\n           * 1. divided by node name\r\n           * 2. divided by task type\r\n           * path => svg lines\r\n           * TEXTAREA => text fields or comic bubbles\r\n           * foreignObject => svg circles\r\n           */\r\n          if (nodeName === 'path') {\r\n            switch (task) {\r\n              case 'create':\r\n                this._clonePath($templateNode, localNodeID);\r\n                break;\r\n              case 'color':\r\n                __removeClass($localNode, 'red blue');\r\n                __addClass($localNode, e.detail.svg.color);\r\n                break;\r\n              case 'remove':\r\n                $localNode.remove();\r\n                break;\r\n              default:\r\n                console.log('Nondefinated path events task. :(');\r\n            }\r\n          } else if (nodeName === 'TEXTAREA') {\r\n            if (e.detail.svg.isBubble) {\r\n              switch (task) {\r\n                case 'create':\r\n                  this._cloneComicBubbles($templateNode, localNodeID);\r\n                  break;\r\n                case 'change':\r\n                  if ($templateNode.value.length !== 0) {\r\n                    $localNode.value = $templateNode.value;\r\n                    // if needs resize\r\n                    if ($localNode.style.height !== $templateNode.style.height) {\r\n                      $localNode.style.height = $templateNode.style.height;\r\n                    }\r\n                  } else {\r\n                    $localNode.parentElement.remove();\r\n                  }\r\n                  break;\r\n                default:\r\n                  console.log('Nondefinated comicBubble events task. :(');\r\n              }\r\n            } else {\r\n              switch (task) {\r\n                case 'create':\r\n                  this._cloneTextField(e.detail.svg.isWrong, $templateNode, localNodeID);\r\n                  break;\r\n                case 'change':\r\n                  $localNode.value = $templateNode.value;\r\n                  // if is now wrong lenght\r\n                  if (e.detail.svg.isWrong) {\r\n                    __addClass($localNode, 'is-wrong');\r\n                  } else {\r\n                    __removeClass($localNode, 'is-wrong');\r\n                  }\r\n                  // if needs resize\r\n                  if ($localNode.style.height !== $templateNode.style.height) {\r\n                    $localNode.style.height = $templateNode.style.height;\r\n                  }\r\n                  break;\r\n                case 'color':\r\n                  $localNode = $localNode.parentElement.childNodes[0];\r\n                  __removeClass($localNode, 'red blue');\r\n                  __addClass($localNode, e.detail.svg.color);\r\n                  break;\r\n                case 'move':\r\n                  if ($localNode) {\r\n                    $localNode.parentElement.remove();\r\n                  }\r\n                  this._cloneTextField(e.detail.svg.isWrong, $templateNode, localNodeID);\r\n                  break;\r\n                case 'remove':\r\n                  $localNode.parentElement.remove();\r\n                  break;\r\n                default:\r\n                  console.log('Nondefinated textField events task. :(');\r\n              }\r\n            }\r\n          } else if (nodeName === 'foreignObject') {\r\n            switch (task) {\r\n              case 'create':\r\n                this._cloneCircle($templateNode, localNodeID);\r\n                break;\r\n              case 'color':\r\n                $localNode = $localNode.childNodes[0];\r\n                __removeClass($localNode, 'red blue');\r\n                __addClass($localNode, e.detail.svg.color);\r\n                break;\r\n              case 'move':\r\n                if ($localNode) {\r\n                  $localNode.remove();\r\n                }\r\n                this._cloneCircle($templateNode, localNodeID);\r\n                break;\r\n              case 'remove':\r\n                $localNode.remove();\r\n                break;\r\n              default:\r\n                console.log('Nondefinated circle events task. :(');\r\n            }\r\n          } else {\r\n            console.log('Nondefinated events nodeName. :(', nodeName);\r\n          }\r\n        }\r\n      });\r\n\r\n    }\r\n\r\n  }\r\n\r\n  _clonePath($templateNode, localNodeID) {\r\n    const $localNode = $templateNode.cloneNode(true);\r\n    $localNode.id = localNodeID;\r\n    this.target.appendChild($localNode);\r\n    // add events to element\r\n    SVGDraw.pathEventsManager(this.target, $localNode);\r\n  }\r\n\r\n  _cloneTextField(isWrong, $templateNode, localNodeID) {\r\n    const $localNode = $templateNode.parentElement.cloneNode(true);\r\n    $localNode.childNodes[1].id = localNodeID;\r\n    this.target.appendChild($localNode);\r\n    if (isWrong) {\r\n      __addClass($localNode, 'is-wrong');\r\n    } else {\r\n      __removeClass($localNode, 'is-wrong');\r\n    }\r\n    // add events to element\r\n    SVGText.textEventsManager(this.target, $localNode.childNodes[1], false);\r\n  }\r\n\r\n  _cloneCircle($templateNode, localNodeID) {\r\n    const $localNode = $templateNode.cloneNode(true);\r\n    $localNode.id = localNodeID;\r\n    this.target.appendChild($localNode);\r\n    // add events to element\r\n    SVGDraw.circleEventsManager(this.target, $localNode);\r\n  }\r\n\r\n  _cloneComicBubbles($templateNode, localNodeID) {\r\n    const $localNode = $templateNode.parentElement.cloneNode(true);\r\n    $localNode.childNodes[1].id = localNodeID;\r\n    this.target.appendChild($localNode);\r\n    // add events to element\r\n    SVGText.comicBubblesEventsManager(this.target, $localNode.childNodes[1]);\r\n  }\r\n\r\n  static selectItem(item) {\r\n    item.setAttribute('data-svg-selected', 'true');\r\n  }\r\n\r\n  // Remove 'selected' classname from element within SVG\r\n  static deselectItem() {\r\n    // previously \"selected\" elements\r\n    const selected = document.querySelectorAll('[data-svg-selected=\"true\"]');\r\n    // unselect them\r\n    for (let i = 0; i < selected.length; i += 1) {\r\n      selected[i].setAttribute('data-svg-selected', 'false');\r\n    }\r\n  }\r\n\r\n  // Remove element from within SVG\r\n  // [data-svg-selected=\"true\"] marks selected element in SVG\r\n  static removeItem(isRadial, element = '[data-svg-selected=\"true\"]') {\r\n    let $element = document.querySelector(element);\r\n    let nodeName = $element.nodeName;\r\n    const $parent = $element.parentElement; // for <foreignObject>\r\n\r\n    // TEXTAREA => text field(right click in textarea)\r\n    // DIV => text field(click in radial menu) or circle\r\n    switch (nodeName) {\r\n      case 'path':\r\n        // $element = $element;\r\n        break;\r\n      case 'TEXTAREA':\r\n        // $element = $element;\r\n        break;\r\n      case 'DIV':\r\n        if ($parent.childNodes[1]) {\r\n          $element = $parent.childNodes[1];\r\n        } else {\r\n          $element = $parent;\r\n        }\r\n        nodeName = $element.nodeName;\r\n        break;\r\n      default:\r\n        console.log('Nondefinated node type. :(', nodeName);\r\n    }\r\n\r\n    // get svg id from object id\r\n    const svgID = $element.id.split('_')[0];\r\n\r\n    // dispatch event that svg has changed\r\n    __dispatchEvent(document, 'svg.change', {}, {\r\n      svg: {\r\n        id: svgID,\r\n        task: 'remove',\r\n        node: $element,\r\n        nodeName,\r\n        contextMenu: isRadial,\r\n      },\r\n    });\r\n\r\n    if ($parent.nodeName === 'foreignObject') {\r\n      d3.select($parent).remove();\r\n    } else {\r\n      d3.select($element).remove();\r\n    }\r\n  }\r\n\r\n  // Unmark all SVGs with 'svg-active' classname\r\n  static deactivate() {\r\n    const allActiveSvgs = document.querySelectorAll('[data-svg-active=\"true\"]');\r\n    for (let i = 0; i < allActiveSvgs.length; i += 1) {\r\n      allActiveSvgs[i].setAttribute('data-svg-active', 'false');\r\n    }\r\n  }\r\n\r\n  // Mark active SVG with 'svg-active' classname\r\n  static activate(svg) {\r\n    SVG.deactivate();\r\n    svg.setAttribute('data-svg-active', 'true');\r\n  }\r\n\r\n  // Remove connection between clone and template\r\n  // Remove third part of id if exists\r\n  static removeCloneConnectionManager($node) {\r\n    const idParts = $node.id.split('_');\r\n    if (idParts[idParts.length - 1].includes('clone')) {\r\n      idParts.pop();\r\n      $node.id = idParts.join('_');\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n}\r\n","/* eslint-disable brace-style */\r\nimport {\r\n  __addClass,\r\n  __removeClass,\r\n  __hasClass,\r\n  __localPosition,\r\n  __globalPosition,\r\n  __dispatchEvent,\r\n} from '../../lib/utils';\r\nimport SVG from '../svg';\r\nimport SVGText from './svg-text';\r\n\r\nexport default class SVGRadialMenu {\r\n\r\n  constructor($radialMenu, $svgs) {\r\n    this.$radialMenu = $radialMenu;\r\n    this.$radialMenuItems = this.$radialMenu.querySelectorAll('[data-radial-menu-item]');\r\n    this.$colorItems = this.$radialMenu.querySelectorAll('.radial-menu-color');\r\n    this.$textItems = this.$radialMenu.querySelectorAll('.radial-menu-text');\r\n    this.$createTextItem = this.$radialMenu.querySelector('#create-text');\r\n    this.$removeItem = this.$radialMenu.querySelector('#remove-content');\r\n    this.$tooltip = this.$radialMenu.querySelector('[data-radial-menu-tooltip]');\r\n    this.$svgs = $svgs;\r\n\r\n    this.initialSetUp = true;\r\n\r\n    this.menuRadius = parseInt(window.getComputedStyle(this.$radialMenu.querySelector('.radial-menu-wrapper'), null).getPropertyValue('width'), 10) / 2;\r\n    this.itemRadius = parseInt(window.getComputedStyle(this.$radialMenu.querySelector('.radial-menu-item'), null).getPropertyValue('width'), 10) / 2;\r\n\r\n    this.init();\r\n  }\r\n\r\n  init() {\r\n    this.setUpRadialMenuItems();\r\n    this.addEventListenersToRadialMenu();\r\n\r\n    // activate radial menu when right click on svg\r\n    Array.from(this.$svgs).forEach(($svg) => {\r\n      d3.select($svg).on('contextmenu', () => {\r\n        // mark this SVG as the active one\r\n        SVG.activate($svg);\r\n        // deselect all previously selected items\r\n        SVG.deselectItem();\r\n        // show radial menu buttons based on clicked element\r\n        // and .select appropriate elements based on clicked element\r\n        this.filterMenuButtons(d3.event.target);\r\n        this.showRadialMenu($svg, d3.event);\r\n        // prevent default 'contextmenu' event\r\n        d3.event.preventDefault();\r\n      });\r\n    });\r\n\r\n    this.initialSetUp = false;\r\n  }\r\n\r\n  setUpRadialMenuItems() {\r\n    // this.positionRadialMenuItems(this.$radialMenuItems);\r\n\r\n    Array.from(this.$radialMenuItems).forEach(($item) => {\r\n      this.addEventListenersToRadialMenuItem($item);\r\n    });\r\n  }\r\n\r\n  positionRadialMenuItems($items) {\r\n    const _itemsLength = $items.length;\r\n    const _menuRadius = this.menuRadius;\r\n    const _itemRadius = this.itemRadius;\r\n    const _menuOffset = _menuRadius - _itemRadius;\r\n    const _interval = 0.6283185307;\r\n    // if more items center them\r\n    const _centerOffset = (-_interval / 2) + ((_itemsLength * _interval) / 2);\r\n\r\n    // make a \"flower\"\r\n    Array.from($items).forEach(($item, index) => {\r\n      // Calculate the angle at which the element will be placed.\r\n      // For a semicircle, we would use (index / _itemsLength) * Math.PI.\r\n      const angle = (Math.PI + ((index * _interval) * -1)) + _centerOffset;\r\n\r\n      // get position\r\n      const x = (_menuRadius * Math.sin(angle)) + _menuOffset;\r\n      const y = (_menuRadius * Math.cos(angle)) + _menuOffset;\r\n\r\n      // console.log('x: ' + x);\r\n      // console.log('y: ' + y);\r\n\r\n      $item.style.left = `${x.toFixed(1)}px`;\r\n      $item.style.top = `${y.toFixed(1)}px`;\r\n\r\n      // if (this.initialSetUp === true) {\r\n      //   this.addEventListenersToRadialMenuItem($item);\r\n      // }\r\n    });\r\n  }\r\n\r\n  addEventListenersToRadialMenu() {\r\n    this.onMouseLeave();\r\n\r\n    this.$radialMenu.addEventListener('click', (event) => {\r\n      this.hideRadialMenu(this.$radialMenu);\r\n      event.preventDefault();\r\n    });\r\n\r\n    this.$radialMenu.addEventListener('contextmenu', (event) => {\r\n      this.hideRadialMenu(this.$radialMenu);\r\n      event.preventDefault();\r\n    });\r\n  }\r\n\r\n  addEventListenersToRadialMenuItem(item) {\r\n    const $item = item;\r\n\r\n    // actions\r\n    const action = $item.getAttribute('data-radial-menu-item');\r\n    // remove item\r\n    if (action === 'remove-content') {\r\n      $item.addEventListener('click', () => {\r\n        SVG.removeItem(true);\r\n        this.hideRadialMenu();\r\n      }, false);\r\n    }\r\n    // create user text\r\n    else if (action === 'create-text') {\r\n      d3.select($item).on('click', () => {\r\n        SVGText.createText();\r\n        this.hideRadialMenu();\r\n      }, false);\r\n    }\r\n    // označit podobnost\r\n    else if (action === 'color-point-blue') {\r\n      $item.addEventListener('click', () => {\r\n        SVGRadialMenu.changeColor('blue');\r\n        this.hideRadialMenu();\r\n      }, false);\r\n    }\r\n    // označit rozdil\r\n    else if (action === 'color-point-red') {\r\n      $item.addEventListener('click', () => {\r\n        SVGRadialMenu.changeColor('red');\r\n        this.hideRadialMenu();\r\n      }, false);\r\n    }\r\n    // označit rozdil\r\n    else if (action === 'color-point-red') {\r\n      $item.addEventListener('click', () => {\r\n        SVGRadialMenu.changeColor('red');\r\n        this.hideRadialMenu();\r\n      }, false);\r\n    }\r\n    // přiřadit kategorii\r\n    // else if (action === 'category') {\r\n    //   const category = $item.getAttribute('data-category');\r\n    //   const categoryLabel = $item.getAttribute('data-radial-menu-item-tooltip');\r\n\r\n    //   $item.addEventListener('click', () => {\r\n    //     const $selected = document.querySelector('[data-svg-selected=\"true\"]');\r\n    //     const $parentForeignObject = $selected.parentElement;\r\n    //     let $category = $parentForeignObject.querySelector('.svg-category-label');\r\n\r\n    //     $selected.setAttribute('data-svg-category', category);\r\n\r\n    //     if (!$category) {\r\n    //       $category = document.createElement('div');\r\n    //       $category.classList.add('svg-category-label');\r\n    //       $parentForeignObject.prepend($category);\r\n    //     }\r\n\r\n    //     $category.innerText = categoryLabel;\r\n\r\n    //     this.hideRadialMenu();\r\n    //   }, false);\r\n    // }\r\n\r\n    // tooltip\r\n    $item.addEventListener('mouseenter', (event) => {\r\n      this.$tooltip.innerHTML = event.currentTarget.getAttribute('data-radial-menu-item-tooltip');\r\n      this.$tooltip.style.display = 'block';\r\n    }, false);\r\n    $item.addEventListener('mouseleave', () => {\r\n      this.$tooltip.innerHTML = '';\r\n      this.$tooltip.style.display = 'none';\r\n    }, false);\r\n  }\r\n\r\n  // Draw a SVG circle on click\r\n  static changeColor(color, element = '[data-svg-selected=\"true\"]') {\r\n    let $element = document.querySelector(element);\r\n    let nodeName = $element.nodeName;\r\n    let taskType = 'color';\r\n\r\n    __removeClass($element, 'red blue');\r\n    __addClass($element, color);\r\n\r\n    // DIV => text field  or circle\r\n    switch (nodeName) {\r\n      case 'path':\r\n        // $element = $element;\r\n        break;\r\n      case 'DIV':\r\n        if ($element.parentElement.childNodes[1]) {\r\n          $element = $element.parentElement.childNodes[1];\r\n        } else {\r\n          $element = $element.parentElement;\r\n        }\r\n        nodeName = $element.nodeName;\r\n        break;\r\n      default:\r\n        console.log('Nondefinated node type. :(', nodeName);\r\n    }\r\n\r\n    // if clone is changed, then dispatch create event\r\n    if (SVG.removeCloneConnectionManager($element)) taskType = 'create';\r\n\r\n    // get svg id from object id\r\n    const svgID = $element.id.split('_')[0];\r\n\r\n    // dispatch event that svg has changed\r\n    __dispatchEvent(document, 'svg.change', {}, {\r\n      svg: {\r\n        id: svgID,\r\n        task: taskType,\r\n        node: $element,\r\n        nodeName,\r\n        contextMenu: true,\r\n        color,\r\n      },\r\n    });\r\n  }\r\n\r\n  showRadialMenu($activeSVG, event) {\r\n    const $svg = $activeSVG || document.querySelector('[data-svg-active=\"true\"]');\r\n    // get global position of the right click event\r\n    const globalPosition = __globalPosition(event);\r\n    const localPosition = __localPosition($svg);\r\n    this.$radialMenu.setAttribute('data-local-x', localPosition.x);\r\n    this.$radialMenu.setAttribute('data-local-y', localPosition.y);\r\n    // set position of radial menu\r\n    // number of 13 is size of #radial-menu\r\n    this.$radialMenu.style.top = `${globalPosition.y - 7}px`;\r\n    this.$radialMenu.style.left = `${globalPosition.x - 7}px`;\r\n\r\n    // make a flower\r\n    const $activeRadialMenuItem = this.$radialMenu.querySelectorAll('.is-active');\r\n    this.positionRadialMenuItems($activeRadialMenuItem);\r\n\r\n    // show radial menu\r\n    __addClass(this.$radialMenu, 'is-active');\r\n\r\n    // return {\r\n    //   localPosition,\r\n    //   globalPosition,\r\n    // };\r\n  }\r\n\r\n  hideRadialMenu() {\r\n    // hide radial menu\r\n    __removeClass(this.$radialMenu, 'is-active');\r\n    // deactivate all SVGs\r\n    SVG.deactivate();\r\n    // deselect all SVG items\r\n    SVG.deselectItem();\r\n\r\n    // deactivate radial menu items when the menu is hidden\r\n    setTimeout(() => {\r\n      if (!__hasClass(this.$radialMenu, 'is-active')) {\r\n        Array.from(this.$radialMenuItems).forEach(($item) => {\r\n          __removeClass($item, 'is-active');\r\n        });\r\n      }\r\n    }, 150);\r\n  }\r\n\r\n  onMouseLeave() {\r\n    let mouseLeaveDelay;\r\n\r\n    this.$radialMenu.addEventListener('mouseleave', () => {\r\n      mouseLeaveDelay = setTimeout(() => {\r\n        this.hideRadialMenu(this.$radialMenu);\r\n      }, 500);\r\n    });\r\n\r\n    this.$radialMenu.addEventListener('mouseenter', () => {\r\n      clearTimeout(mouseLeaveDelay);\r\n    });\r\n  }\r\n\r\n  filterMenuButtons(clickedItem) {\r\n    if (__hasClass(clickedItem, 'svg-path') || clickedItem.nodeName === 'path') {\r\n      __addClass(this.$createTextItem, 'is-active');\r\n      // __addClass(this.$removeItem, 'is-active');\r\n\r\n      Array.from(this.$colorItems).forEach(($colorItem) => {\r\n        __addClass($colorItem, 'is-active');\r\n      });\r\n\r\n      Array.from(this.$textItems).forEach(($textItem) => {\r\n        __removeClass($textItem, 'is-active');\r\n      });\r\n\r\n      // mark it as slected\r\n      // SVG.selectItem(clickedItem);\r\n    }\r\n    if (__hasClass(clickedItem, 'svg-circle')) {\r\n      __addClass(this.$createTextItem, 'is-active');\r\n      // __addClass(this.$removeItem, 'is-active');\r\n\r\n      Array.from(this.$colorItems).forEach(($colorItem) => {\r\n        __addClass($colorItem, 'is-active');\r\n      });\r\n\r\n      Array.from(this.$textItems).forEach(($textItem) => {\r\n        __removeClass($textItem, 'is-active');\r\n      });\r\n\r\n      // mark it as slected\r\n      // SVG.selectItem(clickedItem);\r\n    }\r\n    if (__hasClass(clickedItem, 'svg-textarea')) {\r\n      __removeClass(this.$createTextItem, 'is-active');\r\n      // __addClass(this.$removeItem, 'is-active');\r\n\r\n      if (!__hasClass(clickedItem, 'do-not-remove')) {\r\n        Array.from(this.$colorItems).forEach(($colorItem) => {\r\n          __removeClass($colorItem, 'is-active');\r\n        });\r\n\r\n        Array.from(this.$textItems).forEach(($textItem) => {\r\n          __addClass($textItem, 'is-active');\r\n        });\r\n      }\r\n\r\n      // mark it as slected\r\n      // SVG.selectItem(clickedItem);\r\n    }\r\n    if (clickedItem.nodeName === 'image') {\r\n      __addClass(this.$createTextItem, 'is-active');\r\n      __removeClass(this.$removeItem, 'is-active');\r\n\r\n      Array.from(this.$colorItems).forEach(($colorItem) => {\r\n        __removeClass($colorItem, 'is-active');\r\n      });\r\n\r\n      Array.from(this.$textItems).forEach(($textItem) => {\r\n        __removeClass($textItem, 'is-active');\r\n      });\r\n    }\r\n    else {\r\n      if (__hasClass(clickedItem, 'do-not-remove')) {\r\n        __removeClass(this.$removeItem, 'is-active');\r\n      } else {\r\n        __addClass(this.$removeItem, 'is-active');\r\n      }\r\n      // mark it as slected\r\n      SVG.selectItem(clickedItem);\r\n    }\r\n  }\r\n}\r\n","export default class Observer {\r\n\r\n  constructor() {\r\n    this._events = [];\r\n  }\r\n\r\n  /**\r\n   * Add event listener\r\n   *\r\n   * {String} events - e.g. 'my-event-1 my-event-2'\r\n   * {Function} fn - event listener\r\n   */\r\n  on(events, fn) {\r\n\r\n    events = this._split(events);\r\n\r\n    events.forEach((event) => {\r\n\r\n      if (!this._events[event]) {\r\n        this._events[event] = [];\r\n      }\r\n\r\n      this._events[event].push(fn);\r\n    });\r\n\r\n  }\r\n\r\n  off(events, fn) {\r\n\r\n    events = this._split(events);\r\n\r\n    events.forEach((event) => {\r\n\r\n      if (!this._events[event]) { return; }\r\n\r\n      this.events[event] = this._events[event].filter((current_fn) => {\r\n        return current_fn !== fn;\r\n      });\r\n\r\n    });\r\n\r\n\r\n  }\r\n\r\n  // something like dispatchEvent\r\n  trigger(events, args) {\r\n\r\n    events = this._split(events);\r\n\r\n    console.log(events, args);\r\n\r\n    events.forEach((event) => {\r\n\r\n      if (!this._events[event]) { return; }\r\n\r\n      this._events[event].forEach((fn) => {\r\n        fn.call(this, event, args);\r\n      });\r\n\r\n    });\r\n\r\n  }\r\n\r\n  _split(events) {\r\n    return events.replace(/^\\s+|\\s+$/g, '').split(/\\s+/);\r\n  }\r\n\r\n}\r\n","const actionTypes = {\r\n  editor: {\r\n    id: 'editor',\r\n    ADD_TAG: 'editor:ADD_TAG',\r\n    DELETE_TAG: 'editor:DELETE_TAG',\r\n    UPDATE_TAG: 'editor:UPDATE_TAG',\r\n    CHANGE: 'editor:CHANGE',\r\n  },\r\n  keywords: {\r\n    id: 'keywords',\r\n    CHANGE: 'keywords:CHANGE',\r\n  },\r\n  testQuiz: {\r\n    id: 'testQuiz',\r\n    ADD_ANSWER: 'testQuiz:ADD_ANSWER',\r\n    REMOVE_ANSWER: 'testQuiz:REMOVE_ANSWER',\r\n    UPDATE_ANSWER: 'testQuiz:UPDATE_ANSWER',\r\n    CHANGE: 'testQuiz:CHANGE',\r\n  },\r\n  textOptions: {\r\n    id: 'textOptions',\r\n    ADD: 'textOptions:ADD',\r\n    DELETE: 'textOptions:DELETE',\r\n    UPDATE: 'textOptions:UPDATE',\r\n    CHANGE: 'textOptions:CHANGE',\r\n  },\r\n  store: {\r\n    id: 'store',\r\n    ADD: 'ADD',\r\n    DELETE: 'DELETE',\r\n    UPDATE: 'UPDATE',\r\n    CHANGE: 'CHANGE',\r\n  },\r\n};\r\n\r\n\r\nexport default actionTypes;\r\n","import Observer from './observer';\r\nimport actionTypes from './store-constants';\r\n\r\n/*\r\nconst tagContainer: Object = {\r\n  editorId?: number,\r\n  id: string,\r\n  tagName: string,\r\n  tag: HTMLElement,\r\n  data?: Object\r\n}\r\n*/\r\n\r\n\r\nclass Store extends Observer {\r\n\r\n  constructor() {\r\n    super();\r\n\r\n    /* here the global space for storing objects and data */\r\n    this._data = {};\r\n    this._data.tags = [];\r\n  }\r\n\r\n  _checkTagExists(tagId) {\r\n    let tagExists = false;\r\n    this._data.tags.forEach((item, i) => {\r\n\r\n      if (item.id === tagId) {\r\n        tagExists = { item, index: i };\r\n      }\r\n\r\n    });\r\n\r\n    return tagExists;\r\n  }\r\n\r\n  addTag(tagContainer) {\r\n\r\n    if (this._data.tags.length === 0 || !this._checkTagExists(tagContainer.id)) {\r\n\r\n      if (undefined === tagContainer.data.userSelectedNodeItems) {\r\n        tagContainer.data.userSelectedNodeItems = [];\r\n      }\r\n\r\n      this._data.tags.push(tagContainer);\r\n\r\n      store.trigger(actionTypes.editor.CHANGE, {\r\n        action: {\r\n          id: actionTypes.editor.id,\r\n          type: actionTypes.editor.ADD_TAG,\r\n          data: {\r\n            tagContainer,\r\n          },\r\n        },\r\n\r\n      });\r\n\r\n    } else {\r\n      throw new Error('Tag already exists! Will not add it.');\r\n    }\r\n\r\n  }\r\n\r\n  deleteTag(tagContainer) {\r\n\r\n    let tagExists = this._checkTagExists(tagContainer.id);\r\n\r\n    if (tagExists !== false) {\r\n\r\n      this._data.tags.splice(tagExists.index, 1);\r\n\r\n      store.trigger(actionTypes.editor.CHANGE, {\r\n        action: {\r\n          id: actionTypes.editor.id,\r\n          type: actionTypes.editor.DELETE_TAG,\r\n          data: {\r\n            tagContainer: {\r\n              editorId: tagContainer.editorId,\r\n              id: tagContainer.id,\r\n              tagName: tagContainer.tagName,\r\n              data: {},\r\n            },\r\n          },\r\n        },\r\n\r\n      });\r\n\r\n      return true;\r\n    }\r\n\r\n    throw new Error('Tag does not exist! Will not delete it.');\r\n  }\r\n\r\n  getAllTags(opts) {\r\n\r\n\r\n    if (undefined === opts || !opts.editorId) { return this._data.tags; }\r\n\r\n    const selectedTags = this._data.tags.filter((item) => item.editorId === opts.editorId);\r\n\r\n    return selectedTags;\r\n  }\r\n\r\n  getTagsBy(opts) {\r\n\r\n    const allowedKeys = ['editorId', 'id', 'tagName'];\r\n\r\n    if (opts === undefined) { return false; }\r\n    if (allowedKeys.indexOf(opts.key) === -1) { return false; }\r\n\r\n    if (!Array.isArray(opts.value)) {\r\n      opts.value = [opts.value];\r\n    }\r\n\r\n    // console.log(opts.value);\r\n    // console.log(this._data.tags);\r\n\r\n    const selectedTags = this._data.tags.filter((item) => (item[opts.key] === opts.value[0]) || (item[opts.key] === opts.value[1]));\r\n\r\n    return selectedTags;\r\n  }\r\n\r\n  getLastTag(opts) {\r\n\r\n    if (undefined === opts || !opts.editorId) {\r\n      return this._data.tags[this._data.tags.length - 1];\r\n    }\r\n\r\n    const selectedTags = this._data.tags.filter((item) => item.editorId === opts.editorId);\r\n\r\n    return selectedTags[selectedTags.length - 1];\r\n  }\r\n}\r\n\r\nconst store = new Store();\r\nexport default store;\r\n","import Observer from './observer';\r\nimport actionTypes from './store-constants';\r\n\r\nclass StoreGlobal extends Observer {\r\n\r\n  constructor() {\r\n\r\n    super();\r\n\r\n    /* here the global space for storing objects and data */\r\n    this._data = [];\r\n\r\n  }\r\n\r\n  _checkExists(id) {\r\n    let objectExists = false;\r\n    this._data.forEach((item, i) => {\r\n\r\n      if (item.id === id) {\r\n        objectExists = { item, index: i };\r\n      }\r\n\r\n    });\r\n\r\n    return objectExists;\r\n  }\r\n\r\n  add(data) {\r\n\r\n    // console.log('add global called');\r\n\r\n    if (this._data.length === 0 || !this._checkExists(data.id)) {\r\n\r\n      this._data.push(data);\r\n\r\n      store.trigger(actionTypes.textOptions.id, {\r\n        action: {\r\n          type: actionTypes.textOptions.ADD,\r\n        },\r\n        data,\r\n      });\r\n\r\n    } else {\r\n      throw new Error('Object already exists! Will not add it.');\r\n    }\r\n\r\n  }\r\n\r\n  delete(data) {\r\n\r\n    const objectExists = this._checkExists(data.id);\r\n\r\n    if (objectExists !== false) {\r\n\r\n      this._data.splice(objectExists.index, 1);\r\n\r\n      store.trigger(actionTypes.textOptions.id, {\r\n        action: {\r\n          type: actionTypes.textOptions.DELETE,\r\n        },\r\n        data,\r\n      });\r\n\r\n      return true;\r\n\r\n    }\r\n    throw new Error('Tag does not exist! Will not delete it.');\r\n\r\n\r\n  }\r\n\r\n  getAll(opts) {\r\n\r\n    if (undefined === opts || !opts.editor) { return this._data; }\r\n\r\n    const selectedObjs = this._data.filter((item) => item.id === opts.id);\r\n\r\n    return selectedObjs;\r\n  }\r\n\r\n  getBy(opts) {\r\n\r\n    const allowedKeys = ['id'];\r\n\r\n    if ((opts === undefined) || (allowedKeys.indexOf(opts.key) === -1)) {\r\n      return false;\r\n    }\r\n\r\n    if (!Array.isArray(opts.value)) {\r\n      opts.value = [opts.value];\r\n    }\r\n\r\n    const selectedObjs = this._data.filter((item) => (item[opts.key] === opts.value[0]) || (item[opts.key] === opts.value[1]));\r\n\r\n    return selectedObjs;\r\n\r\n  }\r\n\r\n  getLast(opts) {\r\n\r\n    if (undefined === opts || !opts.editor) {\r\n      return this._data[this._data.length - 1];\r\n    }\r\n\r\n    const selectedObjs = this._data.filter((item) => item.id === opts.id);\r\n\r\n    return selectedObjs[selectedObjs.length - 1];\r\n  }\r\n\r\n}\r\n\r\nconst store = new StoreGlobal();\r\nexport default store;\r\n","import {\r\n  __mergeDeep,\r\n  __hasClass,\r\n  __addClass,\r\n  __removeClass,\r\n  __position,\r\n  __positionTranslated,\r\n  __remove,\r\n  __getRealDimensions,\r\n  __insertBefore,\r\n  __keycodeIsPrintableCharacter,\r\n  __toggleClass,\r\n  __dispatchEvent,\r\n} from '../../lib/utils';\r\nimport store from '../../store/store';\r\nimport storeGlobal from '../../store/store-global';\r\nimport Component from '../component';\r\n// import actionTypes from '../store/store-constants';\r\n\r\n\r\nexport default class Editor extends Component {\r\n\r\n  constructor(element) {\r\n    super(element);\r\n\r\n    // TODO: should extend default Component class and use this.target?\r\n    // this.$editor is better, more readable\r\n    this.$editor = this.target;\r\n    this.id = this.$editor.id;\r\n    // TODO: is DOM element before/after the editor itself.. move it to the editor?\r\n    this.settings = JSON.parse(document.querySelector(`[data-editor-id-reference=\"${this.id}\"]`).getAttribute('data-module-settings'));\r\n\r\n    this.opts = __mergeDeep(Editor.defaults, this.settings);\r\n\r\n    this.models = {\r\n      passive: [\r\n        'cteni',\r\n      ],\r\n      interactive: [\r\n        'predznaceny', 'zvyraznovani', 'komentáře', 'psani',\r\n      ],\r\n      withMenu: [\r\n        'predznaceny', 'zvyraznovani', 'komentáře',\r\n      ],\r\n    };\r\n\r\n    this.totalTagId = 0;\r\n\r\n    this.hasMenu = true;\r\n\r\n    this.selection = null;\r\n    this.lastSelectionSettings = {};\r\n    this.isCollapsed = null;\r\n    this.savedSelectionRange = null;\r\n    this.selectionAttributes = null;\r\n    this.dummyRangeElement = null;\r\n\r\n    this.selectionMouseDown = false;\r\n    this.selectionDirection = null;\r\n\r\n    this.hasEditableContentChanged = false;\r\n    this.lastPressedKey = null;\r\n\r\n    this.hasToolbar = false;\r\n    this.toolbar = {};\r\n\r\n    this.originalContent = {};\r\n    this.currentContent = {};\r\n\r\n    this._handlers = [];\r\n\r\n    this.wrapLastDeletesTimeoutClass = '';\r\n    this.wrapLastDeletesTimeoutFunction = () => { };\r\n    this.wrapLastAdditionsTimeoutClass = '';\r\n    this.wrapLastAdditionsTimeoutFunction = () => { };\r\n    this.isWrappingLastText = false;\r\n    this.isWriting = false;\r\n\r\n    this.$groupDeleted = null;\r\n\r\n    this.cache = {\r\n      body: document.body,\r\n      window,\r\n    };\r\n\r\n    this.init();\r\n  }\r\n\r\n  init() {\r\n    if (Editor._hasMenu(this.opts)) {\r\n      try {\r\n        this.$menu = this.$editor.getElementsByClassName(this.opts.menuClass)[0];\r\n\r\n        // TODO: generalize .item class via defaults and opts\r\n        this.$menuActions = this.$menu.getElementsByClassName('menu')[0].getElementsByClassName('menu-item');\r\n        this.$menuClose = this.$menu.getElementsByClassName('close')[0];\r\n      } catch (error) {\r\n        this.hasMenu = false;\r\n      }\r\n    } else {\r\n      this.hasMenu = false;\r\n    }\r\n\r\n    if (Editor._hasToolbar(this.opts)) {\r\n      this.hasToolbar = true;\r\n    }\r\n\r\n    this.$canvas = this.$editor.getElementsByClassName(this.opts.canvasClass)[0];\r\n\r\n    // only if the editor is INTERACTIVE\r\n    if (this.opts.funkce !== 'cteni') {\r\n      __addClass(this.$menu, 'hidden');\r\n\r\n      // only if the editor is for WRITING\r\n      if (this.opts.funkce === 'psani') {\r\n        this.originalContent.html = this.$canvas.innerHTML;\r\n        this.originalContent.text = this.$canvas.innerText;\r\n        this.currentContent.html = this.$canvas.innerHTML;\r\n        this.currentContent.text = this.$canvas.innerText;\r\n\r\n        this.wrapLastDeletesTimeoutClass = this._generateNewTagGroupClass();\r\n        this.wrapLastAdditionsTimeoutClass = this._generateNewTagGroupClass();\r\n      }\r\n\r\n      // only if the editor is with extra TOOLBAR\r\n      if (this.hasToolbar) {\r\n        this.toolbar.$element = this.$editor.getElementsByClassName('editor-toolbar')[0];\r\n        this.toolbar.$btnReset = this.toolbar.$element.getElementsByClassName('editor-toolbar-action-reset')[0];\r\n      }\r\n\r\n      this.registerEditableHandlers();\r\n    }\r\n\r\n    // only if the editor is with PREHIGHLIGHTED text\r\n    if (this.opts.funkce === 'predznaceny') {\r\n      this.initPreHighlightedTextOptions();\r\n    }\r\n\r\n  }\r\n\r\n  _generateNewTagId() {\r\n    this.totalTagId = this.totalTagId + 1;\r\n    return `${this.id}-${this.totalTagId}`;\r\n  }\r\n\r\n  _generateNewTagGroupClass() {\r\n    this.totalTagId = this.totalTagId + 1;\r\n    return `group-${this.id}-${this.totalTagId}`;\r\n  }\r\n\r\n  // add all eventListeners\r\n  // TODO: separate special case from universal ones?\r\n  registerEditableHandlers() {\r\n\r\n    this.$canvas.addEventListener('mousedown', this.handlerFocus.bind(this), false);\r\n    this.$canvas.addEventListener('focusout ', this.handlerFocus.bind(this), false);\r\n\r\n    // Necessary when mouseup is outside the $canvas element\r\n    // therefore we have to capture the event outside the element through body element\r\n    this.cache.body.addEventListener('mouseup', this.handlerFocus.bind(this), false);\r\n\r\n\r\n    if (this.opts.funkce === 'psani') {\r\n\r\n      this.$canvas.addEventListener('keydown', (e) => {\r\n\r\n        const selection = window.getSelection();\r\n        const keyCode = e.which || e.keyCode;\r\n        let keyName = e.key;\r\n\r\n        // show OK button or feedback\r\n        this.showFeedback();\r\n\r\n        // start DELETE\r\n        if (keyName === 'Backspace' || keyName === 'Delete') {\r\n          if (selection.rangeCount) {\r\n            window.clearTimeout(this.wrapLastDeletesTimeoutFunction);\r\n\r\n            const range = selection.getRangeAt(0);\r\n            const cloneRange = range.cloneRange();\r\n\r\n            if (this.lastSelectionSettings.isCollapsed) {\r\n\r\n              try {\r\n                cloneRange.setStart(range.startContainer, range.startOffset - 1);\r\n              } catch (e) {\r\n                // backspace was pressed at the beginning of the node\r\n                cloneRange.setStart(range.startContainer, range.startOffset);\r\n                cloneRange.collapse(true);\r\n              }\r\n\r\n            } else {\r\n              cloneRange.setStart(range.startContainer, range.startOffset);\r\n\r\n            }\r\n\r\n            cloneRange.setEnd(range.endContainer, range.endOffset);\r\n\r\n            // do nothing when it's space\r\n            const addedFragment = cloneRange.cloneContents();\r\n            const addedFragmentString = addedFragment.textContent.trim();\r\n\r\n            if ((addedFragmentString !== '' && addedFragmentString !== '&nbsp;') || this.isWrappingLastText) {\r\n\r\n              const dummyElementInner = document.createElement('span');\r\n              dummyElementInner.className = `user-removed-text-inner ${this.wrapLastDeletesTimeoutClass}`;\r\n\r\n              cloneRange.surroundContents(dummyElementInner);\r\n\r\n              selection.removeAllRanges();\r\n              selection.addRange(range);\r\n\r\n              this.wrapLastDeletesTimeoutFunction = setTimeout(() => {\r\n\r\n                this.isWrappingLastText = false;\r\n\r\n                // wrap all previous deletes to one element\r\n                const dummyElement = document.createElement('span');\r\n                dummyElement.contentEditable = false;\r\n                dummyElement.className = 'user-removed-text';\r\n\r\n                const newGeneratedId = this._generateNewTagId();\r\n                dummyElement.id = newGeneratedId;\r\n\r\n                const elements = Array.from(document.getElementsByClassName(this.wrapLastDeletesTimeoutClass));\r\n\r\n                __insertBefore(dummyElement, elements[0]);\r\n\r\n                elements.forEach((el, i) => {\r\n                  dummyElement.appendChild(el);\r\n                });\r\n\r\n\r\n                // create close button\r\n                const $btnClose = document.createElement('span');\r\n                $btnClose.className = this.opts.closeBtnClass;\r\n\r\n                const clickHandler = (e) => {\r\n                  const $nodeElement = e.currentTarget.parentNode;\r\n                  this._removeNodeKeepTextContent($nodeElement);\r\n                  e.stopPropagation();\r\n                };\r\n\r\n                $btnClose.addEventListener('click', clickHandler.bind(this));\r\n\r\n                document.getElementById(newGeneratedId).appendChild($btnClose);\r\n\r\n                this.wrapLastDeletesTimeout = true;\r\n                this.wrapLastDeletesTimeoutClass = this._generateNewTagGroupClass();\r\n\r\n              }, 700);\r\n\r\n              this.isWrappingLastText = true;\r\n\r\n              e.preventDefault();\r\n\r\n            } else {\r\n\r\n              if (!this.isWrappingLastText) {\r\n                // we're removing spaces, do nothing use browser's default behaviour, unless the wrapping is going on\r\n                return;\r\n              }\r\n              e.preventDefault();\r\n            }\r\n          }\r\n        }\r\n        // end DELETE\r\n\r\n        // start WRITING\r\n        else if (__keycodeIsPrintableCharacter(keyCode)) {\r\n\r\n          // if nothing is selected (selection is empty)\r\n          if (this.lastSelectionSettings.isCollapsed) {\r\n\r\n            // if \"space\" was written\r\n            if (keyCode === 32) {\r\n              if (!this.isWrappingLastText) {\r\n                // we're adding spaces, do nothing use browser's default behaviour, unless the wrapping is going on\r\n                return;\r\n              }\r\n              // fill a space as the keyname for the spacebar\r\n              keyName = ' ';\r\n            }\r\n\r\n            // The Selection.rangeCount read-only property returns the number of ranges in the selection.\r\n            if (selection.rangeCount) {\r\n\r\n              window.clearTimeout(this.wrapLastAdditionsTimeoutFunction);\r\n\r\n              const range = selection.getRangeAt(0);\r\n              const cloneRange = range.cloneRange();\r\n\r\n              cloneRange.setStart(range.startContainer, range.startOffset);\r\n              cloneRange.setEnd(range.endContainer, range.endOffset);\r\n\r\n              const textToAddElement = document.createElement('span');\r\n              textToAddElement.contentEditable = false;\r\n              textToAddElement.className = `user-inserted-text-inner ${this.wrapLastAdditionsTimeoutClass}`;\r\n              textToAddElement.innerHTML = keyName;\r\n\r\n              cloneRange.insertNode(textToAddElement);\r\n\r\n              // move the caret after the inserted character\r\n              range.setStartAfter(textToAddElement);\r\n\r\n              selection.removeAllRanges();\r\n              selection.addRange(range);\r\n\r\n              this.wrapLastAdditionsTimeoutFunction = setTimeout(() => {\r\n\r\n                this.isWrappingLastText = false;\r\n\r\n                // wrap all previous deletes to one element\r\n                const dummyElement = document.createElement('span');\r\n                dummyElement.contentEditable = false;\r\n                dummyElement.className = 'user-inserted-text';\r\n\r\n                const newGeneratedId = this._generateNewTagId();\r\n                dummyElement.id = newGeneratedId;\r\n\r\n                const elements = Array.from(document.getElementsByClassName(this.wrapLastAdditionsTimeoutClass));\r\n\r\n                __insertBefore(dummyElement, elements[0]);\r\n\r\n                elements.forEach((el, i) => {\r\n                  dummyElement.appendChild(el);\r\n                });\r\n\r\n\r\n                // create close button\r\n                const $btnClose = document.createElement('span');\r\n                $btnClose.className = this.opts.closeBtnClass;\r\n\r\n                const clickHandler = (e) => {\r\n                  const $nodeElement = e.currentTarget.parentNode;\r\n                  __remove($nodeElement);\r\n                  e.stopPropagation();\r\n                };\r\n\r\n                $btnClose.addEventListener('click', clickHandler.bind(this));\r\n                document.getElementById(newGeneratedId).appendChild($btnClose);\r\n\r\n                this.wrapLastAdditionsTimeoutClass = this._generateNewTagGroupClass();\r\n\r\n              }, 700);\r\n\r\n              this.isWrappingLastText = true;\r\n\r\n            }\r\n\r\n\r\n            if (this.hasEditableContentChanged === false) {\r\n              this.hasEditableContentChanged = true;\r\n            }\r\n\r\n            e.preventDefault();\r\n          }\r\n\r\n          // writing over existing text is selected\r\n          else {\r\n            window.clearTimeout(this.wrapLastAdditionsTimeoutFunction);\r\n\r\n            const range = selection.getRangeAt(0);\r\n            const cloneRange = range.cloneRange();\r\n\r\n            cloneRange.setStart(range.startContainer, range.startOffset);\r\n            cloneRange.setEnd(range.endContainer, range.endOffset);\r\n\r\n            // 1. handle deleting the text that was selected when writing started\r\n            if (this.isWriting === false && selection.toString().length > 0) {\r\n              // add deleted text node only for the first time and only if there is some selected text\r\n              this.$groupDeleted = document.createElement('span');\r\n              this.$groupDeleted.contentEditable = false;\r\n              this.$groupDeleted.className = 'user-removed-text';\r\n\r\n              const groupDeletedId = this._generateNewTagId();\r\n              this.$groupDeleted.id = groupDeletedId;\r\n\r\n              const $groupInnerDeleted = document.createElement('span');\r\n              $groupInnerDeleted.className = 'user-removed-text-inner';\r\n\r\n              this.$groupDeleted.appendChild($groupInnerDeleted);\r\n\r\n              cloneRange.surroundContents(this.$groupDeleted);\r\n\r\n              // create close button\r\n              const $btnClose = document.createElement('span');\r\n              $btnClose.className = this.opts.closeBtnClass;\r\n\r\n              const clickHandler = (e) => {\r\n                const $nodeElement = e.currentTarget.parentNode;\r\n                this._removeNodeKeepTextContent($nodeElement);\r\n                e.stopPropagation();\r\n              };\r\n\r\n              $btnClose.addEventListener('click', clickHandler.bind(this));\r\n              this.$groupDeleted.appendChild($btnClose);\r\n            }\r\n\r\n\r\n            // 2. adding new text\r\n            this.isWriting = true;\r\n\r\n            const $groupInnerAdded = document.createElement('span');\r\n            $groupInnerAdded.contentEditable = false;\r\n            $groupInnerAdded.className = `user-inserted-text-inner ${this.wrapLastAdditionsTimeoutClass}`;\r\n\r\n            // add a space so there is a space between the added and removed text\r\n            $groupInnerAdded.innerHTML = `${keyName}`;\r\n\r\n            // TODO: error after deleted selection\r\n            __insertBefore($groupInnerAdded, this.$groupDeleted);\r\n            range.setStartAfter($groupInnerAdded);\r\n\r\n            selection.removeAllRanges();\r\n            selection.addRange(range);\r\n\r\n            this.wrapLastAdditionsTimeoutFunction = setTimeout(() => {\r\n              this.isWriting = false;\r\n\r\n              // wrap all previous deletes to one element\r\n              const $groupAdded = document.createElement('span');\r\n              $groupAdded.contentEditable = false;\r\n              $groupAdded.className = 'user-inserted-text';\r\n\r\n              const newGeneratedId = this._generateNewTagId();\r\n              $groupAdded.id = newGeneratedId;\r\n\r\n              const elements = Array.from(document.getElementsByClassName(this.wrapLastAdditionsTimeoutClass));\r\n\r\n              __insertBefore($groupAdded, elements[0]);\r\n\r\n              elements.forEach((el, i) => {\r\n                $groupAdded.appendChild(el);\r\n              });\r\n\r\n              const $btnClose = document.createElement('span');\r\n              $btnClose.className = this.opts.closeBtnClass;\r\n\r\n              const clickHandler = (e) => {\r\n                const $nodeElement = e.currentTarget.parentNode;\r\n                __remove($nodeElement);\r\n                e.stopPropagation();\r\n              };\r\n\r\n              $btnClose.addEventListener('click', clickHandler.bind(this));\r\n              document.getElementById(newGeneratedId).appendChild($btnClose);\r\n\r\n              this.wrapLastAdditionsTimeoutClass = this._generateNewTagGroupClass();\r\n\r\n            }, 700);\r\n\r\n            e.preventDefault();\r\n          }\r\n        }\r\n        // end WRITING\r\n      });\r\n    }\r\n\r\n\r\n    if (this.hasMenu) {\r\n      this.registerMenuHandler();\r\n    }\r\n\r\n    if (this.hasToolbar) {\r\n      this.toolbar.$btnReset.addEventListener('click', () => {\r\n\r\n        const isConfirmed = confirm('Opravdu chcete vrátit text do původní podoby? Vaše změny se tímto ztratí.');\r\n\r\n        if (isConfirmed) {\r\n          this.$canvas.innerHTML = this.originalContent.html;\r\n        }\r\n\r\n      });\r\n    }\r\n\r\n  }\r\n\r\n  registerMenuHandler() {\r\n    for (let i = 0, len = this.$menuActions.length; i < len; i += 1) {\r\n      this.$menuActions[i].addEventListener('click', this.handlerMenuActions.bind(this), false);\r\n    }\r\n\r\n    this.$menuClose.addEventListener('click', this.handlerMenuClose.bind(this), false);\r\n  }\r\n\r\n  initPreHighlightedTextOptions() {\r\n    // Example of data from JSON:\r\n    //\r\n    // \"predznaceni\": [\r\n    //     {\r\n    //       \"vyraz\": \"Obracíme se na vás\",\r\n    //       \"data\": {\r\n    //         \"osoba\": \"my\",\r\n    //         \"slovesnyZpusob\": \"oznamovací\"\r\n    //       }\r\n    //     }\r\n    //   ]\r\n    // }\r\n    //\r\n    // In PUG, object for every item is injected into `data-text-option` so this JS has access to it\r\n\r\n    const dataAttr = 'data-text-option';\r\n\r\n    // loop over updated DOM via DOM manipulation\r\n    this.$textOptionsElements = this.$editor.querySelectorAll(`[${dataAttr}]`);\r\n    Array.from(this.$textOptionsElements).forEach(($textOption) => {\r\n\r\n      $textOption.addEventListener('click', () => {\r\n        __toggleClass($textOption, this.opts.textOptions.selectedClass);\r\n        const idForSend = this.id.replace('editor-', '');\r\n\r\n        if (__hasClass($textOption, this.opts.textOptions.selectedClass)) {\r\n          // store !!!\r\n          storeGlobal.add({\r\n            editor: this.id,\r\n            id: $textOption.id,\r\n            tag: $textOption,\r\n            tagData: JSON.parse($textOption.getAttribute(dataAttr)),\r\n          });\r\n\r\n          // dispatch event that editor has changed\r\n          const tagData = JSON.parse($textOption.getAttribute('data-text-option'));\r\n\r\n          __dispatchEvent(document, 'editor.change', {}, {\r\n            text: {\r\n              id: idForSend,\r\n              task: 'add',\r\n              tagData,\r\n              value: $textOption.cloneNode(true),\r\n            },\r\n          });\r\n        } else {\r\n          // store !!!\r\n          storeGlobal.delete({\r\n            editor: this.id,\r\n            id: $textOption.id,\r\n          });\r\n\r\n          // dispatch event that editor has changed\r\n          __dispatchEvent(document, 'editor.change', {}, {\r\n            text: {\r\n              id: idForSend,\r\n              task: 'remove',\r\n              value: $textOption,\r\n            },\r\n          });\r\n        }\r\n\r\n        // show OK button or feedback\r\n        this.showFeedback();\r\n      });\r\n\r\n    });\r\n\r\n  }\r\n\r\n  toggleMenu(clickClose = false) {\r\n\r\n    if (clickClose === true) {\r\n      __addClass(this.$menu, 'hidden');\r\n      return;\r\n    }\r\n\r\n    if (this.selectionMouseDown === true) {\r\n      __addClass(this.$menu, 'hidden');\r\n      return;\r\n    }\r\n\r\n    if (__hasClass(this.$menu, 'hidden') && this.selectionMouseDown === false) {\r\n      this._setmenuDimensions();\r\n      __removeClass(this.$menu, 'hidden');\r\n    }\r\n\r\n  }\r\n\r\n  _setmenuDimensions() {\r\n    const menuDimensions = __getRealDimensions(this.$menu);\r\n    const parentTranslatedPosition = __positionTranslated(this.$editor);\r\n    const parentDimensions = __position(this.$editor);\r\n\r\n    // let additionalSize = ( this.selectionDirection === \"right\" ) ?\r\n\r\n    const isOverflowAt = {\r\n      right: (this.selectionAttributes.left + this.selectionAttributes.width + menuDimensions.width + this.opts.menuMargin.x) > (parentTranslatedPosition.left + parentDimensions.width),\r\n      top: (this.selectionAttributes.top - menuDimensions.height - this.opts.menuMargin.y) < (parentTranslatedPosition.top),\r\n      bottom: (this.selectionAttributes.top + this.selectionAttributes.height + menuDimensions.height + this.opts.menuMargin.y) > (parentTranslatedPosition.top + parentDimensions.height),\r\n    };\r\n\r\n    let leftDimensions;\r\n    let topDimensions;\r\n\r\n    if (isOverflowAt.right) {\r\n\r\n      leftDimensions = this.selectionAttributes.left - menuDimensions.width - this.opts.menuMargin.x;\r\n\r\n    } else {\r\n\r\n      leftDimensions = this.selectionAttributes.left + this.selectionAttributes.width + this.opts.menuMargin.x;\r\n\r\n    }\r\n\r\n    if (isOverflowAt.top) {\r\n\r\n      topDimensions = this.selectionAttributes.top + menuDimensions.height + this.opts.menuMargin.y;\r\n\r\n    } else {\r\n\r\n      topDimensions = this.selectionAttributes.top - menuDimensions.height - this.opts.menuMargin.y;\r\n\r\n    }\r\n\r\n    this.$menu.style.left = `${leftDimensions}px`;\r\n    this.$menu.style.top = `${topDimensions}px`;\r\n\r\n  }\r\n\r\n  handlerMenuClose(e) {\r\n\r\n    this.toggleMenu(true);\r\n\r\n    e.preventDefault();\r\n\r\n  }\r\n\r\n  handlerMenuActions(e) {\r\n\r\n    const $el = e.currentTarget;\r\n    const command = $el.getAttribute('data-command');\r\n    const commandName = $el.getAttribute('data-command-name');\r\n\r\n    /* :TODO: Cache the options for given element to avoid JSON parsing each time */\r\n    const options = JSON.parse($el.getAttribute('data-command-options'));\r\n\r\n    this.setSelection(command, commandName, options);\r\n\r\n    e.preventDefault();\r\n\r\n  }\r\n\r\n  handlerFocus(e) {\r\n    const isMouseRightClick = e.which === 3;\r\n\r\n    if (isMouseRightClick) { return; }\r\n\r\n    if (__hasClass(e.target, 'node-close')) { return; }\r\n\r\n    if (__hasClass(e.target, 'node-selected')) { return; }\r\n\r\n    if (e.type === 'mousedown') {\r\n\r\n      // start tracking the mouse down\r\n      this.selectionMouseDown = true;\r\n\r\n      if (this.hasMenu === true) {\r\n        this.toggleMenu();\r\n      }\r\n\r\n    }\r\n\r\n    if (e.type === 'mouseup' && this.selectionMouseDown) {\r\n\r\n      // reset saved last selection settings\r\n      this.lastSelectionSettings = {};\r\n\r\n      this.selection = window.getSelection();\r\n      this.isCollapsed = this.lastSelectionSettings.isCollapsed = this.selection.isCollapsed;\r\n      this.savedSelectionRange = this.selection.getRangeAt(0);\r\n\r\n      this.selectionMouseDown = false;\r\n\r\n      this.lastSelectionSettings.anchorOffset = this.selection.anchorOffset;\r\n      this.lastSelectionSettings.focusOffset = this.selection.focusOffset;\r\n      this.lastSelectionSettings.text = this.savedSelectionRange.toString();\r\n\r\n      /* https://developer.mozilla.org/en-US/docs/Web/API/Selection/isCollapsed */\r\n      /* Returns a Boolean indicating whether the selection's start and end points are at the same position. */\r\n      /* display context menu only if the cursor is NOT at the same position */\r\n      if (this.selection.isCollapsed === false && this.savedSelectionRange.toString().trim() !== '') {\r\n\r\n        this.selectionDirection = (this.selection.anchorOffset <= this.selection.focusOffset) ? 'right' : 'left';\r\n\r\n        if (this.hasMenu === true) {\r\n\r\n          this._setSelectionPosition(); // :TODO: cannot be used in contentEditable editor yet\r\n\r\n          this.toggleMenu();\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  _setSelectionPosition() {\r\n\r\n    const dummyElement = document.createElement('span');\r\n    dummyElement.className = 'dummy-range-element';\r\n\r\n    this.savedSelectionRange.surroundContents(dummyElement);\r\n\r\n    const selectionPosition = __positionTranslated(dummyElement);\r\n    const selectionDimension = __position(dummyElement);\r\n\r\n    this.selectionAttributes = {\r\n      left: selectionPosition.left,\r\n      top: selectionPosition.top,\r\n      width: selectionDimension.width,\r\n      height: selectionDimension.height,\r\n    };\r\n\r\n    __removeClass(dummyElement, 'dummy-range-element');\r\n\r\n    this._removeNodeKeepTextContent(dummyElement);\r\n\r\n  }\r\n\r\n  _extractAndSaveContents($domEl) {\r\n    $domEl.appendChild(this.savedSelectionRange.extractContents());\r\n    this.savedSelectionRange.insertNode($domEl);\r\n\r\n    const tagName = $domEl.getAttribute('data-command-name');\r\n    const newTagId = this._generateNewTagId();\r\n\r\n    $domEl.setAttribute('data-tag-id', newTagId);\r\n\r\n    // store !!!\r\n    store.addTag({\r\n      editor: this.id,\r\n      id: newTagId,\r\n      tag: $domEl,\r\n      tagName,\r\n      data: {},\r\n    });\r\n\r\n    // get tag color\r\n    const classes = $domEl.getAttribute('class');\r\n    // const colors = classes.match(/(?<=node-text-)[a-z]*/g);\r\n    const classesArray = classes.split(' ');\r\n    let color = '';\r\n    classesArray.forEach((value) => {\r\n      if (value.includes('node-text-')) {\r\n        color = value.replace('node-text-', '');\r\n      }\r\n    });\r\n\r\n    // dispatch event that editor has changed\r\n    const idForSend = this.id.replace('editor-', '');\r\n    __dispatchEvent(document, 'editor.change', {}, {\r\n      text: {\r\n        id: idForSend,\r\n        task: 'add',\r\n        tagName,\r\n        value: $domEl.cloneNode(true),\r\n        tagColor: color,\r\n      },\r\n    });\r\n  }\r\n\r\n  _removeNodeKeepTextContent(node) {\r\n    const text = node.textContent;\r\n    node.parentNode.insertBefore(document.createTextNode(text), node);\r\n    __remove(node);\r\n  }\r\n\r\n  _createCloseBtnForElement(parentEl, opts = {}) {\r\n\r\n    const $elClose = document.createElement('span');\r\n    $elClose.setAttribute('class', opts.class);\r\n\r\n    const classesToToggle = opts.toggleClass.split(' ');\r\n\r\n\r\n    const clickHandler = (e) => {\r\n\r\n      const $closeBtn = e.currentTarget;\r\n      const $nodeElement = $closeBtn.parentNode;\r\n\r\n      $closeBtn.removeEventListener('click', clickHandler);\r\n      $nodeElement.removeChild($closeBtn);\r\n\r\n      if (undefined !== $nodeElement.commentRef) {\r\n\r\n        /* :TODO: temporary way to save the reference to the DOM element */\r\n        this.$editor.removeChild($nodeElement.commentRef);\r\n        $nodeElement.commentRef = null;\r\n\r\n      }\r\n\r\n      this._removeNodeKeepTextContent($nodeElement);\r\n\r\n      const tagName = $nodeElement.getAttribute('data-command-name');\r\n\r\n      // store !!!\r\n      store.deleteTag({\r\n        editor: this.id,\r\n        id: $nodeElement.getAttribute('data-tag-id'),\r\n        tag: $nodeElement,\r\n        tagName,\r\n        data: {},\r\n      });\r\n\r\n      // dispatch event that editor has changed\r\n      const idForSend = this.id.replace('editor-', '');\r\n      __dispatchEvent(document, 'editor.change', {}, {\r\n        text: {\r\n          id: idForSend,\r\n          task: 'remove',\r\n          tagName,\r\n          value: $nodeElement,\r\n        },\r\n      });\r\n\r\n      e.stopPropagation();\r\n\r\n    };\r\n\r\n    $elClose.addEventListener('click', clickHandler.bind(this));\r\n\r\n    parentEl.appendChild($elClose);\r\n\r\n  }\r\n\r\n  _calculateCommentPosition($node) /* : Object */ {\r\n\r\n    const nodePosition = __positionTranslated($node);\r\n\r\n    return {\r\n      left: `${nodePosition.left + parseInt($node.offsetWidth, 10) + this.opts.commentMargin.x}px`,\r\n      top: `${nodePosition.top + this.opts.commentMargin.y}px`,\r\n    };\r\n\r\n  }\r\n\r\n  _createCommentForNode($el, opts = {}) {\r\n\r\n    const commentTemplate = document.getElementById('comment-template').innerHTML;\r\n\r\n    const div = document.createElement('div');\r\n    div.innerHTML = commentTemplate;\r\n\r\n    const commentDiv = div.childNodes[1];\r\n\r\n    // attach js reference to the dom element\r\n    commentDiv.data = {};\r\n    commentDiv.data.nodeRef = $el;\r\n\r\n    const commentNewTextarea = commentDiv.getElementsByClassName('comment-new-text')[0];\r\n    const commentDivButtonSubmit = commentDiv.getElementsByTagName('button')[0];\r\n    const commentCommentsContainer = commentDiv.getElementsByClassName('comments-container')[0];\r\n\r\n    const calculatedCommentPosition = this._calculateCommentPosition($el);\r\n\r\n    commentDiv.style.left = calculatedCommentPosition.left;\r\n    commentDiv.style.top = calculatedCommentPosition.top;\r\n\r\n    __addClass(commentDiv, opts.class);\r\n\r\n    commentDiv.addEventListener('click', (e) => {\r\n\r\n      if (__hasClass(e.target, 'close')) {\r\n\r\n        __addClass(commentDiv, 'hidden');\r\n        __removeClass($el, 'active');\r\n\r\n      }\r\n\r\n    });\r\n\r\n    commentDivButtonSubmit.addEventListener('click', (e) => {\r\n\r\n      if (commentNewTextarea.value !== '') {\r\n\r\n        const commentItem = document.createElement('div');\r\n        commentItem.className = 'comment-item';\r\n\r\n        commentItem.innerText = commentNewTextarea.value;\r\n\r\n        commentCommentsContainer.appendChild(commentItem);\r\n\r\n        commentNewTextarea.value = '';\r\n      }\r\n\r\n    });\r\n\r\n    this.$editor.append(commentDiv);\r\n\r\n    __addClass($el, 'comment-created');\r\n\r\n    /* :TODO: Temporary way to save the reference to the DOM element */\r\n    $el.commentRef = commentDiv;\r\n\r\n\r\n  }\r\n\r\n  _addCommentHandlerForElement($el, opts = {}) {\r\n\r\n    __addClass($el, 'has-comments');\r\n\r\n    function clickHandler(e) {\r\n\r\n      if (!__hasClass(e.target, 'node-close')) {\r\n\r\n        if (!__hasClass($el, 'comment-created')) {\r\n\r\n          this._createCommentForNode($el, opts);\r\n\r\n        } else {\r\n\r\n          /* recalculate comment div position */\r\n          const calculatedCommentPosition = this._calculateCommentPosition($el);\r\n\r\n          $el.commentRef.style.left = calculatedCommentPosition.left;\r\n          $el.commentRef.style.top = calculatedCommentPosition.top;\r\n\r\n          __removeClass($el.commentRef, 'hidden');\r\n\r\n        }\r\n\r\n        if (!__hasClass($el, 'active')) {\r\n\r\n          __addClass($el, 'active');\r\n\r\n        } else {\r\n\r\n          __removeClass($el, 'active');\r\n          __addClass($el.commentRef, 'hidden');\r\n\r\n        }\r\n\r\n      }\r\n\r\n      e.stopPropagation();\r\n\r\n    }\r\n\r\n    $el.addEventListener('click', clickHandler.bind(this));\r\n\r\n  }\r\n\r\n  setSelection(command, commandName, opts = {}) {\r\n\r\n    if (this.selection) {\r\n\r\n      if (command === 'toggle-class') {\r\n\r\n        const $el = document.createElement('span');\r\n        $el.setAttribute('class', opts.toggleClass);\r\n        $el.setAttribute('data-command-name', commandName);\r\n\r\n        if (opts.closeBtn === true) {\r\n          this._createCloseBtnForElement($el, {\r\n            class: 'node-close',\r\n            toggleClass: opts.toggleClass,\r\n          });\r\n        }\r\n\r\n        if (opts.comments === true) {\r\n          this._addCommentHandlerForElement($el, {\r\n            class: opts.commentsClass,\r\n          });\r\n        }\r\n\r\n        this._extractAndSaveContents($el);\r\n\r\n        if (opts.showCommentsOnInit === true) {\r\n          $el.click();\r\n        }\r\n\r\n      }\r\n\r\n      // hide context menu after selecting the action#\r\n      this.toggleMenu(true);\r\n\r\n      // show OK button or feedback\r\n      this.showFeedback();\r\n\r\n    }\r\n\r\n  }\r\n\r\n}\r\n\r\nEditor.defaults = {\r\n  menuClass: 'contextual-menu-component',\r\n  canvasClass: 'canvas',\r\n  resetBtnClass: 'reset',\r\n  closeBtnClass: 'node-close',\r\n  nodeSelectedClass: 'node-selected',\r\n  commentMargin: {\r\n    x: 50,\r\n    y: 0,\r\n  },\r\n  menuMargin: {\r\n    x: 15,\r\n    y: 15,\r\n  },\r\n  textOptions: {\r\n    enable: false,\r\n    animatedClass: 'active',\r\n    selectedClass: 'selected',\r\n    deselectedClass: 'deselected',\r\n  },\r\n\r\n};\r\n\r\nEditor._hasMenu = opts => opts.funkce !== 'cteni' && opts.funkce !== 'psani' && (opts.menu !== false && opts.menu !== undefined);\r\nEditor._hasToolbar = opts => opts.funkce === 'psani' || (opts.toolbar !== false && opts.toolbar !== undefined);\r\n","import { __hasClass, __getHTML, __remove } from '../lib/utils';\r\nimport store from '../store/store';\r\nimport actionTypes from '../store/store-constants';\r\nimport Component from './component';\r\n\r\nexport default class AnalyticalTable extends Component {\r\n\r\n  constructor(id, element, opts) {\r\n    super(element);\r\n    this.id = id;\r\n\r\n    this.opts = Object.assign({}, AnalyticalTable.defaults, opts);\r\n\r\n    this.isAdvanced = this.opts.isAdvanced;\r\n\r\n    this.rowIndex = 0;\r\n\r\n    this.tableResult = this.target.getElementsByClassName('table-result')[0];\r\n    this.tableResultBody = this.tableResult.getElementsByClassName('table-body')[0];\r\n    this.tableSelectedItems = this.target.getElementsByClassName('table-selected-items')[0];\r\n    this.tableSelectedItemsBody = this.tableSelectedItems.getElementsByClassName('table-body')[0];\r\n\r\n    this.activeDragged = null;\r\n\r\n    // choose the HTML for a row according to whether we work with the advanced version of a table\r\n    this._getRowHTML = (this.isAdvanced) ? AnalyticalTable._getAdvancedRowHTML : AnalyticalTable._getRowHTML;\r\n  }\r\n\r\n  init() {\r\n    this._registerStoreHandlers(this.tableResultBody, this.tableSelectedItemsBody);\r\n    this._registerHandlers();\r\n  }\r\n\r\n  _registerStoreHandlers(tableResultBody, tableSelectedItemsBody) {\r\n\r\n    store.on(actionTypes.editor.CHANGE, (event, payload) => {\r\n\r\n      const action = payload.action;\r\n      let addedTagContainer;\r\n      let $node;\r\n      // let deletedItem;\r\n\r\n      switch (action.type) {\r\n\r\n        case actionTypes.editor.ADD_TAG:\r\n\r\n          addedTagContainer = action.data.tagContainer;\r\n\r\n          switch (addedTagContainer.tagName) {\r\n\r\n            case this.opts.casti[1].sloupce[0].tag:\r\n\r\n              tableResultBody.insertAdjacentHTML('beforeend', this._getRowHTML(__getHTML(addedTagContainer.tag), addedTagContainer.id));\r\n\r\n\r\n              // TODO: fix this\r\n              if (this.opts.letSecondCaseRunIfSame || this.opts.casti[1].sloupce[0].tag === this.opts.casti[1].sloupce[1].tag) {\r\n\r\n              } else {\r\n                break;\r\n              }\r\n            // break;\r\n\r\n            case this.opts.casti[1].sloupce[1].tag:\r\n              $node = addedTagContainer.tag.cloneNode(true);\r\n              $node.setAttribute('draggable', true);\r\n              $node.addEventListener('click', this._handlerDraggable.bind(this), false);\r\n              $node.addEventListener('dragstart', this._handlerDraggable.bind(this), false);\r\n              $node.addEventListener('dragend', this._handlerDraggable.bind(this), false);\r\n              $node.addEventListener('drag', this._handlerDraggable.bind(this), false);\r\n              tableSelectedItemsBody.appendChild($node);\r\n              break;\r\n            default:\r\n              break;\r\n\r\n          }\r\n          break;\r\n        case actionTypes.editor.DELETE_TAG:\r\n\r\n          addedTagContainer = action.data.tagContainer;\r\n\r\n          // console.log(\"from DELETE_TAG action\", addedTagContainer);\r\n\r\n          // simple analytical table tasks\r\n          // const deletedItems = document.querySelectorAll(`[data-tag-id=\"${addedTagContainer.id}\"]`);\r\n\r\n          Array.prototype.forEach.call(document.querySelectorAll(`[data-tag-id=\"${addedTagContainer.id}\"]`), ($node) => {\r\n\r\n            if (__hasClass($node.parentNode, 'cell-read-only')) {\r\n              // we have to remove the whole row from the table\r\n              // --> cell --> table-row\r\n              __remove($node.parentNode.parentNode);\r\n\r\n            } else {\r\n              __remove($node);\r\n            }\r\n          });\r\n\r\n          break;\r\n\r\n        default:\r\n          break;\r\n      }\r\n    });\r\n  }\r\n\r\n  _registerHandlers() {\r\n    this.target.addEventListener('dragover', this._handlerDrop.bind(this), false);\r\n    this.target.addEventListener('dragleave', this._handlerDrop.bind(this), false);\r\n    this.target.addEventListener('drop', this._handlerDrop.bind(this), false);\r\n  }\r\n\r\n  _handlerDraggable(e) {\r\n\r\n    if (e.type === 'dragstart') {\r\n      e.dataTransfer.setData('text/plain', 'node');\r\n      e.dataTransfer.dropEffect = '';\r\n      e.target.style.opacity = 0.5;\r\n\r\n      this.activeDragged = e.target.cloneNode(true);\r\n    }\r\n\r\n    if (e.type === 'dragend') {\r\n      e.target.style.opacity = 1;\r\n\r\n      // show OK button or feedback\r\n      this.showFeedback();\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  _handlerDrop(e) {\r\n    if (e.target.localName === 'input') {\r\n\r\n      if (e.type === 'dragover') {\r\n        e.preventDefault();\r\n        e.dataTransfer.dropEffect = 'none';\r\n      }\r\n\r\n      if (e.type === 'drop') {\r\n        e.preventDefault();\r\n      }\r\n    }\r\n\r\n    if (__hasClass(e.target, 'dashboard-canvas-widget-content')) {\r\n      if (e.type === 'dragover') {\r\n        e.preventDefault();\r\n\r\n        e.dataTransfer.dropEffect = '';\r\n        e.target.style.background = '#eee';\r\n      }\r\n\r\n      if (e.type === 'dragleave') {\r\n        e.target.style.background = '#fff';\r\n      }\r\n\r\n      if (e.type === 'drop') {\r\n        e.preventDefault();\r\n\r\n        e.target.style.background = '#fff';\r\n        this.activeDragged.style.opacity = 1;\r\n\r\n        this.activeDragged.addEventListener('click', (e) => {\r\n          if (__hasClass(e.target, 'node-close')) {\r\n            e.target.parentNode.remove();\r\n          }\r\n        });\r\n\r\n        e.target.appendChild(this.activeDragged);\r\n\r\n      }\r\n    }\r\n\r\n    return false;\r\n  }\r\n}\r\n\r\nAnalyticalTable.defaults = {\r\n  isAdvanced: false,\r\n};\r\n\r\n\r\nAnalyticalTable._getRowHTML = (nodeHTML, index = 0) => {\r\n\r\n  const tableRowTemplate = `\r\n    <div class=\"table-row\">\r\n      <div class=\"cell cell-read-only cell-border-right\">${nodeHTML}</div>\r\n      <div class=\"cell dashboard-canvas-widget-content\"></div>\r\n    </div>\r\n  `;\r\n\r\n  return tableRowTemplate;\r\n};\r\n\r\nAnalyticalTable._getAdvancedRowHTML = (nodeHTML, index = 0) => {\r\n\r\n  const tableRowTemplate = `\r\n    <div class=\"table-row\">\r\n      <div class=\"cell cell-read-only cell-border-right\">${nodeHTML}</div>\r\n      <div class=\"cell dashboard-canvas-widget-content cell-border-right\"></div>\r\n      <div class=\"cell table-input\">\r\n        <input id=\"table-akteri-vztahy-input-${index}\" data-input-target=\"\" data-save=\"value\" type=\"text\" placeholder=\"Vztah aktérů…\" tabindex=\"-1\">\r\n      </div>\r\n    </div>\r\n  `;\r\n\r\n  return tableRowTemplate;\r\n};\r\n","import Observer from './observer';\r\nimport actionTypes from './store-constants';\r\n\r\n/*\r\nconst tagContainer: Object = {\r\n  editorId?: number,\r\n  id: string,\r\n  tag: HTMLElement,\r\n  data?: Object\r\n}\r\n*/\r\n\r\n\r\nclass StoreKeywords extends Observer {\r\n\r\n  constructor() {\r\n    super();\r\n\r\n    /* here the global space for storing objects and data */\r\n    this._data = {};\r\n\r\n  }\r\n\r\n\r\n  change(keywordsId, newItems, newItemsHTML) {\r\n\r\n    if (!this._data[keywordsId]) {\r\n      this._data[keywordsId] = {};\r\n    }\r\n\r\n    this._data[keywordsId].items = newItems;\r\n    this._data[keywordsId].itemsHTML = newItemsHTML;\r\n\r\n    store.trigger(actionTypes.keywords.CHANGE, {\r\n      action: {\r\n        id: actionTypes.keywords.id,\r\n        type: actionTypes.keywords.CHANGE,\r\n        data: {\r\n          keywordsId,\r\n          newItems,\r\n          newItemsHTML,\r\n        },\r\n      },\r\n\r\n    });\r\n\r\n  }\r\n\r\n  export() {\r\n    return this._data;\r\n  }\r\n\r\n}\r\n\r\nconst store = new StoreKeywords();\r\nexport default store;\r\n","import { __toggleClass, __getHTML } from '../lib/utils';\r\nimport Component from './component';\r\nimport store from '../store/store-keywords';\r\nimport actionTypes from '../store/store-constants';\r\n\r\n// zoom the image\r\nexport default class Keywords extends Component {\r\n  constructor($element, opts = {}) {\r\n    super($element);\r\n    this.id = this.target.id;\r\n    this.function = this.target.getAttribute('data-keywords') || 'selekce';\r\n    this.$controls = Array.from(this.target.querySelectorAll('[data-keywords-control]'));\r\n\r\n    this.opts = Object.assign({}, Keywords.defaults, opts);\r\n\r\n    this.$itemsContainer = this.target.getElementsByClassName(this.opts.itemsContainerClassName)[0];\r\n\r\n    if (this.opts.inherit && this.opts.inherit.from.length > 0) {\r\n      // console.log(this.opts.inherit.from);\r\n      this.isInherited = true;\r\n    } else {\r\n      this.$items = this.target.getElementsByClassName(this.opts.itemClassName);\r\n    }\r\n\r\n  }\r\n\r\n  init() {\r\n    switch (this.function) {\r\n      case 'selekce':\r\n        // we have data at the instantiation for importing\r\n        if (this.opts.import && this.opts.import.length > 0) {\r\n          this.$itemsContainer.innerHTML = Keywords._getHTMLFromItems(this.opts.import);\r\n        }\r\n\r\n        // save the state of all instances on Init\r\n        /* :TODO: a possible duplicity when the instance has the isInherited set to TRUE */\r\n        store.change(\r\n          this.id,\r\n          Keywords._getItemsFromHTML(this.$itemsContainer, this.opts.itemClassName),\r\n          Keywords._getItemsHTML(this.$itemsContainer),\r\n        );\r\n\r\n        // console.log(this.id, this.isInherited);\r\n        if (this.isInherited) {\r\n          // if onInit, we copy the elements\r\n          // by their ids into the itemsContainer of this object\r\n          if (this.opts.inherit.onInit) {\r\n            this._regenerateItemsContainerFromInherited();\r\n          }\r\n\r\n          this._registerStoreHandlers();\r\n        }\r\n\r\n        this._registerHandlers();\r\n        break;\r\n\r\n      case 'wordcloud':\r\n        Array.from(this.$items).forEach(($item) => {\r\n          $item.setAttribute('data-keywords-item', 0);\r\n        });\r\n        this._changeSizeOfKeywordItem(this.opts.skala);\r\n        break;\r\n\r\n      default:\r\n        break;\r\n    }\r\n  }\r\n\r\n  _changeSizeOfKeywordItem(maxLevel) {\r\n    maxLevel = maxLevel ? parseInt(maxLevel, 10) : 4;\r\n\r\n    function setNewLevelValue($keyword, number, feedback) {\r\n      const oldValue = parseInt($keyword.getAttribute('data-keywords-item'), 10);\r\n      const newValue = oldValue + number;\r\n      const value = Math.abs(newValue) > maxLevel ? oldValue : newValue;\r\n      $keyword.setAttribute('data-keywords-item', value);\r\n\r\n      feedback();\r\n    }\r\n\r\n    this.$controls.forEach(($control) => {\r\n      const $keyword = $control.parentElement.parentElement;\r\n      const controlFunction = $control.getAttribute('data-keywords-control');\r\n\r\n      switch (controlFunction) {\r\n        case 'minus':\r\n          $control.addEventListener('click', (event) => {\r\n            setNewLevelValue($keyword, -1, this.showFeedback);\r\n            event.preventDefault();\r\n          });\r\n          break;\r\n\r\n        case 'plus':\r\n          $control.addEventListener('click', (event) => {\r\n            setNewLevelValue($keyword, 1, this.showFeedback);\r\n            event.preventDefault();\r\n          });\r\n          break;\r\n\r\n        default:\r\n          break;\r\n      }\r\n    });\r\n  }\r\n\r\n  _regenerateItemsContainerFromInherited() {\r\n    let tempContent = '';\r\n\r\n    this.opts.inherit.from.forEach((id) => {\r\n      const temp = document.getElementById(id).getElementsByClassName(this.opts.itemsContainerClassName)[0].innerHTML;\r\n      // rename ids of the original items to avoid duplicates in the DOM\r\n      tempContent += Keywords.renameItemsIds(id, this.id, temp);\r\n      // console.log(tempContent);\r\n    });\r\n\r\n    this.$itemsContainer.innerHTML = tempContent;\r\n\r\n    this.$items = this.target.getElementsByClassName(this.opts.itemClassName);\r\n\r\n    store.change(\r\n      this.id,\r\n      Keywords._getItemsFromHTML(this.$itemsContainer, this.opts.itemClassName),\r\n      Keywords._getItemsHTML(this.$itemsContainer),\r\n    );\r\n\r\n  }\r\n\r\n  _registerHandlers() {\r\n\r\n    Array.from(this.target.getElementsByClassName(this.opts.itemClassName)).forEach(($item) => {\r\n      $item.addEventListener('click', this._eventHandler.bind(this), true);\r\n    });\r\n\r\n  }\r\n\r\n  _registerStoreHandlers() {\r\n    store.on(actionTypes.keywords.CHANGE, (event, payload) => {\r\n\r\n      const action = payload.action;\r\n      const data = payload.action.data;\r\n\r\n      switch (action.type) {\r\n\r\n        case actionTypes.keywords.CHANGE:\r\n\r\n          // if there are other objects this object inherits items from, update the html\r\n          if (this.opts.inherit.from.indexOf(data.keywordsId) > -1) {\r\n            this._regenerateItemsContainerFromInherited();\r\n\r\n            // regenerate event handlers\r\n            this._registerHandlers();\r\n          }\r\n\r\n          break;\r\n\r\n        default:\r\n          break;\r\n      }\r\n\r\n    });\r\n\r\n  }\r\n\r\n\r\n  _eventHandler(e) {\r\n\r\n    if (e.type === 'click') {\r\n      // console.log(e.target, e.currentTarget);\r\n      __toggleClass(e.currentTarget, 'disabled');\r\n\r\n      store.change(\r\n        this.id,\r\n        Keywords._getItemsFromHTML(this.$itemsContainer, this.opts.itemClassName),\r\n        Keywords._getItemsHTML(this.$itemsContainer),\r\n      );\r\n\r\n      this.showFeedback();\r\n    }\r\n\r\n  }\r\n\r\n}\r\n\r\n\r\nKeywords._getItemFromDOMElement = $item => ({\r\n  class: $item.className,\r\n  id: $item.getAttribute('id'),\r\n  text: $item.innerText,\r\n});\r\n\r\nKeywords._getItemsHTML = $itemsContainer => $itemsContainer.innerHTML;\r\n\r\nKeywords._getItemsFromHTML = ($itemsContainer, itemsClassName) => {\r\n  const $items = $itemsContainer.getElementsByClassName(itemsClassName);\r\n  const itemsArray = [];\r\n\r\n  Array.from($items).forEach(($item) => {\r\n    itemsArray.push(Keywords._getItemFromDOMElement($item));\r\n  });\r\n\r\n\r\n  return itemsArray;\r\n\r\n};\r\n\r\nKeywords._getDOMElementFromItem = (item) => {\r\n\r\n  const newDiv = document.createElement('div');\r\n  newDiv.setAttribute('class', item.class);\r\n  newDiv.setAttribute('id', item.id);\r\n  newDiv.innerHTML = item.text;\r\n\r\n  return __getHTML(newDiv);\r\n\r\n};\r\n\r\nKeywords._getHTMLFromItems = (items) => {\r\n\r\n  let contentHTML = '';\r\n\r\n  items.forEach((item) => {\r\n\r\n    contentHTML += Keywords._getDOMElementFromItem(item);\r\n\r\n  });\r\n\r\n  return contentHTML;\r\n\r\n};\r\n\r\n\r\nKeywords.renameItemsIds = (oldId, newId, itemsHTML) => {\r\n\r\n  const expString = new RegExp(oldId, 'g');\r\n\r\n  return itemsHTML.replace(expString, newId);\r\n\r\n};\r\n\r\nKeywords.defaults = {\r\n  itemsContainerClassName: 'keywords-items-container',\r\n  itemClassName: 'keywords-item',\r\n};\r\n","import { __getHTML } from '../lib/utils';\r\n\r\nimport store from '../store/store';\r\nimport actionTypes from '../store/store-constants';\r\n\r\n// zoom the image\r\nexport default class EditorTagsPlaceholder {\r\n  constructor(element, opts = {}) {\r\n\r\n    this.$element = element;\r\n    this.id = this.$element.getAttribute('id');\r\n\r\n    this.opts = Object.assign({}, EditorTagsPlaceholder.defaults, opts);\r\n\r\n    this.commandNames = JSON.parse(this.$element.getAttribute(this.opts.itemSubscribeAttributeClassName));\r\n    this.$itemsContainer = this.$element.getElementsByClassName(this.opts.itemsContainerClassName)[0];\r\n\r\n  }\r\n\r\n  init() {\r\n\r\n    this._registerStoreHandlers();\r\n\r\n  }\r\n\r\n\r\n  _registerStoreHandlers() {\r\n\r\n    store.on(actionTypes.editor.CHANGE, (event, payload) => {\r\n\r\n      const action = payload.action;\r\n      const data = payload.action.data;\r\n      const tagContainer = data.tagContainer;\r\n\r\n      if (this.commandNames.indexOf(tagContainer.tagName) > -1) {\r\n\r\n        const tags = store.getTagsBy({key: 'tagName', value: this.commandNames});\r\n\r\n        let content = \"\";\r\n\r\n        tags.forEach((tag) => {\r\n\r\n          content += __getHTML( tag.tag );\r\n\r\n        });\r\n\r\n        this.$itemsContainer.innerHTML = content;\r\n\r\n      }\r\n\r\n  });\r\n\r\n  }\r\n\r\n\r\n\r\n}\r\n\r\n\r\n\r\n\r\n\r\nEditorTagsPlaceholder.defaults = {\r\n  itemsContainerClassName: \"editor-tags-placeholder-content\",\r\n  itemSubscribeAttributeClassName: 'data-placeholder-editor-subscribe'\r\n\r\n};\r\n","import { __removeClass, __toggleClass } from '../lib/utils';\r\nimport Component from './component';\r\n// import store from '../store/store';\r\n// import actionTypes from '../store/store-constants';\r\n\r\n\r\nexport default class TestQuiz extends Component {\r\n\r\n  constructor(id, element, opts) {\r\n    super(element);\r\n\r\n    this.id = id;\r\n\r\n    this.opts = Object.assign({}, TestQuiz.defaults, opts);\r\n\r\n    this.$questions = this.target.getElementsByClassName(this.opts.itemClass);\r\n    this.cache = {\r\n      answersCorrect: 0,\r\n      colors: [],\r\n      questions: [],\r\n    };\r\n\r\n    // get colors for all feedback variants\r\n    if (this.opts.zpetnaVazba) {\r\n      this.cache.colors = this.opts.zpetnaVazba.map(feedback => feedback.barva);\r\n    }\r\n  }\r\n\r\n  init() {\r\n    // this._registerStoreHandlers();\r\n    this._registerHandlers();\r\n  }\r\n\r\n  _registerHandlers() {\r\n\r\n    Array.from(this.$questions).forEach(($question, questionIndex) => {\r\n      // all questions are without answer by default\r\n      this.cache.questions.push({ answered: false });\r\n\r\n      const answerCorrect = parseInt($question.getAttribute('data-module-answer'), 10);\r\n      const $answers = Array.from($question.getElementsByClassName(this.opts.optionClass));\r\n\r\n      $answers.forEach(($answer, answerIndex) => {\r\n        $answer.addEventListener('click', () => {\r\n          const $answerCurrent = $answer;\r\n\r\n          // if already selected do nothing\r\n          if ($answerCurrent.classList.contains('selected')) {\r\n            return;\r\n          }\r\n\r\n          // remove the selection\r\n          $answers.forEach($answersItem => __removeClass($answersItem, this.opts.selectedClass));\r\n          // select the clicked one\r\n          __toggleClass($answerCurrent, this.opts.selectedClass);\r\n\r\n          // get sum of all corect answers\r\n          if (this.opts.zpetnaVazba) {\r\n            if (answerIndex === answerCorrect) {\r\n              this.cache.answersCorrect += 1;\r\n            } else if (this.cache.answersCorrect !== 0 && this.cache.questions[questionIndex].answered === true) {\r\n              this.cache.answersCorrect -= 1;\r\n            }\r\n            // loop through all \"zpetnaVazba\" to get the one with the fullfilled condition\r\n            const feedbackActual = this.opts.zpetnaVazba.find(feedback => feedback.podminka.includes(this.cache.answersCorrect));\r\n\r\n            // show the right feedback message\r\n            this.$buttonFeedback.classList.remove(...this.cache.colors);\r\n            this.$buttonFeedback.classList.add(feedbackActual.barva);\r\n            this.$buttonFeedbackText.innerText = feedbackActual.text;\r\n          }\r\n\r\n          // note that this question has been answered (whether true or false)\r\n          this.cache.questions[questionIndex].answered = true;\r\n\r\n          // show OK button with feedback only when all question have been answered\r\n          if (this.cache.questions.find(question => !question.answered) === undefined) {\r\n            this.showFeedback();\r\n          }\r\n\r\n        }, false);\r\n      });\r\n    });\r\n  }\r\n}\r\n\r\nTestQuiz.defaults = {\r\n  itemClass: 'test-quiz-item',\r\n  optionClass: 'option',\r\n  selectedClass: 'selected',\r\n};\r\n","import { __remove } from '../lib/utils';\r\nimport storeGlobal from '../store/store-global';\r\nimport actionTypes from '../store/store-constants';\r\nimport Component from './component';\r\n\r\nexport default class GenericTable extends Component {\r\n\r\n  constructor($element, opts) {\r\n    super($element);\r\n\r\n    this.id = this.target.id;\r\n    this.opts = Object.assign({}, GenericTable.defaults, opts);\r\n\r\n    this.rowIndex = 0;\r\n\r\n    this.$tableResultBody = this.target.getElementsByClassName('table-body')[0];\r\n\r\n    this.dataSettings = this.opts.data;\r\n\r\n    this.cache = {\r\n      tasksToComplete: 0,\r\n      tasksCompleted: 0,\r\n      tasks: [],\r\n    };\r\n  }\r\n\r\n  init() {\r\n\r\n    if (this.dataSettings.source === 'store') {\r\n      this._registerStoreHandlers();\r\n    }\r\n\r\n    // this._registerHandlers();\r\n  }\r\n\r\n  _registerStoreHandlers() {\r\n\r\n    // register store event handler\r\n    // in tabulkaObecna JSON settings, subscribe is an array, here we need a string of strings separated by spaces\r\n    storeGlobal.on(this.dataSettings.subscribe.join(' '), (event, payload) => {\r\n      const action = payload.action;\r\n      const data = payload.data;\r\n\r\n      switch (action.type) {\r\n\r\n        case actionTypes[event].ADD: {\r\n          this.$tableResultBody.insertAdjacentHTML('beforeend', GenericTable._getRowHTML(data));\r\n\r\n          const $allRows = this.$tableResultBody.querySelectorAll('.table-row');\r\n          const $lastRow = $allRows[$allRows.length - 1];\r\n\r\n          const $newSelects = $lastRow.querySelectorAll('select');\r\n\r\n          this.cache.tasksToComplete += $newSelects.length;\r\n\r\n          Array.from($newSelects).forEach(($select) => {\r\n            this.cache.tasks.push({ answered: false });\r\n            const taskNumber = this.cache.tasks.length - 1;\r\n\r\n            $select.addEventListener('change', () => {\r\n              if (this.cache.tasks[taskNumber].answered === false) {\r\n                this.cache.tasksCompleted += 1;\r\n                this.cache.tasks[taskNumber].answered = true;\r\n              }\r\n              if (this.cache.tasksToComplete === this.cache.tasksCompleted) {\r\n                // show OK button or feedback\r\n                this.showFeedback();\r\n              }\r\n            });\r\n          });\r\n          break;\r\n        }\r\n        case actionTypes[event].DELETE: {\r\n          const $row = document.getElementById(`${data.id}_table`);\r\n          __remove($row);\r\n          this.cache.tasksToComplete -= $row.querySelectorAll('select').length;\r\n          this.cache.tasksCompleted -= $row.querySelectorAll('select').length;\r\n\r\n          if (this.cache.tasksToComplete <= this.cache.tasksCompleted) {\r\n            // show OK button or feedback\r\n            this.showFeedback();\r\n          }\r\n\r\n          break;\r\n        }\r\n        default:\r\n          break;\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nGenericTable.defaults = {};\r\n\r\n// data.data.text: editor text name\r\n// data.data.vyraz selected text option text value\r\nGenericTable._getRowHTML = (data) => {\r\n  const tableRowTemplate = `\r\n    <div class=\"table-row\" id=\"${data.id}_table\">\r\n      <div class=\"cell\">${data.tagData.nazev}</div>\r\n      <div class=\"cell\">${data.tagData.vyraz}</div>\r\n      <div class=\"cell\">\r\n        <select id=\"${data.id}-select-osoba\" name=\"osoba\" data-save=\"value\">\r\n          <option>Vyberte osobu</option>\r\n          <option>já</option>\r\n          <option>ty</option>\r\n          <option>on/ona/ono</option>\r\n          <option>my</option>\r\n          <option>vy</option>\r\n          <option>oni/ony/ona</option>\r\n          <option>infinitiv</option>\r\n        </select>\r\n      </div>\r\n      <div class=\"cell\">\r\n        <select id=\"${data.id}-select-zpusob\" name=\"zpusob\" data-save=\"value\">\r\n          <option>Vyberte způsob</option>\r\n          <option>oznamovací</option>\r\n          <option>podmiňovací</option>\r\n          <option>rozkazovací</option>\r\n          <option id=\"select-zpusob-infinitiv\">infinitiv</option>\r\n        </select>\r\n      </div>\r\n    </div>\r\n  `;\r\n\r\n  return tableRowTemplate;\r\n};\r\n","// [data-fullscreen]\r\nimport Component from './component';\r\n\r\nclass Fullscreen extends Component {\r\n  constructor($element) {\r\n    super($element);\r\n\r\n    this.$fullscreen = document.querySelector('[data-fullscreen=\"target\"]');\r\n    this.$fullscreenImage = this.$fullscreen.querySelector('[data-fullscreen=\"image\"]');\r\n\r\n    this.window = {};\r\n    this.image = {};\r\n\r\n    this.window.width = window.innerWidth;\r\n    this.window.height = window.innerHeight;\r\n    this.window.ratio = this.window.width / this.window.height;\r\n\r\n    this.$fullscreenImage.onload = () => {\r\n      this.image.width = this.$fullscreenImage.naturalWidth;\r\n      this.image.height = this.$fullscreenImage.naturalHeight;\r\n      this.image.ratio = this.image.width / this.image.height;\r\n\r\n      if (this.image.ratio >= this.window.ratio) {\r\n        this.$fullscreenImage.style.width = '100%';\r\n        this.$fullscreenImage.style.height = 'auto';\r\n      } else {\r\n        this.$fullscreenImage.style.width = 'auto';\r\n        this.$fullscreenImage.style.height = `${this.window.height}px`;\r\n      }\r\n    };\r\n\r\n  }\r\n}\r\n\r\nexport default class FullscreenToggle extends Fullscreen {\r\n  constructor($element) {\r\n    super($element);\r\n\r\n    this.target.addEventListener('click', (event) => {\r\n      this.$fullscreenImage.src = this.target.nextElementSibling.src;\r\n      this.$fullscreen.classList.toggle('hidden');\r\n\r\n      this.showFeedback();\r\n\r\n      event.preventDefault();\r\n      event.stopPropagation();\r\n    }, false);\r\n\r\n  }\r\n}\r\n","import Component from './component';\r\nimport { __dispatchEvent } from '../lib/utils';\r\n\r\nexport default class UserText extends Component {\r\n  constructor($element) {\r\n    super($element);\r\n    this.$userTexts = this.$slide.querySelectorAll('[data-textarea-target]');\r\n    this.$counter = this.target.nextElementSibling.querySelector('[data-usertext-counter]');\r\n    this.$wrapper = this.$counter.parentElement;\r\n\r\n    this.feedback = JSON.parse(this.target.getAttribute('data-feedback'));\r\n\r\n    this.lengthExpected = {\r\n      min: parseInt(this.target.getAttribute('minlength') === '0' ? 1 : this.target.getAttribute('minlength'), 10),\r\n      avg: null,\r\n      max: parseInt(this.target.getAttribute('maxlength') / 2, 10),\r\n    };\r\n    this.lengthExpected.avg = Math.floor((this.lengthExpected.max - this.lengthExpected.min) / 4 + this.lengthExpected.min);\r\n\r\n    this.cache = {\r\n      answersCorrect: 0,\r\n      colors: [\r\n        'color-red',\r\n        'color-orange',\r\n        'color-green',\r\n      ],\r\n      questions: [],\r\n    };\r\n\r\n    this.lastValue = '';\r\n    this.hadData = this.target.value && this.target.value.length > 0;\r\n    this.wasUsed = false;\r\n\r\n    if (this.hadData) {\r\n      this.updateCharacterCounter();\r\n    }\r\n\r\n    if (!HISTORYLAB.import.done) {\r\n      // duplicate source of different text element\r\n      this.toDuplicate = this.target.getAttribute('data-duplicate-text');\r\n      this.textDuplicateSources = this.toDuplicate ? this.toDuplicate.split(' ') : [];\r\n\r\n      // listen events\r\n      this.getEvents();\r\n      this.addEventListeners();\r\n    }\r\n  }\r\n\r\n  updateCharacterCounter(length = this.target.value.length) {\r\n    this.$wrapper.classList.remove(...this.cache.colors);\r\n    if (length < this.lengthExpected.min) this.$wrapper.classList.add(this.cache.colors[0]);\r\n    else if (length <= this.lengthExpected.avg) this.$wrapper.classList.add(this.cache.colors[1]);\r\n    else if (length > this.lengthExpected.avg) this.$wrapper.classList.add(this.cache.colors[2]);\r\n\r\n    this.$counter.innerText = length;\r\n    this.target.classList.add('is-used', !this.wasUsed);\r\n    this.wasUsed = true;\r\n  }\r\n\r\n  updateFeedback(length = this.target.value.length) {\r\n    this.$buttonFeedback.classList.remove(...this.cache.colors);\r\n    if (length < this.lengthExpected.min) {\r\n      this.$buttonFeedback.classList.add(this.cache.colors[0]);\r\n      this.$buttonFeedbackText.innerText = this.feedback.none;\r\n    } else {\r\n\r\n      if (length <= this.lengthExpected.avg) {\r\n        this.$buttonFeedback.classList.add(this.cache.colors[1]);\r\n        this.$buttonFeedbackText.innerText = this.feedback.short;\r\n      }\r\n      else if (length > this.lengthExpected.avg) {\r\n        this.$buttonFeedback.classList.add(this.cache.colors[2]);\r\n        this.$buttonFeedbackText.innerText = this.feedback.ok;\r\n      }\r\n\r\n      this.target.setAttribute('data-textarea-target', 'success');\r\n      // check if all conditions of the same component on the same slide are met\r\n      const conditionAll = Array.from(this.$userTexts).find(($userText) => ($userText.getAttribute('data-textarea-target') !== 'success'));\r\n\r\n      if (conditionAll === undefined) {\r\n        // show OK button or feedback\r\n        this.showFeedback();\r\n      }\r\n    }\r\n  }\r\n\r\n  addEventListeners() {\r\n    // BLUR\r\n    this.target.addEventListener('blur', (event) => {\r\n      this.updateCharacterCounter();\r\n\r\n      if (event.target.value !== this.lastValue) {\r\n        const taskName = (this.lastValue === '') ? 'create' : 'change';\r\n        this.lastValue = event.target.value;\r\n\r\n        // dispatch event that text has changed\r\n        __dispatchEvent(document, 'text.change', {}, {\r\n          text: {\r\n            id: event.target.id,\r\n            task: taskName,\r\n            text: event.target.value,\r\n          },\r\n        });\r\n\r\n        // remove connection of any textfields\r\n        this.textDuplicateSources = [];\r\n      }\r\n    });\r\n\r\n    // KEYUP\r\n    this.target.addEventListener('keyup', (event) => {\r\n      event.stopPropagation();\r\n\r\n      const valueLength = this.target.value.length;\r\n      this.updateCharacterCounter(valueLength);\r\n      this.updateFeedback(valueLength);\r\n    });\r\n  }\r\n\r\n  getEvents() {\r\n    if (this.textDuplicateSources[0]) {\r\n\r\n      document.addEventListener('text.change', (e) => {\r\n        if (this.textDuplicateSources.includes(e.detail.text.id)) {\r\n\r\n          const taskName = (this.target.value === '') ? 'create' : 'change';\r\n          switch (e.detail.text.task) {\r\n            case 'create':\r\n            case 'change':\r\n              // if is something already there\r\n              if (this.target.value !== '') this.target.value += '\\n';\r\n\r\n              // if array length is one it means that can by connection line\r\n              if (this.textDuplicateSources.length === 1) {\r\n                this.target.value = e.detail.text.text;\r\n              } else {\r\n                this.target.value += `${e.detail.text.text}\\n`;\r\n              }\r\n\r\n              // dispatch event that text has changed\r\n              __dispatchEvent(document, 'text.change', {}, {\r\n                text: {\r\n                  id: this.target.id,\r\n                  task: taskName,\r\n                  text: this.target.value,\r\n                },\r\n              });\r\n\r\n              // make different first value if is need\r\n              this.lastValue = this.target.value;\r\n\r\n              this.updateCharacterCounter();\r\n              break;\r\n            default:\r\n              console.log('Nondefinated text events task. :(');\r\n          }\r\n        }\r\n      });\r\n    }\r\n  }\r\n}\r\n","import Component from '../component';\r\n\r\nexport default class AudioPlayerNormal extends Component {\r\n\r\n  constructor($element) {\r\n    super($element);\r\n\r\n    this.$playButton = this.target.querySelector('[data-player-control]');\r\n    this.$loadWave = this.target.querySelector('[data-audio-wave]');\r\n    this.$leftTime = this.target.querySelector('[data-audio-time-left]');\r\n    this.$audioDuration = this.target.querySelector('[data-audio-time-duration]');\r\n\r\n    this.wavesurfer = WaveSurfer.create({\r\n      container: this.$loadWave,\r\n      waveColor: '#A77977',\r\n      progressColor: '#FCE4E3',\r\n      height: 80,\r\n      responsive: true,\r\n      barWidth: 2,\r\n    });\r\n    this.wavesurfer.load(this.$loadWave.dataset.src);\r\n\r\n    this.initWave();\r\n  }\r\n\r\n  initWave() {\r\n    this.wavesurfer.on('ready', () => {\r\n      this.$leftTime.textContent = '0:00';\r\n      const duration = this.wavesurfer.getDuration();\r\n      const minutes = Math.floor((duration % 3600) / 60);\r\n      const seconds = (`00${Math.floor(duration % 60)}`).slice(-2);\r\n      this.$audioDuration.textContent = `${minutes}:${seconds}`;\r\n\r\n      this.addListenerAfterReady();\r\n    });\r\n  }\r\n\r\n  addListenerAfterReady() {\r\n    this.wavesurfer.on('audioprocess', (time) => {\r\n      const minutes = Math.floor((time % 3600) / 60);\r\n      const seconds = (`00${Math.floor(time % 60)}`).slice(-2);\r\n      this.$leftTime.textContent = `${minutes}:${seconds}`;\r\n    });\r\n\r\n    this.wavesurfer.on('finish', () => {\r\n      this.$playButton.setAttribute('data-player-control', 'paused');\r\n    });\r\n\r\n    this.$playButton.addEventListener('click', () => {\r\n      this.wavesurfer.playPause();\r\n\r\n      if (this.$playButton.getAttribute('data-player-control') === 'paused') {\r\n        this.$playButton.setAttribute('data-player-control', 'playing');\r\n      } else {\r\n        this.$playButton.setAttribute('data-player-control', 'paused');\r\n      }\r\n\r\n      this.showFeedback();\r\n    });\r\n\r\n    // stop audio prehravac kdyz se zapne dalsi slajd\r\n    const $nextSlides = document.querySelectorAll('[data-nav-button]');\r\n    Array.from($nextSlides).forEach(($nextSlide) => {\r\n      $nextSlide.addEventListener('click', () => {\r\n        if (this.$playButton.getAttribute('data-player-control') === 'playing') {\r\n          this.wavesurfer.playPause();\r\n          this.$playButton.setAttribute('data-player-control', 'paused');\r\n        }\r\n      });\r\n    });\r\n\r\n  }\r\n\r\n}\r\n","import AudioPlayer from './audio-player';\r\nimport { getSecondsMinutesFormat } from './media';\r\n\r\nexport default class AudioPlayerSimple extends AudioPlayer {\r\n  constructor($element) {\r\n    super($element);\r\n\r\n    this.$audio = this.target.querySelector('audio');\r\n    this.$timeLeft = this.target.querySelector('[data-audio-time-left]');\r\n    this.$duration = this.target.querySelector('[data-audio-time-duration]');\r\n\r\n    this.$duration.innerText = `/${getSecondsMinutesFormat(this.$audio.duration)}`;\r\n\r\n    AudioPlayer.addEventListeners(this.target, this.showFeedback);\r\n  }\r\n}\r\n","import Component from './component';\r\n\r\nexport default class FakeMap extends Component {\r\n  constructor($element) {\r\n    super($element);\r\n\r\n    this.$buttons = this.target.querySelectorAll('[data-fake-map=\"toggle\"]');\r\n    this.$maps = this.target.querySelectorAll('[data-fake-map=\"map\"]');\r\n    this.lastActiveIndex = 0;\r\n\r\n    this.addEventListenerToButtons();\r\n  }\r\n\r\n  switchMap($button, index) {\r\n    this.$maps[this.lastActiveIndex].classList.remove('active');\r\n    this.$buttons[this.lastActiveIndex].classList.remove('active');\r\n\r\n    this.$maps[index].classList.add('active');\r\n    $button.classList.add('active');\r\n\r\n    this.lastActiveIndex = index;\r\n  }\r\n\r\n  addEventListenerToButtons() {\r\n    this.$buttons.forEach(($button, index) => {\r\n\r\n      $button.addEventListener('click', (event) => {\r\n        this.switchMap($button, index);\r\n        this.showFeedback();\r\n\r\n        event.preventDefault();\r\n      });\r\n\r\n    });\r\n  }\r\n}\r\n","/* eslint-disable no-nested-ternary */\r\nimport Component from '../component';\r\nimport { getSecondsMinutesFormat, mediaEvents } from './media';\r\n\r\nexport default class VideoPlayer extends Component {\r\n  constructor($element, options) {\r\n    super($element);\r\n\r\n    this.$media = this.target.querySelector('video');\r\n    this.options = Object(options);\r\n    this.prefix = this.options.prefix || 'media';\r\n    this.lang = Object(this.options.lang);\r\n    // lang.currentTime\r\n    // lang.play\r\n    // lang.pause\r\n    // lang.minutes\r\n    // lang.seconds\r\n    // lang.leaveFullscreen\r\n    // lang.enterFullscreen\r\n\r\n    this.paused = null;\r\n    this.currentTime = null;\r\n    this.duration = null;\r\n    this.interval = null;\r\n\r\n    this.$document = this.target.ownerDocument;\r\n    this.$controls = this.target.querySelector('.media-player-controls');\r\n    // play/pause toggle\r\n    this.$play = this.$controls.querySelector('[data-player-control]');\r\n    this.$playSymbol = this.$play.querySelector('.media-play-symbol');\r\n    this.$pauseSymbol = this.$play.querySelector('.media-pause-symbol');\r\n    // time slider\r\n    this.$time = this.$controls.querySelector('[data-video-time-progress]');\r\n    this.$timeMeter = this.$time.querySelector('.media-meter.media-time-meter');\r\n    this.$timeRange = this.$time.querySelector('.media-range.media-time-range');\r\n\r\n    // current time text\r\n    this.$currentTimeText = this.$document.createTextNode('');\r\n    this.$currentTime = this.$controls.querySelector('[data-video-time-left]');\r\n    this.$currentTime.appendChild(this.$currentTimeText);\r\n\r\n    // duration time text\r\n    this.durationTime = this.$media.duration;\r\n    this.$durationTime = this.$controls.querySelector('[data-video-time-duration]');\r\n    this.$durationTime.innerText = getSecondsMinutesFormat(this.durationTime);\r\n    this.$durationTime.setAttribute(\r\n      'title',\r\n      `${VideoPlayer.timeToAural(\r\n        this.durationTime,\r\n        this.lang.minutes || 'minutes',\r\n        this.lang.seconds || 'seconds',\r\n      )}`,\r\n    );\r\n\r\n    // fullscreen button\r\n    this.$fullscreen = this.$controls.querySelector(\r\n      '.fullscreen-toggle',\r\n    );\r\n    this.$enterFullscreenSymbol = this.$fullscreen.querySelector(\r\n      '.media-enterFullscreen-symbol',\r\n    );\r\n    this.$leaveFullscreenSymbol = this.$fullscreen.querySelector(\r\n      '.media-leaveFullscreen-symbol',\r\n    );\r\n\r\n    // fullscreen api\r\n    this._fullscreenchange = 'onfullscreenchange' in this.target\r\n      ? 'fullscreenchange'\r\n      : 'onwebkitfullscreenchange' in this.target\r\n        ? 'webkitfullscreenchange'\r\n        : 'onMSFullscreenChange' in this.target\r\n          ? 'MSFullscreenChange'\r\n          : 'fullscreenchange';\r\n\r\n    this._requestFullscreen = this.target.requestFullscreen\r\n    || this.target.webkitRequestFullscreen\r\n    // || this.target.mozRequestFullScreen\r\n    || this.target.msRequestFullscreen;\r\n\r\n    this.onCanPlayStart = this.onCanPlayStart.bind(this);\r\n    this.onLoadStart = this.onLoadStart.bind(this);\r\n    this.onLoadedData = this.onLoadedData.bind(this);\r\n    this.onPlayChange = this.onPlayChange.bind(this);\r\n    this.onTimeChange = this.onTimeChange.bind(this);\r\n    this.onPlayClick = this.onPlayClick.bind(this);\r\n    this.onTimeKeydown = this.onTimeKeydown.bind(this);\r\n    this.onTimeClick = this.onTimeClick.bind(this);\r\n    this.onTimeKeydown = this.onTimeKeydown.bind(this);\r\n    this.onFullscreenClick = this.onFullscreenClick.bind(this);\r\n    this.onFullscreenChange = this.onFullscreenChange.bind(this);\r\n\r\n    // add event listeners\r\n    this.$media.addEventListener('canplaythrough', this.onCanPlayStart);\r\n    this.$media.addEventListener('loadstart', this.onLoadStart);\r\n    this.$media.addEventListener('loadeddata', this.onLoadedData);\r\n    this.$media.addEventListener('pause', this.onPlayChange);\r\n    this.$media.addEventListener('play', this.onPlayChange);\r\n    this.$media.addEventListener('timeupdate', this.onTimeChange);\r\n    this.$controls.addEventListener('click', this.onPlayClick, false);\r\n    // this.$play.addEventListener('click', this.onPlayClick, false);\r\n    this.$play.addEventListener('keydown', this.onTimeKeydown);\r\n    this.$time.addEventListener('click', this.onTimeClick, false);\r\n    this.$time.addEventListener('keydown', this.onTimeKeydown);\r\n    this.$fullscreen.addEventListener('click', this.onFullscreenClick, false);\r\n    // listen for fullscreen changes\r\n    document.addEventListener(\r\n      this._fullscreenchange,\r\n      this.onFullscreenChange,\r\n    );\r\n\r\n    // pointer events from time control\r\n    VideoPlayer.onDrag(this.$time, this.$timeRange, (percentage) => {\r\n      this.$media.currentTime = this.duration * Math.max(0, Math.min(1, percentage));\r\n\r\n      this.onTimeChange();\r\n    });\r\n\r\n    this.onLoadStart();\r\n  }\r\n\r\n  static _fullscreenElement() {\r\n    return document.fullscreenElement\r\n    || document.webkitFullscreenElement\r\n    // || document.mozFullScreenElement\r\n    || document.msFullscreenElement;\r\n  }\r\n\r\n  static _exitFullscreen() {\r\n    return document.exitFullscreen\r\n    || document.webkitCancelFullScreen\r\n    // || document.mozCancelFullScreen\r\n    || document.msExitFullscreen;\r\n  }\r\n\r\n  // when the play state changes\r\n  onPlayChange() {\r\n    if (this.paused !== this.$media.paused) {\r\n      this.paused = this.$media.paused;\r\n\r\n      this.$play.setAttribute(\r\n        'aria-label',\r\n        this.paused ? this.lang.play || 'play' : this.lang.pause || 'pause',\r\n      );\r\n      this.target.setAttribute(\r\n        'data-player-state',\r\n        this.paused ? 'paused' : 'playing',\r\n      );\r\n      this.$playSymbol.setAttribute('aria-hidden', !this.paused);\r\n      this.$pauseSymbol.setAttribute('aria-hidden', this.paused);\r\n\r\n      clearInterval(this.interval);\r\n\r\n      if (!this.paused) {\r\n        // listen for time changes every 30th of a second\r\n        this.interval = setInterval(this.onTimeChange, 34);\r\n      }\r\n\r\n      // dispatch new \"playchange\" event\r\n      this.$media.dispatchEvent(mediaEvents.playchange);\r\n    }\r\n  }\r\n\r\n  // when the time changes\r\n  onTimeChange() {\r\n    if (\r\n      this.currentTime !== this.$media.currentTime\r\n      || this.duration !== this.$media.duration\r\n    ) {\r\n      this.currentTime = this.$media.currentTime;\r\n      this.duration = this.$media.duration || 0;\r\n\r\n      const currentTimePercentage = this.currentTime / this.duration;\r\n      // const currentTimeCode = VideoPlayer.timeToTimecode(this.currentTime);\r\n      const currentTimeCode = getSecondsMinutesFormat(this.currentTime);\r\n      // const remainingTimeCode = VideoPlayer.timeToTimecode(\r\n      //   this.duration - Math.floor(this.currentTime),\r\n      // );\r\n\r\n      if (currentTimeCode !== this.$currentTimeText.nodeValue) {\r\n        this.$currentTimeText.nodeValue = currentTimeCode;\r\n\r\n        this.$currentTime.setAttribute(\r\n          'title',\r\n          `${VideoPlayer.timeToAural(\r\n            this.currentTime,\r\n            this.lang.minutes || 'minutes',\r\n            this.lang.seconds || 'seconds',\r\n          )}`,\r\n        );\r\n      }\r\n\r\n      // if (remainingTimeCode !== this.$remainingTimeText.nodeValue) {\r\n      //   this.$remainingTimeText.nodeValue = remainingTimeCode;\r\n\r\n      //   $(this.$remainingTime, {\r\n      //     title: `${VideoPlayer.timeToAural(\r\n      //       this.duration - this.currentTime,\r\n      //       this.lang.minutes || 'minutes',\r\n      //       this.lang.seconds || 'seconds',\r\n      //     )}`,\r\n      //   });\r\n      // }\r\n\r\n      this.$time.setAttribute('aria-valuenow', this.currentTime);\r\n      this.$time.setAttribute('aria-valuemin', 0);\r\n      this.$time.setAttribute('aria-valuemax', this.duration);\r\n\r\n      this.$timeMeter.style.width = `${currentTimePercentage * 100}%`;\r\n\r\n      // dispatch new \"timechange\" event\r\n      this.$media.dispatchEvent(mediaEvents.timechange);\r\n    }\r\n  }\r\n\r\n  // when media loads for the first time\r\n  onLoadStart() {\r\n    this.$media.removeEventListener('canplaythrough', this.onCanPlayStart);\r\n    this.$media.addEventListener('canplaythrough', this.onCanPlayStart);\r\n\r\n    this.onPlayChange();\r\n    this.onFullscreenChange();\r\n    this.onTimeChange();\r\n  }\r\n\r\n  // when the immediate current playback position is available\r\n  onLoadedData() {\r\n    this.onTimeChange();\r\n  }\r\n\r\n  // when the media can play\r\n  onCanPlayStart() {\r\n    this.$media.removeEventListener('canplaythrough', this.nCanPlayStart);\r\n\r\n    // dispatch new \"canplaystart\" event\r\n    this.$media.dispatchEvent(mediaEvents.canplaystart);\r\n\r\n\r\n    if (!this.paused || this.$media.autoplay) {\r\n      this.$media.play();\r\n    }\r\n  }\r\n\r\n  onFullscreenChange() {\r\n    const isFullscreen = this.target === VideoPlayer._fullscreenElement();\r\n\r\n    this.$fullscreen.setAttribute(\r\n      'aria-label',\r\n      isFullscreen\r\n        ? this.lang.leaveFullscreen || 'leave full screen'\r\n        : this.lang.enterFullscreen || 'enter full screen',\r\n    );\r\n    this.$enterFullscreenSymbol.setAttribute('aria-hidden', isFullscreen);\r\n    this.$leaveFullscreenSymbol.setAttribute('aria-hidden', !isFullscreen);\r\n  }\r\n\r\n  // when the play control is clicked\r\n  onPlayClick(event) {\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n\r\n    this.$media[this.$media.paused ? 'play' : 'pause']();\r\n  }\r\n\r\n  // when the time control\r\n  onTimeClick(event) {\r\n    event.stopPropagation();\r\n\r\n    // handle click if clicked without pointer\r\n    if (!event.pointerType && !event.detail) {\r\n      this.onPlayClick(event);\r\n    }\r\n  }\r\n\r\n  // click from fullscreen control\r\n  onFullscreenClick(event) {\r\n    event.stopPropagation();\r\n\r\n    if (this._requestFullscreen) {\r\n      if (this.target === VideoPlayer._fullscreenElement()) {\r\n        // exit fullscreen\r\n        VideoPlayer._exitFullscreen().call(document);\r\n      } else {\r\n        // enter fullscreen\r\n        this._requestFullscreen.call(this.target);\r\n\r\n        // maintain focus in internet explorer\r\n        this.$fullscreen.focus();\r\n\r\n        // maintain focus in safari\r\n        setTimeout(() => {\r\n          this.$fullscreen.focus();\r\n        }, 200);\r\n      }\r\n    } else if (this.$media.webkitSupportsFullscreen) {\r\n      // iOS allows fullscreen of the video itself\r\n      if (this.$media.webkitDisplayingFullscreen) {\r\n        // exit ios fullscreen\r\n        this.$media.webkitExitFullscreen();\r\n      } else {\r\n        // enter ios fullscreen\r\n        this.$media.webkitEnterFullscreen();\r\n      }\r\n\r\n      this.onFullscreenChange();\r\n    }\r\n  }\r\n\r\n  // keydown from play control or current time control\r\n  onTimeKeydown(event) {\r\n    const { keyCode, shiftKey } = event;\r\n\r\n    // 37: LEFT, 38: UP, 39: RIGHT, 40: DOWN\r\n    if (keyCode >= 37 && keyCode <= 40) {\r\n      event.preventDefault();\r\n\r\n      const offset = keyCode === 37 || keyCode === 39 ? keyCode - 38 : keyCode - 39;\r\n\r\n      this.$media.currentTime = Math.max(\r\n        0,\r\n        Math.min(\r\n          this.$media.duration,\r\n          this.$media.currentTime + offset * (shiftKey ? 10 : 1),\r\n        ),\r\n      );\r\n\r\n      this.onTimeChange();\r\n    }\r\n  }\r\n\r\n  // Handle Drag Ranges\r\n  static onDrag(target, innerTarget, listener) {\r\n    // eslint-disable-line max-params\r\n    const hasPointerEvent = undefined !== target.onpointerup;\r\n    const hasTouchEvent = undefined !== target.ontouchstart;\r\n    const pointerDown = hasPointerEvent\r\n      ? 'pointerdown'\r\n      : hasTouchEvent\r\n        ? 'touchstart'\r\n        : 'mousedown';\r\n    const pointerMove = hasPointerEvent\r\n      ? 'pointermove'\r\n      : hasTouchEvent\r\n        ? 'touchmove'\r\n        : 'mousemove';\r\n    const pointerUp = hasPointerEvent\r\n      ? 'pointerup'\r\n      : hasTouchEvent\r\n        ? 'touchend'\r\n        : 'mouseup';\r\n\r\n    // ...\r\n    const axisProp = 'clientX';\r\n\r\n    let window;\r\n    let start;\r\n    let end;\r\n\r\n    function onpointermove(event) {\r\n      // prevent browser actions on this event\r\n      event.preventDefault();\r\n\r\n      // the pointer coordinate\r\n      const position = axisProp in event\r\n        ? event[axisProp]\r\n        : (event.touches && event.touches[0] && event.touches[0][axisProp])\r\n            || 0;\r\n\r\n      // the percentage of the pointer along the container\r\n      const percentage = (position - start) / (end - start);\r\n\r\n      // call the listener with percentage\r\n      listener(percentage);\r\n    }\r\n\r\n    function onpointerdown(event) {\r\n      // window\r\n      window = target.ownerDocument.defaultView;\r\n\r\n      // client boundaries\r\n      const rect = innerTarget.getBoundingClientRect();\r\n\r\n      // the container start and end coordinates\r\n      start = rect.left;\r\n      end = rect.right;\r\n\r\n      onpointermove(event);\r\n\r\n      window.addEventListener(pointerMove, onpointermove);\r\n      window.addEventListener(pointerUp, onpointerup);\r\n    }\r\n\r\n    function onpointerup() {\r\n      window.removeEventListener(pointerMove, onpointermove);\r\n      window.removeEventListener(pointerUp, onpointerup);\r\n    }\r\n\r\n    // on pointer down\r\n    target.addEventListener(pointerDown, onpointerdown);\r\n  }\r\n\r\n  // Time To Timecode\r\n  // DEPRECATED (media.util)\r\n  // static timeToTimecode(time) {\r\n  //   return `${`0${Math.floor(time / 60)}`.slice(-2)}:${`0${Math.floor(\r\n  //     time % 60,\r\n  //   )}`.slice(-2)}`;\r\n  // }\r\n\r\n  // Time To Aural\r\n  // DEPRECATED (media.util)\r\n  static timeToAural(time, langMinutes, langSeconds) {\r\n    return `${Math.floor(time / 60)} ${langMinutes}, ${Math.floor(\r\n      time % 60,\r\n    )} ${langSeconds}`;\r\n  }\r\n}\r\n","/* eslint-disable linebreak-style */\r\nimport Component from './component';\r\nimport { __dispatchEvent } from '../lib/utils';\r\n\r\nexport default class Selectable extends Component {\r\n\r\n  constructor($element) {\r\n    super($element);\r\n\r\n    // TODO: is DOM element before/after the editor itself.. move it to the editor?\r\n    this.$settings = document.querySelector(`[data-selectable-id-reference=\"${this.target.id}\"]`);\r\n\r\n    this.feedback = JSON.parse(this.$settings.getAttribute('data-module-zpetnavazba'));\r\n    this.settings = JSON.parse(this.$settings.getAttribute('data-module-settings'));\r\n\r\n    this.$items = this.target.querySelectorAll('.selectable-item');\r\n\r\n    this.$inputs = this.target.querySelectorAll('input');\r\n    this.$inputs.forEach(($input) => {\r\n      this._changeClassIfChecked($input);\r\n      this._addEventListeners($input);\r\n    });\r\n\r\n    this.cache = {\r\n      answersCorrect: 0,\r\n      zpetnaVazba: false,\r\n      colors: [],\r\n      checkedInput: 0,\r\n    };\r\n\r\n    // get colors for all feedback variants\r\n    if (this.feedback) {\r\n      this.cache.zpetnaVazba = true;\r\n      this.cache.colors = this.feedback.map((feedback) => feedback.barva);\r\n    }\r\n\r\n  }\r\n\r\n  _addEventListeners($input) {\r\n    $input.addEventListener('change', () => {\r\n      this.$inputs.forEach(($input_) => {\r\n        this._changeClassIfChecked($input_);\r\n      });\r\n      this._checkAndResolveFeedback();\r\n    }, false);\r\n  }\r\n\r\n  /* eslint class-methods-use-this: [\"error\", { \"exceptMethods\": [\"_changeClassIfChecked\"] }] */\r\n  // TODO: might be possible with CSS only with `:checked` selector & sibling combinator`+` or `~`\r\n  _changeClassIfChecked($input) {\r\n    $input.parentNode.classList.toggle('is-checked', $input.checked === true);\r\n  }\r\n\r\n  _checkAndResolveFeedback() {\r\n    this.cache.answersCorrect = 0;\r\n    if (this.settings.viceOdpovedi) {\r\n      this.$items.forEach(($item, index) => {\r\n        if (this.$inputs[index].checked) {\r\n          this.cache.checkedInput += 1;\r\n        }\r\n        if (this.$inputs[index].checked && $item.hasAttribute('data-select-spravnaodpoved')) {\r\n          this.cache.answersCorrect += 1;\r\n        }\r\n        if (!this.$inputs[index].checked && !$item.hasAttribute('data-select-spravnaodpoved')) {\r\n          this.cache.answersCorrect += 1;\r\n        }\r\n      });\r\n    } else {\r\n      this.$items.forEach(($item, index) => {\r\n        if (this.$inputs[index].checked) {\r\n          this.cache.checkedInput += 1;\r\n        }\r\n        if (this.$inputs[index].checked && $item.hasAttribute('data-select-spravnaodpoved')) {\r\n          this.cache.answersCorrect += 1;\r\n        }\r\n      });\r\n    }\r\n\r\n    // Display feedback button (if no checkbox is select, the button is hidden)\r\n    if ((this.cache.checkedInput === 0 && !this.settings.vybrano) || (this.cache.checkedInput === this.$inputs.length && this.settings.vybrano)) {\r\n      this.hideFeedback();\r\n    } else {\r\n\r\n      if (this.cache.zpetnaVazba) {\r\n        const feedbackActual = this.feedback.find((feedback) => feedback.podminka.includes(this.cache.answersCorrect));\r\n        this.$buttonFeedback.classList.remove(...this.cache.colors);\r\n        this.$buttonFeedback.classList.add(feedbackActual.barva);\r\n        this.$buttonFeedbackText.innerText = feedbackActual.text;\r\n      }\r\n\r\n      this.showFeedback();\r\n    }\r\n\r\n    this.cache.checkedInput = 0;\r\n    this._dispatchEvent();\r\n  }\r\n\r\n  _dispatchEvent() {\r\n    const items = Array.from(this.$inputs).map(($input) => ({\r\n      checked: $input.checked,\r\n      id: $input.id,\r\n    }));\r\n\r\n    __dispatchEvent(this.target, 'selection.change', {}, {\r\n      id: this.target.id,\r\n      // task: 'change', // TODO: 'select', 'unselect' ?\r\n      items,\r\n    });\r\n  }\r\n}\r\n","/* eslint-disable no-case-declarations */\r\nimport Component from './component';\r\n\r\nexport default class NewTable extends Component {\r\n  constructor($element) {\r\n    super($element);\r\n    // duplicate source of different editor elements\r\n    this.dataFrom = this.target.parentNode.getAttribute('data-from');\r\n    this.dataSources = this.dataFrom ? this.dataFrom.split(' ') : [];\r\n\r\n    this.init();\r\n\r\n  }\r\n\r\n  init() {\r\n    const autofill = this.target.parentNode.getAttribute('data-autofill');\r\n\r\n    switch (autofill) {\r\n      case 'columns':\r\n        this._columnManager();\r\n        break;\r\n      case 'rows':\r\n        this._rowManager();\r\n        break;\r\n      case 'cells':\r\n        const allCells = this.target.querySelectorAll('td');\r\n\r\n        allCells.forEach(($cell) => {\r\n          const columnId = $cell.getAttribute('data-column-id');\r\n          const rowId = $cell.getAttribute('data-row-id');\r\n          // add listener\r\n          this._cellManager($cell, columnId, rowId);\r\n        });\r\n        break;\r\n      default:\r\n        console.log('NewTableERROR: Undefinated autofill key word!', autofill);\r\n    }\r\n  }\r\n\r\n  _rowManager() {\r\n    document.addEventListener('editor.change', (e) => {\r\n      const data = e.detail.text;\r\n\r\n      if (this.dataSources.includes(data.id)) {\r\n        let $tableRow;\r\n\r\n        // get columns header\r\n        const $header = this.target.previousSibling;\r\n        const $headerCells = $header.firstChild.childNodes;\r\n\r\n        switch (data.task) {\r\n          case 'add':\r\n            $tableRow = document.createElement('tr');\r\n            $tableRow.setAttribute('class', 'table-new__row');\r\n\r\n            $headerCells.forEach(($item) => {\r\n              const $rowCell = document.createElement('td');\r\n              $rowCell.setAttribute('class', 'table-new__cell');\r\n\r\n              const itemType = JSON.parse($item.getAttribute('data-type'));\r\n\r\n              // add data to cell\r\n              NewTable.fillCell(itemType, data, $rowCell);\r\n\r\n              $tableRow.appendChild($rowCell);\r\n            });\r\n\r\n            this.target.appendChild($tableRow);\r\n            break;\r\n          case 'remove':\r\n            const tableRows = this.target.childNodes;\r\n            tableRows.forEach(($row) => {\r\n              $row.childNodes.forEach(($cell, index) => {\r\n                const itemType = JSON.parse($headerCells[index].getAttribute('data-type'));\r\n\r\n                if (NewTable.isRightToDeleteHelper($cell, data.value, itemType)) {\r\n                  $tableRow = $row;\r\n                }\r\n              });\r\n            });\r\n\r\n            $tableRow.remove();\r\n            break;\r\n          default:\r\n            console.log('NewTableERROR: Undefinated task for new table! (rowManager)');\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  _columnManager() {\r\n    document.addEventListener('editor.change', (e) => {\r\n      const data = e.detail.text;\r\n\r\n      if (this.dataSources.includes(data.id)) {\r\n        const $rows = this.target.childNodes;\r\n\r\n        switch (data.task) {\r\n          case 'add':\r\n            $rows.forEach(($row) => {\r\n              const $cell = document.createElement('td');\r\n              $cell.setAttribute('class', 'table-new__cell');\r\n\r\n              const $firstCell = $row.firstChild;\r\n              const itemType = JSON.parse($firstCell.getAttribute('data-type'));\r\n\r\n              // add data to cell\r\n              NewTable.fillCell(itemType, data, $cell);\r\n\r\n              $row.appendChild($cell);\r\n            });\r\n            break;\r\n          case 'remove':\r\n            let columnIndex;\r\n            $rows.forEach(($row) => {\r\n              const $firstCell = $row.firstChild;\r\n              const itemType = JSON.parse($firstCell.getAttribute('data-type'));\r\n\r\n              $row.childNodes.forEach(($cell, index) => {\r\n                if (NewTable.isRightToDeleteHelper($cell, data.value, itemType)) {\r\n                  columnIndex = index;\r\n                }\r\n              });\r\n            });\r\n\r\n            this.target.childNodes.forEach(($row) => {\r\n              $row.childNodes[columnIndex].remove();\r\n            });\r\n            break;\r\n          default:\r\n            console.log('NewTableERROR: Undefinated task for new table! (columnManager)');\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  _cellManager($cell, columnId, rowId) {\r\n    document.addEventListener('editor.change', (e) => {\r\n      const data = e.detail.text;\r\n\r\n      if (this.dataSources.includes(data.id) && data.id === columnId && data.tagName === rowId) {\r\n        const itemType = JSON.parse(this._findCellType($cell));\r\n\r\n        switch (data.task) {\r\n          case 'add':\r\n            const $tag = document.createElement('div');\r\n            NewTable.fillCell(itemType, data, $cell);\r\n\r\n            $cell.appendChild($tag);\r\n            break;\r\n          case 'remove':\r\n            const $tags = $cell.querySelectorAll('div');\r\n            $tags.forEach(($elm) => {\r\n              if (NewTable.isRightToDeleteHelper($elm, data.value, itemType)) {\r\n                $elm.remove();\r\n              }\r\n            });\r\n            break;\r\n          default:\r\n            console.log('NewTableERROR: Undefinated task for new table! (cellManager)');\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  static fillCell(itemType, data, $node) {\r\n    let $innerItem;\r\n\r\n    switch (itemType.name) {\r\n      case 'dup-text':\r\n        $innerItem = document.createElement('div');\r\n        if (itemType.type === 'text') {\r\n          $innerItem.innerHTML = data.value.textContent;\r\n        } else if (itemType.type === 'tag') {\r\n          $innerItem.appendChild(data.value);\r\n        }\r\n        break;\r\n      case 'select':\r\n        $innerItem = document.createElement(itemType.name);\r\n        itemType.options.forEach((value) => {\r\n          const $option = document.createElement('option');\r\n          $option.innerHTML = value;\r\n          $innerItem.appendChild($option);\r\n        });\r\n        break;\r\n      case 'input':\r\n        $innerItem = document.createElement(itemType.name);\r\n        $innerItem.setAttribute('class', 'table-new__cell--input');\r\n        Object.keys(itemType.attributes).forEach((key) => {\r\n          $innerItem.setAttribute(key, itemType.attributes[key]);\r\n        });\r\n        break;\r\n      default:\r\n        $innerItem = document.createElement('div');\r\n        /*\r\n          if item Type name is value of data object from delivered cviceni feature\r\n          then use it and it's value set in table\r\n          else set empry value and show error\r\n       */\r\n        if (data.tagData[itemType.name]) {\r\n          $innerItem.innerHTML = data.tagData[itemType.name];\r\n        } else {\r\n          $innerItem.innerHTML = ' ';\r\n          console.log('FillCellERROR: Undefinated object name.', itemType);\r\n        }\r\n    }\r\n    $node.appendChild($innerItem);\r\n  }\r\n\r\n  // prepare for more types of duplicate types\r\n  static isRightToDeleteHelper(elm, deliveredValue, itemType) {\r\n    let result;\r\n    if (itemType.name === 'dup-text') {\r\n      result = elm.textContent === deliveredValue.textContent;\r\n    }\r\n    return result;\r\n  }\r\n\r\n  _findCellType($cell) {\r\n    const rowType = $cell.parentNode.firstChild.getAttribute('data-type');\r\n    if (rowType) return rowType;\r\n\r\n    // if rows header isn´t definated\r\n    const columnId = $cell.getAttribute('data-column-id');\r\n    const $columnHeader = this.target.parentNode.querySelector(`th[data-column-id=${columnId}]`);\r\n    if ($columnHeader) return $columnHeader.getAttribute('data-type');\r\n\r\n    return 'empty';\r\n  }\r\n}\r\n","import domLoadComponents from './dom-load';\r\nimport windowLoadComponents from './window-load';\r\n\r\n// The DOMContentLoaded event fires when parsing of the current page is complete. DOMContentLoaded is a great event to use to hookup UI functionality to complex web pages.\r\ndocument.addEventListener('DOMContentLoaded', domLoadComponents, false);\r\n\r\n// The load event fires when all files have finished loading from all resources, including ads and images.\r\nwindow.addEventListener('load', windowLoadComponents, false);\r\n","\r\nconst domLoadComponents = () => {\r\n  console.log('domLoad:components');\r\n\r\n  // instantiate\r\n\r\n  // run\r\n\r\n};\r\n\r\nexport default domLoadComponents;\r\n","/* eslint-disable no-unused-vars */\r\nimport MagnifyingGlass from './magnifying-glass';\r\nimport Sortable from './sortable';\r\nimport SVG from './svg';\r\nimport SVGRadialMenu from './svg-lib/svg-radial-menu';\r\nimport Editor from './editor/editor';\r\nimport AnalyticalTable from './analytical-table';\r\nimport Keywords from './keywords';\r\nimport EditorTagsPlaceholder from './editor-tags-placeholder';\r\nimport TestQuiz from './test-quiz';\r\nimport GenericTable from './generic-table';\r\nimport FullscreenToggle from './fullscreen';\r\nimport UserText from './user-text';\r\nimport AudioPlayerNormal from './media/audio-player-normal';\r\nimport AudioPlayerSimple from './media/audio-player-simple';\r\nimport FakeMap from './fake-map';\r\nimport { stopPlayingVideoPlayers } from './media/media';\r\nimport VideoPlayer from './media/video';\r\nimport Selectable from './selectable';\r\nimport NewTable from './new-table';\r\n\r\n// import actionTypes from '../store/store-constants';\r\n// import storeGlobal from '../store/store-global';\r\n\r\nconst windowLoadComponents = () => {\r\n  console.log('windowLoad:components');\r\n\r\n  // Video player - normal\r\n  const $videoPlayers = Array.from(\r\n    document.querySelectorAll('[data-player-video]'),\r\n  );\r\n  if ($videoPlayers.length > 0) {\r\n    $videoPlayers.forEach(($videoPlayer) => {\r\n      // console.log('$videoPlayer', $videoPlayer);\r\n      const videoPlayer = new VideoPlayer($videoPlayer);\r\n    });\r\n\r\n    document.addEventListener('slide.change', () => {\r\n      stopPlayingVideoPlayers($videoPlayers);\r\n    });\r\n  }\r\n\r\n  // Audio player - normal\r\n  const $audioPlayerNormals = Array.from(\r\n    document.querySelectorAll('[data-player-audio=\"normal\"]'),\r\n  );\r\n  if ($audioPlayerNormals.length > 0) {\r\n    $audioPlayerNormals.forEach(($audioPlayerNormal) => {\r\n      const audioPlayerNormal = new AudioPlayerNormal($audioPlayerNormal);\r\n    });\r\n\r\n    // TODO > audio-player-normal.js#61\r\n    // document.addEventListener('slide.change', () => {\r\n    //   stopPlayingVideoPlayers($audioPlayerNormals);\r\n    // });\r\n  }\r\n\r\n  // Audio player — simple\r\n  const $audioPlayerSimples = Array.from(document.querySelectorAll(\r\n    '[data-player-audio=\"simple\"]',\r\n  ));\r\n  if ($audioPlayerSimples.length > 0) {\r\n    $audioPlayerSimples.forEach(($audioPlayerSimple) => {\r\n      const audioPlayerSimple = new AudioPlayerSimple($audioPlayerSimple);\r\n    });\r\n\r\n    document.addEventListener('slide.change', () => {\r\n      stopPlayingVideoPlayers($audioPlayerSimples);\r\n    });\r\n  }\r\n\r\n  // Fullscreen\r\n  const $fullscreenToggles = document.querySelectorAll(\r\n    '[data-fullscreen=\"toggle\"]',\r\n  );\r\n  if ($fullscreenToggles.length > 0) {\r\n    Array.from($fullscreenToggles).forEach(($fullscreenToggle) => {\r\n      const fullscreenToggle = new FullscreenToggle($fullscreenToggle);\r\n    });\r\n  }\r\n\r\n  // Magnifying glass\r\n  const $magnifyingGlass = document.querySelectorAll('[data-lupa-target]');\r\n  if ($magnifyingGlass.length > 0) {\r\n    for (let i = 0; i < $magnifyingGlass.length; i += 1) {\r\n      const magnifyingGlass = new MagnifyingGlass($magnifyingGlass[i]);\r\n    }\r\n  }\r\n\r\n  // Fake Map\r\n  const $fakeMaps = document.querySelectorAll('[data-fake-map=\"target\"]');\r\n  if ($fakeMaps.length > 0) {\r\n    for (let i = 0; i < $fakeMaps.length; i += 1) {\r\n      const fakeMap = new FakeMap($fakeMaps[i]);\r\n    }\r\n  }\r\n\r\n  //\r\n  // load these below in working mode only\r\n\r\n  // User texts\r\n  // - preview/working mode logic in side the component\r\n  //  - show\r\n  const $userTexts = document.querySelectorAll('[data-textarea-target=\"\"]');\r\n  if ($userTexts.length > 0) {\r\n    Array.from($userTexts).forEach(($userText) => {\r\n      const userText = new UserText($userText);\r\n    });\r\n  }\r\n\r\n  // SVG + Radial menu\r\n  // - preview/working mode logic in side the component\r\n  //  - to set max-width\r\n  const $svgs = document.querySelectorAll('[data-svg-target]');\r\n  if ($svgs.length > 0) {\r\n\r\n    if (HISTORYLAB.import.done !== true) {\r\n      // radial menu\r\n      const $radialMenu = document.querySelector('[data-radial-menu]');\r\n      if ($radialMenu) {\r\n        const radialMenu = new SVGRadialMenu($radialMenu, $svgs);\r\n      }\r\n    }\r\n\r\n    // svgs\r\n    Array.from($svgs).forEach(($svg) => {\r\n      const svg = new SVG($svg);\r\n    });\r\n  }\r\n\r\n  if (HISTORYLAB.import.done !== true) {\r\n\r\n    // Editor\r\n    const $editors = document.querySelectorAll('[data-editor]');\r\n    if ($editors.length > 0) {\r\n      Array.from($editors).forEach(($editor) => {\r\n        const editor = new Editor($editor);\r\n      });\r\n    }\r\n\r\n    // Test Quizes\r\n    const $testQuizs = document.querySelectorAll('[data-target-test-quiz]');\r\n    if ($testQuizs.length > 0) {\r\n      Array.from($testQuizs).forEach(($testQuiz) => {\r\n        const settings = document.querySelector(\r\n          `[data-test-quiz-id-reference=\"${$testQuiz.getAttribute(\r\n            'data-test-quiz-id',\r\n          )}\"]`,\r\n        );\r\n\r\n        const testQuiz = new TestQuiz(\r\n          $testQuiz.getAttribute('data-test-quiz-id'),\r\n          $testQuiz,\r\n          JSON.parse(settings.getAttribute('data-module-settings')),\r\n        );\r\n        testQuiz.init();\r\n      });\r\n    }\r\n\r\n    // Analytical tables\r\n    const $analyticalTables = document.querySelectorAll(\r\n      '[data-target-analytical-table]',\r\n    );\r\n\r\n    if ($analyticalTables.length > 0) {\r\n      Array.from($analyticalTables).forEach(($analyticalTable) => {\r\n        const settings = document.querySelector(\r\n          `[data-analytical-table-id-reference=\"${$analyticalTable.getAttribute(\r\n            'data-analytical-table-id',\r\n          )}\"]`,\r\n        );\r\n        const analyticalTable = new AnalyticalTable(\r\n          $analyticalTable.getAttribute('data-analytical-table-id'),\r\n          $analyticalTable,\r\n          JSON.parse(settings.getAttribute('data-module-settings')),\r\n        );\r\n        analyticalTable.init();\r\n      });\r\n    }\r\n\r\n    // Generic tables\r\n    const $genericTables = document.querySelectorAll(\r\n      '[data-target-generic-table]',\r\n    );\r\n    if ($genericTables.length > 0) {\r\n      Array.from($genericTables).forEach(($genericTable) => {\r\n        const settings = document.querySelector(\r\n          `[data-generic-table-id-reference=\"${$genericTable.id}\"]`,\r\n        );\r\n        const genericTable = new GenericTable(\r\n          $genericTable,\r\n          JSON.parse(settings.getAttribute('data-module-settings')),\r\n        );\r\n        genericTable.init();\r\n      });\r\n    }\r\n\r\n    // New table\r\n    const $newTables = document.querySelectorAll('[data-new-table]');\r\n    if ($newTables.length > 0) {\r\n      Array.from($newTables).forEach(($newTable) => {\r\n        const newTable = new NewTable($newTable);\r\n      });\r\n    }\r\n\r\n    // Sortable\r\n    const $sortables = document.querySelectorAll('[data-sortable-target]');\r\n    if ($sortables.length > 0) {\r\n      Array.from($sortables).forEach(($sortable) => {\r\n        const sortable = new Sortable($sortable);\r\n      });\r\n    }\r\n\r\n    // Selectable\r\n    const $selectables = document.querySelectorAll('[data-selectable-target]');\r\n    if ($selectables.length > 0) {\r\n      Array.from($selectables).forEach(($selectable) => {\r\n        const selectable = new Selectable($selectable);\r\n      });\r\n    }\r\n\r\n    // Keywords selection\r\n    const $keywords = document.querySelectorAll('[data-keywords]');\r\n    if ($keywords.length > 0) {\r\n      Array.from($keywords).forEach(($keyword) => {\r\n        const settings = $keyword.hasAttribute('data-module-settings')\r\n          ? $keyword.getAttribute('data-module-settings')\r\n          : {};\r\n        const keywords = new Keywords($keyword, JSON.parse(settings));\r\n        keywords.init();\r\n      });\r\n    }\r\n\r\n    // Editor tags placeholders\r\n    const $editorTagsPlaceholders = document.querySelectorAll(\r\n      '.editor-tags-placeholder',\r\n    );\r\n    if ($editorTagsPlaceholders.length > 0) {\r\n      Array.from($editorTagsPlaceholders).forEach((item) => {\r\n        const editorTagsPlaceholder = new EditorTagsPlaceholder(item);\r\n        editorTagsPlaceholder.init();\r\n      });\r\n    }\r\n  }\r\n};\r\n\r\nexport default windowLoadComponents;\r\n"],"names":["Component","$element","target","$slide","this","closest","lang","document","documentElement","getAttribute","$buttonFeedback","querySelector","$buttonFeedbackText","showFeedback","bind","classList","contains","remove","add","MagnifyingGlass","$canvas","ctx","_this","getContext","_onStart","_onMove","_onEnd","_update","_onResize","zoomGlassSize","targetBCR","zoomed","targetZoomed","x","y","trackingTouch","_addEventListeners","_initCanvas","window","requestAnimationFrame","width","height","dPR","devicePixelRation","style","scale","getBoundingClientRect","event","preventDefault","pageX","touches","pageY","TAU","Math","PI","radius","ratioX","max","min","left","ratioY","top","scaledTargetWidth","scaledTargetHeight","platform","os","family","indexOf","name","shadowColor","shadowBlur","shadowOffsetY","clearRect","fillStyle","beginPath","arc","closePath","fill","save","clip","drawImage","restore","transform","addEventListener","__createNewCustomEvent","options","data","defaults","bubbles","properties","Object","assign","CustomEvent","detail","__dispatchEvent","type","payload","dispatchEvent","__isObject","item","_typeof","Array","isArray","__insertBefore","newNode","referenceNode","parentNode","insertBefore","__insertAfter","nextSibling","__remove","el","removeChild","__getHTML","node","tagName","outerHTML","wrapper","createElement","appendChild","cloneNode","innerHTML","__localPosition","container","pos","d3","mouse","format","__positionTranslated","curTransform","WebKitCSSMatrix","getComputedStyle","webkitTransform","body","pageYOffset","scrollTop","pageXOffset","scrollLeft","offsetLeft","m41","offsetTop","m42","__position","elAttibutes","__toggleClass","element","cls","__hasClass","__removeClass","__addClass","className","elements","classes","_elements","_classes","querySelectorAll","split","i","length","j","console","log","replace","RegExp","mediaEvents","playchange","timechange","canplaystart","stopPlayingVideoPlayers","$players","forEach","$player","$media","paused","pause","setAttribute","getSecondsMinutesFormat","seconds","duration","floor","minutes","toString","slice","AudioPlayer","$item","$audio","$playButton","$timeLeft","from","play","stopPropagation","innerText","currentTime","Sortable","$settings","id","feedback","JSON","parse","$items","$droppables","$placeholder","direction","before","after","evaluation","undefined","clientX","clientY","x0","y0","x1","y1","dragged","clone","posRel","rect","size","siblings","prev","next","cache","answersCorrect","colors","map","barva","hasAttribute","offsetWidth","offsetHeight","_addPlaceholder","_onOver","right","_onDrop","bottom","_removePlaceholder","_dispatchEvent","_checkAndResolveFeedback","_getReference","_addEventListenerToItem","addEventListeners","parentElement","minHeight","src","img","nextElementSibling","previousElementSibling","_this2","index","correctAnswerAttr","parseInt","_this3","feedbackActual","find","podminka","includes","text","splneno","items","SVGDragNDrop","select","raise","classed","diff","attr","toFixed","SVGDraw","$svg","callback","sourceEvent","nodeName","line","curve","curveLinear","d","subject","active","append","datum","on","dx","dy","push","$thisPath","svg","task","contextMenu","pathEventsManager","d3svg","localPosition","circleEventsManager","elementPosition","selection","selectAll","nodes","call","drag","start","oldXCoordinate","oldYCoordinate","taskType","end","SVG","removeCloneConnectionManager","SVGText","maxLength","minLength","svgID","svgGroup","$radialMenu","hash","orientation","foreignObject","textarea","focus","textEventsManager","$node","isCreated","firstWrite","oldText","value","childNodes","updateTextareaHeight","$target","wrongBool","isWrong","removeItem","scrollHeight","isBubble","_setSize","HISTORYLAB","done","init","toDuplicate","svgSpecificActions","_initPath","_initCircle","_initComicBubbles","_getEvents","viewbox","maxWidth","warn","p","renderPath","createCircle","$comicBubbles","$comicBubble","comicBubblesEventsManager","_this4","oldID","idParts","join","svgDuplicateSources","e","$templateNode","localNodeID","_this5","_generateNewID","$localNode","_clonePath","color","_cloneComicBubbles","_cloneTextField","_cloneCircle","selected","isRadial","$parent","allActiveSvgs","deactivate","pop","SVGRadialMenu","$svgs","$radialMenuItems","$colorItems","$textItems","$createTextItem","$removeItem","$tooltip","initialSetUp","menuRadius","getPropertyValue","itemRadius","setUpRadialMenuItems","addEventListenersToRadialMenu","activate","deselectItem","filterMenuButtons","showRadialMenu","addEventListenersToRadialMenuItem","_itemsLength","_menuRadius","_itemRadius","_menuOffset","_centerOffset","angle","sin","cos","onMouseLeave","hideRadialMenu","action","createText","changeColor","currentTarget","display","$activeSVG","globalPosition","__globalPosition","$activeRadialMenuItem","positionRadialMenuItems","setTimeout","mouseLeaveDelay","_this6","clearTimeout","clickedItem","$colorItem","$textItem","selectItem","Observer","_events","events","fn","_split","filter","current_fn","args","actionTypes","editor","ADD_TAG","DELETE_TAG","UPDATE_TAG","CHANGE","keywords","testQuiz","ADD_ANSWER","REMOVE_ANSWER","UPDATE_ANSWER","textOptions","ADD","DELETE","UPDATE","store","_data","tags","tagId","tagExists","tagContainer","_checkTagExists","Error","userSelectedNodeItems","trigger","splice","editorId","opts","key","selectedTags","objectExists","_checkExists","selectedObjs","Editor","$editor","settings","__mergeDeep","source","output","keys","models","passive","interactive","withMenu","totalTagId","hasMenu","lastSelectionSettings","isCollapsed","savedSelectionRange","selectionAttributes","dummyRangeElement","selectionMouseDown","selectionDirection","hasEditableContentChanged","lastPressedKey","hasToolbar","toolbar","originalContent","currentContent","_handlers","wrapLastDeletesTimeoutClass","wrapLastDeletesTimeoutFunction","wrapLastAdditionsTimeoutClass","wrapLastAdditionsTimeoutFunction","isWrappingLastText","isWriting","$groupDeleted","_hasMenu","$menu","getElementsByClassName","menuClass","$menuActions","$menuClose","error","_hasToolbar","canvasClass","funkce","html","_generateNewTagGroupClass","$btnReset","registerEditableHandlers","initPreHighlightedTextOptions","handlerFocus","keycode","getSelection","keyCode","which","keyName","rangeCount","range","getRangeAt","cloneRange","setStart","startContainer","startOffset","collapse","setEnd","endContainer","endOffset","addedFragmentString","cloneContents","textContent","trim","dummyElementInner","surroundContents","removeAllRanges","addRange","dummyElement","contentEditable","newGeneratedId","_generateNewTagId","$btnClose","closeBtnClass","$nodeElement","_removeNodeKeepTextContent","getElementById","wrapLastDeletesTimeout","textToAddElement","insertNode","setStartAfter","groupDeletedId","$groupInnerDeleted","$groupInnerAdded","$groupAdded","registerMenuHandler","confirm","len","handlerMenuActions","handlerMenuClose","$textOptionsElements","$textOption","selectedClass","idForSend","storeGlobal","tag","tagData","clickClose","_setmenuDimensions","leftDimensions","topDimensions","menuDimensions","translated","clonedElement","visibility","elDimensions","elPosition","__getRealDimensions","parentTranslatedPosition","parentDimensions","isOverflowAt","menuMargin","toggleMenu","$el","command","commandName","setSelection","anchorOffset","focusOffset","_setSelectionPosition","selectionPosition","selectionDimension","$domEl","extractContents","newTagId","addTag","classesArray","tagColor","createTextNode","parentEl","$elClose","toggleClass","clickHandler","$closeBtn","removeEventListener","commentRef","deleteTag","nodePosition","commentMargin","commentTemplate","div","commentDiv","nodeRef","commentNewTextarea","commentDivButtonSubmit","getElementsByTagName","commentCommentsContainer","calculatedCommentPosition","_calculateCommentPosition","commentItem","_createCommentForNode","closeBtn","_createCloseBtnForElement","comments","_addCommentHandlerForElement","commentsClass","_extractAndSaveContents","showCommentsOnInit","click","resetBtnClass","nodeSelectedClass","enable","animatedClass","deselectedClass","menu","AnalyticalTable","isAdvanced","rowIndex","tableResult","tableResultBody","tableSelectedItems","tableSelectedItemsBody","activeDragged","_getRowHTML","_getAdvancedRowHTML","_registerStoreHandlers","_registerHandlers","addedTagContainer","casti","sloupce","insertAdjacentHTML","letSecondCaseRunIfSame","_handlerDraggable","prototype","_handlerDrop","dataTransfer","setData","dropEffect","opacity","localName","background","nodeHTML","tableRowTemplate","keywordsId","newItems","newItemsHTML","itemsHTML","Keywords","$controls","$itemsContainer","itemsContainerClassName","inherit","isInherited","itemClassName","_getHTMLFromItems","change","_getItemsFromHTML","_getItemsHTML","onInit","_regenerateItemsContainerFromInherited","_changeSizeOfKeywordItem","skala","maxLevel","setNewLevelValue","$keyword","number","oldValue","newValue","abs","$control","tempContent","temp","renameItemsIds","_eventHandler","_getItemFromDOMElement","itemsClassName","itemsArray","_getDOMElementFromItem","newDiv","contentHTML","oldId","newId","expString","EditorTagsPlaceholder","commandNames","itemSubscribeAttributeClassName","getTagsBy","content","TestQuiz","$questions","itemClass","questions","zpetnaVazba","$question","questionIndex","answered","answerCorrect","$answers","optionClass","$answer","answerIndex","$answerCurrent","$answersItem","question","GenericTable","$tableResultBody","dataSettings","tasksToComplete","tasksCompleted","tasks","subscribe","$allRows","$newSelects","$select","taskNumber","$row","nazev","vyraz","FullscreenToggle","$fullscreenImage","$fullscreen","toggle","image","innerWidth","innerHeight","ratio","onload","naturalWidth","naturalHeight","UserText","$userTexts","$counter","$wrapper","lengthExpected","avg","lastValue","hadData","wasUsed","updateCharacterCounter","textDuplicateSources","getEvents","none","ok","conditionAll","$userText","taskName","valueLength","updateFeedback","AudioPlayerNormal","$loadWave","$leftTime","$audioDuration","wavesurfer","WaveSurfer","create","waveColor","progressColor","responsive","barWidth","load","dataset","initWave","getDuration","addListenerAfterReady","time","playPause","$nextSlides","$nextSlide","AudioPlayerSimple","$duration","FakeMap","$buttons","$maps","lastActiveIndex","addEventListenerToButtons","$button","switchMap","VideoPlayer","prefix","interval","$document","ownerDocument","$play","$playSymbol","$pauseSymbol","$time","$timeMeter","$timeRange","$currentTimeText","$currentTime","durationTime","$durationTime","timeToAural","$enterFullscreenSymbol","$leaveFullscreenSymbol","_fullscreenchange","_requestFullscreen","requestFullscreen","webkitRequestFullscreen","msRequestFullscreen","onCanPlayStart","onLoadStart","onLoadedData","onPlayChange","onTimeChange","onPlayClick","onTimeKeydown","onTimeClick","onFullscreenClick","onFullscreenChange","onDrag","percentage","clearInterval","setInterval","currentTimePercentage","currentTimeCode","nodeValue","nCanPlayStart","autoplay","isFullscreen","_fullscreenElement","leaveFullscreen","enterFullscreen","pointerType","_exitFullscreen","webkitSupportsFullscreen","webkitDisplayingFullscreen","webkitExitFullscreen","webkitEnterFullscreen","shiftKey","offset","fullscreenElement","webkitFullscreenElement","msFullscreenElement","exitFullscreen","webkitCancelFullScreen","msExitFullscreen","innerTarget","listener","hasPointerEvent","onpointerup","hasTouchEvent","ontouchstart","pointerDown","pointerMove","pointerUp","onpointermove","position","defaultView","langMinutes","langSeconds","Selectable","$inputs","$input","_changeClassIfChecked","checkedInput","$input_","checked","viceOdpovedi","vybrano","hideFeedback","NewTable","dataFrom","dataSources","autofill","_columnManager","_rowManager","$cell","columnId","rowId","_cellManager","$tableRow","$headerCells","previousSibling","firstChild","$rowCell","itemType","fillCell","isRightToDeleteHelper","$rows","$firstCell","columnIndex","_findCellType","$tag","$elm","rowType","$columnHeader","$innerItem","$option","attributes","elm","deliveredValue","result","$videoPlayers","$videoPlayer","$audioPlayerNormals","$audioPlayerNormal","$audioPlayerSimples","$audioPlayerSimple","$fullscreenToggles","$fullscreenToggle","$magnifyingGlass","$fakeMaps","$editors","$testQuizs","$testQuiz","$analyticalTables","$analyticalTable","$genericTables","$genericTable","$newTables","$newTable","$sortables","$sortable","$selectables","$selectable","$keywords","$editorTagsPlaceholders"],"mappings":"itEAAqBA,wBACPC,kBACLC,OAASD,OACTE,OAASC,KAAKF,OAAOG,QAAQ,eAC7BC,KAAOC,SAASC,gBAAgBC,aAAa,QAE9CL,KAAKD,cACFO,gBAAkBN,KAAKD,OAAOQ,cAAc,+BAC5CC,oBAAsBR,KAAKM,gBAAgBC,cAAc,cAG3DE,aAAeT,KAAKS,aAAaC,KAAKV,uDAIvCA,KAAKM,iBAAmBN,KAAKM,gBAAgBK,UAAUC,SAAS,uBAC7DN,gBAAgBK,UAAUE,OAAO,6DAKnCP,gBAAgBK,UAAUG,IAAI,0BCnBlBC,yBAEPlB,mDACJA,KAODA,SAAWM,SAASI,cAAc,iBAClCS,QAAUb,SAASI,cAAc,wBACjCU,IAAMC,EAAKF,QAAQG,WAAW,QAE9BC,SAAWF,EAAKE,SAASV,aACzBW,QAAUH,EAAKG,QAAQX,aACvBY,OAASJ,EAAKI,OAAOZ,aACrBa,QAAUL,EAAKK,QAAQb,aACvBc,UAAYN,EAAKM,UAAUd,aAE3Be,cAAgB,MAChBC,UAAY,OACZC,OAAS,IACTC,aAAe,IAEfC,EAAI,IACJC,EAAI,IACJC,eAAgB,IAEhBC,uBACAC,gBACAT,YAELU,OAAOC,sBAAsBjB,EAAKK,sEAI5Ba,EAAQpC,KAAKyB,cACbY,EAASrC,KAAKyB,cAEda,EAAMJ,OAAOK,mBAAqB,OACnCvB,QAAQoB,MAAQA,EAAQE,OACxBtB,QAAQqB,OAASA,EAASC,OAE1BtB,QAAQwB,MAAMJ,gBAAWA,aACzBpB,QAAQwB,MAAMH,iBAAYA,aAE1BpB,IAAIwB,MAAMH,EAAKA,4CAIfZ,UAAY1B,KAAKF,OAAO4C,yDAGtBC,GACHA,EAAM7C,SAAWE,KAAKF,SAI1B6C,EAAMC,sBAGDf,EAAIc,EAAME,OAASF,EAAMG,QAAQ,GAAGD,WACpCf,EAAIa,EAAMI,OAASJ,EAAMG,QAAQ,GAAGC,WAEpChB,eAAgB,OAChBH,aAAe,OACfD,OAAS,EAEdO,OAAOC,sBAAsBnC,KAAKuB,0CAG5BoB,GACD3C,KAAK+B,qBAILF,EAAIc,EAAME,OAASF,EAAMG,QAAQ,GAAGD,WACpCf,EAAIa,EAAMI,OAASJ,EAAMG,QAAQ,GAAGC,wCAIrC/C,KAAK4B,mBAEFnB,oBAGFmB,aAAe,OACfG,eAAgB,wCAIfiB,EAAgB,EAAVC,KAAKC,GAEXC,EADa,IACJnD,KAAK2B,YAEfD,UAAY1B,KAAKF,OAAO4C,4BAGvBU,EAEJH,KAAKI,IAAI,EAEPJ,KAAKK,IAAI,GAAKtD,KAAK6B,EAAI7B,KAAK0B,UAAU6B,MAAQvD,KAAK0B,UAAUU,QAG3DoB,EAEJP,KAAKI,IAAI,EAEPJ,KAAKK,IAAI,GAAKtD,KAAK8B,EAAI9B,KAAK0B,UAAU+B,KAAOzD,KAAK0B,UAAUW,SAM1DqB,EADa,IACO1D,KAAK0B,UAAUU,MACnCuB,EAFa,IAEQ3D,KAAK0B,UAAUW,OAGpCuB,SAASC,GAAGC,OAAOC,QAAQ,YAAc,GAAKH,SAASI,KAAKD,QAAQ,YAAc,SAEjF9C,IAAIgD,YAAc,uBAClBhD,IAAIiD,WAAa,QACjBjD,IAAIkD,cAAgB,QAItBlD,IAAImD,UAAU,EAAG,EAAGpE,KAAKyB,cAAezB,KAAKyB,oBAC7CR,IAAIoD,UAAY,YAChBpD,IAAIqD,iBACJrD,IAAIsD,SAEF9C,cAAgB,OAEfA,cAAgB,GAAM0B,EAE5BA,EAAQ,EAAGH,QACR/B,IAAIuD,iBACJvD,IAAIwD,YAGJxD,IAAIyD,YAGJzD,IAAIqD,iBACJrD,IAAIsD,SAEF9C,cAAgB,OAEfA,cAAgB,IAAO0B,EAAS,GAE7B,KAATA,EAAe,EAAGH,QACf/B,IAAI0D,YACJ1D,IAAIuD,iBACJvD,IAAI2D,UAAU5E,KAAKF,QAEpBsD,EAASM,EAAsB1D,KAAKyB,cAAgB,GACpD+B,EAASG,EAAuB3D,KAAKyB,cAAgB,EAEvDiC,EAAmBC,QAIhB1C,IAAI4D,eAGJhF,SAAS2C,MAAMsC,8BAAyB9E,KAAK6B,iBAAQ7B,KAAK8B,cAG1DH,SAAW3B,KAAK4B,aAAe5B,KAAK2B,QAAU,EAG/C3B,KAAK2B,OAAS,KAEhBO,OAAOC,sBAAsBnC,KAAKuB,cAI7BI,OAAS,+CAMhBxB,SAAS4E,iBAAiB,aAAc/E,KAAKoB,UAC7CjB,SAAS4E,iBAAiB,YAAa/E,KAAKqB,SAC5ClB,SAAS4E,iBAAiB,WAAY/E,KAAKsB,QAE3CnB,SAAS4E,iBAAiB,YAAa/E,KAAKoB,UAC5CjB,SAAS4E,iBAAiB,YAAa/E,KAAKqB,SAC5ClB,SAAS4E,iBAAiB,UAAW/E,KAAKsB,QAE1CY,OAAO6C,iBAAiB,SAAU/E,KAAKwB,kBAjME5B,GCqBtC,SAASoF,EAAuBhB,OAAMiB,yDAAU,GAAIC,yDAAO,KAC1DC,EAAW,CAEfC,SAAS,GAkBLC,EAAaC,OAAOC,OAAOJ,EAAUF,UAEpC,IAAIO,YAAYxB,KACrByB,OAAQP,GACLG,IAIA,SAASK,EAAgB7F,EAAU8F,EAAMV,EAASW,OACjDjD,EAAQqC,EAAuBW,EAAMV,EAASW,GAEpD/F,EAASgG,cAAclD,GAiClB,SAASmD,EAAWC,UACjBA,GAAwB,WAAhBC,EAAOD,KAAsBE,MAAMC,QAAQH,GA2BtD,SAASI,EAAeC,EAASC,GACtCA,EAAcC,WAAWC,aAAaH,EAASC,GAG1C,SAASG,EAAcJ,EAASC,GAErCA,EAAcC,WAAWC,aAAaH,EAASC,EAAcI,aA4BxD,SAASC,EAASC,GAEvBA,EAAGL,WAAWM,YAAYD,GAKrB,SAASE,EAAUC,MAEnBA,GAASA,EAAKC,YACfD,EAAKE,iBAAoBF,EAAKE,cAG5BC,EAAU9G,SAAS+G,cAAc,cACvCD,EAAQE,YAAYL,EAAKM,WAAU,IAC5BH,EAAQI,WAkBV,SAASC,EAAgBC,OAIxBC,EAAMC,GAAGC,MAAMH,SACd,CACL1F,EAAG4F,GAAGE,OAAO,MAAVF,CAAiBD,EAAI,IACxB1F,EAAG2F,GAAGE,OAAO,MAAVF,CAAiBD,EAAI,KAIrB,SAASI,EAAqBjB,OAG7BkB,EAAe,IAAIC,gBAAgB5F,OAAO6F,iBAAiBpB,GAAIqB,iBAE/DC,EAAO9H,SAAS8H,KAEJ/F,OAAOgG,aAAeD,EAAKE,UAC1BjG,OAAOkG,aAAeH,EAAKI,iBAEvC,CACL9E,KAAMoD,EAAG2B,WAAaT,EAAaU,IACnC9E,IAAKkD,EAAG6B,UAAYX,EAAaY,KAK9B,SAASC,EAAW/B,OAEnBgC,EAAchC,EAAGjE,wBACjBuF,EAAO9H,SAAS8H,KAEhBE,EAAYjG,OAAOgG,aAAeD,EAAKE,UACvCE,EAAanG,OAAOkG,aAAeH,EAAKI,iBAEvC,CACL9E,KAAMoF,EAAYpF,KAAO8E,EACzB5E,IAAKkF,EAAYlF,IAAM0E,EACvB9F,OAAQsG,EAAYtG,OACpBD,MAAOuG,EAAYvG,OAKhB,SAASwG,EAAcC,EAASC,GACjCC,EAAWF,EAASC,GACtBE,EAAcH,EAASC,GAEvBG,EAAWJ,EAASC,GAIjB,SAASC,EAAWF,EAASC,YAE7BD,IAAYC,KACTD,EAAQlI,UAAakI,EAAQlI,UAAUC,SAASkI,GAAO,UAAID,EAAQK,eAAcnF,kBAAW+E,SAAW,GAG1G,SAASG,EAAWE,EAAUC,OAC/BC,EAAYF,EACZG,EAAWF,KAGVC,GAAcC,KAEQ,iBAAfD,EAEVA,EAAYlJ,SAASoJ,iBAAiBF,GAC7BA,EAAUtC,UAEnBsC,EAAY,CAACA,IAGW,iBAAdC,GAEVA,EAAWA,EAASE,MAAM,SAOvB,IAAIC,EAAI,EAAGA,EAAIJ,EAAUK,OAAQD,GAAK,EAAG,UAExCJ,EAAUI,GAAG9I,aACf0I,EAAUI,GAAG9I,WAAUG,cAAOwI,SACzB,IAAKP,gBAAWM,EAAUI,aAAOH,SACjC,IAAIK,EAAI,EAAGA,EAAIL,EAASI,OAAQC,GAAK,EACxCN,EAAUI,GAAGL,oBAAeE,EAASK,UAXzCC,QAAQC,IAAI,qEAiBT,SAASb,EAAcG,EAAUC,OAClCC,EAAYF,EACZG,EAAWF,KAGVC,GAAcC,KAEQ,iBAAfD,EAEVA,EAAYlJ,SAASoJ,iBAAiBF,GAC7BA,EAAUtC,UAEnBsC,EAAY,CAACA,IAGW,iBAAdC,GAEVA,EAAWA,EAASE,MAAM,SAOvB,IAAIC,EAAI,EAAGA,EAAIJ,EAAUK,OAAQD,GAAK,EAAG,UAExCJ,EAAUI,GAAG9I,aACf0I,EAAUI,GAAG9I,WAAUE,iBAAUyI,aAE5B,IAAIK,EAAI,EAAGA,EAAIL,EAASI,OAAQC,GAAK,EACxCN,EAAUI,GAAGP,UAAYG,EAAUI,GAAGP,UAAUY,QAAQ,IAAIC,oBAAaX,EAAQO,UAAS,KAAM,UAXpGC,QAAQC,IAAI,yECvSVG,EAAc,CAClBC,WAAYjF,EAAuB,cACnCkF,WAAYlF,EAAuB,cACnCmF,aAAcnF,EAAuB,iBAGvC,SAASoF,EAAwBC,GAE/BA,EAASC,SAAQ,SAACC,OACVC,EAASD,EAAQhK,cAAc,UAAYgK,EAAQhK,cAAc,SACnEiK,IAAWA,EAAOC,SACpBD,EAAOE,QACPH,EACGhK,cAAc,yBACdoK,aAAa,sBAAuB,cAK7C,SAASC,EAAwBC,OACzBC,EAAW,CACfD,QAAS5H,KAAK8H,MAAMF,GACpBG,QAAS/H,KAAK8H,MAAMF,EAAU,YAGhCC,EAASD,SAAWC,EAASD,QAA8B,GAAnBC,EAASE,SAAeC,SAAS,cAE/DH,EAASE,oBAAW,WAAKF,EAASD,SAAWK,OAAO,QC1B3CC,yBAEPtL,0CACJA,oEAIiBuL,EAAO3K,OACxB4J,EAAWlK,SAASoJ,iBAAiB,uBACrC8B,EAASD,EAAM7K,cAAc,SAC7B+K,EAAcF,EAAM7K,cAAc,yBAClCgL,EAAYH,EAAM7K,cAAc,0BAEtC+K,EAAYvG,iBAAiB,SAAS,SAACpC,GACmB,WAApD2I,EAAYjL,aAAa,wBAE3B+J,EAAwBnE,MAAMuF,KAAKnB,IACnCgB,EAAOI,OACPH,EAAYX,aAAa,sBAAuB,aAGhDU,EAAOX,QACPY,EAAYX,aAAa,sBAAuB,WAGlDlK,IAEAkC,EAAM+I,qBACL,GAGHJ,EAAYvG,iBAAiB,aAAa,SAACpC,GACzCA,EAAM+I,qBACL,GAEHL,EAAOtG,iBAAiB,cAAc,WACpCwG,EAAUI,UAAYf,EAAwBS,EAAOO,gBAGvDP,EAAOtG,iBAAiB,SAAS,WAC/BuG,EAAYX,aAAa,sBAAuB,oBAxCb/K,GCEpBiM,yBACPhM,mDACJA,KACDiM,UAAY3L,SAASI,qDACQW,EAAKpB,OAAOiM,YAEzCC,SAAWC,KAAKC,MAAMhL,EAAK4K,UAAUzL,aAAa,8BAElDkH,UAAYrG,EAAKpB,SACjBqM,OAASjL,EAAKpB,OAAOyJ,iBAAiB,0BACtC6C,YAAclL,EAAKpB,OAAOyJ,iBAAiB,0BAC3C8C,aAAe,kBAAMlM,SAASI,cAAc,4BAC5C8J,SAAWnJ,EAAKqG,UAAUgC,iBAAiB,yBAG3C+C,UAAYpL,EAAKpB,OAAOO,aAAa,0BACrC0B,eAAgB,IAChBwK,QAAS,IACTC,OAAQ,IACRC,gBAAaC,IAEbhF,MAAQ,CACX7F,EAAG,SAAAc,UAASA,EAAMgK,SAAWhK,EAAMG,QAAQ,GAAG6J,SAC9C7K,EAAG,SAAAa,UAASA,EAAMiK,SAAWjK,EAAMG,QAAQ,GAAG8J,SAC9CC,GAAI,EACJC,GAAI,EACJC,GAAI,EACJC,GAAI,KAGDC,QAAU,CACbtG,GAAI,KACJuG,MAAO,KACPC,OAAQ,GACRC,KAAM,kBAAMlM,EAAK+L,QAAQtG,GAAGjE,yBAC5B2K,KAAM,MAGHC,SAAW,CACdC,KAAM,KACNC,KAAM,QAGHpM,SAAWF,EAAKE,SAASV,aACzBW,QAAUH,EAAKG,QAAQX,aACvBY,OAASJ,EAAKI,OAAOZ,aACrBa,QAAUL,EAAKK,QAAQb,aAEvBsB,uBAGAyL,MAAQ,CACXC,eAAgB,EAChBC,OAAQ,IAINzM,EAAK8K,aACFyB,MAAME,OAASzM,EAAK8K,SAAS4B,KAAI,SAAA5B,UAAYA,EAAS6B,8DAItDlL,GACFA,EAAM7C,OAAOgO,aAAa,wBAK3B9N,KAAKqK,SAASX,OAAS,GACzBU,EAAwBpK,KAAKqK,eAI1BtI,eAAgB,OAEhBkL,QAAQtG,GAAKhE,EAAM7C,YACnBmN,QAAQC,MAAQlN,KAAKiN,QAAQtG,GAAGS,WAAU,QAC1C6F,QAAQE,OAAO1J,IAAMzD,KAAKiN,QAAQtG,GAAG6B,eACrCyE,QAAQE,OAAO5J,KAAOvD,KAAKiN,QAAQtG,GAAG2B,gBACtC2E,QAAQI,KAAKjL,MAAQpC,KAAKiN,QAAQtG,GAAGoH,iBACrCd,QAAQI,KAAKhL,OAASrC,KAAKiN,QAAQtG,GAAGqH,kBAEtCf,QAAQtG,GAAGnE,MAAMiB,cAASzD,KAAKiN,QAAQE,OAAO1J,eAC9CwJ,QAAQtG,GAAGnE,MAAMe,eAAUvD,KAAKiN,QAAQE,OAAO5J,gBAC/C0J,QAAQtG,GAAGnE,MAAMJ,gBAAWpC,KAAKiN,QAAQI,KAAKjL,iBAC9C6K,QAAQtG,GAAGnE,MAAMH,iBAAYrC,KAAKiN,QAAQI,KAAKhL,kBAC/C4K,QAAQtG,GAAGhG,UAAUG,IAAI,mBAEzByG,UAAU5G,UAAUG,IAAI,mBAExBmN,gBAAgBjO,KAAKiN,QAAQtG,SAC7BuH,eAEAxG,MAAMmF,GAAK7M,KAAK0H,MAAM7F,EAAEc,QACxB+E,MAAMoF,GAAK9M,KAAK0H,MAAM5F,EAAEa,GAE7BA,EAAMC,kDAGAD,GACD3C,KAAK+B,qBAIL2F,MAAMqF,GAAK/M,KAAK0H,MAAM7F,EAAEc,GAAS3C,KAAK0H,MAAMmF,QAC5CnF,MAAMsF,GAAKhN,KAAK0H,MAAM5F,EAAEa,GAAS3C,KAAK0H,MAAMoF,GAEjD5K,OAAOC,sBAAsBnC,KAAKuB,cAE7B2M,0CAGAvL,MACA3C,KAAK+B,oBAILA,eAAgB,OAChBwF,UAAU5G,UAAUE,OAAO,mBAC3BoM,QAAQtG,GAAGhG,UAAUE,OAAO,mBAC5BoM,QAAQtG,GAAGnE,MAAMiB,IAAM,QACvBwJ,QAAQtG,GAAGnE,MAAMe,KAAO,QACxB0J,QAAQtG,GAAGnE,MAAMJ,MAAQ,QACzB6K,QAAQtG,GAAGnE,MAAMH,OAAS,QAC1B4K,QAAQtG,GAAGnE,MAAMsC,UAAY,OAG5BsI,EADepN,KAAKqM,eACA3J,+BAElB1C,KAAKsM,eACN,aACCc,EAAK7J,MAAQvD,KAAK0H,MAAM7F,EAAEc,IAAUyK,EAAKe,YACtCC,oBAGJ,WACChB,EAAK3J,KAAOzD,KAAK0H,MAAM5F,EAAEa,IAAUyK,EAAKiB,aACrCD,eAQNE,0BACAC,sBACAC,sEAMAjC,QAAS,OACTC,OAAQ,OAERiC,gBAGHzO,KAAKsN,SAASE,MACXxN,KAAKsN,SAASE,KAAKM,aAAa,sBACnC,KACMN,EAAOxN,KAAKsN,SAASE,KAAK9K,+BAExB1C,KAAKsM,eACN,aACCtM,KAAKiN,QAAQG,OAAOe,MAASX,EAAKjK,KAAQiK,EAAKpL,MAAQ,WACpDoK,OAAQ,OACRyB,gBAAgBjO,KAAKsN,SAASE,iBAGlC,WACCxN,KAAKiN,QAAQG,OAAOiB,OAAUb,EAAK/J,IAAO+J,EAAKnL,OAAS,WACrDmK,OAAQ,OACRyB,gBAAgBjO,KAAKsN,SAASE,WAUzCxN,KAAKsN,SAASC,MACXvN,KAAKsN,SAASC,KAAKO,aAAa,sBACnC,KACMP,EAAOvN,KAAKsN,SAASC,KAAK7K,+BAExB1C,KAAKsM,eACN,aACCtM,KAAKiN,QAAQG,OAAO7J,KAAQgK,EAAKY,MAASZ,EAAKnL,MAAQ,WACpDmK,QAAS,OACT0B,gBAAgBjO,KAAKsN,SAASC,iBAGlC,WACCvN,KAAKiN,QAAQG,OAAO3J,IAAO8J,EAAKc,OAAUd,EAAKlL,OAAS,WACrDkK,QAAS,OACT0B,gBAAgBjO,KAAKsN,SAASC,+CAarClB,EAAerM,KAAKqM,oBAErBqC,wBAAwB1O,KAAKiN,QAAQC,OAEtClN,KAAKiN,QAAQC,MAAM3M,cAAc,wBACnC4K,EAAYwD,kBAAkB3O,KAAKiN,QAAQC,MAAOlN,KAAKS,mBAGpD8G,UAAUhB,aAAavG,KAAKiN,QAAQC,MAAOb,QAC3CY,QAAQtG,GAAGiI,cAAchI,YAAY5G,KAAKiN,QAAQtG,2CAIlDsG,QAAQtG,GAAGnE,MAAMsC,gCAA2B9E,KAAK0H,MAAMqF,kBAC1D/M,KAAK0H,MAAMsF,kEAICjH,QACTuI,yBAECjC,EAAelM,SAAS+G,cAAc,UAC5CmF,EAAa1L,UAAUG,IAAI,gBAAiB,wBAC5CuL,EAAa1B,aAAa,KAAM,wBAChC0B,EAAa7J,MAAMqM,oBAAe7O,KAAKiN,QAAQI,KAAKhL,aAEhDrC,KAAKiN,QAAQtG,GAAGpG,cAAc,OAAQ,KAClCuO,EAAM9O,KAAKiN,QAAQtG,GAAGpG,cAAc,OAAOF,aAAa,OACxD0O,EAAM5O,SAAS+G,cAAc,OACnC6H,EAAIpE,aAAa,MAAOmE,GACxBzC,EAAalF,YAAY4H,GAGvB/O,KAAKwM,WACFjF,UAAUhB,aAAa8F,EAActG,EAAKiJ,qBACtChP,KAAKuM,YACThF,UAAUhB,aAAa8F,EAActG,qDAOtCsG,EAAerM,KAAKqM,eACtBA,GAAcA,EAAauC,cAAchI,YAAYyF,+CAInDA,EAAerM,KAAKqM,oBACrBiB,SAASC,KAAOlB,EAAa4C,yBAA2BjP,KAAKiN,QAAQtG,GACtE3G,KAAKiN,QAAQtG,GAAGsI,uBAChB5C,EAAa4C,4BACZ3B,SAASE,KAAOnB,EAAa2C,qBAAuBhP,KAAKiN,QAAQtG,GAClE3G,KAAKiN,QAAQtG,GAAGqI,mBAChB3C,EAAa2C,mEAGK5D,GAEtBA,EAAMrG,iBAAiB,aAAc/E,KAAKoB,UAAU,GAEpDgK,EAAMrG,iBAAiB,YAAa/E,KAAKoB,UAAU,2DAKnDjB,SAAS4E,iBAAiB,YAAa/E,KAAKqB,SAC5ClB,SAAS4E,iBAAiB,WAAY/E,KAAKsB,QAE3CnB,SAAS4E,iBAAiB,YAAa/E,KAAKqB,SAC5ClB,SAAS4E,iBAAiB,UAAW/E,KAAKsB,aAErC6K,OAAO7B,SAAQ,SAACc,GACnB8D,EAAKR,wBAAwBtD,uEAK3BpL,KAAKgM,SAAU,YACZyB,MAAMC,eAAiB,OAEvB5N,OAAOyJ,iBAAiB,wBAAwBe,SAAQ,SAACc,EAAO+D,OAC7DC,EAAoBhE,EAAM/K,aAAa,gCAEzCgP,SAASD,EAAmB,MAASD,EAAQ,IAC/CG,EAAK7B,MAAMC,gBAAkB,UAI3B6B,EAAiBvP,KAAKgM,SAASwD,MAAK,SAAAxD,UAAYA,EAASyD,SAASC,SAASJ,EAAK7B,MAAMC,2BACvFpN,gBAAgBK,WAAUE,iBAAUb,KAAKyN,MAAME,cAC/CrN,gBAAgBK,UAAUG,IAAIyO,EAAe1B,YAC7CrN,oBAAoBmL,UAAY4D,EAAeI,UAC/ClD,WAAa8C,EAAeK,aAG9BnP,4DAICoP,EAAQ5J,MAAMuF,KAAKxL,KAAKF,OAAOyJ,iBAAiB,yBAAyBqE,KAAI,SAAAxC,SAAU,CAC3FW,GAAIX,EAAMW,OAGZrG,EAAgB1F,KAAKF,OAAQ,kBAAmB,GAAI,CAClDiM,GAAI/L,KAAKF,OAAOiM,GAChBU,WAAYzM,KAAKyM,WACjBoD,MAAAA,WA/TgCjQ,GCLjBkQ,iFAcNjH,GACXpB,GAAGsI,OAAOlH,GAASmH,QAAQC,QAAQ,cAAc,mCAGpCpH,EAASqH,GAEtBzI,GAAGsI,OAAOlH,GACPsH,KAAK,KAAM1I,GAAG9E,MAAMd,EAAIqO,EAAKrO,GAAGuO,WAChCD,KAAK,KAAM1I,GAAG9E,MAAMb,EAAIoO,EAAKpO,GAAGsO,uCAG1BvH,EAASlD,EAAMuK,GAExBzI,GAAGsI,OAAOlH,GACPsH,KAAK,KAAM1I,GAAG9E,MAAMd,EAAIqO,EAAKrO,GAAGuO,WAChCD,KAAK,KAAM1I,GAAG9E,MAAMb,EAAIoO,EAAKpO,GAAGsO,WAIhCH,QAAQ,cAAc,YC3BRI,sFAKDC,EAAMC,MACuB,UAAzC9I,GAAG9E,MAAM6N,YAAY1Q,OAAO2Q,SAAsB,KAE9CC,EAAOjJ,GAAGiJ,OAGbC,MAAMlJ,GAAGmJ,aAENjJ,EAASF,GAAGE,OAAO,OACnBkJ,EAAIpJ,GAAG9E,MAAMmO,QAEfjE,EAAKlF,EAAOF,GAAG9E,MAAMd,GACrBiL,EAAKnF,EAAOF,GAAG9E,MAAMb,GAEnBiK,YAAQuE,EAAKvE,oBAAWc,cAAMC,GAE9BiE,EAAStJ,GAAGsI,kBAAWO,EAAKvE,kBAAgBiF,OAAO,YAGtDb,KAAK,gBAAiB,IACtBA,KAAK,QAAS,YACdA,KAAK,KAAMpE,GACXkF,MAAMJ,GAGTpJ,GAAG9E,MACAuO,GAAG,QAAQ,eAEJnE,EAAKpF,EAAOF,GAAG9E,MAAMd,GACrBmL,EAAKrF,EAAOF,GAAG9E,MAAMb,GAErBqP,EAAKpE,EAAKF,EACVuE,EAAKpE,EAAKF,EAGXqE,EAAKA,EAAOC,EAAKA,EAAM,IAAKP,EAAEQ,KAAK,CAACxE,EAAKE,EAAID,EAAKE,IAElD6D,EAAEA,EAAEnH,OAAS,GAAK,CAACqD,EAAIC,GAE5B+D,EAAOZ,KAAK,IAAKO,MAElBQ,GAAG,OAAO,eACHI,EAAY7J,GAAGsI,kBAAWhE,IAC5BuF,IACEA,EAAUnB,KAAK,KACbmB,EAAUnB,KAAK,KAAKzG,OAAS,GAC/B4H,EAAUzQ,SAGV6E,EAAgBvF,SAAU,aAAc,GAAI,CAC1CoR,IAAK,CACHxF,GAAIuE,EAAKvE,GACTyF,KAAM,SACN1K,KAAMwK,EAAUxK,OAChB2J,SAAUa,EAAUxK,OAAO2J,SAC3BgB,aAAa,KAITH,EAAUnB,KAAK,MACzBmB,EAAUzQ,UAId0P,OAIJF,EAAQqB,kBAAkBpB,EAAM7I,GAAGsI,kBAAWhE,IAAMjF,8CAKpCwJ,OACZqB,EAAQlK,GAAGsI,kBAAWO,EAAKvE,kBAE3B6F,EAAgBtK,EAAgBgJ,GAChCvE,YAAQuE,EAAKvE,sBAAa6F,EAAc/P,cAAK+P,EAAc9P,GAc3DjC,GAXgB8R,EAAMX,OAAO,qBAChCb,KAAK,kBAAmB,IACxBA,KAAK,KAAMpE,GACXoE,KAAK,IAAKyB,EAAc/P,GACxBsO,KAAK,IAAKyB,EAAc9P,GACxBqO,KAAK,QAAS,GACdA,KAAK,SAAU,GAEWa,OAAO,aACjCb,KAAK,QAAS,mBAEAhQ,SAASI,yBAAkBwL,KAG5CsE,EAAQwB,oBAAoBvB,EAAMzQ,GAGlC6F,EAAgBvF,SAAU,aAAc,GAAI,CAC1CoR,IAAK,CACHxF,GAAIuE,EAAKvE,GACTyF,KAAM,SACN1K,KAAMjH,EACN4Q,SAAU5Q,EAAS4Q,SACnBgB,aAAa,+CAKMnB,EAAMzQ,GAC7B4H,GAAGsI,kBAAWlQ,EAASkM,KAAMmF,GAAG,SAAS,WAEvCxL,EAAgBvF,SAAU,aAAc,GAAI,CAC1CoR,IAAK,CACHxF,GAAIuE,EAAKvE,GACTyF,KAAM,SACN1K,KAAMW,GAAG9E,MAAM7C,OACf2Q,SAAUhJ,GAAG9E,MAAM7C,OAAO2Q,SAC1BgB,aAAa,KAIjBhK,GAAGsI,kBAAWlQ,EAASkM,KAAMlL,SAE7B4G,GAAG9E,MAAMC,oBACR,+CAGsB0N,EAAMzQ,OACzBmB,EAAUb,SAASI,yBAAkB+P,EAAKvE,kBAK5C+F,EAAkB,CACpBjS,EAASQ,aAAa,KACtBR,EAASQ,aAAa,MAEpB6P,EAAO,GAEL6B,EAAYtK,GAAGuK,qBAAcnS,EAASkM,cAC5CtE,GAAGsI,OAAOgC,EAAUE,QAAQ,IAAIf,GAAG,SAAS,WAG1CxL,EAAgBvF,SAAU,aAAc,GAAI,CAC1CoR,IAAK,CACHxF,GAAIuE,EAAKvE,GACTyF,KAAM,SACN1K,KAAMjH,EACN4Q,SAAU5Q,EAAS4Q,SACnBgB,aAAa,KAIjBhK,GAAGsI,OAAOtI,GAAG9E,MAAM7C,OAAOwG,YAAYzF,YAErCqR,KAAKzK,GAAG0K,OACN5K,UAAUvG,GACV8P,QAAQjR,GACRqR,GAAG,SAAS,WACXhB,EAAO,CACLrO,EAAG4F,GAAG9E,MAAMd,EAAIiQ,EAAgB,GAChChQ,EAAG2F,GAAG9E,MAAMb,EAAIgQ,EAAgB,IAGlChC,EAAasC,MAAMvS,MAEpBqR,GAAG,QAAQ,WACVpB,EAAa7C,QAAQpN,EAAUqQ,MAEhCgB,GAAG,OAAO,eACHmB,EAAiBP,EAAgB,GACjCQ,EAAiBR,EAAgB,GACnCS,EAAW,OAEfzC,EAAa0C,IAAI3S,EAAU,SAAUqQ,GAErC4B,EAAkB,CAChBjS,EAASQ,aAAa,KACtBR,EAASQ,aAAa,MAIpBoS,EAAIC,6BAA6B7S,KAAW0S,EAAW,UAEvDT,EAAgB,KAAOO,GAAkBP,EAAgB,KAAOQ,GAElE5M,EAAgBvF,SAAU,aAAc,GAAI,CAC1CoR,IAAK,CACHxF,GAAIuE,EAAKvE,GACTyF,KAAMe,EACNzL,KAAMjH,EACN4Q,SAAU5Q,EAAS4Q,SACnBgB,aAAa,kBCjMRkB,4FACDC,yDAAY,IAAKC,yDAAY,EACvCvC,EAAOnQ,SAASI,cAAc,4BAC9BuS,EAAQxC,EAAKvE,GACbgH,EAAWtL,GAAGsI,OAAOO,GAAMP,OAAO,aAGlCiD,EAAc7S,SAASI,cAAc,sBACrCqR,EAAgB,CACpB/P,EAAGmR,EAAY3S,aAAa,gBAC5ByB,EAAGkR,EAAY3S,aAAa,iBAExB0L,YAAQ+G,uBAAkBlB,EAAc/P,cAAK+P,EAAc9P,GAC3DmR,aAAWlH,GACXmH,EAAc,CAClBrR,EAAIkR,EAAS5C,KAAK,SAAWyB,EAAc/P,EAAK,IAAM,QAAU,OAChEC,EAAIiR,EAAS5C,KAAK,UAAYyB,EAAc9P,EAAK,GAAK,SAAW,OAK7DqR,EAAgBJ,EAAS/B,OAAO,qBACnCb,KAAK,uCAAiC+C,EAAYrR,0BAAiBqR,EAAYpR,IAC/EqO,KAAK,gBAAiB,IACtBA,KAAK,IAAKyB,EAAc/P,GACxBsO,KAAK,IAAKyB,EAAc9P,GACxBqO,KAAK,QAAS,GACdA,KAAK,SAAU,GAGlBgD,EAAcnC,OAAO,aAClBb,KAAK,QAAS,kCAEXiD,EAAWD,EAAcnC,OAAO,kBACnCb,KAAK,YAAayC,GAClBzC,KAAK,WAAY,MACjBA,KAAK,KAAMpE,GACXoE,KAAK,QAAS,gBACdA,KAAK,YAAa,IAClBA,KAAK,2BAA4B2C,GAGpCxC,EAAK/P,wBAAiB0S,IAAQI,QAG9BV,EAAQW,kBAAkBhD,EAAM8C,EAAStM,QAAQ,EAAM+L,6CAGhCvC,EAAMiD,EAAOC,OAAWX,yDAAY,EACrD7R,EAAUsP,EAAK/P,cAAc,aAC7B0S,aAAWM,EAAMxH,IACnB0H,EAAaD,EACbE,EAAUH,EAAMI,MAKd9T,EAAWyQ,EAAK/P,cAAc0S,GAAMrE,cACtCkD,EAAkB,CACpBjS,EAASQ,aAAa,KACtBR,EAASQ,aAAa,MAEpB6P,EAAO,GAEXzI,GAAGsI,iBAAUkD,IAEVf,KAAKzK,GAAG0K,OACN5K,UAAUvG,GACV8P,QAAQjR,GACRqR,GAAG,SAAS,WACXhB,EAAO,CACLrO,EAAG4F,GAAG9E,MAAMd,EAAIiQ,EAAgB,GAChChQ,EAAG2F,GAAG9E,MAAMb,EAAIgQ,EAAgB,IAGlChC,EAAasC,MAAMvS,MAEpBqR,GAAG,QAAQ,WACVpB,EAAa7C,QAAQpN,EAAUqQ,MAEhCgB,GAAG,OAAO,eACHmB,EAAiBP,EAAgB,GACjCQ,EAAiBR,EAAgB,GACnCS,EAAW,OAEfzC,EAAa0C,IAAI3S,EAAU,OAAQqQ,GAEnC4B,EAAkB,CAChBjS,EAASQ,aAAa,KACtBR,EAASQ,aAAa,MAGnBoT,GAAe3B,EAAgB,KAAOO,GAAkBP,EAAgB,KAAOQ,IAE9EG,EAAIC,6BAA6B7S,EAAS+T,WAAW,MAAKrB,EAAW,UAGzE7M,EAAgBvF,SAAU,aAAc,GAAI,CAC1CoR,IAAK,CACHxF,GAAIuE,EAAKvE,GACTyF,KAAMe,EACNzL,KAAMjH,EAAS+T,WAAW,GAC1BnD,SAAU5Q,EAAS+T,WAAW,GAAGnD,SACjCgB,aAAa,UAOtBP,GAAG,SAAS,WACXyB,EAAQkB,qBAAqBpM,GAAG9E,MAAM7C,WAGvCoR,GAAG,QAAQ,eAGNqB,EAFEuB,EAAUrM,GAAG9E,MAAM7C,OACnB6T,EAAQG,EAAQH,MAElBI,GAAY,EAEK,IAAjBJ,EAAMjK,QAINiK,EAAMjK,OAASmJ,GACjB5J,EAAW6K,EAAS,YACpBC,GAAY,GACFJ,EAAMjK,QAAUmJ,GAAc9J,EAAW+K,EAAS,cAC5D9K,EAAc8K,EAAS,YACvBC,GAAY,GAGVL,IAAYC,IACVF,GACFlB,EAAW,SACXkB,GAAa,GAEblB,EAAW,SAEbmB,EAAUC,EAENlB,EAAIC,6BAA6BoB,KAAUvB,EAAW,UAG1D7M,EAAgBvF,SAAU,aAAc,GAAI,CAC1CoR,IAAK,CACHxF,GAAIuE,EAAKvE,GACTyF,KAAMe,EACNzL,KAAMgN,EACNrD,SAAUqD,EAAQrD,SAClBuD,QAASD,EACTtC,aAAa,MAMnBiC,EAAUC,GApCRlB,EAAIwB,YAAW,EAAOhB,MAuCzB/B,GAAG,SAAS,WACXzJ,GAAGsI,OAAOlQ,GAAUmQ,wDAIE8D,GAC1BA,EAAQtR,MAAMH,OAAS,MACvByR,EAAQtR,MAAMH,iBAAY,GAAKyR,EAAQI,qEAGR5D,EAAMiD,OACjCE,GAAa,EACbC,EAAUH,EAAMI,MAEpBlM,GAAGsI,OAAOwD,GAAOrC,GAAG,SAAS,WAC3ByB,EAAQkB,qBAAqBpM,GAAG9E,MAAM7C,WAErCoR,GAAG,QAAQ,eAGNqB,EAFEuB,EAAUrM,GAAG9E,MAAM7C,OACnB6T,EAAQG,EAAQH,MAGlBD,IAAYC,IACVF,GACFlB,EAAW,SACXkB,GAAa,IAEblB,EAAW,SACU,IAAjBoB,EAAMjK,SACR+J,GAAa,IAGjBC,EAAUC,EAENlB,EAAIC,6BAA6BoB,KAAUvB,EAAW,UAG1D7M,EAAgBvF,SAAU,aAAc,GAAI,CAC1CoR,IAAK,CACHxF,GAAIuE,EAAKvE,GACTyF,KAAMe,EACNzL,KAAMgN,EACNrD,SAAUqD,EAAQrD,SAClB0D,UAAU,EACV1C,aAAa,MAMnBiC,EAAUC,cCrLGlB,yBACP5S,mDACJA,KAGDuU,WAEAC,kBAAkBC,QAChBC,8DAMFC,YAAcxU,KAAKF,OAAOO,aAAa,8BAGtCoU,EAAqBzU,KAAKF,OAAOO,aAAa,mBAAmBmJ,MAAM,KACpEC,EAAI,EAAGA,EAAIgL,EAAmB/K,OAAQD,GAAK,EACpB,aAA1BgL,EAAmBhL,QAChBiL,UAAU1U,KAAKS,cAEa,WAA1BgU,EAAmBhL,SACrBkL,YAAY3U,KAAKS,mBASrBmU,yBAGAC,oDAKCC,EAAU9U,KAAKF,OAAOO,aAAa,WAAWmJ,MAAM,KACpDnH,EAASrC,KAAKF,OAAO4C,wBAAwBL,OAC7CI,EAAQJ,EAASyS,EAAQ,QAE1BhV,OAAO0C,MAAMuS,SAAWtS,YAAWqS,EAAQ,GAAKrS,QAAY,GAE5DJ,GACHuH,QAAQoL,KAAK,wEAaPzE,cACR9I,GAAGsI,OAAO/P,KAAKF,QACZoS,KAAKzK,GAAG0K,OACN5K,WAAU,kBAAM2H,EAAKpP,UACrBgR,SAAQ,eACDmE,EAAI,CAACxN,GAAG9E,MAAMd,EAAEuO,UAAW3I,GAAG9E,MAAMb,EAAEsO,iBAErC,CAAC6E,EAAGA,MAEZ/D,GAAG,SAAS,WACXb,EAAQ6E,WAAWhG,EAAKpP,OAAQyQ,2CAU5BA,cACV9I,GAAGsI,OAAO/P,KAAKF,QAAQoR,GAAG,SAAS,WAGA,UAFpBzJ,GAAG9E,MAAM7C,OACA2Q,WAQtBJ,EAAQ8E,aAAa7F,EAAKxP,QAC1ByQ,IAEA9I,GAAG9E,MAAMC,qBACR,0DAIGwS,EAAgBpV,KAAKF,OAAOyJ,iBAAiB,6BAE/C6L,GACFA,EAAc9K,SAAQ,SAAC+K,GACrB1C,EAAQ2C,0BAA0BC,EAAKzV,OAAQuV,6CAKtCG,OACPC,EAAUD,EAAMhM,MAAM,YAExBiM,EAAQ/L,OAAS,GACnBE,QAAQC,IAAI,gBAAiB2L,GACtBA,IAILC,EAAQA,EAAQ/L,OAAS,qBAAgB+L,EAAQ,KACnDA,EAAQpE,qBAAcoE,EAAQ,KAIhCA,EAAQ,GAAKzV,KAAKF,OAAOiM,GAEX0J,EAAQC,KAAK,sDAMrBC,EAAsB3V,KAAKwU,YAAcxU,KAAKwU,YAAYhL,MAAM,KAAO,GAEzEmM,EAAoB,IAEtBxV,SAAS4E,iBAAiB,cAAc,SAAC6Q,MACnCD,EAAoBjG,SAASkG,EAAEnQ,OAAO8L,IAAIxF,IAAK,KAK7CyF,EAJEqE,EAAgBD,EAAEnQ,OAAO8L,IAAIzK,KAC7B2J,EAAWmF,EAAEnQ,OAAO8L,IAAId,SACxBqF,EAAcC,EAAKC,eAAeH,EAAc9J,IAClDkK,EAAaF,EAAKjW,OAAOS,yBAAkBuV,QAG3CG,GAAoC,WAAtBL,EAAEnQ,OAAO8L,IAAIC,eAC7BA,EAAOoE,EAAEnQ,OAAO8L,IAAIC,KAYL,SAAbf,SACMe,OACD,SACHuE,EAAKG,WAAWL,EAAeC,aAE5B,QACH9M,EAAciN,EAAY,YAC1BhN,EAAWgN,EAAYL,EAAEnQ,OAAO8L,IAAI4E,iBAEjC,SACHF,EAAWpV,uBAGX+I,QAAQC,IAAI,0CAEX,GAAiB,aAAb4G,KACLmF,EAAEnQ,OAAO8L,IAAI4C,gBACP3C,OACD,SACHuE,EAAKK,mBAAmBP,EAAeC,aAEpC,SACgC,IAA/BD,EAAclC,MAAMjK,QACtBuM,EAAWtC,MAAQkC,EAAclC,MAE7BsC,EAAWzT,MAAMH,SAAWwT,EAAcrT,MAAMH,SAClD4T,EAAWzT,MAAMH,OAASwT,EAAcrT,MAAMH,SAGhD4T,EAAWrH,cAAc/N,uBAI3B+I,QAAQC,IAAI,wDAGR2H,OACD,SACHuE,EAAKM,gBAAgBT,EAAEnQ,OAAO8L,IAAIyC,QAAS6B,EAAeC,aAEvD,SACHG,EAAWtC,MAAQkC,EAAclC,MAE7BiC,EAAEnQ,OAAO8L,IAAIyC,QACf/K,EAAWgN,EAAY,YAEvBjN,EAAciN,EAAY,YAGxBA,EAAWzT,MAAMH,SAAWwT,EAAcrT,MAAMH,SAClD4T,EAAWzT,MAAMH,OAASwT,EAAcrT,MAAMH,kBAG7C,QAEH2G,EADAiN,EAAaA,EAAWrH,cAAcgF,WAAW,GACvB,YAC1B3K,EAAWgN,EAAYL,EAAEnQ,OAAO8L,IAAI4E,iBAEjC,OACCF,GACFA,EAAWrH,cAAc/N,SAE3BkV,EAAKM,gBAAgBT,EAAEnQ,OAAO8L,IAAIyC,QAAS6B,EAAeC,aAEvD,SACHG,EAAWrH,cAAc/N,uBAGzB+I,QAAQC,IAAI,+CAGb,GAAiB,kBAAb4G,SACDe,OACD,SACHuE,EAAKO,aAAaT,EAAeC,aAE9B,QAEH9M,EADAiN,EAAaA,EAAWrC,WAAW,GACT,YAC1B3K,EAAWgN,EAAYL,EAAEnQ,OAAO8L,IAAI4E,iBAEjC,OACCF,GACFA,EAAWpV,SAEbkV,EAAKO,aAAaT,EAAeC,aAE9B,SACHG,EAAWpV,uBAGX+I,QAAQC,IAAI,4CAGhBD,QAAQC,IAAI,mCAAoC4G,0CAS/CoF,EAAeC,OAClBG,EAAaJ,EAAczO,WAAU,GAC3C6O,EAAWlK,GAAK+J,OACXhW,OAAOqH,YAAY8O,GAExB5F,EAAQqB,kBAAkB1R,KAAKF,OAAQmW,2CAGzBjC,EAAS6B,EAAeC,OAChCG,EAAaJ,EAAcjH,cAAcxH,WAAU,GACzD6O,EAAWrC,WAAW,GAAG7H,GAAK+J,OACzBhW,OAAOqH,YAAY8O,GACpBjC,EACF/K,EAAWgN,EAAY,YAEvBjN,EAAciN,EAAY,YAG5BtD,EAAQW,kBAAkBtT,KAAKF,OAAQmW,EAAWrC,WAAW,IAAI,wCAGtDiC,EAAeC,OACpBG,EAAaJ,EAAczO,WAAU,GAC3C6O,EAAWlK,GAAK+J,OACXhW,OAAOqH,YAAY8O,GAExB5F,EAAQwB,oBAAoB7R,KAAKF,OAAQmW,8CAGxBJ,EAAeC,OAC1BG,EAAaJ,EAAcjH,cAAcxH,WAAU,GACzD6O,EAAWrC,WAAW,GAAG7H,GAAK+J,OACzBhW,OAAOqH,YAAY8O,GAExBtD,EAAQ2C,0BAA0BtV,KAAKF,OAAQmW,EAAWrC,WAAW,yCAGrD7N,GAChBA,EAAK4E,aAAa,oBAAqB,uDAMjC4L,EAAWpW,SAASoJ,iBAAiB,8BAElCE,EAAI,EAAGA,EAAI8M,EAAS7M,OAAQD,GAAK,EACxC8M,EAAS9M,GAAGkB,aAAa,oBAAqB,4CAMhC6L,OAAU3N,yDAAU,6BAChChJ,EAAWM,SAASI,cAAcsI,GAClC4H,EAAW5Q,EAAS4Q,SAClBgG,EAAU5W,EAAS+O,qBAIjB6B,OACD,WAGA,qBAGA,MAMHA,GAJE5Q,EADE4W,EAAQ7C,WAAW,GACV6C,EAAQ7C,WAAW,GAEnB6C,GAEOhG,uBAGpB7G,QAAQC,IAAI,6BAA8B4G,OAIxCqC,EAAQjT,EAASkM,GAAGvC,MAAM,KAAK,GAGrC9D,EAAgBvF,SAAU,aAAc,GAAI,CAC1CoR,IAAK,CACHxF,GAAI+G,EACJtB,KAAM,SACN1K,KAAMjH,EACN4Q,SAAAA,EACAgB,YAAa+E,KAIQ,kBAArBC,EAAQhG,SACVhJ,GAAGsI,OAAO0G,GAAS5V,SAEnB4G,GAAGsI,OAAOlQ,GAAUgB,sDAMhB6V,EAAgBvW,SAASoJ,iBAAiB,4BACvCE,EAAI,EAAGA,EAAIiN,EAAchN,OAAQD,GAAK,EAC7CiN,EAAcjN,GAAGkB,aAAa,kBAAmB,0CAKrC4G,GACdkB,EAAIkE,aACJpF,EAAI5G,aAAa,kBAAmB,6DAKF4I,OAC5BkC,EAAUlC,EAAMxH,GAAGvC,MAAM,aAC3BiM,EAAQA,EAAQ/L,OAAS,GAAGgG,SAAS,WACvC+F,EAAQmB,MACRrD,EAAMxH,GAAK0J,EAAQC,KAAK,MACjB,UA3XoB9V,GC3BZiX,wBAEP7D,EAAa8D,kBAClB9D,YAAcA,OACd+D,iBAAmB/W,KAAKgT,YAAYzJ,iBAAiB,gCACrDyN,YAAchX,KAAKgT,YAAYzJ,iBAAiB,2BAChD0N,WAAajX,KAAKgT,YAAYzJ,iBAAiB,0BAC/C2N,gBAAkBlX,KAAKgT,YAAYzS,cAAc,qBACjD4W,YAAcnX,KAAKgT,YAAYzS,cAAc,wBAC7C6W,SAAWpX,KAAKgT,YAAYzS,cAAc,mCAC1CuW,MAAQA,OAERO,cAAe,OAEfC,WAAajI,SAASnN,OAAO6F,iBAAiB/H,KAAKgT,YAAYzS,cAAc,wBAAyB,MAAMgX,iBAAiB,SAAU,IAAM,OAC7IC,WAAanI,SAASnN,OAAO6F,iBAAiB/H,KAAKgT,YAAYzS,cAAc,qBAAsB,MAAMgX,iBAAiB,SAAU,IAAM,OAE1IhD,gEAIAkD,4BACAC,gCAGLzR,MAAMuF,KAAKxL,KAAK8W,OAAOxM,SAAQ,SAACgG,GAC9B7I,GAAGsI,OAAOO,GAAMY,GAAG,eAAe,WAEhCuB,EAAIkF,SAASrH,GAEbmC,EAAImF,eAGJ1W,EAAK2W,kBAAkBpQ,GAAG9E,MAAM7C,QAChCoB,EAAK4W,eAAexH,EAAM7I,GAAG9E,OAE7B8E,GAAG9E,MAAMC,4BAIRyU,cAAe,4DAMpBpR,MAAMuF,KAAKxL,KAAK+W,kBAAkBzM,SAAQ,SAACc,GACzC8D,EAAK6I,kCAAkC3M,sDAInBe,OAChB6L,EAAe7L,EAAOzC,OACtBuO,EAAcjY,KAAKsX,WACnBY,EAAclY,KAAKwX,WACnBW,EAAcF,EAAcC,EAG5BE,EAFY,YAEyBJ,EAA4B,EAAhD,aAGvB/R,MAAMuF,KAAKW,GAAQ7B,SAAQ,SAACc,EAAO+D,OAG3BkJ,EAASpV,KAAKC,GARJ,YAQWiM,GAAsB,EAAMiJ,EAGjDvW,EAAKoW,EAAchV,KAAKqV,IAAID,GAAUF,EACtCrW,EAAKmW,EAAchV,KAAKsV,IAAIF,GAAUF,EAK5C/M,EAAM5I,MAAMe,eAAU1B,EAAEuO,QAAQ,SAChChF,EAAM5I,MAAMiB,cAAS3B,EAAEsO,QAAQ,oFAS5BoI,oBAEAxF,YAAYjO,iBAAiB,SAAS,SAACpC,GAC1C2M,EAAKmJ,eAAenJ,EAAK0D,aACzBrQ,EAAMC,yBAGHoQ,YAAYjO,iBAAiB,eAAe,SAACpC,GAChD2M,EAAKmJ,eAAenJ,EAAK0D,aACzBrQ,EAAMC,8EAIwBmD,cAC1BqF,EAAQrF,EAGR2S,EAAStN,EAAM/K,aAAa,yBAEnB,mBAAXqY,EACFtN,EAAMrG,iBAAiB,SAAS,WAC9B0N,EAAIwB,YAAW,GACfsB,EAAKkD,oBACJ,GAGe,gBAAXC,EACPjR,GAAGsI,OAAO3E,GAAO8F,GAAG,SAAS,WAC3ByB,EAAQgG,aACRpD,EAAKkD,oBACJ,GAGe,qBAAXC,EACPtN,EAAMrG,iBAAiB,SAAS,WAC9B8R,EAAc+B,YAAY,QAC1BrD,EAAKkD,oBACJ,GAGe,oBAAXC,EACPtN,EAAMrG,iBAAiB,SAAS,WAC9B8R,EAAc+B,YAAY,OAC1BrD,EAAKkD,oBACJ,GAGe,oBAAXC,GACPtN,EAAMrG,iBAAiB,SAAS,WAC9B8R,EAAc+B,YAAY,OAC1BrD,EAAKkD,oBACJ,GA2BLrN,EAAMrG,iBAAiB,cAAc,SAACpC,GACpC4S,EAAK6B,SAAS/P,UAAY1E,EAAMkW,cAAcxY,aAAa,iCAC3DkV,EAAK6B,SAAS5U,MAAMsW,QAAU,WAC7B,GACH1N,EAAMrG,iBAAiB,cAAc,WACnCwQ,EAAK6B,SAAS/P,UAAY,GAC1BkO,EAAK6B,SAAS5U,MAAMsW,QAAU,UAC7B,0CAgDUC,EAAYpW,OACnB2N,EAAOyI,GAAc5Y,SAASI,cAAc,4BAE5CyY,ER1DH,SAA0BrW,SAIxB,CACLd,EAAGc,EAAME,MACTf,EAAGa,EAAMI,OQoDckW,CAAiBtW,GAClCiP,EAAgBtK,EAAgBgJ,QACjC0C,YAAYrI,aAAa,eAAgBiH,EAAc/P,QACvDmR,YAAYrI,aAAa,eAAgBiH,EAAc9P,QAGvDkR,YAAYxQ,MAAMiB,cAASuV,EAAelX,EAAI,aAC9CkR,YAAYxQ,MAAMe,eAAUyV,EAAenX,EAAI,YAG9CqX,EAAwBlZ,KAAKgT,YAAYzJ,iBAAiB,mBAC3D4P,wBAAwBD,GAG7BjQ,EAAWjJ,KAAKgT,YAAa,iEAU7BhK,EAAchJ,KAAKgT,YAAa,aAEhCP,EAAIkE,aAEJlE,EAAImF,eAGJwB,YAAW,WACJrQ,EAAWgN,EAAK/C,YAAa,cAChC/M,MAAMuF,KAAKuK,EAAKgB,kBAAkBzM,SAAQ,SAACc,GACzCpC,EAAcoC,EAAO,kBAGxB,gDAICiO,cAECrG,YAAYjO,iBAAiB,cAAc,WAC9CsU,EAAkBD,YAAW,WAC3BE,EAAKb,eAAea,EAAKtG,eACxB,aAGAA,YAAYjO,iBAAiB,cAAc,WAC9CwU,aAAaF,gDAICG,IACZzQ,EAAWyQ,EAAa,aAAwC,SAAzBA,EAAY/I,YACrDxH,EAAWjJ,KAAKkX,gBAAiB,aAGjCjR,MAAMuF,KAAKxL,KAAKgX,aAAa1M,SAAQ,SAACmP,GACpCxQ,EAAWwQ,EAAY,gBAGzBxT,MAAMuF,KAAKxL,KAAKiX,YAAY3M,SAAQ,SAACoP,GACnC1Q,EAAc0Q,EAAW,iBAMzB3Q,EAAWyQ,EAAa,gBAC1BvQ,EAAWjJ,KAAKkX,gBAAiB,aAGjCjR,MAAMuF,KAAKxL,KAAKgX,aAAa1M,SAAQ,SAACmP,GACpCxQ,EAAWwQ,EAAY,gBAGzBxT,MAAMuF,KAAKxL,KAAKiX,YAAY3M,SAAQ,SAACoP,GACnC1Q,EAAc0Q,EAAW,iBAMzB3Q,EAAWyQ,EAAa,kBAC1BxQ,EAAchJ,KAAKkX,gBAAiB,aAG/BnO,EAAWyQ,EAAa,mBAC3BvT,MAAMuF,KAAKxL,KAAKgX,aAAa1M,SAAQ,SAACmP,GACpCzQ,EAAcyQ,EAAY,gBAG5BxT,MAAMuF,KAAKxL,KAAKiX,YAAY3M,SAAQ,SAACoP,GACnCzQ,EAAWyQ,EAAW,kBAOC,UAAzBF,EAAY/I,UACdxH,EAAWjJ,KAAKkX,gBAAiB,aACjClO,EAAchJ,KAAKmX,YAAa,aAEhClR,MAAMuF,KAAKxL,KAAKgX,aAAa1M,SAAQ,SAACmP,GACpCzQ,EAAcyQ,EAAY,gBAG5BxT,MAAMuF,KAAKxL,KAAKiX,YAAY3M,SAAQ,SAACoP,GACnC1Q,EAAc0Q,EAAW,kBAIvB3Q,EAAWyQ,EAAa,iBAC1BxQ,EAAchJ,KAAKmX,YAAa,aAEhClO,EAAWjJ,KAAKmX,YAAa,aAG/B1E,EAAIkH,WAAWH,0CAxKArD,OAAOtN,yDAAU,6BAC9BhJ,EAAWM,SAASI,cAAcsI,GAClC4H,EAAW5Q,EAAS4Q,SACpB8B,EAAW,eAEfvJ,EAAcnJ,EAAU,YACxBoJ,EAAWpJ,EAAUsW,GAGb1F,OACD,iBAGA,MAMHA,GAJE5Q,EADEA,EAAS+O,cAAcgF,WAAW,GACzB/T,EAAS+O,cAAcgF,WAAW,GAElC/T,EAAS+O,eAEF6B,uBAGpB7G,QAAQC,IAAI,6BAA8B4G,GAI1CgC,EAAIC,6BAA6B7S,KAAW0S,EAAW,cAGrDO,EAAQjT,EAASkM,GAAGvC,MAAM,KAAK,GAGrC9D,EAAgBvF,SAAU,aAAc,GAAI,CAC1CoR,IAAK,CACHxF,GAAI+G,EACJtB,KAAMe,EACNzL,KAAMjH,EACN4Q,SAAAA,EACAgB,aAAa,EACb0E,MAAAA,cC/NayD,yCAGZC,QAAU,wCASdC,EAAQC,eAETD,EAAS9Z,KAAKga,OAAOF,IAEdxP,SAAQ,SAAC3H,GAETzB,EAAK2Y,QAAQlX,KAChBzB,EAAK2Y,QAAQlX,GAAS,IAGxBzB,EAAK2Y,QAAQlX,GAAO0O,KAAK0I,kCAKzBD,EAAQC,eAEVD,EAAS9Z,KAAKga,OAAOF,IAEdxP,SAAQ,SAAC3H,GAETuM,EAAK2K,QAAQlX,KAElBuM,EAAK4K,OAAOnX,GAASuM,EAAK2K,QAAQlX,GAAOsX,QAAO,SAACC,UACxCA,IAAeH,yCASpBD,EAAQK,cAEdL,EAAS9Z,KAAKga,OAAOF,GAErBlQ,QAAQC,IAAIiQ,EAAQK,GAEpBL,EAAOxP,SAAQ,SAAC3H,GAET2M,EAAKuK,QAAQlX,IAElB2M,EAAKuK,QAAQlX,GAAO2H,SAAQ,SAACyP,GAC3BA,EAAG7H,KAAK5C,EAAM3M,EAAOwX,wCAOpBL,UACEA,EAAOhQ,QAAQ,aAAc,IAAIN,MAAM,gBChE5C4Q,EAAc,CAClBC,OAAQ,CACNtO,GAAI,SACJuO,QAAS,iBACTC,WAAY,oBACZC,WAAY,oBACZC,OAAQ,iBAEVC,SAAU,CACR3O,GAAI,WACJ0O,OAAQ,mBAEVE,SAAU,CACR5O,GAAI,WACJ6O,WAAY,sBACZC,cAAe,yBACfC,cAAe,yBACfL,OAAQ,mBAEVM,YAAa,CACXhP,GAAI,cACJiP,IAAK,kBACLC,OAAQ,qBACRC,OAAQ,qBACRT,OAAQ,sBAEVU,MAAO,CACLpP,GAAI,QACJiP,IAAK,MACLC,OAAQ,SACRC,OAAQ,SACRT,OAAQ,WCwGNU,EAAQ,gFAnHLC,MAAQ,KACRA,MAAMC,KAAO,8DAGJC,OACVC,GAAY,cACXH,MAAMC,KAAK/Q,SAAQ,SAACvE,EAAM0D,GAEzB1D,EAAKgG,KAAOuP,IACdC,EAAY,CAAExV,KAAAA,EAAMoJ,MAAO1F,OAKxB8R,iCAGFC,MAE0B,IAA3Bxb,KAAKob,MAAMC,KAAK3R,QAAiB1J,KAAKyb,gBAAgBD,EAAazP,UAoB/D,IAAI2P,MAAM,6CAlBZhP,IAAc8O,EAAatW,KAAKyW,wBAClCH,EAAatW,KAAKyW,sBAAwB,SAGvCP,MAAMC,KAAKhK,KAAKmK,GAErBL,EAAMS,QAAQxB,EAAYC,OAAOI,OAAQ,CACvC/B,OAAQ,CACN3M,GAAIqO,EAAYC,OAAOtO,GACvBpG,KAAMyU,EAAYC,OAAOC,QACzBpV,KAAM,CACJsW,aAAAA,wCAYAA,OAEJD,EAAYvb,KAAKyb,gBAAgBD,EAAazP,QAEhC,IAAdwP,cAEGH,MAAMC,KAAKQ,OAAON,EAAUpM,MAAO,GAExCgM,EAAMS,QAAQxB,EAAYC,OAAOI,OAAQ,CACvC/B,OAAQ,CACN3M,GAAIqO,EAAYC,OAAOtO,GACvBpG,KAAMyU,EAAYC,OAAOE,WACzBrV,KAAM,CACJsW,aAAc,CACZM,SAAUN,EAAaM,SACvB/P,GAAIyP,EAAazP,GACjBhF,QAASyU,EAAazU,QACtB7B,KAAM,SAOP,QAGH,IAAIwW,MAAM,8EAGPK,eAGLrP,IAAcqP,GAASA,EAAKD,SAEX9b,KAAKob,MAAMC,KAAKpB,QAAO,SAAClU,UAASA,EAAK+V,WAAaC,EAAKD,YAF1B9b,KAAKob,MAAMC,uCAOtDU,eAIKrP,IAATqP,KACmC,IAHnB,CAAC,WAAY,KAAM,WAGvBhY,QAAQgY,EAAKC,OAExB/V,MAAMC,QAAQ6V,EAAKpI,SACtBoI,EAAKpI,MAAQ,CAACoI,EAAKpI,QAMA3T,KAAKob,MAAMC,KAAKpB,QAAO,SAAClU,UAAUA,EAAKgW,EAAKC,OAASD,EAAKpI,MAAM,IAAQ5N,EAAKgW,EAAKC,OAASD,EAAKpI,MAAM,2CAKlHoI,WAELrP,IAAcqP,IAASA,EAAKD,gBACvB9b,KAAKob,MAAMC,KAAKrb,KAAKob,MAAMC,KAAK3R,OAAS,OAG5CuS,EAAejc,KAAKob,MAAMC,KAAKpB,QAAO,SAAClU,UAASA,EAAK+V,WAAaC,EAAKD,mBAEtEG,EAAaA,EAAavS,OAAS,UArH1BkQ,ICiGduB,EAAQ,gFArGLC,MAAQ,2DAIFrP,OACPmQ,GAAe,cACdd,MAAM9Q,SAAQ,SAACvE,EAAM0D,GAEpB1D,EAAKgG,KAAOA,IACdmQ,EAAe,CAAEnW,KAAAA,EAAMoJ,MAAO1F,OAK3ByS,8BAGLhX,MAIwB,IAAtBlF,KAAKob,MAAM1R,QAAiB1J,KAAKmc,aAAajX,EAAK6G,UAY/C,IAAI2P,MAAM,gDAVXN,MAAM/J,KAAKnM,GAEhBiW,EAAMS,QAAQxB,EAAYW,YAAYhP,GAAI,CACxC2M,OAAQ,CACN/S,KAAMyU,EAAYW,YAAYC,KAEhC9V,KAAAA,mCASCA,OAECgX,EAAelc,KAAKmc,aAAajX,EAAK6G,QAEvB,IAAjBmQ,cAEGd,MAAMS,OAAOK,EAAa/M,MAAO,GAEtCgM,EAAMS,QAAQxB,EAAYW,YAAYhP,GAAI,CACxC2M,OAAQ,CACN/S,KAAMyU,EAAYW,YAAYE,QAEhC/V,KAAAA,KAGK,QAGH,IAAIwW,MAAM,0EAKXK,eAEDrP,IAAcqP,GAASA,EAAK1B,OAEXra,KAAKob,MAAMnB,QAAO,SAAClU,UAASA,EAAKgG,KAAOgQ,EAAKhQ,MAFjB/L,KAAKob,oCAOlDW,eAIUrP,IAATqP,IAA2D,IAF5C,CAAC,MAEoBhY,QAAQgY,EAAKC,OAIjD/V,MAAMC,QAAQ6V,EAAKpI,SACtBoI,EAAKpI,MAAQ,CAACoI,EAAKpI,QAGA3T,KAAKob,MAAMnB,QAAO,SAAClU,UAAUA,EAAKgW,EAAKC,OAASD,EAAKpI,MAAM,IAAQ5N,EAAKgW,EAAKC,OAASD,EAAKpI,MAAM,uCAMhHoI,WAEFrP,IAAcqP,IAASA,EAAK1B,cACvBra,KAAKob,MAAMpb,KAAKob,MAAM1R,OAAS,OAGlC0S,EAAepc,KAAKob,MAAMnB,QAAO,SAAClU,UAASA,EAAKgG,KAAOgQ,EAAKhQ,aAE3DqQ,EAAaA,EAAa1S,OAAS,UAvGpBkQ,ICiBLyC,yBAEPxT,mDACJA,KAIDyT,QAAUpb,EAAKpB,SACfiM,GAAK7K,EAAKob,QAAQvQ,KAElBwQ,SAAWtQ,KAAKC,MAAM/L,SAASI,mDAA4CW,EAAK6K,UAAQ1L,aAAa,2BAErG0b,Kb8DF,SAASS,EAAY1c,EAAQ2c,OAC5BC,EAASpX,OAAOC,OAAO,GAAIzF,UAC7BgG,EAAWhG,IAAWgG,EAAW2W,IACnCnX,OAAOqX,KAAKF,GAAQnS,SAAQ,SAAC0R,GACvBlW,EAAW2W,EAAOT,KACdA,KAAOlc,EAGX4c,EAAOV,GAAOQ,EAAY1c,EAAOkc,GAAMS,EAAOT,IAGhD1W,OAAOC,OAAOmX,OAAWV,EAAMS,EAAOT,QAIrCU,Ea7EOF,CAAYH,EAAOlX,SAAUjE,EAAKqb,YAEzCK,OAAS,CACZC,QAAS,CACP,SAEFC,YAAa,CACX,cAAe,eAAgB,YAAa,SAE9CC,SAAU,CACR,cAAe,eAAgB,gBAI9BC,WAAa,IAEbC,SAAU,IAEVlL,UAAY,OACZmL,sBAAwB,KACxBC,YAAc,OACdC,oBAAsB,OACtBC,oBAAsB,OACtBC,kBAAoB,OAEpBC,oBAAqB,IACrBC,mBAAqB,OAErBC,2BAA4B,IAC5BC,eAAiB,OAEjBC,YAAa,IACbC,QAAU,KAEVC,gBAAkB,KAClBC,eAAiB,KAEjBC,UAAY,KAEZC,4BAA8B,KAC9BC,+BAAiC,eACjCC,8BAAgC,KAChCC,iCAAmC,eACnCC,oBAAqB,IACrBC,WAAY,IAEZC,cAAgB,OAEhB7Q,MAAQ,CACXxF,KAAM9H,SAAS8H,KACf/F,OAAAA,UAGGqS,4DAID8H,EAAOkC,SAASve,KAAK+b,eAEhByC,MAAQxe,KAAKsc,QAAQmC,uBAAuBze,KAAK+b,KAAK2C,WAAW,QAGjEC,aAAe3e,KAAKwe,MAAMC,uBAAuB,QAAQ,GAAGA,uBAAuB,kBACnFG,WAAa5e,KAAKwe,MAAMC,uBAAuB,SAAS,GAC7D,MAAOI,QACF5B,SAAU,YAGZA,SAAU,EAGbZ,EAAOyC,YAAY9e,KAAK+b,aACrB4B,YAAa,QAGf3c,QAAUhB,KAAKsc,QAAQmC,uBAAuBze,KAAK+b,KAAKgD,aAAa,GAGjD,UAArB/e,KAAK+b,KAAKiD,SACZ/V,EAAWjJ,KAAKwe,MAAO,UAGE,UAArBxe,KAAK+b,KAAKiD,cACPnB,gBAAgBoB,KAAOjf,KAAKgB,QAAQqG,eACpCwW,gBAAgBlO,KAAO3P,KAAKgB,QAAQ2K,eACpCmS,eAAemB,KAAOjf,KAAKgB,QAAQqG,eACnCyW,eAAenO,KAAO3P,KAAKgB,QAAQ2K,eAEnCqS,4BAA8Bhe,KAAKkf,iCACnChB,8BAAgCle,KAAKkf,6BAIxClf,KAAK2d,kBACFC,QAAQ/d,SAAWG,KAAKsc,QAAQmC,uBAAuB,kBAAkB,QACzEb,QAAQuB,UAAYnf,KAAK4d,QAAQ/d,SAAS4e,uBAAuB,+BAA+B,SAGlGW,4BAIkB,gBAArBpf,KAAK+b,KAAKiD,aACPK,wFAMFrC,WAAahd,KAAKgd,WAAa,YAC1Bhd,KAAK+L,eAAM/L,KAAKgd,4EAIrBA,WAAahd,KAAKgd,WAAa,kBACpBhd,KAAK+L,eAAM/L,KAAKgd,+EAO3Bhc,QAAQ+D,iBAAiB,YAAa/E,KAAKsf,aAAa5e,KAAKV,OAAO,QACpEgB,QAAQ+D,iBAAiB,YAAa/E,KAAKsf,aAAa5e,KAAKV,OAAO,QAIpEyN,MAAMxF,KAAKlD,iBAAiB,UAAW/E,KAAKsf,aAAa5e,KAAKV,OAAO,GAGjD,UAArBA,KAAK+b,KAAKiD,aAEPhe,QAAQ+D,iBAAiB,WAAW,SAAC6Q,Ob3FF2J,Ea6FhCxN,EAAY7P,OAAOsd,eACnBC,EAAU7J,EAAE8J,OAAS9J,EAAE6J,QACzBE,EAAU/J,EAAEoG,OAGhB9M,EAAKzO,eAGW,cAAZkf,GAAuC,WAAZA,MACzB5N,EAAU6N,WAAY,CACxB1d,OAAOqX,aAAarK,EAAK+O,oCAEnB4B,EAAQ9N,EAAU+N,WAAW,GAC7BC,EAAaF,EAAME,gBAErB7Q,EAAKgO,sBAAsBC,gBAG3B4C,EAAWC,SAASH,EAAMI,eAAgBJ,EAAMK,YAAc,GAC9D,MAAOtK,GAEPmK,EAAWC,SAASH,EAAMI,eAAgBJ,EAAMK,aAChDH,EAAWI,UAAS,QAItBJ,EAAWC,SAASH,EAAMI,eAAgBJ,EAAMK,aAIlDH,EAAWK,OAAOP,EAAMQ,aAAcR,EAAMS,eAItCC,EADgBR,EAAWS,gBACSC,YAAYC,UAEzB,KAAxBH,GAAsD,WAAxBA,GAAqCrR,EAAKkP,mBAAoB,KAEzFuC,EAAoBxgB,SAAS+G,cAAc,QACjDyZ,EAAkBzX,4CAAuCgG,EAAK8O,6BAE9D+B,EAAWa,iBAAiBD,GAE5B5O,EAAU8O,kBACV9O,EAAU+O,SAASjB,GAEnB3Q,EAAK+O,+BAAiC7E,YAAW,WAE/ClK,EAAKkP,oBAAqB,MAGpB2C,EAAe5gB,SAAS+G,cAAc,QAC5C6Z,EAAaC,iBAAkB,EAC/BD,EAAa7X,UAAY,wBAEnB+X,EAAiB/R,EAAKgS,oBAC5BH,EAAahV,GAAKkV,MAEZ9X,EAAWlD,MAAMuF,KAAKrL,SAASse,uBAAuBvP,EAAK8O,8BAEjE7X,EAAe4a,EAAc5X,EAAS,IAEtCA,EAASmB,SAAQ,SAAC3D,EAAI8C,GACpBsX,EAAa5Z,YAAYR,UAKrBwa,EAAYhhB,SAAS+G,cAAc,QACzCia,EAAUjY,UAAYgG,EAAK6M,KAAKqF,cAQhCD,EAAUpc,iBAAiB,QANN,SAAC6Q,OACdyL,EAAezL,EAAEiD,cAAcvS,WACrC4I,EAAKoS,2BAA2BD,GAChCzL,EAAElK,mBAG6ChL,KAAKwO,IAEtD/O,SAASohB,eAAeN,GAAgB9Z,YAAYga,GAEpDjS,EAAKsS,wBAAyB,EAC9BtS,EAAK8O,4BAA8B9O,EAAKgQ,8BAEvC,KAEHhQ,EAAKkP,oBAAqB,EAE1BxI,EAAEhT,qBAEG,KAEAsM,EAAKkP,0BAIVxI,EAAEhT,wBAOH,IbpMiC2c,EaoMCE,GbjMhC,IAAMF,EAAU,IAChB,IAAXA,GAA4B,IAAXA,GAChBA,EAAU,IAAMA,EAAU,IAC1BA,EAAU,IAAMA,EAAU,KAC1BA,EAAU,KAAOA,EAAU,KAC3BA,EAAU,KAAOA,EAAU,Oa+LlBrQ,EAAKgO,sBAAsBC,YAAa,IAG1B,KAAZsC,EAAgB,KACbvQ,EAAKkP,0BAKVuB,EAAU,OAIR5N,EAAU6N,WAAY,CAExB1d,OAAOqX,aAAarK,EAAKiP,sCAEnB0B,EAAQ9N,EAAU+N,WAAW,GAC7BC,EAAaF,EAAME,aAEzBA,EAAWC,SAASH,EAAMI,eAAgBJ,EAAMK,aAChDH,EAAWK,OAAOP,EAAMQ,aAAcR,EAAMS,eAEtCmB,EAAmBthB,SAAS+G,cAAc,QAChDua,EAAiBT,iBAAkB,EACnCS,EAAiBvY,6CAAwCgG,EAAKgP,+BAC9DuD,EAAiBpa,UAAYsY,EAE7BI,EAAW2B,WAAWD,GAGtB5B,EAAM8B,cAAcF,GAEpB1P,EAAU8O,kBACV9O,EAAU+O,SAASjB,GAEnB3Q,EAAKiP,iCAAmC/E,YAAW,WAEjDlK,EAAKkP,oBAAqB,MAGpB2C,EAAe5gB,SAAS+G,cAAc,QAC5C6Z,EAAaC,iBAAkB,EAC/BD,EAAa7X,UAAY,yBAEnB+X,EAAiB/R,EAAKgS,oBAC5BH,EAAahV,GAAKkV,MAEZ9X,EAAWlD,MAAMuF,KAAKrL,SAASse,uBAAuBvP,EAAKgP,gCAEjE/X,EAAe4a,EAAc5X,EAAS,IAEtCA,EAASmB,SAAQ,SAAC3D,EAAI8C,GACpBsX,EAAa5Z,YAAYR,UAKrBwa,EAAYhhB,SAAS+G,cAAc,QACzCia,EAAUjY,UAAYgG,EAAK6M,KAAKqF,cAQhCD,EAAUpc,iBAAiB,QANN,SAAC6Q,GAEpBlP,EADqBkP,EAAEiD,cAAcvS,YAErCsP,EAAElK,mBAG6ChL,KAAKwO,IACtD/O,SAASohB,eAAeN,GAAgB9Z,YAAYga,GAEpDjS,EAAKgP,8BAAgChP,EAAKgQ,8BAEzC,KAEHhQ,EAAKkP,oBAAqB,GAKW,IAAnClP,EAAKuO,4BACPvO,EAAKuO,2BAA4B,GAGnC7H,EAAEhT,qBAIC,CACHV,OAAOqX,aAAarK,EAAKiP,sCAEnB0B,EAAQ9N,EAAU+N,WAAW,GAC7BC,EAAaF,EAAME,gBAEzBA,EAAWC,SAASH,EAAMI,eAAgBJ,EAAMK,aAChDH,EAAWK,OAAOP,EAAMQ,aAAcR,EAAMS,YAGrB,IAAnBpR,EAAKmP,WAAuBtM,EAAU9G,WAAWvB,OAAS,EAAG,CAE/DwF,EAAKoP,cAAgBne,SAAS+G,cAAc,QAC5CgI,EAAKoP,cAAc0C,iBAAkB,EACrC9R,EAAKoP,cAAcpV,UAAY,wBAEzB0Y,EAAiB1S,EAAKgS,oBAC5BhS,EAAKoP,cAAcvS,GAAK6V,MAElBC,EAAqB1hB,SAAS+G,cAAc,QAClD2a,EAAmB3Y,UAAY,0BAE/BgG,EAAKoP,cAAcnX,YAAY0a,GAE/B9B,EAAWa,iBAAiB1R,EAAKoP,mBAG3B6C,EAAYhhB,SAAS+G,cAAc,QACzCia,EAAUjY,UAAYgG,EAAK6M,KAAKqF,cAQhCD,EAAUpc,iBAAiB,QANN,SAAC6Q,OACdyL,EAAezL,EAAEiD,cAAcvS,WACrC4I,EAAKoS,2BAA2BD,GAChCzL,EAAElK,mBAG6ChL,KAAKwO,IACtDA,EAAKoP,cAAcnX,YAAYga,GAKjCjS,EAAKmP,WAAY,MAEXyD,EAAmB3hB,SAAS+G,cAAc,QAChD4a,EAAiBd,iBAAkB,EACnCc,EAAiB5Y,6CAAwCgG,EAAKgP,+BAG9D4D,EAAiBza,oBAAesY,GAGhCxZ,EAAe2b,EAAkB5S,EAAKoP,eACtCuB,EAAM8B,cAAcG,GAEpB/P,EAAU8O,kBACV9O,EAAU+O,SAASjB,GAEnB3Q,EAAKiP,iCAAmC/E,YAAW,WACjDlK,EAAKmP,WAAY,MAGX0D,EAAc5hB,SAAS+G,cAAc,QAC3C6a,EAAYf,iBAAkB,EAC9Be,EAAY7Y,UAAY,yBAElB+X,EAAiB/R,EAAKgS,oBAC5Ba,EAAYhW,GAAKkV,MAEX9X,EAAWlD,MAAMuF,KAAKrL,SAASse,uBAAuBvP,EAAKgP,gCAEjE/X,EAAe4b,EAAa5Y,EAAS,IAErCA,EAASmB,SAAQ,SAAC3D,EAAI8C,GACpBsY,EAAY5a,YAAYR,UAGpBwa,EAAYhhB,SAAS+G,cAAc,QACzCia,EAAUjY,UAAYgG,EAAK6M,KAAKqF,cAQhCD,EAAUpc,iBAAiB,QANN,SAAC6Q,GAEpBlP,EADqBkP,EAAEiD,cAAcvS,YAErCsP,EAAElK,mBAG6ChL,KAAKwO,IACtD/O,SAASohB,eAAeN,GAAgB9Z,YAAYga,GAEpDjS,EAAKgP,8BAAgChP,EAAKgQ,8BAEzC,KAEHtJ,EAAEhT,qBAQN5C,KAAKid,cACF+E,sBAGHhiB,KAAK2d,iBACFC,QAAQuB,UAAUpa,iBAAiB,SAAS,WAE3Bkd,QAAQ,+EAG1B/S,EAAKlO,QAAQqG,UAAY6H,EAAK2O,gBAAgBoB,2DAS/C,IAAIxV,EAAI,EAAGyY,EAAMliB,KAAK2e,aAAajV,OAAQD,EAAIyY,EAAKzY,GAAK,OACvDkV,aAAalV,GAAG1E,iBAAiB,QAAS/E,KAAKmiB,mBAAmBzhB,KAAKV,OAAO,QAGhF4e,WAAW7Z,iBAAiB,QAAS/E,KAAKoiB,iBAAiB1hB,KAAKV,OAAO,2EAsBvEqiB,qBAAuBriB,KAAKsc,QAAQ/S,4BAHxB,yBAIjBtD,MAAMuF,KAAKxL,KAAKqiB,sBAAsB/X,SAAQ,SAACgY,GAE7CA,EAAYvd,iBAAiB,SAAS,WACpC6D,EAAc0Z,EAAahT,EAAKyM,KAAKhB,YAAYwH,mBAC3CC,EAAYlT,EAAKvD,GAAGjC,QAAQ,UAAW,OAEzCf,EAAWuZ,EAAahT,EAAKyM,KAAKhB,YAAYwH,eAAgB,CAEhEE,EAAY3hB,IAAI,CACduZ,OAAQ/K,EAAKvD,GACbA,GAAIuW,EAAYvW,GAChB2W,IAAKJ,EACLK,QAAS1W,KAAKC,MAAMoW,EAAYjiB,aAhBvB,2BAoBLsiB,EAAU1W,KAAKC,MAAMoW,EAAYjiB,aAAa,qBAEpDqF,EAAgBvF,SAAU,gBAAiB,GAAI,CAC7CwP,KAAM,CACJ5D,GAAIyW,EACJhR,KAAM,MACNmR,QAAAA,EACAhP,MAAO2O,EAAYlb,WAAU,WAKjCqb,SAAmB,CACjBpI,OAAQ/K,EAAKvD,GACbA,GAAIuW,EAAYvW,KAIlBrG,EAAgBvF,SAAU,gBAAiB,GAAI,CAC7CwP,KAAM,CACJ5D,GAAIyW,EACJhR,KAAM,SACNmC,MAAO2O,KAMbhT,EAAK7O,8DAOAmiB,2DAEU,IAAfA,IAK4B,IAA5B5iB,KAAKud,mBAKLxU,EAAW/I,KAAKwe,MAAO,YAAyC,IAA5Bxe,KAAKud,0BACtCsF,qBACL7Z,EAAchJ,KAAKwe,MAAO,WAX1BvV,EAAWjJ,KAAKwe,MAAO,2DA6BrBsE,EACAC,EAbEC,EbncH,SAA6Brc,OAAIsc,6DAEhCC,EAAgBvc,EAAGS,WAAU,GAEnC8b,EAAc1gB,MAAM2gB,WAAa,SACjCD,EAAc1gB,MAAMsW,QAAU,QAE9BtS,EAAc0c,EAAevc,OAEvByc,EAAeF,EAAcxgB,wBAC7B2gB,EAAcJ,EAAcrb,EAAqBsb,GAAiBxa,EAAWwa,UAGnFxc,EAASwc,GAEF,CACL9gB,MAAOghB,EAAahhB,MACpBC,OAAQ+gB,EAAa/gB,OACrBoB,IAAK4f,EAAW5f,IAChBF,KAAM8f,EAAW9f,MagbM+f,CAAoBtjB,KAAKwe,OAC1C+E,EAA2B3b,EAAqB5H,KAAKsc,SACrDkH,EAAmB9a,EAAW1I,KAAKsc,SAInCmH,EACIzjB,KAAKqd,oBAAoB9Z,KAAOvD,KAAKqd,oBAAoBjb,MAAQ4gB,EAAe5gB,MAAQpC,KAAK+b,KAAK2H,WAAW7hB,EAAM0hB,EAAyBhgB,KAAOigB,EAAiBphB,MADxKqhB,EAEEzjB,KAAKqd,oBAAoB5Z,IAAMuf,EAAe3gB,OAASrC,KAAK+b,KAAK2H,WAAW5hB,EAAMyhB,EAAyB9f,IACxGzD,KAAKqd,oBAAoB5Z,IAAMzD,KAAKqd,oBAAoBhb,OAAS2gB,EAAe3gB,OAASrC,KAAK+b,KAAK2H,WAAW5hB,EAAMyhB,EAAyB9f,IAAM+f,EAAiBnhB,OAQ7KygB,EAFEW,EAEezjB,KAAKqd,oBAAoB9Z,KAAOyf,EAAe5gB,MAAQpC,KAAK+b,KAAK2H,WAAW7hB,EAI5E7B,KAAKqd,oBAAoB9Z,KAAOvD,KAAKqd,oBAAoBjb,MAAQpC,KAAK+b,KAAK2H,WAAW7hB,EAMvGkhB,EAFEU,EAEczjB,KAAKqd,oBAAoB5Z,IAAMuf,EAAe3gB,OAASrC,KAAK+b,KAAK2H,WAAW5hB,EAI5E9B,KAAKqd,oBAAoB5Z,IAAMuf,EAAe3gB,OAASrC,KAAK+b,KAAK2H,WAAW5hB,OAIzF0c,MAAMhc,MAAMe,eAAUuf,aACtBtE,MAAMhc,MAAMiB,cAASsf,iDAIXnN,QAEV+N,YAAW,GAEhB/N,EAAEhT,4DAIegT,OAEXgO,EAAMhO,EAAEiD,cACRgL,EAAUD,EAAIvjB,aAAa,gBAC3ByjB,EAAcF,EAAIvjB,aAAa,qBAG/B4E,EAAUgH,KAAKC,MAAM0X,EAAIvjB,aAAa,8BAEvC0jB,aAAaF,EAASC,EAAa7e,GAExC2Q,EAAEhT,sDAISgT,GAC2B,IAAZA,EAAE8J,OAIxB3W,EAAW6M,EAAE9V,OAAQ,eAErBiJ,EAAW6M,EAAE9V,OAAQ,mBAEV,cAAX8V,EAAEjQ,YAGC4X,oBAAqB,GAEL,IAAjBvd,KAAKid,cACF0G,cAKM,YAAX/N,EAAEjQ,MAAsB3F,KAAKud,0BAG1BL,sBAAwB,QAExBnL,UAAY7P,OAAOsd,oBACnBrC,YAAcnd,KAAKkd,sBAAsBC,YAAcnd,KAAK+R,UAAUoL,iBACtEC,oBAAsBpd,KAAK+R,UAAU+N,WAAW,QAEhDvC,oBAAqB,OAErBL,sBAAsB8G,aAAehkB,KAAK+R,UAAUiS,kBACpD9G,sBAAsB+G,YAAcjkB,KAAK+R,UAAUkS,iBACnD/G,sBAAsBvN,KAAO3P,KAAKod,oBAAoBnS,YAKxB,IAA/BjL,KAAK+R,UAAUoL,aAAwE,KAA/Cnd,KAAKod,oBAAoBnS,WAAWyV,cAEzElD,mBAAsBxd,KAAK+R,UAAUiS,cAAgBhkB,KAAK+R,UAAUkS,YAAe,QAAU,QAE7E,IAAjBjkB,KAAKid,eAEFiH,6BAEAP,qEAWL5C,EAAe5gB,SAAS+G,cAAc,QAC5C6Z,EAAa7X,UAAY,2BAEpBkU,oBAAoBwD,iBAAiBG,OAEpCoD,EAAoBvc,EAAqBmZ,GACzCqD,EAAqB1b,EAAWqY,QAEjC1D,oBAAsB,CACzB9Z,KAAM4gB,EAAkB5gB,KACxBE,IAAK0gB,EAAkB1gB,IACvBrB,MAAOgiB,EAAmBhiB,MAC1BC,OAAQ+hB,EAAmB/hB,QAG7B2G,EAAc+X,EAAc,4BAEvBO,2BAA2BP,mDAIVsD,GACtBA,EAAOld,YAAYnH,KAAKod,oBAAoBkH,wBACvClH,oBAAoBsE,WAAW2C,OAE9Btd,EAAUsd,EAAOhkB,aAAa,qBAC9BkkB,EAAWvkB,KAAKkhB,oBAEtBmD,EAAO1Z,aAAa,cAAe4Z,GAGnCpJ,EAAMqJ,OAAO,CACXnK,OAAQra,KAAK+L,GACbA,GAAIwY,EACJ7B,IAAK2B,EACLtd,QAAAA,EACA7B,KAAM,SAMFuf,EAFUJ,EAAOhkB,aAAa,SAEPmJ,MAAM,KAC/B2M,EAAQ,GACZsO,EAAana,SAAQ,SAACqJ,GAChBA,EAAMjE,SAAS,gBACjByG,EAAQxC,EAAM7J,QAAQ,aAAc,YAKlC0Y,EAAYxiB,KAAK+L,GAAGjC,QAAQ,UAAW,IAC7CpE,EAAgBvF,SAAU,gBAAiB,GAAI,CAC7CwP,KAAM,CACJ5D,GAAIyW,EACJhR,KAAM,MACNzK,QAAAA,EACA4M,MAAO0Q,EAAOjd,WAAU,GACxBsd,SAAUvO,wDAKWrP,OACnB6I,EAAO7I,EAAK2Z,YAClB3Z,EAAKR,WAAWC,aAAapG,SAASwkB,eAAehV,GAAO7I,GAC5DJ,EAASI,qDAGe8d,cAAU7I,yDAAO,GAEnC8I,EAAW1kB,SAAS+G,cAAc,QACxC2d,EAASla,aAAa,QAASoR,SAEPA,EAAK+I,YAAYtb,MAAM,SAGzCub,EAAe,SAAfA,EAAgBnP,OAEdoP,EAAYpP,EAAEiD,cACdwI,EAAe2D,EAAU1e,WAE/B0e,EAAUC,oBAAoB,QAASF,GACvC1D,EAAaza,YAAYoe,QAErBtY,IAAc2U,EAAa6D,aAG7B3P,EAAK+G,QAAQ1V,YAAYya,EAAa6D,YACtC7D,EAAa6D,WAAa,MAI5B3P,EAAK+L,2BAA2BD,OAE1Bta,EAAUsa,EAAahhB,aAAa,qBAG1C8a,EAAMgK,UAAU,CACd9K,OAAQ9E,EAAKxJ,GACbA,GAAIsV,EAAahhB,aAAa,eAC9BqiB,IAAKrB,EACLta,QAAAA,EACA7B,KAAM,SAIFsd,EAAYjN,EAAKxJ,GAAGjC,QAAQ,UAAW,IAC7CpE,EAAgBvF,SAAU,gBAAiB,GAAI,CAC7CwP,KAAM,CACJ5D,GAAIyW,EACJhR,KAAM,SACNzK,QAAAA,EACA4M,MAAO0N,KAIXzL,EAAElK,mBAIJmZ,EAAS9f,iBAAiB,QAASggB,EAAarkB,KAAKV,OAErD4kB,EAASzd,YAAY0d,qDAIGtR,OAElB6R,EAAexd,EAAqB2L,SAEnC,CACLhQ,eAAS6hB,EAAa7hB,KAAO8L,SAASkE,EAAMxF,YAAa,IAAM/N,KAAK+b,KAAKsJ,cAAcxjB,QACvF4B,cAAQ2hB,EAAa3hB,IAAMzD,KAAK+b,KAAKsJ,cAAcvjB,uDAKjC8hB,OAAK7H,yDAAO,GAE1BuJ,EAAkBnlB,SAASohB,eAAe,oBAAoBla,UAE9Dke,EAAMplB,SAAS+G,cAAc,OACnCqe,EAAIle,UAAYie,MAEVE,EAAaD,EAAI3R,WAAW,GAGlC4R,EAAWtgB,KAAO,GAClBsgB,EAAWtgB,KAAKugB,QAAU7B,MAEpB8B,EAAqBF,EAAW/G,uBAAuB,oBAAoB,GAC3EkH,EAAyBH,EAAWI,qBAAqB,UAAU,GACnEC,EAA2BL,EAAW/G,uBAAuB,sBAAsB,GAEnFqH,EAA4B9lB,KAAK+lB,0BAA0BnC,GAEjE4B,EAAWhjB,MAAMe,KAAOuiB,EAA0BviB,KAClDiiB,EAAWhjB,MAAMiB,IAAMqiB,EAA0BriB,IAEjDwF,EAAWuc,EAAYzJ,SAEvByJ,EAAWzgB,iBAAiB,SAAS,SAAC6Q,GAEhC7M,EAAW6M,EAAE9V,OAAQ,WAEvBmJ,EAAWuc,EAAY,UACvBxc,EAAc4a,EAAK,cAMvB+B,EAAuB5gB,iBAAiB,SAAS,SAAC6Q,MAEf,KAA7B8P,EAAmB/R,MAAc,KAE7BqS,EAAc7lB,SAAS+G,cAAc,OAC3C8e,EAAY9c,UAAY,eAExB8c,EAAYra,UAAY+Z,EAAmB/R,MAE3CkS,EAAyB1e,YAAY6e,GAErCN,EAAmB/R,MAAQ,YAK1B2I,QAAQtL,OAAOwU,GAEpBvc,EAAW2a,EAAK,mBAGhBA,EAAIsB,WAAaM,uDAKU5B,OAAK7H,yDAAO,YAI9BgJ,EAAanP,OAEf7M,EAAW6M,EAAE9V,OAAQ,cAAe,IAElCiJ,EAAW6a,EAAK,mBAId,KAGCkC,EAA4B9lB,KAAK+lB,0BAA0BnC,GAEjEA,EAAIsB,WAAW1iB,MAAMe,KAAOuiB,EAA0BviB,KACtDqgB,EAAIsB,WAAW1iB,MAAMiB,IAAMqiB,EAA0BriB,IAErDuF,EAAc4a,EAAIsB,WAAY,oBAVzBe,sBAAsBrC,EAAK7H,GAc7BhT,EAAW6a,EAAK,WAMnB5a,EAAc4a,EAAK,UACnB3a,EAAW2a,EAAIsB,WAAY,WAL3Bjc,EAAW2a,EAAK,UAWpBhO,EAAElK,kBAnCJzC,EAAW2a,EAAK,gBAuChBA,EAAI7e,iBAAiB,QAASggB,EAAarkB,KAAKV,4CAIrC6jB,EAASC,OAAa/H,yDAAO,MAEpC/b,KAAK+R,UAAW,IAEF,iBAAZ8R,EAA4B,KAExBD,EAAMzjB,SAAS+G,cAAc,QACnC0c,EAAIjZ,aAAa,QAASoR,EAAK+I,aAC/BlB,EAAIjZ,aAAa,oBAAqBmZ,IAEhB,IAAlB/H,EAAKmK,eACFC,0BAA0BvC,EAAK,OAC3B,aACPkB,YAAa/I,EAAK+I,eAIA,IAAlB/I,EAAKqK,eACFC,6BAA6BzC,EAAK,OAC9B7H,EAAKuK,qBAIXC,wBAAwB3C,IAEG,IAA5B7H,EAAKyK,oBACP5C,EAAI6C,aAMH9C,YAAW,QAGXljB,uBA57ByBb,GAo8BpCyc,EAAOlX,SAAW,CAChBuZ,UAAW,4BACXK,YAAa,SACb2H,cAAe,QACftF,cAAe,aACfuF,kBAAmB,gBACnBtB,cAAe,CACbxjB,EAAG,GACHC,EAAG,GAEL4hB,WAAY,CACV7hB,EAAG,GACHC,EAAG,IAELiZ,YAAa,CACX6L,QAAQ,EACRC,cAAe,SACftE,cAAe,WACfuE,gBAAiB,eAKrBzK,EAAOkC,SAAW,SAAAxC,SAAwB,UAAhBA,EAAKiD,QAAsC,UAAhBjD,EAAKiD,SAAqC,IAAdjD,EAAKgL,WAAgCra,IAAdqP,EAAKgL,MAC7G1K,EAAOyC,YAAc,SAAA/C,SAAwB,UAAhBA,EAAKiD,SAAwC,IAAjBjD,EAAK6B,cAAsClR,IAAjBqP,EAAK6B,aC3+BnEoJ,yBAEPjb,EAAIlD,EAASkT,mDACjBlT,KACDkD,GAAKA,IAELgQ,KAAOzW,OAAOC,OAAO,GAAIyhB,EAAgB7hB,SAAU4W,KAEnDkL,WAAa/lB,EAAK6a,KAAKkL,aAEvBC,SAAW,IAEXC,YAAcjmB,EAAKpB,OAAO2e,uBAAuB,gBAAgB,KACjE2I,gBAAkBlmB,EAAKimB,YAAY1I,uBAAuB,cAAc,KACxE4I,mBAAqBnmB,EAAKpB,OAAO2e,uBAAuB,wBAAwB,KAChF6I,uBAAyBpmB,EAAKmmB,mBAAmB5I,uBAAuB,cAAc,KAEtF8I,cAAgB,OAGhBC,YAAetmB,EAAK+lB,WAAcD,EAAgBS,oBAAsBT,EAAgBQ,mEAIxFE,uBAAuB1nB,KAAKonB,gBAAiBpnB,KAAKsnB,6BAClDK,mEAGgBP,EAAiBE,cAEtCnM,EAAMjK,GAAGkJ,EAAYC,OAAOI,QAAQ,SAAC9X,EAAOiD,OAGtCgiB,EACArU,EAFEmF,EAAS9S,EAAQ8S,cAKfA,EAAO/S,WAERyU,EAAYC,OAAOC,gBAEtBsN,EAAoBlP,EAAOxT,KAAKsW,cAENzU,cAEnBmI,EAAK6M,KAAK8L,MAAM,GAAGC,QAAQ,GAAGpF,OAEjC0E,EAAgBW,mBAAmB,YAAa7Y,EAAKsY,YAAY3gB,EAAU+gB,EAAkBlF,KAAMkF,EAAkB7b,MAIjHmD,EAAK6M,KAAKiM,wBAA0B9Y,EAAK6M,KAAK8L,MAAM,GAAGC,QAAQ,GAAGpF,MAAQxT,EAAK6M,KAAK8L,MAAM,GAAGC,QAAQ,GAAGpF,eAOzGxT,EAAK6M,KAAK8L,MAAM,GAAGC,QAAQ,GAAGpF,KACjCnP,EAAQqU,EAAkBlF,IAAItb,WAAU,IAClCuD,aAAa,aAAa,GAChC4I,EAAMxO,iBAAiB,QAASmK,EAAK+Y,kBAAkBvnB,KAAKwO,IAAO,GACnEqE,EAAMxO,iBAAiB,YAAamK,EAAK+Y,kBAAkBvnB,KAAKwO,IAAO,GACvEqE,EAAMxO,iBAAiB,UAAWmK,EAAK+Y,kBAAkBvnB,KAAKwO,IAAO,GACrEqE,EAAMxO,iBAAiB,OAAQmK,EAAK+Y,kBAAkBvnB,KAAKwO,IAAO,GAClEoY,EAAuBngB,YAAYoM,cAOpC6G,EAAYC,OAAOE,WAEtBqN,EAAoBlP,EAAOxT,KAAKsW,aAOhCvV,MAAMiiB,UAAU5d,QAAQ4H,KAAK/R,SAASoJ,yCAAkCqe,EAAkB7b,WAAS,SAACwH,GAE9FxK,EAAWwK,EAAMjN,WAAY,kBAG/BI,EAAS6M,EAAMjN,WAAWA,YAG1BI,EAAS6M,2DAadzT,OAAOiF,iBAAiB,WAAY/E,KAAKmoB,aAAaznB,KAAKV,OAAO,QAClEF,OAAOiF,iBAAiB,YAAa/E,KAAKmoB,aAAaznB,KAAKV,OAAO,QACnEF,OAAOiF,iBAAiB,OAAQ/E,KAAKmoB,aAAaznB,KAAKV,OAAO,6CAGnD4V,SAED,cAAXA,EAAEjQ,OACJiQ,EAAEwS,aAAaC,QAAQ,aAAc,QACrCzS,EAAEwS,aAAaE,WAAa,GAC5B1S,EAAE9V,OAAO0C,MAAM+lB,QAAU,QAEpBhB,cAAgB3R,EAAE9V,OAAOsH,WAAU,IAG3B,YAAXwO,EAAEjQ,OACJiQ,EAAE9V,OAAO0C,MAAM+lB,QAAU,OAGpB9nB,iBAGA,uCAGImV,SACgB,UAAvBA,EAAE9V,OAAO0oB,YAEI,aAAX5S,EAAEjQ,OACJiQ,EAAEhT,iBACFgT,EAAEwS,aAAaE,WAAa,QAGf,SAAX1S,EAAEjQ,MACJiQ,EAAEhT,kBAIFmG,EAAW6M,EAAE9V,OAAQ,qCACR,aAAX8V,EAAEjQ,OACJiQ,EAAEhT,iBAEFgT,EAAEwS,aAAaE,WAAa,GAC5B1S,EAAE9V,OAAO0C,MAAMimB,WAAa,QAGf,cAAX7S,EAAEjQ,OACJiQ,EAAE9V,OAAO0C,MAAMimB,WAAa,QAGf,SAAX7S,EAAEjQ,OACJiQ,EAAEhT,iBAEFgT,EAAE9V,OAAO0C,MAAMimB,WAAa,YACvBlB,cAAc/kB,MAAM+lB,QAAU,OAE9BhB,cAAcxiB,iBAAiB,SAAS,SAAC6Q,GACxC7M,EAAW6M,EAAE9V,OAAQ,eACvB8V,EAAE9V,OAAOwG,WAAWzF,YAIxB+U,EAAE9V,OAAOqH,YAAYnH,KAAKunB,kBAKvB,SAzKkC3nB,GA6K7ConB,EAAgB7hB,SAAW,CACzB8hB,YAAY,GAIdD,EAAgBQ,YAAc,SAACkB,2GAI4BA,6FAQ3D1B,EAAgBS,oBAAsB,SAACiB,OAAUvZ,yDAAQ,EAEjDwZ,oGAEmDD,0LAGZvZ,0IAKtCwZ,OCzJHxN,EAAQ,gFAnCLC,MAAQ,qDAKRwN,EAAYC,EAAUC,GAEtB9oB,KAAKob,MAAMwN,UACTxN,MAAMwN,GAAc,SAGtBxN,MAAMwN,GAAY/Y,MAAQgZ,OAC1BzN,MAAMwN,GAAYG,UAAYD,EAEnC3N,EAAMS,QAAQxB,EAAYM,SAASD,OAAQ,CACzC/B,OAAQ,CACN3M,GAAIqO,EAAYM,SAAS3O,GACzBpG,KAAMyU,EAAYM,SAASD,OAC3BvV,KAAM,CACJ0jB,WAAAA,EACAC,SAAAA,EACAC,aAAAA,8CASC9oB,KAAKob,aApCYxB,ICPPoP,yBACPnpB,SAAUkc,yDAAO,6CACrBlc,KACDkM,GAAK7K,EAAKpB,OAAOiM,cACN7K,EAAKpB,OAAOO,aAAa,kBAAoB,YACxD4oB,UAAYhjB,MAAMuF,KAAKtK,EAAKpB,OAAOyJ,iBAAiB,8BAEpDwS,KAAOzW,OAAOC,OAAO,GAAIyjB,EAAS7jB,SAAU4W,KAE5CmN,gBAAkBhoB,EAAKpB,OAAO2e,uBAAuBvd,EAAK6a,KAAKoN,yBAAyB,GAEzFjoB,EAAK6a,KAAKqN,SAAWloB,EAAK6a,KAAKqN,QAAQ5d,KAAK9B,OAAS,IAElD2f,aAAc,IAEdld,OAASjL,EAAKpB,OAAO2e,uBAAuBvd,EAAK6a,KAAKuN,wEAMrDtpB,mBACD,UAECA,KAAK+b,aAAe/b,KAAK+b,YAAYrS,OAAS,SAC3Cwf,gBAAgB7hB,UAAY2hB,EAASO,kBAAkBvpB,KAAK+b,cAKnEZ,EAAMqO,OACJxpB,KAAK+L,GACLid,EAASS,kBAAkBzpB,KAAKkpB,gBAAiBlpB,KAAK+b,KAAKuN,eAC3DN,EAASU,cAAc1pB,KAAKkpB,kBAI1BlpB,KAAKqpB,cAGHrpB,KAAK+b,KAAKqN,QAAQO,aACfC,8CAGFlC,+BAGFC,8BAGF,YACH1hB,MAAMuF,KAAKxL,KAAKmM,QAAQ7B,SAAQ,SAACc,GAC/BA,EAAMT,aAAa,qBAAsB,WAEtCkf,yBAAyB7pB,KAAK+b,KAAK+N,yDAQrBC,uBAGdC,EAAiBC,EAAUC,EAAQle,OACpCme,EAAW9a,SAAS4a,EAAS5pB,aAAa,sBAAuB,IACjE+pB,EAAWD,EAAWD,EACtBvW,EAAQ1Q,KAAKonB,IAAID,GAAYL,EAAWI,EAAWC,EACzDH,EAAStf,aAAa,qBAAsBgJ,GAE5C3H,IARF+d,EAAWA,EAAW1a,SAAS0a,EAAU,IAAM,OAW1Cd,UAAU3e,SAAQ,SAACggB,OAChBL,EAAWK,EAAS1b,cAAcA,qBAChB0b,EAASjqB,aAAa,8BAGvC,QACHiqB,EAASvlB,iBAAiB,SAAS,SAACpC,GAClCqnB,EAAiBC,GAAW,EAAG/a,EAAKzO,cACpCkC,EAAMC,8BAIL,OACH0nB,EAASvlB,iBAAiB,SAAS,SAACpC,GAClCqnB,EAAiBC,EAAU,EAAG/a,EAAKzO,cACnCkC,EAAMC,oGAWV2nB,EAAc,QAEbxO,KAAKqN,QAAQ5d,KAAKlB,SAAQ,SAACyB,OACxBye,EAAOrqB,SAASohB,eAAexV,GAAI0S,uBAAuBnP,EAAKyM,KAAKoN,yBAAyB,GAAG9hB,UAEtGkjB,GAAevB,EAASyB,eAAe1e,EAAIuD,EAAKvD,GAAIye,WAIjDtB,gBAAgB7hB,UAAYkjB,OAE5Bpe,OAASnM,KAAKF,OAAO2e,uBAAuBze,KAAK+b,KAAKuN,eAE3DnO,EAAMqO,OACJxpB,KAAK+L,GACLid,EAASS,kBAAkBzpB,KAAKkpB,gBAAiBlpB,KAAK+b,KAAKuN,eAC3DN,EAASU,cAAc1pB,KAAKkpB,yEAO9BjjB,MAAMuF,KAAKxL,KAAKF,OAAO2e,uBAAuBze,KAAK+b,KAAKuN,gBAAgBhf,SAAQ,SAACc,GAC/EA,EAAMrG,iBAAiB,QAASwQ,EAAKmV,cAAchqB,KAAK6U,IAAO,kEAMjE4F,EAAMjK,GAAGkJ,EAAYM,SAASD,QAAQ,SAAC9X,EAAOiD,OAEtC8S,EAAS9S,EAAQ8S,OACjBxT,EAAOU,EAAQ8S,OAAOxT,YAEpBwT,EAAO/S,WAERyU,EAAYM,SAASD,OAGpB1E,EAAKgG,KAAKqN,QAAQ5d,KAAKzH,QAAQmB,EAAK0jB,aAAe,IACrD7S,EAAK6T,yCAGL7T,EAAK4R,+DAcD/R,GAEG,UAAXA,EAAEjQ,OAEJiD,EAAcgN,EAAEiD,cAAe,YAE/BsC,EAAMqO,OACJxpB,KAAK+L,GACLid,EAASS,kBAAkBzpB,KAAKkpB,gBAAiBlpB,KAAK+b,KAAKuN,eAC3DN,EAASU,cAAc1pB,KAAKkpB,uBAGzBzoB,uBA1K2Bb,GAkLtCopB,EAAS2B,uBAAyB,SAAAvf,SAAU,OACnCA,EAAMlC,UACb6C,GAAIX,EAAM/K,aAAa,MACvBsP,KAAMvE,EAAMO,YAGdqd,EAASU,cAAgB,SAAAR,UAAmBA,EAAgB7hB,WAE5D2hB,EAASS,kBAAoB,SAACP,EAAiB0B,OACvCze,EAAS+c,EAAgBzK,uBAAuBmM,GAChDC,EAAa,UAEnB5kB,MAAMuF,KAAKW,GAAQ7B,SAAQ,SAACc,GAC1Byf,EAAWxZ,KAAK2X,EAAS2B,uBAAuBvf,OAI3Cyf,GAIT7B,EAAS8B,uBAAyB,SAAC/kB,OAE3BglB,EAAS5qB,SAAS+G,cAAc,cACtC6jB,EAAOpgB,aAAa,QAAS5E,SAC7BglB,EAAOpgB,aAAa,KAAM5E,EAAKgG,IAC/Bgf,EAAO1jB,UAAYtB,EAAK4J,KAEjB9I,EAAUkkB,IAInB/B,EAASO,kBAAoB,SAAC1Z,OAExBmb,EAAc,UAElBnb,EAAMvF,SAAQ,SAACvE,GAEbilB,GAAehC,EAAS8B,uBAAuB/kB,MAI1CilB,GAKThC,EAASyB,eAAiB,SAACQ,EAAOC,EAAOnC,OAEjCoC,EAAY,IAAIphB,OAAOkhB,EAAO,YAE7BlC,EAAUjf,QAAQqhB,EAAWD,IAItClC,EAAS7jB,SAAW,CAClBgkB,wBAAyB,2BACzBG,cAAe,qBC3OI8B,wBACPviB,OAASkT,yDAAO,kBAErBlc,SAAWgJ,OACXkD,GAAK/L,KAAKH,SAASQ,aAAa,WAEhC0b,KAAOzW,OAAOC,OAAO,GAAI6lB,EAAsBjmB,SAAU4W,QAEzDsP,aAAepf,KAAKC,MAAMlM,KAAKH,SAASQ,aAAaL,KAAK+b,KAAKuP,uCAC/DpC,gBAAkBlpB,KAAKH,SAAS4e,uBAAuBze,KAAK+b,KAAKoN,yBAAyB,iDAM1FzB,qFAOLvM,EAAMjK,GAAGkJ,EAAYC,OAAOI,QAAQ,SAAC9X,EAAOiD,GAE3BA,EAAQ8S,WAEjB8C,EADO5V,EAAQ8S,OAAOxT,KACFsW,gBAEtBta,EAAKmqB,aAAatnB,QAAQyX,EAAazU,UAAY,EAAG,KAElDsU,EAAOF,EAAMoQ,UAAU,CAACvP,IAAK,UAAWrI,MAAOzS,EAAKmqB,eAEtDG,EAAU,GAEdnQ,EAAK/Q,SAAQ,SAACoY,GAEZ8I,GAAW3kB,EAAW6b,EAAIA,QAI5BxhB,EAAKgoB,gBAAgB7hB,UAAYmkB,eAgBzCJ,EAAsBjmB,SAAW,CAC/BgkB,wBAAyB,kCACzBmC,gCAAiC,yCC1DdG,yBAEP1f,EAAIlD,EAASkT,mDACjBlT,KAEDkD,GAAKA,IAELgQ,KAAOzW,OAAOC,OAAO,GAAIkmB,EAAStmB,SAAU4W,KAE5C2P,WAAaxqB,EAAKpB,OAAO2e,uBAAuBvd,EAAK6a,KAAK4P,aAC1Dle,MAAQ,CACXC,eAAgB,EAChBC,OAAQ,GACRie,UAAW,IAIT1qB,EAAK6a,KAAK8P,gBACPpe,MAAME,OAASzM,EAAK6a,KAAK8P,YAAYje,KAAI,SAAA5B,UAAYA,EAAS6B,iEAMhE8Z,2EAKL1hB,MAAMuF,KAAKxL,KAAK0rB,YAAYphB,SAAQ,SAACwhB,EAAWC,GAE9C7c,EAAKzB,MAAMme,UAAUva,KAAK,CAAE2a,UAAU,QAEhCC,EAAgB5c,SAASyc,EAAUzrB,aAAa,sBAAuB,IACvE6rB,EAAWjmB,MAAMuF,KAAKsgB,EAAUrN,uBAAuBvP,EAAK6M,KAAKoQ,cAEvED,EAAS5hB,SAAQ,SAAC8hB,EAASC,GACzBD,EAAQrnB,iBAAiB,SAAS,eAC1BunB,EAAiBF,MAGnBE,EAAe3rB,UAAUC,SAAS,gBAKtCsrB,EAAS5hB,SAAQ,SAAAiiB,UAAgBvjB,EAAcujB,EAAcrd,EAAK6M,KAAKwG,kBAEvE3Z,EAAc0jB,EAAgBpd,EAAK6M,KAAKwG,eAGpCrT,EAAK6M,KAAK8P,YAAa,OACrBQ,IAAgBJ,EAClB/c,EAAKzB,MAAMC,gBAAkB,EACU,IAA9BwB,EAAKzB,MAAMC,iBAAyE,IAAjDwB,EAAKzB,MAAMme,UAAUG,GAAeC,WAChF9c,EAAKzB,MAAMC,gBAAkB,OAGzB6B,EAAiBL,EAAK6M,KAAK8P,YAAYrc,MAAK,SAAAxD,UAAYA,EAASyD,SAASC,SAASR,EAAKzB,MAAMC,sBAGpGwB,EAAK5O,gBAAgBK,WAAUE,iBAAUqO,EAAKzB,MAAME,SACpDuB,EAAK5O,gBAAgBK,UAAUG,IAAIyO,EAAe1B,OAClDqB,EAAK1O,oBAAoBmL,UAAY4D,EAAeI,KAItDT,EAAKzB,MAAMme,UAAUG,GAAeC,UAAW,OAGmBtf,IAA9DwC,EAAKzB,MAAMme,UAAUpc,MAAK,SAAAgd,UAAaA,EAASR,aAClD9c,EAAKzO,mBAGN,gBA1E2Bb,GAgFtC6rB,EAAStmB,SAAW,CAClBwmB,UAAW,iBACXQ,YAAa,SACb5J,cAAe,gBCpFIkK,yBAEP5sB,EAAUkc,mDACdlc,KAEDkM,GAAK7K,EAAKpB,OAAOiM,KACjBgQ,KAAOzW,OAAOC,OAAO,GAAIknB,EAAatnB,SAAU4W,KAEhDmL,SAAW,IAEXwF,iBAAmBxrB,EAAKpB,OAAO2e,uBAAuB,cAAc,KAEpEkO,aAAezrB,EAAK6a,KAAK7W,OAEzBuI,MAAQ,CACXmf,gBAAiB,EACjBC,eAAgB,EAChBC,MAAO,sDAMwB,UAA7B9sB,KAAK2sB,aAAalQ,aACfiL,qFAUPjF,EAAYvR,GAAGlR,KAAK2sB,aAAaI,UAAUrX,KAAK,MAAM,SAAC/S,EAAOiD,OACtD8S,EAAS9S,EAAQ8S,OACjBxT,EAAOU,EAAQV,YAEbwT,EAAO/S,WAERyU,EAAYzX,GAAOqY,IACtB9L,EAAKwd,iBAAiB3E,mBAAmB,YAAa0E,EAAajF,YAAYtiB,QAEzE8nB,EAAW9d,EAAKwd,iBAAiBnjB,iBAAiB,cAGlD0jB,EAFWD,EAASA,EAAStjB,OAAS,GAEfH,iBAAiB,UAE9C2F,EAAKzB,MAAMmf,iBAAmBK,EAAYvjB,OAE1CzD,MAAMuF,KAAKyhB,GAAa3iB,SAAQ,SAAC4iB,GAC/Bhe,EAAKzB,MAAMqf,MAAMzb,KAAK,CAAE2a,UAAU,QAC5BmB,EAAaje,EAAKzB,MAAMqf,MAAMpjB,OAAS,EAE7CwjB,EAAQnoB,iBAAiB,UAAU,YACa,IAA1CmK,EAAKzB,MAAMqf,MAAMK,GAAYnB,WAC/B9c,EAAKzB,MAAMof,gBAAkB,EAC7B3d,EAAKzB,MAAMqf,MAAMK,GAAYnB,UAAW,GAEtC9c,EAAKzB,MAAMmf,kBAAoB1d,EAAKzB,MAAMof,gBAE5C3d,EAAKzO,gCAMR2Z,EAAYzX,GAAOsY,WAChBmS,EAAOjtB,SAASohB,yBAAkBrc,EAAK6G,cAC7CrF,EAAS0mB,GACTle,EAAKzB,MAAMmf,iBAAmBQ,EAAK7jB,iBAAiB,UAAUG,OAC9DwF,EAAKzB,MAAMof,gBAAkBO,EAAK7jB,iBAAiB,UAAUG,OAEzDwF,EAAKzB,MAAMmf,iBAAmB1d,EAAKzB,MAAMof,gBAE3C3d,EAAKzO,0BA3EyBb,GAuF1C6sB,EAAatnB,SAAW,GAIxBsnB,EAAajF,YAAc,SAACtiB,oDAEKA,EAAK6G,gDACZ7G,EAAKyd,QAAQ0K,iDACbnoB,EAAKyd,QAAQ2K,uEAEjBpoB,EAAK6G,waAYL7G,EAAK6G,kVChFNwhB,yBACP1tB,mDACJA,KAEDC,OAAOiF,iBAAiB,SAAS,SAACpC,KAChC6qB,iBAAiB1e,IAAMI,EAAKpP,OAAOkP,mBAAmBF,MACtD2e,YAAY9sB,UAAU+sB,OAAO,YAE7BjtB,eAELkC,EAAMC,iBACND,EAAM+I,qBACL,6CA1CO7L,mDACJA,KAED4tB,YAActtB,SAASI,cAAc,gCACrCitB,iBAAmBtsB,EAAKusB,YAAYltB,cAAc,+BAElD2B,OAAS,KACTyrB,MAAQ,KAERzrB,OAAOE,MAAQF,OAAO0rB,aACtB1rB,OAAOG,OAASH,OAAO2rB,cACvB3rB,OAAO4rB,MAAQ5sB,EAAKgB,OAAOE,MAAQlB,EAAKgB,OAAOG,SAE/CmrB,iBAAiBO,OAAS,aACxBJ,MAAMvrB,MAAQlB,EAAKssB,iBAAiBQ,eACpCL,MAAMtrB,OAASnB,EAAKssB,iBAAiBS,gBACrCN,MAAMG,MAAQ5sB,EAAKysB,MAAMvrB,MAAQlB,EAAKysB,MAAMtrB,OAE7CnB,EAAKysB,MAAMG,OAAS5sB,EAAKgB,OAAO4rB,SAC7BN,iBAAiBhrB,MAAMJ,MAAQ,SAC/BorB,iBAAiBhrB,MAAMH,OAAS,WAEhCmrB,iBAAiBhrB,MAAMJ,MAAQ,SAC/BorB,iBAAiBhrB,MAAMH,iBAAYnB,EAAKgB,OAAOG,kCAxBnCzC,ICAJsuB,yBACPruB,mDACJA,KACDsuB,WAAajtB,EAAKnB,OAAOwJ,iBAAiB,4BAC1C6kB,SAAWltB,EAAKpB,OAAOkP,mBAAmBzO,cAAc,6BACxD8tB,SAAWntB,EAAKktB,SAASxf,gBAEzB5C,SAAWC,KAAKC,MAAMhL,EAAKpB,OAAOO,aAAa,oBAE/CiuB,eAAiB,CACpBhrB,IAAK+L,SAAmD,MAA1CnO,EAAKpB,OAAOO,aAAa,aAAuB,EAAIa,EAAKpB,OAAOO,aAAa,aAAc,IACzGkuB,IAAK,KACLlrB,IAAKgM,SAASnO,EAAKpB,OAAOO,aAAa,aAAe,EAAG,OAEtDiuB,eAAeC,IAAMtrB,KAAK8H,OAAO7J,EAAKotB,eAAejrB,IAAMnC,EAAKotB,eAAehrB,KAAO,EAAIpC,EAAKotB,eAAehrB,OAE9GmK,MAAQ,CACXC,eAAgB,EAChBC,OAAQ,CACN,YACA,eACA,eAEFie,UAAW,MAGR4C,UAAY,KACZC,QAAUvtB,EAAKpB,OAAO6T,OAASzS,EAAKpB,OAAO6T,MAAMjK,OAAS,IAC1DglB,SAAU,EAEXxtB,EAAKutB,WACFE,yBAGFta,kBAAkBC,SAEhBE,YAActT,EAAKpB,OAAOO,aAAa,yBACvCuuB,qBAAuB1tB,EAAKsT,YAActT,EAAKsT,YAAYhL,MAAM,KAAO,KAGxEqlB,cACAlgB,+FAIcjF,yDAAS1J,KAAKF,OAAO6T,MAAMjK,eAC3C2kB,SAAS1tB,WAAUE,iBAAUb,KAAKyN,MAAME,SACzCjE,EAAS1J,KAAKsuB,eAAehrB,IAAKtD,KAAKquB,SAAS1tB,UAAUG,IAAId,KAAKyN,MAAME,OAAO,IAC3EjE,GAAU1J,KAAKsuB,eAAeC,IAAKvuB,KAAKquB,SAAS1tB,UAAUG,IAAId,KAAKyN,MAAME,OAAO,IACjFjE,EAAS1J,KAAKsuB,eAAeC,KAAKvuB,KAAKquB,SAAS1tB,UAAUG,IAAId,KAAKyN,MAAME,OAAO,SAEpFygB,SAASziB,UAAYjC,OACrB5J,OAAOa,UAAUG,IAAI,WAAYd,KAAK0uB,cACtCA,SAAU,iDAGFhlB,yDAAS1J,KAAKF,OAAO6T,MAAMjK,kBACnCpJ,gBAAgBK,WAAUE,iBAAUb,KAAKyN,MAAME,SAChDjE,EAAS1J,KAAKsuB,eAAehrB,SAC1BhD,gBAAgBK,UAAUG,IAAId,KAAKyN,MAAME,OAAO,SAChDnN,oBAAoBmL,UAAY3L,KAAKgM,SAAS8iB,SAC9C,CAEDplB,GAAU1J,KAAKsuB,eAAeC,UAC3BjuB,gBAAgBK,UAAUG,IAAId,KAAKyN,MAAME,OAAO,SAChDnN,oBAAoBmL,UAAY3L,KAAKgM,gBAEnCtC,EAAS1J,KAAKsuB,eAAeC,WAC/BjuB,gBAAgBK,UAAUG,IAAId,KAAKyN,MAAME,OAAO,SAChDnN,oBAAoBmL,UAAY3L,KAAKgM,SAAS+iB,SAGhDjvB,OAAO6K,aAAa,uBAAwB,eAE3CqkB,EAAe/oB,MAAMuF,KAAKxL,KAAKmuB,YAAY3e,MAAK,SAACyf,SAAkE,YAAnDA,EAAU5uB,aAAa,gCAExEqM,IAAjBsiB,QAEGvuB,4EAOJX,OAAOiF,iBAAiB,QAAQ,SAACpC,MACpCuM,EAAKyf,yBAEDhsB,EAAM7C,OAAO6T,QAAUzE,EAAKsf,UAAW,KACnCU,EAA+B,KAAnBhgB,EAAKsf,UAAoB,SAAW,SACtDtf,EAAKsf,UAAY7rB,EAAM7C,OAAO6T,MAG9BjO,EAAgBvF,SAAU,cAAe,GAAI,CAC3CwP,KAAM,CACJ5D,GAAIpJ,EAAM7C,OAAOiM,GACjByF,KAAM0d,EACNvf,KAAMhN,EAAM7C,OAAO6T,SAKvBzE,EAAK0f,qBAAuB,YAK3B9uB,OAAOiF,iBAAiB,SAAS,SAACpC,GACrCA,EAAM+I,sBAEAyjB,EAAcjgB,EAAKpP,OAAO6T,MAAMjK,OACtCwF,EAAKyf,uBAAuBQ,GAC5BjgB,EAAKkgB,eAAeD,qDAKlBnvB,KAAK4uB,qBAAqB,IAE5BzuB,SAAS4E,iBAAiB,eAAe,SAAC6Q,MACpCtG,EAAKsf,qBAAqBlf,SAASkG,EAAEnQ,OAAOkK,KAAK5D,IAAK,KAElDmjB,EAAkC,KAAtB5f,EAAKxP,OAAO6T,MAAgB,SAAW,gBACjDiC,EAAEnQ,OAAOkK,KAAK6B,UACf,aACA,SAEuB,KAAtBlC,EAAKxP,OAAO6T,QAAcrE,EAAKxP,OAAO6T,OAAS,MAGV,IAArCrE,EAAKsf,qBAAqBllB,OAC5B4F,EAAKxP,OAAO6T,MAAQiC,EAAEnQ,OAAOkK,KAAKA,KAElCL,EAAKxP,OAAO6T,iBAAYiC,EAAEnQ,OAAOkK,KAAKA,WAIxCjK,EAAgBvF,SAAU,cAAe,GAAI,CAC3CwP,KAAM,CACJ5D,GAAIuD,EAAKxP,OAAOiM,GAChByF,KAAM0d,EACNvf,KAAML,EAAKxP,OAAO6T,SAKtBrE,EAAKkf,UAAYlf,EAAKxP,OAAO6T,MAE7BrE,EAAKqf,uCAGL/kB,QAAQC,IAAI,iDAvJYjK,GCDjByvB,yBAEPxvB,mDACJA,KAEDyL,YAAcpK,EAAKpB,OAAOS,cAAc,2BACxC+uB,UAAYpuB,EAAKpB,OAAOS,cAAc,uBACtCgvB,UAAYruB,EAAKpB,OAAOS,cAAc,4BACtCivB,eAAiBtuB,EAAKpB,OAAOS,cAAc,gCAE3CkvB,WAAaC,WAAWC,OAAO,CAClCpoB,UAAWrG,EAAKouB,UAChBM,UAAW,UACXC,cAAe,UACfxtB,OAAQ,GACRytB,YAAY,EACZC,SAAU,MAEPN,WAAWO,KAAK9uB,EAAKouB,UAAUW,QAAQnhB,OAEvCohB,iFAIAT,WAAWve,GAAG,SAAS,WAC1BhC,EAAKqgB,UAAU9O,YAAc,WACvB3V,EAAWoE,EAAKugB,WAAWU,cAC3BnlB,EAAU/H,KAAK8H,MAAOD,EAAW,KAAQ,IACzCD,EAAU,YAAM5H,KAAK8H,MAAMD,EAAW,KAAOI,OAAO,GAC1DgE,EAAKsgB,eAAe/O,sBAAiBzV,cAAWH,GAEhDqE,EAAKkhB,2FAKFX,WAAWve,GAAG,gBAAgB,SAACmf,OAC5BrlB,EAAU/H,KAAK8H,MAAOslB,EAAO,KAAQ,IACrCxlB,EAAU,YAAM5H,KAAK8H,MAAMslB,EAAO,KAAOnlB,OAAO,GACtDoE,EAAKigB,UAAU9O,sBAAiBzV,cAAWH,WAGxC4kB,WAAWve,GAAG,UAAU,WAC3B5B,EAAKhE,YAAYX,aAAa,sBAAuB,kBAGlDW,YAAYvG,iBAAiB,SAAS,WACzCuK,EAAKmgB,WAAWa,YAE6C,WAAzDhhB,EAAKhE,YAAYjL,aAAa,uBAChCiP,EAAKhE,YAAYX,aAAa,sBAAuB,WAErD2E,EAAKhE,YAAYX,aAAa,sBAAuB,UAGvD2E,EAAK7O,sBAID8vB,EAAcpwB,SAASoJ,iBAAiB,qBAC9CtD,MAAMuF,KAAK+kB,GAAajmB,SAAQ,SAACkmB,GAC/BA,EAAWzrB,iBAAiB,SAAS,WAC0B,YAAzDuK,EAAKhE,YAAYjL,aAAa,yBAChCiP,EAAKmgB,WAAWa,YAChBhhB,EAAKhE,YAAYX,aAAa,sBAAuB,wBAhEhB/K,GCC1B6wB,yBACP5wB,mDACJA,KAEDwL,OAASnK,EAAKpB,OAAOS,cAAc,WACnCgL,UAAYrK,EAAKpB,OAAOS,cAAc,4BACtCmwB,UAAYxvB,EAAKpB,OAAOS,cAAc,gCAEtCmwB,UAAU/kB,qBAAgBf,EAAwB1J,EAAKmK,OAAOP,WAEnEK,EAAYwD,kBAAkBzN,EAAKpB,OAAQoB,EAAKT,iCAVL0K,GCD1BwlB,0BACP9wB,mDACJA,KAED+wB,SAAW1vB,EAAKpB,OAAOyJ,iBAAiB,8BACxCsnB,MAAQ3vB,EAAKpB,OAAOyJ,iBAAiB,2BACrCunB,gBAAkB,IAElBC,iFAGGC,EAAS7hB,QACZ0hB,MAAM7wB,KAAK8wB,iBAAiBnwB,UAAUE,OAAO,eAC7C+vB,SAAS5wB,KAAK8wB,iBAAiBnwB,UAAUE,OAAO,eAEhDgwB,MAAM1hB,GAAOxO,UAAUG,IAAI,UAChCkwB,EAAQrwB,UAAUG,IAAI,eAEjBgwB,gBAAkB3hB,sEAIlByhB,SAAStmB,SAAQ,SAAC0mB,EAAS7hB,GAE9B6hB,EAAQjsB,iBAAiB,SAAS,SAACpC,GACjCuM,EAAK+hB,UAAUD,EAAS7hB,GACxBD,EAAKzO,eAELkC,EAAMC,8BA5BuBhD,GCEhBsxB,0BACPrxB,EAAUoF,mDACdpF,KAED2K,OAAStJ,EAAKpB,OAAOS,cAAc,WACnC0E,QAAUK,OAAOL,KACjBksB,OAASjwB,EAAK+D,QAAQksB,QAAU,UAChCjxB,KAAOoF,OAAOpE,EAAK+D,QAAQ/E,QAS3BuK,OAAS,OACTmB,YAAc,OACdd,SAAW,OACXsmB,SAAW,OAEXC,UAAYnwB,EAAKpB,OAAOwxB,gBACxBrI,UAAY/nB,EAAKpB,OAAOS,cAAc,4BAEtCgxB,MAAQrwB,EAAK+nB,UAAU1oB,cAAc,2BACrCixB,YAActwB,EAAKqwB,MAAMhxB,cAAc,wBACvCkxB,aAAevwB,EAAKqwB,MAAMhxB,cAAc,yBAExCmxB,MAAQxwB,EAAK+nB,UAAU1oB,cAAc,gCACrCoxB,WAAazwB,EAAKwwB,MAAMnxB,cAAc,mCACtCqxB,WAAa1wB,EAAKwwB,MAAMnxB,cAAc,mCAGtCsxB,iBAAmB3wB,EAAKmwB,UAAU1M,eAAe,MACjDmN,aAAe5wB,EAAK+nB,UAAU1oB,cAAc,4BAC5CuxB,aAAa3qB,YAAYjG,EAAK2wB,oBAG9BE,aAAe7wB,EAAKsJ,OAAOM,WAC3BknB,cAAgB9wB,EAAK+nB,UAAU1oB,cAAc,gCAC7CyxB,cAAcrmB,UAAYf,EAAwB1J,EAAK6wB,gBACvDC,cAAcrnB,aACjB,kBACGumB,EAAYe,YACb/wB,EAAK6wB,aACL7wB,EAAKhB,KAAK8K,SAAW,UACrB9J,EAAKhB,KAAK2K,SAAW,eAKpB4iB,YAAcvsB,EAAK+nB,UAAU1oB,cAChC,wBAEG2xB,uBAAyBhxB,EAAKusB,YAAYltB,cAC7C,mCAEG4xB,uBAAyBjxB,EAAKusB,YAAYltB,cAC7C,mCAIG6xB,kBAAoB,uBAAwBlxB,EAAKpB,OAClD,mBACA,6BAA8BoB,EAAKpB,OACjC,yBACA,yBAA0BoB,EAAKpB,OAC7B,qBACA,qBAEHuyB,mBAAqBnxB,EAAKpB,OAAOwyB,mBACnCpxB,EAAKpB,OAAOyyB,yBAEZrxB,EAAKpB,OAAO0yB,sBAEVC,eAAiBvxB,EAAKuxB,eAAe/xB,aACrCgyB,YAAcxxB,EAAKwxB,YAAYhyB,aAC/BiyB,aAAezxB,EAAKyxB,aAAajyB,aACjCkyB,aAAe1xB,EAAK0xB,aAAalyB,aACjCmyB,aAAe3xB,EAAK2xB,aAAanyB,aACjCoyB,YAAc5xB,EAAK4xB,YAAYpyB,aAC/BqyB,cAAgB7xB,EAAK6xB,cAAcryB,aACnCsyB,YAAc9xB,EAAK8xB,YAAYtyB,aAC/BqyB,cAAgB7xB,EAAK6xB,cAAcryB,aACnCuyB,kBAAoB/xB,EAAK+xB,kBAAkBvyB,aAC3CwyB,mBAAqBhyB,EAAKgyB,mBAAmBxyB,aAG7C8J,OAAOzF,iBAAiB,iBAAkB7D,EAAKuxB,kBAC/CjoB,OAAOzF,iBAAiB,YAAa7D,EAAKwxB,eAC1CloB,OAAOzF,iBAAiB,aAAc7D,EAAKyxB,gBAC3CnoB,OAAOzF,iBAAiB,QAAS7D,EAAK0xB,gBACtCpoB,OAAOzF,iBAAiB,OAAQ7D,EAAK0xB,gBACrCpoB,OAAOzF,iBAAiB,aAAc7D,EAAK2xB,gBAC3C5J,UAAUlkB,iBAAiB,QAAS7D,EAAK4xB,aAAa,KAEtDvB,MAAMxsB,iBAAiB,UAAW7D,EAAK6xB,iBACvCrB,MAAM3sB,iBAAiB,QAAS7D,EAAK8xB,aAAa,KAClDtB,MAAM3sB,iBAAiB,UAAW7D,EAAK6xB,iBACvCtF,YAAY1oB,iBAAiB,QAAS7D,EAAK+xB,mBAAmB,GAEnE9yB,SAAS4E,iBACP7D,EAAKkxB,kBACLlxB,EAAKgyB,oBAIPhC,EAAYiC,OAAOjyB,EAAKwwB,MAAOxwB,EAAK0wB,YAAY,SAACwB,KAC1C5oB,OAAOoB,YAAc1K,EAAK4J,SAAW7H,KAAKI,IAAI,EAAGJ,KAAKK,IAAI,EAAG8vB,MAE7DP,oBAGFH,wEAmBD1yB,KAAKyK,SAAWzK,KAAKwK,OAAOC,cACzBA,OAASzK,KAAKwK,OAAOC,YAErB8mB,MAAM5mB,aACT,aACA3K,KAAKyK,OAASzK,KAAKE,KAAKuL,MAAQ,OAASzL,KAAKE,KAAKwK,OAAS,cAEzD5K,OAAO6K,aACV,oBACA3K,KAAKyK,OAAS,SAAW,gBAEtB+mB,YAAY7mB,aAAa,eAAgB3K,KAAKyK,aAC9CgnB,aAAa9mB,aAAa,cAAe3K,KAAKyK,QAEnD4oB,cAAcrzB,KAAKoxB,UAEdpxB,KAAKyK,cAEH2mB,SAAWkC,YAAYtzB,KAAK6yB,aAAc,UAI5CroB,OAAO3E,cAAcmE,EAAYC,uDAOtCjK,KAAK4L,cAAgB5L,KAAKwK,OAAOoB,aAC9B5L,KAAK8K,WAAa9K,KAAKwK,OAAOM,SACjC,MACKc,YAAc5L,KAAKwK,OAAOoB,iBAC1Bd,SAAW9K,KAAKwK,OAAOM,UAAY,MAElCyoB,EAAwBvzB,KAAK4L,YAAc5L,KAAK8K,SAEhD0oB,EAAkB5oB,EAAwB5K,KAAK4L,aAKjD4nB,IAAoBxzB,KAAK6xB,iBAAiB4B,iBACvC5B,iBAAiB4B,UAAYD,OAE7B1B,aAAannB,aAChB,kBACGumB,EAAYe,YACbjyB,KAAK4L,YACL5L,KAAKE,KAAK8K,SAAW,UACrBhL,KAAKE,KAAK2K,SAAW,mBAiBtB6mB,MAAM/mB,aAAa,gBAAiB3K,KAAK4L,kBACzC8lB,MAAM/mB,aAAa,gBAAiB,QACpC+mB,MAAM/mB,aAAa,gBAAiB3K,KAAK8K,eAEzC6mB,WAAWnvB,MAAMJ,gBAAmC,IAAxBmxB,YAG5B/oB,OAAO3E,cAAcmE,EAAYE,wDAMnCM,OAAOya,oBAAoB,iBAAkBjlB,KAAKyyB,qBAClDjoB,OAAOzF,iBAAiB,iBAAkB/E,KAAKyyB,qBAE/CG,oBACAM,0BACAL,2DAKAA,6DAKAroB,OAAOya,oBAAoB,iBAAkBjlB,KAAK0zB,oBAGlDlpB,OAAO3E,cAAcmE,EAAYG,cAGjCnK,KAAKyK,SAAUzK,KAAKwK,OAAOmpB,eACzBnpB,OAAOiB,wDAKRmoB,EAAe5zB,KAAKF,SAAWoxB,EAAY2C,0BAE5CpG,YAAY9iB,aACf,aACAipB,EACI5zB,KAAKE,KAAK4zB,iBAAmB,oBAC7B9zB,KAAKE,KAAK6zB,iBAAmB,0BAE9B7B,uBAAuBvnB,aAAa,cAAeipB,QACnDzB,uBAAuBxnB,aAAa,eAAgBipB,uCAI/CjxB,GACVA,EAAMC,iBACND,EAAM+I,uBAEDlB,OAAOxK,KAAKwK,OAAOC,OAAS,OAAS,+CAIhC9H,GACVA,EAAM+I,kBAGD/I,EAAMqxB,aAAgBrxB,EAAM8C,aAC1BqtB,YAAYnwB,6CAKHA,cAChBA,EAAM+I,kBAEF1L,KAAKqyB,mBACHryB,KAAKF,SAAWoxB,EAAY2C,qBAE9B3C,EAAY+C,kBAAkB/hB,KAAK/R,gBAG9BkyB,mBAAmBngB,KAAKlS,KAAKF,aAG7B2tB,YAAYpa,QAGjB+F,YAAW,WACTlK,EAAKue,YAAYpa,UAChB,MAEIrT,KAAKwK,OAAO0pB,2BAEjBl0B,KAAKwK,OAAO2pB,gCAET3pB,OAAO4pB,4BAGP5pB,OAAO6pB,6BAGTnB,4DAKKvwB,OACJ8c,EAAsB9c,EAAtB8c,QAAS6U,EAAa3xB,EAAb2xB,YAGb7U,GAAW,IAAMA,GAAW,GAAI,CAClC9c,EAAMC,qBAEA2xB,EAAqB,KAAZ9U,GAA8B,KAAZA,EAAiBA,EAAU,GAAKA,EAAU,QAEtEjV,OAAOoB,YAAc3I,KAAKI,IAC7B,EACAJ,KAAKK,IACHtD,KAAKwK,OAAOM,SACZ9K,KAAKwK,OAAOoB,YAAc2oB,GAAUD,EAAW,GAAK,UAInDzB,sEA5MA1yB,SAASq0B,mBACbr0B,SAASs0B,yBAETt0B,SAASu0B,qEAILv0B,SAASw0B,gBACbx0B,SAASy0B,wBAETz0B,SAAS00B,gDAuMA/0B,EAAQg1B,EAAaC,OAuB7B7yB,EACAkQ,EACAI,EAvBEwiB,OAAkBtoB,IAAc5M,EAAOm1B,YACvCC,OAAgBxoB,IAAc5M,EAAOq1B,aACrCC,EAAcJ,EAChB,cACAE,EACE,aACA,YACAG,EAAcL,EAChB,cACAE,EACE,YACA,YACAI,EAAYN,EACd,YACAE,EACE,WACA,mBASGK,EAAc5yB,GAErBA,EAAMC,qBAGA4yB,EAXS,YAWc7yB,EACzBA,EAAK,QACJA,EAAMG,SAAWH,EAAMG,QAAQ,IAAMH,EAAMG,QAAQ,GAAd,SACjC,EAMTiyB,GAHoBS,EAAWpjB,IAAUI,EAAMJ,aAuBxC6iB,IACP/yB,EAAO+iB,oBAAoBoQ,EAAaE,GACxCrzB,EAAO+iB,oBAAoBqQ,EAAWL,GAIxCn1B,EAAOiF,iBAAiBqwB,YAvBDzyB,GAErBT,EAASpC,EAAOwxB,cAAcmE,gBAGxBroB,EAAO0nB,EAAYpyB,wBAGzB0P,EAAQhF,EAAK7J,KACbiP,EAAMpF,EAAKe,MAEXonB,EAAc5yB,GAEdT,EAAO6C,iBAAiBswB,EAAaE,GACrCrzB,EAAO6C,iBAAiBuwB,EAAWL,0CAsBpB5E,EAAMqF,EAAaC,mBAC1B1yB,KAAK8H,MAAMslB,EAAO,gBAAOqF,eAAgBzyB,KAAK8H,MACtDslB,EAAO,gBACJsF,UAzZgC/1B,GCApBg2B,0BAEP/1B,mDACJA,KAGDiM,UAAY3L,SAASI,uDAAgDW,EAAKpB,OAAOiM,YAEjFC,SAAWC,KAAKC,MAAMhL,EAAK4K,UAAUzL,aAAa,8BAClDkc,SAAWtQ,KAAKC,MAAMhL,EAAK4K,UAAUzL,aAAa,2BAElD8L,OAASjL,EAAKpB,OAAOyJ,iBAAiB,sBAEtCssB,QAAU30B,EAAKpB,OAAOyJ,iBAAiB,WACvCssB,QAAQvrB,SAAQ,SAACwrB,KACfC,sBAAsBD,KACtB9zB,mBAAmB8zB,QAGrBroB,MAAQ,CACXC,eAAgB,EAChBme,aAAa,EACble,OAAQ,GACRqoB,aAAc,GAIZ90B,EAAK8K,aACFyB,MAAMoe,aAAc,IACpBpe,MAAME,OAASzM,EAAK8K,SAAS4B,KAAI,SAAC5B,UAAaA,EAAS6B,wEAK9CioB,cACjBA,EAAO/wB,iBAAiB,UAAU,WAChCmK,EAAK2mB,QAAQvrB,SAAQ,SAAC2rB,GACpB/mB,EAAK6mB,sBAAsBE,MAE7B/mB,EAAKV,8BACJ,iDAKiBsnB,GACpBA,EAAOxvB,WAAW3F,UAAU+sB,OAAO,cAAiC,IAAnBoI,EAAOI,+EAInDzoB,MAAMC,eAAiB,EACxB1N,KAAKuc,SAAS4Z,kBACXhqB,OAAO7B,SAAQ,SAACc,EAAO+D,GACtBG,EAAKumB,QAAQ1mB,GAAO+mB,UACtB5mB,EAAK7B,MAAMuoB,cAAgB,GAEzB1mB,EAAKumB,QAAQ1mB,GAAO+mB,SAAW9qB,EAAM0C,aAAa,gCACpDwB,EAAK7B,MAAMC,gBAAkB,GAE1B4B,EAAKumB,QAAQ1mB,GAAO+mB,SAAY9qB,EAAM0C,aAAa,gCACtDwB,EAAK7B,MAAMC,gBAAkB,WAI5BvB,OAAO7B,SAAQ,SAACc,EAAO+D,GACtBG,EAAKumB,QAAQ1mB,GAAO+mB,UACtB5mB,EAAK7B,MAAMuoB,cAAgB,GAEzB1mB,EAAKumB,QAAQ1mB,GAAO+mB,SAAW9qB,EAAM0C,aAAa,gCACpDwB,EAAK7B,MAAMC,gBAAkB,MAMF,IAA5B1N,KAAKyN,MAAMuoB,eAAuBh2B,KAAKuc,SAAS6Z,SAAap2B,KAAKyN,MAAMuoB,eAAiBh2B,KAAK61B,QAAQnsB,QAAU1J,KAAKuc,SAAS6Z,aAC5HC,mBACA,IAEDr2B,KAAKyN,MAAMoe,YAAa,OACpBtc,EAAiBvP,KAAKgM,SAASwD,MAAK,SAACxD,UAAaA,EAASyD,SAASC,SAASJ,EAAK7B,MAAMC,2BACzFpN,gBAAgBK,WAAUE,iBAAUb,KAAKyN,MAAME,cAC/CrN,gBAAgBK,UAAUG,IAAIyO,EAAe1B,YAC7CrN,oBAAoBmL,UAAY4D,EAAeI,UAGjDlP,oBAGFgN,MAAMuoB,aAAe,OACrBznB,8DAICsB,EAAQ5J,MAAMuF,KAAKxL,KAAK61B,SAASjoB,KAAI,SAACkoB,SAAY,CACtDI,QAASJ,EAAOI,QAChBnqB,GAAI+pB,EAAO/pB,OAGbrG,EAAgB1F,KAAKF,OAAQ,mBAAoB,GAAI,CACnDiM,GAAI/L,KAAKF,OAAOiM,GAEhB8D,MAAAA,WAtGkCjQ,GCDnB02B,0BACPz2B,mDACJA,KAED02B,SAAWr1B,EAAKpB,OAAOwG,WAAWjG,aAAa,eAC/Cm2B,YAAct1B,EAAKq1B,SAAWr1B,EAAKq1B,SAAS/sB,MAAM,KAAO,KAEzD+K,oEAKCkiB,EAAWz2B,KAAKF,OAAOwG,WAAWjG,aAAa,wBAE7Co2B,OACD,eACEC,2BAEF,YACEC,wBAEF,QACc32B,KAAKF,OAAOyJ,iBAAiB,MAErCe,SAAQ,SAACssB,OACVC,EAAWD,EAAMv2B,aAAa,kBAC9By2B,EAAQF,EAAMv2B,aAAa,eAEjC6O,EAAK6nB,aAAaH,EAAOC,EAAUC,oBAIrCltB,QAAQC,IAAI,gDAAiD4sB,qDAKjEt2B,SAAS4E,iBAAiB,iBAAiB,SAAC6Q,OACpC1Q,EAAO0Q,EAAEnQ,OAAOkK,QAElBL,EAAKknB,YAAY9mB,SAASxK,EAAK6G,IAAK,KAClCirB,EAIEC,EADU3nB,EAAKxP,OAAOo3B,gBACCC,WAAWvjB,kBAEhC1O,EAAKsM,UACN,OACHwlB,EAAY72B,SAAS+G,cAAc,OACzByD,aAAa,QAAS,kBAEhCssB,EAAa3sB,SAAQ,SAACc,OACdgsB,EAAWj3B,SAAS+G,cAAc,MACxCkwB,EAASzsB,aAAa,QAAS,uBAEzB0sB,EAAWprB,KAAKC,MAAMd,EAAM/K,aAAa,cAG/Ci2B,EAASgB,SAASD,EAAUnyB,EAAMkyB,GAElCJ,EAAU7vB,YAAYiwB,MAGxB9nB,EAAKxP,OAAOqH,YAAY6vB,aAErB,SACe1nB,EAAKxP,OAAO8T,WACpBtJ,SAAQ,SAAC8iB,GACjBA,EAAKxZ,WAAWtJ,SAAQ,SAACssB,EAAOznB,OACxBkoB,EAAWprB,KAAKC,MAAM+qB,EAAa9nB,GAAO9O,aAAa,cAEzDi2B,EAASiB,sBAAsBX,EAAO1xB,EAAKyO,MAAO0jB,KACpDL,EAAY5J,SAKlB4J,EAAUn2B,uBAGV+I,QAAQC,IAAI,wHAOpB1J,SAAS4E,iBAAiB,iBAAiB,SAAC6Q,OACpC1Q,EAAO0Q,EAAEnQ,OAAOkK,QAElB4F,EAAKihB,YAAY9mB,SAASxK,EAAK6G,IAAK,KAChCyrB,EAAQjiB,EAAKzV,OAAO8T,kBAElB1O,EAAKsM,UACN,MACHgmB,EAAMltB,SAAQ,SAAC8iB,OACPwJ,EAAQz2B,SAAS+G,cAAc,MACrC0vB,EAAMjsB,aAAa,QAAS,uBAEtB8sB,EAAarK,EAAK+J,WAClBE,EAAWprB,KAAKC,MAAMurB,EAAWp3B,aAAa,cAGpDi2B,EAASgB,SAASD,EAAUnyB,EAAM0xB,GAElCxJ,EAAKjmB,YAAYyvB,gBAGhB,aACCc,EACJF,EAAMltB,SAAQ,SAAC8iB,OACPqK,EAAarK,EAAK+J,WAClBE,EAAWprB,KAAKC,MAAMurB,EAAWp3B,aAAa,cAEpD+sB,EAAKxZ,WAAWtJ,SAAQ,SAACssB,EAAOznB,GAC1BmnB,EAASiB,sBAAsBX,EAAO1xB,EAAKyO,MAAO0jB,KACpDK,EAAcvoB,SAKpBoG,EAAKzV,OAAO8T,WAAWtJ,SAAQ,SAAC8iB,GAC9BA,EAAKxZ,WAAW8jB,GAAa72B,0BAI/B+I,QAAQC,IAAI,4GAMT+sB,EAAOC,EAAUC,cAC5B32B,SAAS4E,iBAAiB,iBAAiB,SAAC6Q,OACpC1Q,EAAO0Q,EAAEnQ,OAAOkK,QAElBoG,EAAKygB,YAAY9mB,SAASxK,EAAK6G,KAAO7G,EAAK6G,KAAO8qB,GAAY3xB,EAAK6B,UAAY+vB,EAAO,KAClFO,EAAWprB,KAAKC,MAAM6J,EAAK4hB,cAAcf,WAEvC1xB,EAAKsM,UACN,UACGomB,EAAOz3B,SAAS+G,cAAc,OACpCovB,EAASgB,SAASD,EAAUnyB,EAAM0xB,GAElCA,EAAMzvB,YAAYywB,aAEf,SACWhB,EAAMrtB,iBAAiB,OAC/Be,SAAQ,SAACutB,GACTvB,EAASiB,sBAAsBM,EAAM3yB,EAAKyO,MAAO0jB,IACnDQ,EAAKh3B,0BAKT+I,QAAQC,IAAI,2GA2DR+sB,OACNkB,EAAUlB,EAAMtwB,WAAW6wB,WAAW92B,aAAa,gBACrDy3B,EAAS,OAAOA,MAGdjB,EAAWD,EAAMv2B,aAAa,kBAC9B03B,EAAgB/3B,KAAKF,OAAOwG,WAAW/F,0CAAmCs2B,eAC5EkB,EAAsBA,EAAc13B,aAAa,aAE9C,2CA9DOg3B,EAAUnyB,EAAMqO,OAC1BykB,SAEIX,EAASrzB,UACV,WACHg0B,EAAa73B,SAAS+G,cAAc,OACd,SAAlBmwB,EAAS1xB,KACXqyB,EAAW3wB,UAAYnC,EAAKyO,MAAM8M,YACP,QAAlB4W,EAAS1xB,MAClBqyB,EAAW7wB,YAAYjC,EAAKyO,iBAG3B,SACHqkB,EAAa73B,SAAS+G,cAAcmwB,EAASrzB,MAC7CqzB,EAASpyB,QAAQqF,SAAQ,SAACqJ,OAClBskB,EAAU93B,SAAS+G,cAAc,UACvC+wB,EAAQ5wB,UAAYsM,EACpBqkB,EAAW7wB,YAAY8wB,gBAGtB,SACHD,EAAa73B,SAAS+G,cAAcmwB,EAASrzB,OAClC2G,aAAa,QAAS,0BACjCrF,OAAOqX,KAAK0a,EAASa,YAAY5tB,SAAQ,SAAC0R,GACxCgc,EAAWrtB,aAAaqR,EAAKqb,EAASa,WAAWlc,qBAInDgc,EAAa73B,SAAS+G,cAAc,OAMhChC,EAAKyd,QAAQ0U,EAASrzB,MACxBg0B,EAAW3wB,UAAYnC,EAAKyd,QAAQ0U,EAASrzB,OAE7Cg0B,EAAW3wB,UAAY,IACvBuC,QAAQC,IAAI,0CAA2CwtB,IAG7D9jB,EAAMpM,YAAY6wB,iDAISG,EAAKC,EAAgBf,OAC5CgB,QACkB,aAAlBhB,EAASrzB,OACXq0B,EAASF,EAAI1X,cAAgB2X,EAAe3X,aAEvC4X,SApN2Bz4B,GCCtCO,SAAS4E,iBAAiB,oBCHA,WACxB6E,QAAQC,IAAI,yBDEmD,GAGjE3H,OAAO6C,iBAAiB,QEiBK,WAC3B6E,QAAQC,IAAI,6BAGNyuB,EAAgBryB,MAAMuF,KAC1BrL,SAASoJ,iBAAiB,wBAExB+uB,EAAc5uB,OAAS,IACzB4uB,EAAchuB,SAAQ,SAACiuB,GAED,IAAIrH,GAAYqH,MAGtCp4B,SAAS4E,iBAAiB,gBAAgB,WACxCqF,EAAwBkuB,WAKtBE,EAAsBvyB,MAAMuF,KAChCrL,SAASoJ,iBAAiB,iCAExBivB,EAAoB9uB,OAAS,GAC/B8uB,EAAoBluB,SAAQ,SAACmuB,GACD,IAAIpJ,EAAkBoJ,UAU9CC,EAAsBzyB,MAAMuF,KAAKrL,SAASoJ,iBAC9C,iCAEEmvB,EAAoBhvB,OAAS,IAC/BgvB,EAAoBpuB,SAAQ,SAACquB,GACD,IAAIlI,EAAkBkI,MAGlDx4B,SAAS4E,iBAAiB,gBAAgB,WACxCqF,EAAwBsuB,WAKtBE,EAAqBz4B,SAASoJ,iBAClC,8BAEEqvB,EAAmBlvB,OAAS,GAC9BzD,MAAMuF,KAAKotB,GAAoBtuB,SAAQ,SAACuuB,GACb,IAAItL,EAAiBsL,UAK5CC,EAAmB34B,SAASoJ,iBAAiB,yBAC/CuvB,EAAiBpvB,OAAS,MACvB,IAAID,EAAI,EAAGA,EAAIqvB,EAAiBpvB,OAAQD,GAAK,EACxB,IAAI1I,EAAgB+3B,EAAiBrvB,QAK3DsvB,EAAY54B,SAASoJ,iBAAiB,+BACxCwvB,EAAUrvB,OAAS,MAChB,IAAID,EAAI,EAAGA,EAAIsvB,EAAUrvB,OAAQD,GAAK,EACzB,IAAIknB,GAAQoI,EAAUtvB,QAUpC0kB,EAAahuB,SAASoJ,iBAAiB,6BACzC4kB,EAAWzkB,OAAS,GACtBzD,MAAMuF,KAAK2iB,GAAY7jB,SAAQ,SAAC2kB,GACb,IAAIf,EAASe,UAO5BnY,EAAQ3W,SAASoJ,iBAAiB,wBACpCuN,EAAMpN,OAAS,EAAG,KAEW,IAA3B2K,kBAAkBC,KAAe,KAE7BtB,EAAc7S,SAASI,cAAc,yBACvCyS,EACiB,IAAI6D,EAAc7D,EAAa8D,GAKtD7Q,MAAMuF,KAAKsL,GAAOxM,SAAQ,SAACgG,GACb,IAAImC,EAAInC,UAIO,IAA3B+D,kBAAkBC,KAAe,KAG7B0kB,EAAW74B,SAASoJ,iBAAiB,iBACvCyvB,EAAStvB,OAAS,GACpBzD,MAAMuF,KAAKwtB,GAAU1uB,SAAQ,SAACgS,GACb,IAAID,EAAOC,UAKxB2c,EAAa94B,SAASoJ,iBAAiB,2BACzC0vB,EAAWvvB,OAAS,GACtBzD,MAAMuF,KAAKytB,GAAY3uB,SAAQ,SAAC4uB,OACxB3c,EAAWpc,SAASI,sDACS24B,EAAU74B,aACzC,4BAIa,IAAIorB,EACnByN,EAAU74B,aAAa,qBACvB64B,EACAjtB,KAAKC,MAAMqQ,EAASlc,aAAa,0BAE1BkU,cAKP4kB,EAAoBh5B,SAASoJ,iBACjC,kCAGE4vB,EAAkBzvB,OAAS,GAC7BzD,MAAMuF,KAAK2tB,GAAmB7uB,SAAQ,SAAC8uB,OAC/B7c,EAAWpc,SAASI,6DACgB64B,EAAiB/4B,aACvD,mCAGoB,IAAI2mB,EAC1BoS,EAAiB/4B,aAAa,4BAC9B+4B,EACAntB,KAAKC,MAAMqQ,EAASlc,aAAa,0BAEnBkU,cAKd8kB,EAAiBl5B,SAASoJ,iBAC9B,+BAEE8vB,EAAe3vB,OAAS,GAC1BzD,MAAMuF,KAAK6tB,GAAgB/uB,SAAQ,SAACgvB,OAC5B/c,EAAWpc,SAASI,0DACa+4B,EAAcvtB,UAEhC,IAAI0gB,EACvB6M,EACArtB,KAAKC,MAAMqQ,EAASlc,aAAa,0BAEtBkU,cAKXglB,EAAap5B,SAASoJ,iBAAiB,oBACzCgwB,EAAW7vB,OAAS,GACtBzD,MAAMuF,KAAK+tB,GAAYjvB,SAAQ,SAACkvB,GACb,IAAIlD,GAASkD,UAK5BC,EAAat5B,SAASoJ,iBAAiB,0BACzCkwB,EAAW/vB,OAAS,GACtBzD,MAAMuF,KAAKiuB,GAAYnvB,SAAQ,SAACovB,GACb,IAAI7tB,EAAS6tB,UAK5BC,EAAex5B,SAASoJ,iBAAiB,4BAC3CowB,EAAajwB,OAAS,GACxBzD,MAAMuF,KAAKmuB,GAAcrvB,SAAQ,SAACsvB,GACb,IAAIhE,GAAWgE,UAKhCC,EAAY15B,SAASoJ,iBAAiB,mBACxCswB,EAAUnwB,OAAS,GACrBzD,MAAMuF,KAAKquB,GAAWvvB,SAAQ,SAAC2f,OACvB1N,EAAW0N,EAASnc,aAAa,wBACnCmc,EAAS5pB,aAAa,wBACtB,GACa,IAAI2oB,EAASiB,EAAUhe,KAAKC,MAAMqQ,IAC1ChI,cAKPulB,EAA0B35B,SAASoJ,iBACvC,4BAEEuwB,EAAwBpwB,OAAS,GACnCzD,MAAMuF,KAAKsuB,GAAyBxvB,SAAQ,SAACvE,GACb,IAAIqlB,EAAsBrlB,GAClCwO,cFzOwB"}