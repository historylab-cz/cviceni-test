{"version":3,"file":"components.build.js","sources":["../../../../src/js/components/dom-load.js","../../../../src/js/components/component.js","../../../../src/js/components/magnifying-glass.js","../../../../src/js/lib/utils.js","../../../../src/js/components/media/media.js","../../../../src/js/components/media/audio-player.js","../../../../src/js/components/svg-lib/svg-dragndrop.js","../../../../src/js/components/svg-lib/svg-draw.js","../../../../src/js/components/svg-lib/svg-text.js","../../../../src/js/components/svg.js","../../../../src/js/components/sortable.js","../../../../src/js/components/svg-lib/svg-radial-menu.js","../../../../src/js/components/editor/editor.js","../../../../src/js/components/keywords.js","../../../../src/js/components/test-quiz.js","../../../../src/js/components/fullscreen.js","../../../../src/js/components/user-text.js","../../../../src/js/components/media/audio-player-normal.js","../../../../src/js/components/media/audio-player-simple.js","../../../../src/js/components/fake-map.js","../../../../src/js/components/media/video.js","../../../../src/js/components/selectable.js","../../../../src/js/components/new-table.js","../../../../src/js/components/draggable.js","../../../../src/js/components/window-load.js","../../../../src/js/components/components.js","../../../../src/js/lib/unsupported-browsers.js"],"sourcesContent":["\nconst domLoadComponents = () => {\n  console.log('domLoad:components');\n\n  // instantiate\n\n  // run\n\n};\n\nexport default domLoadComponents;\n","export default class Component {\n  constructor($element) {\n    this.target = $element;\n    this.$slide = this.target.closest('.slide');\n    this.lang = document.documentElement.getAttribute('lang');\n\n    if (!HISTORYLAB.import.done) {\n\n      if (this.$slide) {\n        this.$buttonFeedback = this.$slide.querySelector('[data-feedback-button]');\n\n        if (this.$buttonFeedback) {\n          this.$buttonFeedbackText = this.$buttonFeedback.querySelector('span');\n        }\n      }\n\n\n      this.showFeedback = this.showFeedback.bind(this);\n    }\n  }\n\n  showFeedback() {\n    if (this.$buttonFeedback && this.$buttonFeedback.classList.contains('button-hidden')) {\n      this.$buttonFeedback.classList.remove('button-hidden');\n    }\n  }\n\n  hideFeedback() {\n    this.$buttonFeedback.classList.add('button-hidden');\n  }\n}\n","import Component from './component';\n\nexport default class MagnifyingGlass extends Component {\n  // https://www.youtube.com/watch?v=e8IwM3iqnL0\n  constructor($element) {\n    super($element);\n    // SVG lupa a ještě dynamicky měnícího se SVG,\n    // který není na počátku známé?\n    // if (el.nodeName === 'svg') {\n    //   console.log('SVG');\n    //   el.children[0].getAttribute('xlink:href')\n    // }\n    this.$element = document.querySelector('[data-lupa]');\n    this.$canvas = document.querySelector('[data-lupa-canvas]');\n    this.ctx = this.$canvas.getContext('2d');\n\n    this._onStart = this._onStart.bind(this);\n    this._onMove = this._onMove.bind(this);\n    this._onEnd = this._onEnd.bind(this);\n    this._update = this._update.bind(this);\n    this._onResize = this._onResize.bind(this);\n\n    this.zoomGlassSize = 230;\n    this.targetBCR = null;\n    this.zoomed = 0;\n    this.targetZoomed = 0;\n\n    this.x = 0;\n    this.y = 0;\n    this.trackingTouch = false;\n\n    this._addEventListeners();\n    this._initCanvas();\n    this._onResize();\n\n    window.requestAnimationFrame(this._update);\n  }\n\n  _initCanvas() {\n    const width = this.zoomGlassSize;\n    const height = this.zoomGlassSize;\n    // if retina makes canvas more dense\n    const dPR = window.devicePixelRation || 1;\n    this.$canvas.width = width * dPR;\n    this.$canvas.height = height * dPR;\n\n    this.$canvas.style.width = `${width}px`;\n    this.$canvas.style.height = `${height}px`;\n\n    this.ctx.scale(dPR, dPR);\n  }\n\n  _onResize() {\n    this.targetBCR = this.target.getBoundingClientRect();\n  }\n\n  _onStart(event) {\n    if (event.target !== this.target) {\n      return;\n    }\n\n    event.preventDefault();\n\n\n    this.x = event.pageX || event.touches[0].pageX;\n    this.y = event.pageY || event.touches[0].pageY;\n\n    this.trackingTouch = true;\n    this.targetZoomed = 1;\n    this.zoomed = 0;\n\n    window.requestAnimationFrame(this._update);\n  }\n\n  _onMove(event) {\n    if (!this.trackingTouch) {\n      return;\n    }\n\n    this.x = event.pageX || event.touches[0].pageX;\n    this.y = event.pageY || event.touches[0].pageY;\n  }\n\n  _onEnd() {\n    if (this.targetZoomed) {\n      // show OK button or feedback\n      this.showFeedback();\n    }\n\n    this.targetZoomed = 0;\n    this.trackingTouch = false;\n  }\n\n  _update() {\n    const TAU = Math.PI * 2;\n    const MAX_RADIUS = 100;\n    const radius = this.zoomed * MAX_RADIUS;\n\n    this.targetBCR = this.target.getBoundingClientRect();\n\n    // local coordinates (ratio <0,1>)\n    const ratioX =\n      // min. 0\n      Math.max(0,\n        // max. 1\n        Math.min(1, ((this.x - this.targetBCR.left) / this.targetBCR.width))\n      );\n    // console.log(ratioX);\n    const ratioY =\n      // min. 0\n      Math.max(0,\n        // max. 1\n        Math.min(1, ((this.y - this.targetBCR.top) / this.targetBCR.height))\n      );\n    // console.log(ratioY);\n\n    // actual zooming (scaling)\n    const imageScale = 2.5;\n    const scaledTargetWidth = this.targetBCR.width * imageScale;\n    const scaledTargetHeight = this.targetBCR.height * imageScale;\n\n    // Firefox on Windows has a bug because of the shadow\n    if (!(platform.os.family.indexOf('Windows') > -1 && platform.name.indexOf('Firefox') > -1)) {\n      // Shadow.\n      this.ctx.shadowColor = 'rgba(0,0,0,0.4)';\n      this.ctx.shadowBlur = 12;\n      this.ctx.shadowOffsetY = 8;\n    }\n\n    // Background.\n    this.ctx.clearRect(0, 0, this.zoomGlassSize, this.zoomGlassSize);\n    this.ctx.fillStyle = '#fff';\n    this.ctx.beginPath();\n    this.ctx.arc(\n      // x\n      this.zoomGlassSize / 2,\n      // y\n      (this.zoomGlassSize - 10) - radius,\n      // radius, startAngle, endAngle\n      radius, 0, TAU);\n    this.ctx.closePath();\n    this.ctx.fill();\n\n    // save the default state (without image)\n    this.ctx.save();\n\n    // Zoomed image.\n    this.ctx.beginPath();\n    this.ctx.arc(\n      // x\n      this.zoomGlassSize / 2,\n      // y\n      (this.zoomGlassSize - 10) - (radius + 1),\n      // radius, startAngle, endAngle\n      radius * 1.03, 0, TAU);\n    this.ctx.clip();\n    this.ctx.closePath();\n    this.ctx.drawImage(this.target,\n      // dx and dy (left and top)\n      (-ratioX * scaledTargetWidth) + (this.zoomGlassSize / 2),\n      (-ratioY * scaledTargetHeight) + (this.zoomGlassSize / 2),\n      // scaled width and height\n      scaledTargetWidth, scaledTargetHeight);\n\n    // go back to default state (without image)\n    // so next update starts fresh\n    this.ctx.restore();\n\n    // Position the parent $element.\n    this.$element.style.transform = `translate(${this.x}px, ${this.y}px)`;\n\n    // Update the zoom value.\n    this.zoomed += (this.targetZoomed - this.zoomed) / 4;\n\n    // Schedule another update if the zoom is fairly non-zero.\n    if (this.zoomed > 0.001) {\n      // if (this.zoomed > 0.001 && this.zoomed < 0.998) {\n      window.requestAnimationFrame(this._update);\n      // } else if (this.zoomed >= 0.998) {\n      //   this.zoomed = 1;\n    } else {\n      this.zoomed = 0;\n    }\n  }\n\n  _addEventListeners() {\n    // touch events\n    document.addEventListener('touchstart', this._onStart);\n    document.addEventListener('touchmove', this._onMove);\n    document.addEventListener('touchend', this._onEnd);\n    // mouse events\n    document.addEventListener('mousedown', this._onStart);\n    document.addEventListener('mousemove', this._onMove);\n    document.addEventListener('mouseup', this._onEnd);\n    // window events\n    window.addEventListener('resize', this._onResize);\n  }\n}\n","export function imageIsLoaded(src) {\n  return new Promise((resolve, reject) => {\n    const img = new Image();\n    img.onload = () => resolve(img);\n    img.onerror = reject;\n    img.src = src;\n  });\n}\n\nexport function __createNewCustomEvent(name, options = {}, data = null) {\n  const defaults = {\n    // https://developer.mozilla.org/en-US/docs/Web/Guide/Events/Creating_and_triggering_events#Event_bubbling\n    bubbles: true,\n    // cancelBubble\n    // stopPropagation()\n    // cancelable\n    // composed\n    // currentTarget\n    // defaultPrevented\n    // preventDefault()\n    // eventPhase\n    // returnValue\n    // preventDefault()\n    // defaultPrevented\n    // target\n    // timeStamp\n    // type\n    // isTrusted\n  };\n\n  const properties = Object.assign(defaults, options);\n\n  return new CustomEvent(name, {\n    detail: data,\n    ...properties,\n  });\n}\n\nexport function __dispatchEvent($element, type, options, payload) {\n  const event = __createNewCustomEvent(type, options, payload);\n\n  // console.log(event);\n  $element.dispatchEvent(event);\n}\n\n/* https://plainjs.com/javascript/events/trigger-an-event-11/ */\nexport function __triggerEvent(el, type) {\n\n  if ('createEvent' in document) {\n    // modern browsers, IE9+\n    const e = new Event(type);\n    el.dispatchEvent(e);\n  } else {\n    // IE 8\n    const e = document.createEventObject();\n    e.eventType = type;\n    el.fireEvent('on'+e.eventType, e);\n  }\n}\n\nexport function __keycodeIsPrintableCharacter(keycode) {\n\n  const valid =\n    (keycode > 47 && keycode < 58) || // number keys\n    keycode == 32 || keycode == 13 || // spacebar & return key(s) (if you want to allow carriage returns)\n    (keycode > 64 && keycode < 91) || // letter keys\n    (keycode > 95 && keycode < 112) || // numpad keys\n    (keycode > 185 && keycode < 193) || // ;=,-./` (in order)\n    (keycode > 218 && keycode < 223); // [\\]' (in order)\n  // https://stackoverflow.com/questions/12467240/determine-if-javascript-e-keycode-is-a-printable-non-control-character#answer-12467610\n\n  return valid;\n\n}\n\nexport function __isObject(item) {\n  return (item && typeof item === 'object' && !Array.isArray(item));\n}\n\n// https://stackoverflow.com/questions/27936772/how-to-deep-merge-instead-of-shallow-merge\n// Maybe use lodash ? https://lodash.com/docs/4.17.10#defaultsDeep\nexport function __mergeDeep(target, source) {\n  const output = Object.assign({}, target);\n  if (__isObject(target) && __isObject(source)) {\n    Object.keys(source).forEach((key) => {\n      if (__isObject(source[key])) {\n        if (!(key in target)) {\n          Object.assign(output, { [key]: source[key] });\n        } else {\n          output[key] = __mergeDeep(target[key], source[key]);\n        }\n      } else {\n        Object.assign(output, { [key]: source[key] });\n      }\n    });\n  }\n  return output;\n}\n\nexport function __isObjectEmpty(object) {\n  return !Object.keys(object).length;\n}\n\nexport function __insertBefore(newNode, referenceNode) {\n  referenceNode.parentNode.insertBefore(newNode, referenceNode);\n}\n\nexport function __insertAfter(newNode, referenceNode) {\n\n  referenceNode.parentNode.insertBefore(newNode, referenceNode.nextSibling);\n\n}\n\nexport function __getRealDimensions(el, translated = true) {\n\n  const clonedElement = el.cloneNode(true);\n\n  clonedElement.style.visibility = 'hidden';\n  clonedElement.style.display = 'block';\n\n  __insertAfter(clonedElement, el);\n\n  const elDimensions = clonedElement.getBoundingClientRect();\n  const elPosition = (translated) ? __positionTranslated(clonedElement) : __position(clonedElement);\n\n\n  __remove(clonedElement);\n\n  return {\n    width: elDimensions.width,\n    height: elDimensions.height,\n    top: elPosition.top,\n    left: elPosition.left,\n  };\n\n}\n\nexport function __remove(el /* :HTMLElement */) {\n\n  el.parentNode.removeChild(el);\n\n}\n\n\nexport function __getHTML(node) {\n\n  if (!node || !node.tagName) { return; }\n  if (node.outerHTML) { return node.outerHTML; }\n\n  // polyfill:\n  const wrapper = document.createElement('div');\n  wrapper.appendChild(node.cloneNode(true));\n  return wrapper.innerHTML;\n\n}\n\nexport function __getText(el) {\n  return el.innerText || el.textContent;\n}\n\nexport function __globalPosition(event) {\n  // d3.event\n  // The current event, if any. This is set during the invocation of an event listener, and is reset after the listener terminates. Use this to access standard event fields such as event.timeStamp and methods such as event.preventDefault. While you can use the native event.pageX and event.pageY, it is often more convenient to transform the event position to the local coordinate system of the container that received the event using d3.mouse, d3.touch or d3.touches.\n  // If you use Babel, Webpack, or another ES6-to-ES5 bundler, be aware that the value of d3.event changes during an event! An import of d3.event must be a live binding, so you may need to configure the bundler to import from D3’s ES6 modules rather than from the generated UMD bundle; not all bundlers observe jsnext:main. Also beware of conflicts with the window.event global.\n  return {\n    x: event.pageX,\n    y: event.pageY,\n  };\n}\n\nexport function __localPosition(container) {\n  // d3.mouse\n  // Returns the x and y coordinates of the current event relative to the specified container. The container may be an HTML or SVG container element, such as a G element or an SVG element. The coordinates are returned as a two-element array of numbers [x, y].\n  // BUG: d3.mouse doesn’t observe CSS transform on Firefox — https://github.com/d3/d3-selection/issues/81\n  // TEMPORARY FIX: https://github.com/d3/d3-selection/issues/191#issuecomment-474987103\n\n  let position = [];\n\n  if (platform.name === 'Firefox' && d3.event.target.closest('.half-slide-active')) {\n    // this works for Firefox even in transformed container\n    // if (platform.name === 'Firefox')\n    // but creates another bug when used on top of another SVG element (with different viewbox?),\n    // so make temporary fix only of .half-slide-active to fix the orginal bug with new bug\n    // console.log(d3.event.target.closest('.half-slide-active'));\n    position = [\n      d3.event.offsetX,\n      d3.event.offsetY,\n    ];\n  } else {\n    // this works for Chrome\n    position = d3.mouse(container);\n  }\n\n  return {\n    x: d3.format('.0f')(position[0]),\n    y: d3.format('.0f')(position[1]),\n  };\n}\n\nexport function __positionTranslated(el) {\n\n\n  const curTransform = new WebKitCSSMatrix(window.getComputedStyle(el).webkitTransform);\n\n  const body = document.body;\n\n  const scrollTop = window.pageYOffset || body.scrollTop;\n  const scrollLeft = window.pageXOffset || body.scrollLeft;\n\n  return {\n    left: el.offsetLeft + curTransform.m41,\n    top: el.offsetTop + curTransform.m42,\n  };\n\n}\n\nexport function __position(el) {\n\n  const elAttibutes = el.getBoundingClientRect();\n  const body = document.body;\n\n  const scrollTop = window.pageYOffset || body.scrollTop;\n  const scrollLeft = window.pageXOffset || body.scrollLeft;\n\n  return {\n    left: elAttibutes.left + scrollLeft,\n    top: elAttibutes.top + scrollTop,\n    height: elAttibutes.height,\n    width: elAttibutes.width,\n  };\n}\n\n// TODO: check for https://github.com/vladocar/nanoJS/\nexport function __toggleClass(element, cls) {\n  if (__hasClass(element, cls)) {\n    __removeClass(element, cls);\n  } else {\n    __addClass(element, cls);\n  }\n}\n\nexport function __hasClass(element, cls) {\n  // if there are no elements or classes, we're done\n  if (!element || !cls) return false;\n  return (element.classList) ? element.classList.contains(cls) : (`${element.className} `).indexOf(`${cls} `) > -1;\n}\n\nexport function __addClass(elements, classes) {\n  let _elements = elements;\n  let _classes = classes;\n\n  // if there are no elements or classes, we're done\n  if (!_elements || !_classes) { return; }\n\n  if (typeof (_elements) === 'string') {\n    // if we have a selector, get the chosen _elements\n    _elements = document.querySelectorAll(_elements);\n  } else if (_elements.tagName) {\n    // if we have a single DOM element, make it an array to simplify behavior\n    _elements = [_elements];\n  }\n\n  if (typeof (_classes) === 'string') {\n    // make an array from string _classes\n    _classes = _classes.split(' ');\n  } else {\n    console.log('Class argument must be string with spaces in between class names.');\n    return;\n  }\n\n  // add class to all chosen _elements\n  for (let i = 0; i < _elements.length; i += 1) {\n    // check classList support\n    if (_elements[i].classList) {\n      _elements[i].classList.add(..._classes);\n    } else if (!__hasClass(_elements[i], ..._classes)) {\n      for (let j = 0; j < _classes.length; j += 1) {\n        _elements[i].classes += ` ${_classes[j]}`;\n      }\n    }\n  }\n}\n\nexport function __removeClass(elements, classes) {\n  let _elements = elements;\n  let _classes = classes;\n\n  // if there are no elements or classes, we're done\n  if (!_elements || !_classes) { return; }\n\n  if (typeof (_elements) === 'string') {\n    // if we have a selector, get the chosen _elements\n    _elements = document.querySelectorAll(_elements);\n  } else if (_elements.tagName) {\n    // if we have a single DOM element, make it an array to simplify behavior\n    _elements = [_elements];\n  }\n\n  if (typeof (_classes) === 'string') {\n    // make an array from string _classes\n    _classes = _classes.split(' ');\n  } else {\n    console.log('Class argument must be string with spaces in between class names.');\n    return;\n  }\n\n  // remove class from all chosen _elements\n  for (let i = 0; i < _elements.length; i += 1) {\n    // check classList support\n    if (_elements[i].classList) {\n      _elements[i].classList.remove(..._classes);\n    } else {\n      for (let j = 0; j < _classes.length; j += 1) {\n        _elements[i].className = _elements[i].className.replace(new RegExp(`\\\\b${classes[j]}\\\\b`, 'g'), '');\n      }\n    }\n  }\n}\n","import { __createNewCustomEvent } from '../../lib/utils';\n\nconst mediaEvents = {\n  playchange: __createNewCustomEvent('playchange'),\n  timechange: __createNewCustomEvent('timechange'),\n  canplaystart: __createNewCustomEvent('canplaystart'),\n};\n\nfunction stopPlayingVideoPlayers($players) {\n  // pause all other playing media tracks\n  $players.forEach(($player) => {\n    const $media = $player.querySelector('audio') || $player.querySelector('video');\n    if ($media && !$media.paused) {\n      $media.pause();\n      $player\n        .querySelector('[data-player-control]')\n        .setAttribute('data-player-control', 'paused');\n    }\n  });\n}\n\nfunction getSecondsMinutesFormat(seconds) {\n  const duration = {\n    seconds: Math.floor(seconds),\n    minutes: Math.floor(seconds / 60),\n  };\n\n  duration.seconds = (duration.seconds - (duration.minutes * 60)).toString(10);\n\n  return `${duration.minutes}:${(`0${duration.seconds}`).slice(-2)}`;\n}\n\nexport {\n  getSecondsMinutesFormat,\n  stopPlayingVideoPlayers,\n  mediaEvents,\n};\n","import Component from '../component';\nimport { getSecondsMinutesFormat, stopPlayingVideoPlayers } from './media';\n\nexport default class AudioPlayer extends Component {\n  // eslint-disable-next-line no-useless-constructor\n  constructor($element) {\n    super($element);\n  }\n\n  // TODO: move to audio-simple.js\n  static addEventListeners($item, showFeedback) {\n    const $players = document.querySelectorAll('[data-player-audio]');\n    const $audio = $item.querySelector('audio');\n    const $playButton = $item.querySelector('[data-player-control]');\n    const $timeLeft = $item.querySelector('[data-audio-time-left]');\n\n    $playButton.addEventListener('click', (event) => {\n      if ($playButton.getAttribute('data-player-control') === 'paused') {\n        // TODO: abstract\n        stopPlayingVideoPlayers($players);\n        $audio.play();\n        $playButton.setAttribute('data-player-control', 'playing');\n      } else {\n        // TODO: abstract\n        $audio.pause();\n        $playButton.setAttribute('data-player-control', 'paused');\n      }\n\n      showFeedback();\n\n      event.stopPropagation();\n    }, false);\n\n    // do not propagate audio control events higher into the dom\n    $playButton.addEventListener('mousedown', (event) => {\n      event.stopPropagation();\n    }, false);\n\n    $audio.addEventListener('timeupdate', () => {\n      $timeLeft.innerText = getSecondsMinutesFormat($audio.currentTime);\n    });\n\n    $audio.addEventListener('ended', () => {\n      $playButton.setAttribute('data-player-control', 'paused');\n    });\n  }\n}\n","export default class SVGDragNDrop {\n  // static drag(id) {\n  //   d3.drag()\n  //     .on('start', () => {\n  //       SVGDragNDrop.start(id);\n  //     })\n  //     .on('drag', () => {\n  //       SVGDragNDrop.dragged(id);\n  //     })\n  //     .on('end', () => {\n  //       SVGDragNDrop.end(id);\n  //     });\n  // }\n\n  static start(element) {\n    d3.select(element).raise().classed('is-dragged', true);\n  }\n\n  static dragged(element, diff) {\n\n    d3.select(element)\n      .attr('x', (d3.event.x - diff.x).toFixed())\n      .attr('y', (d3.event.y - diff.y).toFixed());\n  }\n\n  static end(element, type, diff) {\n\n    d3.select(element)\n      .attr('x', (d3.event.x - diff.x).toFixed())\n      .attr('y', (d3.event.y - diff.y).toFixed())\n      // neumožňuje v jiných funkcí s tímto objektem dále pracovat,\n      // protože pracují s id\n      // .attr('id', `${type}-${d3.event.x.toFixed()}-${d3.event.y.toFixed()}`)\n      .classed('is-dragged', false);\n  }\n}\n","import { __localPosition, __dispatchEvent } from '../../lib/utils';\n\n// import SVG from '../svg';\nimport SVGDragNDrop from './svg-dragndrop';\nimport SVG from '../svg';\n\nexport default class SVGDraw {\n  // static selectPath(svg) {\n  //   // https://bl.ocks.org/mbostock/8027637\n  // }\n\n  static renderPath($svg, callback) {\n    if (d3.event.sourceEvent.target.nodeName === 'image') {\n\n      const line = d3.line()\n        // removed smooth curve to get rid of loong decimals\n        // see https://github.com/d3/d3-path/issues/10\n        .curve(d3.curveLinear); // _dragStarted\n\n      const format = d3.format('.0f');\n      const d = d3.event.subject;\n      // origin\n      let x0 = format(d3.event.x);\n      let y0 = format(d3.event.y);\n\n      const id = `${$svg.id}_path-${x0}-${y0}`;\n\n      const active = d3.select(`#${$svg.id} .svg-view`).append('svg:path')\n        // .attr('marker-start', 'url('#marker-circle-blue')')\n        // .attr('marker-end', 'url('#marker-arrow-blue')')\n        .attr('data-svg-path', '')\n        .attr('class', 'svg-path')\n        .attr('id', id)\n        .datum(d);\n\n      // github.com/d3/d3-drag#event_on\n      d3.event\n        .on('drag', () => {\n          // current position\n          const x1 = format(d3.event.x);\n          const y1 = format(d3.event.y);\n          // distance from origin\n          const dx = x1 - x0;\n          const dy = y1 - y0;\n\n          // if the distance of drag event is too large, make new origin\n          if ((dx * dx) + (dy * dy) > 300) d.push([x0 = x1, y0 = y1]);\n          // smooth line, correct last point\n          else d[d.length - 1] = [x1, y1];\n\n          active.attr('d', line);\n        })\n        .on('end', () => {\n          const $thisPath = d3.select(`#${id}`);\n          if ($thisPath) {\n            if ($thisPath.attr('d')) {\n              if ($thisPath.attr('d').length < 40) {\n                $thisPath.remove();\n              } else {\n                // dispatch event that svg has changed\n                __dispatchEvent(document, 'svg.change', {}, {\n                  svg: {\n                    id: $svg.id,\n                    task: 'create',\n                    node: $thisPath.node(),\n                    nodeName: $thisPath.node().nodeName,\n                    contextMenu: false,\n                  },\n                });\n              }\n            } else if (!$thisPath.attr('d')) {\n              $thisPath.remove();\n            }\n          }\n\n          callback();\n        });\n\n      // add events to element\n      SVGDraw.pathEventsManager($svg, d3.select(`#${id}`).node());\n    }\n  }\n\n  // Draw a SVG circle on click\n  static createCircle($svg, color) {\n    const d3svg = d3.select(`#${$svg.id} .svg-view`);\n    // const canvas = document.querySelector(`#${$svg.id} .svg-view`);\n    const localPosition = __localPosition($svg);\n    const id = `${$svg.id}_circle-${localPosition.x}-${localPosition.y}`;\n\n    // circle wrapper\n    const foreignObject = d3svg.append('svg:foreignObject')\n      .attr('data-svg-circle', '')\n      .attr('id', id)\n      .attr('x', localPosition.x)\n      .attr('y', localPosition.y)\n      .attr('width', 1)\n      .attr('height', 1);\n\n    const circle = foreignObject.append('xhtml:div')\n      .attr('class', `svg-circle ${color}`);\n\n    const $element = document.querySelector(`#${id}`);\n\n    // add events to element\n    SVGDraw.circleEventsManager($svg, $element);\n\n    // dispatch event that svg has changed\n    __dispatchEvent(document, 'svg.change', {}, {\n      svg: {\n        id: $svg.id,\n        task: 'create',\n        node: $element,\n        nodeName: $element.nodeName,\n        contextMenu: false,\n      },\n    });\n  }\n\n  static pathEventsManager($svg, $element) {\n    d3.select(`#${$element.id}`).on('click', () => {\n      // dispatch event that svg has changed\n      __dispatchEvent(document, 'svg.change', {}, {\n        svg: {\n          id: $svg.id,\n          task: 'remove',\n          node: d3.event.target,\n          nodeName: d3.event.target.nodeName,\n          contextMenu: false,\n        },\n      });\n\n      d3.select(`#${$element.id}`).remove();\n\n      d3.event.preventDefault();\n    }, false);\n  }\n\n  static circleEventsManager($svg, $element) {\n    const $canvas = document.querySelector(`#${$svg.id} .svg-view`);\n\n    // TODO:\n    // standalone function\n    // same for all draggable svg elements\n    let elementPosition = [\n      $element.getAttribute('x'),\n      $element.getAttribute('y'),\n    ];\n    let diff = {};\n\n    const selection = d3.selectAll(`#${$element.id} > div`);\n    d3.select(selection.nodes()[0]).on('click', () => {\n\n      // dispatch event that svg has changed\n      __dispatchEvent(document, 'svg.change', {}, {\n        svg: {\n          id: $svg.id,\n          task: 'remove',\n          node: $element,\n          nodeName: $element.nodeName,\n          contextMenu: false,\n        },\n      });\n\n      // dispatch event that drop item was deleted\n      const idParts = $element.id.split('_');\n      if (idParts[idParts.length - 1] === 'dropItem') {\n        __dispatchEvent(document, 'svg.drop.delete', {}, {\n          item: {\n            id: idParts[1],\n            $object: $element.firstChild,\n          },\n        });\n      }\n\n      d3.event.target.closest('foreignObject').remove();\n    })\n      .call(d3.drag()\n        .container($canvas)\n        .subject($element)\n        .on('start', () => {\n          diff = {\n            x: d3.event.x - elementPosition[0],\n            y: d3.event.y - elementPosition[1],\n          };\n\n          SVGDragNDrop.start($element);\n        })\n        .on('drag', () => {\n          SVGDragNDrop.dragged($element, diff);\n        })\n        .on('end', () => {\n          const oldXCoordinate = elementPosition[0];\n          const oldYCoordinate = elementPosition[1];\n          let taskType = 'move';\n\n          SVGDragNDrop.end($element, 'circle', diff);\n\n          elementPosition = [\n            $element.getAttribute('x'),\n            $element.getAttribute('y'),\n          ];\n\n          // if clone is changed, then dispatch create event\n          if (SVG.removeCloneConnectionManager($element)) taskType = 'create';\n\n          if (elementPosition[0] !== oldXCoordinate || elementPosition[1] !== oldYCoordinate) {\n            // dispatch event that svg has changed\n            __dispatchEvent(document, 'svg.change', {}, {\n              svg: {\n                id: $svg.id,\n                task: taskType,\n                node: $element,\n                nodeName: $element.nodeName,\n                contextMenu: false,\n              },\n            });\n          }\n        }));\n  }\n}\n","import {\n  __addClass,\n  __removeClass,\n  __hasClass,\n  __dispatchEvent,\n} from '../../lib/utils';\n\nimport SVG from '../svg';\nimport SVGDragNDrop from './svg-dragndrop';\n\nexport default class SVGText {\n  static createText(maxLength = 333, minLength = 2) {\n    const $svg = document.querySelector('[data-svg-active=\"true\"]');\n    const svgID = $svg.id;\n    const svgGroup = d3.select($svg).select('.svg-view');\n\n    // const $canvas = $svg.querySelector('.svg-view');\n    const $radialMenu = document.querySelector('[data-radial-menu]');\n    const localPosition = {\n      x: $radialMenu.getAttribute('data-local-x'),\n      y: $radialMenu.getAttribute('data-local-y'),\n    };\n    const id = `${svgID}_svg-text-${localPosition.x}-${localPosition.y}`;\n    const hash = `#${id}`;\n    const orientation = {\n      x: (svgGroup.attr('width') - localPosition.x) > 320 ? 'right' : 'left',\n      y: (svgGroup.attr('height') - localPosition.y) > 60 ? 'bottom' : 'top',\n    };\n    // let firstWrite = true;\n\n    // text wrapper\n    const foreignObject = svgGroup.append('svg:foreignObject')\n      .attr('class', `svg-text orientation-${orientation.x} orientation-${orientation.y}`)\n      .attr('data-svg-text', '')\n      .attr('x', localPosition.x)\n      .attr('y', localPosition.y)\n      .attr('width', 1)\n      .attr('height', 1);\n\n    // create visual point of interest for text input\n    foreignObject.append('xhtml:div')\n      .attr('class', 'svg-circle svg-circle-text');\n    // create text input\n    const textarea = foreignObject.append('xhtml:textarea')\n      .attr('maxlength', maxLength)\n      .attr('tabindex', '-1')\n      .attr('id', id)\n      .attr('class', 'svg-textarea')\n      .attr('data-save', '')\n      .attr('data-svg-textarea-target', svgID);\n\n    // set focus to the new text input\n    $svg.querySelector(hash).focus();\n\n    // add events to element\n    SVGText.textEventsManager($svg, textarea.node(), true, minLength);\n  }\n\n  static textEventsManager($svg, $node, isCreated, minLength = 2) {\n    const $canvas = $svg.querySelector('.svg-view');\n    const hash = `#${$node.id}`;\n    let firstWrite = isCreated;\n    let oldText = $node.value;\n\n    // TODO\n    // standalone function\n    // same for all draggable svg elements\n    const $element = $svg.querySelector(hash).parentElement;\n    let elementPosition = [\n      $element.getAttribute('x'),\n      $element.getAttribute('y'),\n    ];\n    let diff = {};\n\n    d3.select(hash)\n      // drag & drop\n      .call(d3.drag()\n        .container($canvas)\n        .subject($element)\n        .on('start', () => {\n          diff = {\n            x: d3.event.x - elementPosition[0],\n            y: d3.event.y - elementPosition[1],\n          };\n\n          SVGDragNDrop.start($element);\n        })\n        .on('drag', () => {\n          SVGDragNDrop.dragged($element, diff);\n        })\n        .on('end', () => {\n          const oldXCoordinate = elementPosition[0];\n          const oldYCoordinate = elementPosition[1];\n          let taskType = 'move';\n\n          SVGDragNDrop.end($element, 'text', diff);\n\n          elementPosition = [\n            $element.getAttribute('x'),\n            $element.getAttribute('y'),\n          ];\n\n          if (!firstWrite && (elementPosition[0] !== oldXCoordinate || elementPosition[1] !== oldYCoordinate)) {\n            // if clone is changed, then dispatch create event\n            if (SVG.removeCloneConnectionManager($element.childNodes[1])) taskType = 'create';\n\n            // dispatch event that svg has changed\n            __dispatchEvent(document, 'svg.change', {}, {\n              svg: {\n                id: $svg.id,\n                task: taskType,\n                node: $element.childNodes[1],\n                nodeName: $element.childNodes[1].nodeName,\n                contextMenu: false,\n              },\n            });\n          }\n        }))\n      // keystroke\n      // control height of the text input on every key stroke\n      .on('keyup', () => {\n        SVGText.updateTextareaHeight(d3.event.target);\n      })\n      // loss of focus\n      .on('blur', () => {\n        const $target = d3.event.target;\n        const value = $target.value;\n        let taskType;\n        let wrongBool = false;\n\n        if (value.length === 0) {\n          SVG.removeItem(false, hash);\n          return;\n        }\n        if (value.length < minLength) {\n          __addClass($target, 'is-wrong');\n          wrongBool = true;\n        } else if ((value.length >= minLength) && __hasClass($target, 'is-wrong')) {\n          __removeClass($target, 'is-wrong');\n          wrongBool = false;\n        }\n\n        if (oldText !== value) {\n          if (firstWrite) {\n            taskType = 'create';\n            firstWrite = false;\n          } else {\n            taskType = 'change';\n          }\n          oldText = value;\n          // if clone is changed, then dispatch create event\n          if (SVG.removeCloneConnectionManager($target)) taskType = 'create';\n\n          // dispatch event that svg has changed\n          __dispatchEvent(document, 'svg.change', {}, {\n            svg: {\n              id: $svg.id,\n              task: taskType,\n              node: $target,\n              nodeName: $target.nodeName,\n              isWrong: wrongBool,\n              contextMenu: false,\n            },\n          });\n        }\n\n        // update oldText\n        oldText = value;\n      })\n      // gain focus\n      .on('focus', () => {\n        d3.select($element).raise();\n      });\n  }\n\n  static updateTextareaHeight($target) {\n    $target.style.height = '1px';\n    $target.style.height = `${22 + $target.scrollHeight}px`;\n  }\n\n  static comicBubblesEventsManager($svg, $node) {\n    let firstWrite = true;\n    let oldText = $node.value;\n\n    d3.select($node).on('keyup', () => {\n      SVGText.updateTextareaHeight(d3.event.target);\n    })\n      .on('blur', () => {\n        const $target = d3.event.target;\n        const value = $target.value;\n        let taskType;\n\n        if (oldText !== value) {\n          if (firstWrite) {\n            taskType = 'create';\n            firstWrite = false;\n          } else {\n            taskType = 'change';\n            if (value.length === 0) {\n              firstWrite = true;\n            }\n          }\n          oldText = value;\n          // if clone is changed, then dispatch create event\n          if (SVG.removeCloneConnectionManager($target)) taskType = 'create';\n\n          // dispatch event that svg has changed\n          __dispatchEvent(document, 'svg.change', {}, {\n            svg: {\n              id: $svg.id,\n              task: taskType,\n              node: $target,\n              nodeName: $target.nodeName,\n              isBubble: true,\n              contextMenu: false,\n            },\n          });\n        }\n\n        // update oldText\n        oldText = value;\n      });\n  }\n}\n","/**\n * čára:\n *  - nakreslit   ( drag'n'drop )\n *  - smazat      ( left click )\n *  - radial menu ( right click)\n *    - změnit barvu\n *    - smazaní\n *    - textový komentář\n * textové pole:\n *  - vytvořit    ( right click on svg )\n *    - nic => smaže se\n *    - málo znaků => zčervená\n *    - přes řádek textu => zvětší se\n *  - změnit      ( click on and write )\n *  - smazat      ( right click on textarea )\n *  - přenést     ( drag'n'drop )\n *  - radial menu ( right click on mark )\n *    - změnit barvu\n *    - smazaní\n *    - textový komentář\n * značka:\n *  - nakreslit   ( left click on svg )\n *  - přenést     ( drag'n'drop )\n *  - smazat      ( left click on mark )\n *  - radial menu ( right click)\n *    - změnit barvu\n *    - smazaní\n *    - textový komentář\n * komiksová bublina:  ( je již vytvořena předem )\n *  - napsat dovnitř\n *    - nic => zůstane\n *    - přes řádek textu => zvětší se\n */\n/* eslint-disable brace-style */\nimport Component from './component';\nimport { __dispatchEvent, __removeClass, __addClass } from '../lib/utils';\nimport SVGDraw from './svg-lib/svg-draw';\nimport SVGText from './svg-lib/svg-text';\n\nexport default class SVG extends Component {\n  constructor($element) {\n    super($element);\n\n    this.format = d3.format('.0f');\n\n    this._setSize();\n\n    this.init();\n    this._initWhenDone();\n  }\n\n  init() {\n    if (HISTORYLAB.import.done) return;\n\n    // duplicate source of different svg element\n    this.toDuplicate = this.target.getAttribute('data-duplicate-svg');\n\n    // make array from data-attributes (contains what kind of actions can user do on this svg)\n    const svgSpecificActions = this.target.getAttribute('data-svg-target').split(' ');\n\n    // get default color\n    const colors = this.target.getAttribute('data-svg-colors');\n    const svgSpecificColor = colors ? colors.split(' ')[0] : 'blue';\n\n    for (let i = 0; i < svgSpecificActions.length; i += 1) {\n      if (svgSpecificActions[i] === 'kresleni') {\n        this._initPath(this.showFeedback);\n      }\n      else if (svgSpecificActions[i] === 'znacky') {\n        this._initCircle(this.showFeedback, svgSpecificColor);\n      }\n      // else if (svgSpecificActions[i] === 'text') {\n      //   this._initText();\n      // }\n    }\n\n    // this._initZoom();\n    // comic bubbles if exists\n    this._initComicBubbles();\n\n    // listen events\n    this._getEvents();\n    this._getDropEvent();\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  _initWhenDone() {\n    if (!HISTORYLAB.import.done) return;\n\n    d3.selectAll('[data-svg-text] textarea')\n      // local context needed because of `this`\n      // eslint-disable-next-line func-names\n      .on('mouseenter', function () {\n        d3.select(this.closest('foreignObject')).raise();\n      });\n  }\n\n  _setSize() {\n    // NOTE: Cannot set `width` because of change of width when on half slide.\n    // TODO: set size on window resize\n\n    // might not be needed when inside sortable or other higher level module\n    // TODO: add condition for other higher level modules\n    // if (this.target.closest('[data-sortable-target')) return false;\n\n    const viewbox = this.target.getAttribute('viewBox').split(' ');\n    const rect = this.target.getBoundingClientRect(); // max-height: 100vh\n    // const getMaxWidthAbsolute = () => {\n    //   if (matchMedia('screen and (min-width: 1025px)').matches) {\n    //     return window.innerWidth * .8; // max-width: 62vw\n    //   }\n\n    //   return window.innerWidth;\n    // };\n    const maxWidthAbsolute = window.innerWidth;\n    const maxHeightAbsolute = window.innerHeight * .9;\n    const getHeight = () => {\n      if (!rect.height) return viewbox[3];\n      if (rect.height > viewbox[3]) return viewbox[3];\n\n      return rect.height;\n    };\n\n    const height = getHeight() > maxHeightAbsolute ? maxHeightAbsolute : getHeight();\n\n    const scale = height / viewbox[3];\n    const maxWidth = viewbox[2] * scale;\n    const setMaxWidth = scale ? `${maxWidth < maxWidthAbsolute ? maxWidth : maxWidthAbsolute}px` : '';\n\n    this.target.style.maxWidth = setMaxWidth;\n\n    // fix for svg + draggable/gallery (horizontal layout) in Chrome\n    if (\n      this.target.getAttribute('data-svg-drop')\n      && !this.target.closest('.layout-vertical')\n    ) {\n      this.target.closest('.svgs-container').style.maxWidth = setMaxWidth;\n    }\n  }\n\n  // _initZoom() {\n  //   const view = d3.select(`#${this.target.id} .svg-view`);\n  //   const size = [\n  //     view.attr('width'),\n  //     view.attr('height'),\n  //   ];\n  //   SVGZoom.zoom(this.target, view, size);\n  // }\n\n  _initPath(callback) {\n    d3.select(this.target)\n      .call(d3.drag()\n        .container(() => this.target)\n        .subject(() => {\n          const p = [d3.event.x.toFixed(), d3.event.y.toFixed()];\n\n          return [p, p];\n        })\n        .on('start', () => {\n          SVGDraw.renderPath(this.target, callback);\n        }));\n  }\n  // _initText() {\n  //   d3.select(this.target).on('click', () => {\n  //     SVGText.openTextDialog(this.target);\n  //     d3.event.preventDefault();\n  //   });\n  // }\n\n  _initCircle(callback, color) {\n    d3.select(this.target).on('click', () => {\n      const item = d3.event.target;\n      const nodeName = item.nodeName;\n      const validPlace = (nodeName === 'image');\n      // const isCircle = (__hasClass(item, 'svg-circle'));\n\n      if (!validPlace) {\n        return;\n      }\n\n      SVGDraw.createCircle(this.target, color);\n      callback();\n\n      d3.event.preventDefault();\n    }, false);\n  }\n\n  _initComicBubbles() {\n    const $comicBubbles = this.target.querySelectorAll('.svg-komiks .svg-textarea');\n\n    if ($comicBubbles) {\n      $comicBubbles.forEach(($comicBubble) => {\n        SVGText.comicBubblesEventsManager(this.target, $comicBubble);\n      });\n    }\n  }\n\n  _generateNewID(oldID) {\n    const idParts = oldID.split('_');\n    // beware if it's a error, return oldID\n    if (idParts.length < 2) {\n      console.log('Svg ID error!', oldID);\n      return oldID;\n    }\n\n    // solve thirt part of id\n    if (idParts[idParts.length - 1] !== `clone-${idParts[0]}`) {\n      idParts.push(`clone-${idParts[0]}`);\n    }\n\n    // solve first part of id\n    idParts[0] = this.target.id;\n\n    const newID = idParts.join('_');\n    return newID;\n  }\n\n  _getEvents() {\n\n    const svgDuplicateSources = this.toDuplicate ? this.toDuplicate.split(' ') : [];\n\n    if (svgDuplicateSources[0]) {\n\n      document.addEventListener('svg.change', (e) => {\n        if (svgDuplicateSources.includes(e.detail.svg.id)) {\n          const $templateNode = e.detail.svg.node;\n          const nodeName = e.detail.svg.nodeName;\n          const localNodeID = this._generateNewID($templateNode.id);\n          let $localNode = this.target.querySelector(`#${localNodeID}`);\n          let task;\n          // for creating new element or we edit the old one after created one\n          if ($localNode || e.detail.svg.task === 'create') {\n            task = e.detail.svg.task;\n          } else {\n            return;\n          }\n\n          /**\n           * 1. divided by node name\n           * 2. divided by task type\n           * path => svg lines\n           * TEXTAREA => text fields or comic bubbles\n           * foreignObject => svg circles\n           */\n          if (nodeName === 'path') {\n            switch (task) {\n              case 'create':\n                this._clonePath($templateNode, localNodeID);\n                break;\n              case 'color':\n                __removeClass($localNode, 'red blue');\n                __addClass($localNode, e.detail.svg.color);\n                break;\n              case 'remove':\n                $localNode.remove();\n                break;\n              default:\n                console.log('Nondefinated path events task. :(');\n            }\n          } else if (nodeName === 'TEXTAREA') {\n            if (e.detail.svg.isBubble) {\n              switch (task) {\n                case 'create':\n                  this._cloneComicBubbles($templateNode, localNodeID);\n                  break;\n                case 'change':\n                  if ($templateNode.value.length !== 0) {\n                    $localNode.value = $templateNode.value;\n                    // if needs resize\n                    if ($localNode.style.height !== $templateNode.style.height) {\n                      $localNode.style.height = $templateNode.style.height;\n                    }\n                  } else {\n                    $localNode.parentElement.remove();\n                  }\n                  break;\n                default:\n                  console.log('Nondefinated comicBubble events task. :(');\n              }\n            } else {\n              switch (task) {\n                case 'create':\n                  this._cloneTextField(e.detail.svg.isWrong, $templateNode, localNodeID);\n                  break;\n                case 'change':\n                  $localNode.value = $templateNode.value;\n                  // if is now wrong lenght\n                  if (e.detail.svg.isWrong) {\n                    __addClass($localNode, 'is-wrong');\n                  } else {\n                    __removeClass($localNode, 'is-wrong');\n                  }\n                  // if needs resize\n                  if ($localNode.style.height !== $templateNode.style.height) {\n                    $localNode.style.height = $templateNode.style.height;\n                  }\n                  break;\n                case 'color':\n                  $localNode = $localNode.parentElement.childNodes[0];\n                  __removeClass($localNode, 'red blue');\n                  __addClass($localNode, e.detail.svg.color);\n                  break;\n                case 'move':\n                  if ($localNode) {\n                    $localNode.parentElement.remove();\n                  }\n                  this._cloneTextField(e.detail.svg.isWrong, $templateNode, localNodeID);\n                  break;\n                case 'remove':\n                  $localNode.parentElement.remove();\n                  break;\n                default:\n                  console.log('Nondefinated textField events task. :(');\n              }\n            }\n          } else if (nodeName === 'foreignObject') {\n            switch (task) {\n              case 'create':\n                this._cloneCircle($templateNode, localNodeID);\n                break;\n              case 'color':\n                $localNode = $localNode.childNodes[0];\n                __removeClass($localNode, 'red blue');\n                __addClass($localNode, e.detail.svg.color);\n                break;\n              case 'move':\n                if ($localNode) {\n                  $localNode.remove();\n                }\n                this._cloneCircle($templateNode, localNodeID);\n                break;\n              case 'remove':\n                $localNode.remove();\n                break;\n              default:\n                console.log('Nondefinated circle events task. :(');\n            }\n          } else {\n            console.log('Nondefinated events nodeName. :(', nodeName);\n          }\n\n          // dispatch event that svg has changed\n          __dispatchEvent(document, 'svg.change', {}, {\n            svg: {\n              id: this.target.id,\n              task: e.detail.svg.task,\n              node: $templateNode,\n              nodeName,\n              contextMenu: false,\n            },\n          });\n        }\n      });\n    }\n  }\n\n  _getDropEvent() {\n    // need if we drop more than one same item\n    let idSalt = 0;\n\n    document.addEventListener('svg.drop', (event) => {\n\n      if (event.detail.svg.id === this.target.id) {\n\n        const { $node, position, type, size } = event.detail.svg;\n\n        const getMultiply = () => {\n          // make images smaller when dropped\n          if (type === 'image' || type === 'svg') return .62;\n          // make tags larger when dropped to not jump on more lines\n          if (type === 'tag') return 1.075;\n\n          return 1;\n        }\n        const multiply = getMultiply();\n\n        size.width = size.width * multiply;\n        size.height = size.height * multiply;\n\n        const $d3canvas = d3.select(`#${this.target.id} .svg-view`);\n        const $d3foreignObject = $d3canvas.append('svg:foreignObject')\n          .attr('width', size.width)\n          .attr('height', size.height)\n          .attr('x', this.format(position[0] - (size.width / 2)))\n          .attr('y', this.format(position[1] - (size.height / 2)))\n          .attr('id', `${this.target.id}_${$node.getAttribute('data-id')}_${idSalt}_dropItem`);\n          // _dropItem is important identifier\n\n        const $dropItem = document.createElement('div');\n        $dropItem.classList.add('dropped__item', `dropped__item--${type}`);\n        $dropItem.appendChild($node.firstElementChild.firstElementChild);\n\n        $d3foreignObject.append(() => $dropItem);\n\n        const $foreignObject = $d3foreignObject.node();\n\n        // increment salt\n        idSalt += 1;\n\n        // add events to element\n        SVGDraw.circleEventsManager(this.target, $foreignObject);\n\n        // dispatch event that svg has changed\n        __dispatchEvent(document, 'svg.change', {}, {\n          svg: {\n            id: this.target.id,\n            task: 'create',\n            node: $foreignObject,\n            nodeName: $foreignObject.nodeName,\n            contextMenu: false,\n          },\n        });\n      }\n    });\n  }\n\n  _clonePath($templateNode, localNodeID) {\n    const $localNode = $templateNode.cloneNode(true);\n    $localNode.id = localNodeID;\n    this.target.appendChild($localNode);\n    // add events to element\n    SVGDraw.pathEventsManager(this.target, $localNode);\n  }\n\n  _cloneTextField(isWrong, $templateNode, localNodeID) {\n    const $localNode = $templateNode.parentElement.cloneNode(true);\n    $localNode.childNodes[1].id = localNodeID;\n    this.target.appendChild($localNode);\n    if (isWrong) {\n      __addClass($localNode, 'is-wrong');\n    } else {\n      __removeClass($localNode, 'is-wrong');\n    }\n    // add events to element\n    SVGText.textEventsManager(this.target, $localNode.childNodes[1], false);\n  }\n\n  _cloneCircle($templateNode, localNodeID) {\n    const $localNode = $templateNode.cloneNode(true);\n    $localNode.id = localNodeID;\n    this.target.appendChild($localNode);\n    // add events to element\n    SVGDraw.circleEventsManager(this.target, $localNode);\n  }\n\n  _cloneComicBubbles($templateNode, localNodeID) {\n    const $localNode = $templateNode.parentElement.cloneNode(true);\n    $localNode.childNodes[1].id = localNodeID;\n    this.target.appendChild($localNode);\n    // add events to element\n    SVGText.comicBubblesEventsManager(this.target, $localNode.childNodes[1]);\n  }\n\n  static selectItem(item) {\n    item.setAttribute('data-svg-selected', 'true');\n  }\n\n  // Remove 'selected' classname from element within SVG\n  static deselectItem() {\n    // previously \"selected\" elements\n    const selected = document.querySelectorAll('[data-svg-selected=\"true\"]');\n    // unselect them\n    for (let i = 0; i < selected.length; i += 1) {\n      selected[i].setAttribute('data-svg-selected', 'false');\n    }\n  }\n\n  // Remove element from within SVG\n  // [data-svg-selected=\"true\"] marks selected element in SVG\n  static removeItem(isRadial, element = '[data-svg-selected=\"true\"]') {\n    let $element = document.querySelector(element);\n    let nodeName = $element.nodeName;\n    const $parent = $element.parentElement; // for <foreignObject>\n\n    // TEXTAREA => text field(right click in textarea)\n    // DIV => text field(click in radial menu) or circle\n    switch (nodeName) {\n      case 'path':\n        // $element = $element;\n        break;\n      case 'TEXTAREA':\n        // $element = $element;\n        break;\n      case 'DIV':\n        if ($parent.childNodes[1]) {\n          $element = $parent.childNodes[1];\n        } else {\n          $element = $parent;\n        }\n        nodeName = $element.nodeName;\n        break;\n      default:\n        console.log('Nondefinated node type. :(', nodeName);\n    }\n\n    // get svg id from object id\n    const svgID = $element.id.split('_')[0];\n\n    // dispatch event that svg has changed\n    __dispatchEvent(document, 'svg.change', {}, {\n      svg: {\n        id: svgID,\n        task: 'remove',\n        node: $element,\n        nodeName,\n        contextMenu: isRadial,\n      },\n    });\n\n    if ($parent.nodeName === 'foreignObject') {\n      d3.select($parent).remove();\n\n      // dispatch event that drop item was deleted\n      const idParts = $parent.id.split('_');\n      if (idParts[idParts.length - 1] === 'dropItem') {\n        __dispatchEvent(document, 'svg.drop.delete', {}, {\n          item: {\n            id: idParts[1],\n            $object: $element.firstChild,\n          },\n        });\n      }\n    } else {\n      d3.select($element).remove();\n    }\n  }\n\n  // Unmark all SVGs with 'svg-active' classname\n  static deactivate() {\n    const allActiveSvgs = document.querySelectorAll('[data-svg-active=\"true\"]');\n    for (let i = 0; i < allActiveSvgs.length; i += 1) {\n      allActiveSvgs[i].setAttribute('data-svg-active', 'false');\n    }\n  }\n\n  // Mark active SVG with 'svg-active' classname\n  static activate(svg) {\n    SVG.deactivate();\n    svg.setAttribute('data-svg-active', 'true');\n  }\n\n  // Remove connection between clone and template\n  // Remove third part of id if exists\n  static removeCloneConnectionManager($node) {\n    const idParts = $node.id.split('_');\n    if (idParts[idParts.length - 1].includes('clone')) {\n      idParts.pop();\n      $node.id = idParts.join('_');\n      return true;\n    }\n    return false;\n  }\n}\n","import Component from './component';\nimport AudioPlayer from './media/audio-player';\nimport SVG from './svg';\nimport { stopPlayingVideoPlayers } from './media/media';\nimport { __dispatchEvent } from '../lib/utils';\n\nexport default class Sortable extends Component {\n  constructor($element) {\n    super($element);\n    this.$settings = document.querySelector(\n      `[data-sortable-id-reference=\"${this.target.id}\"]`,\n    );\n    this.feedback = JSON.parse(\n      this.$settings.getAttribute('data-module-zpetnavazba'),\n    );\n    this.$container = this.target;\n    this.$items = this.target.querySelectorAll('[data-sortable-drag]');\n    this.$droppables = this.target.querySelectorAll('[data-sortable-drop]');\n    this.$placeholder = () => document.querySelector('#sortable-placeholder');\n    this.$players = this.$container.querySelectorAll('[data-player-audio]');\n    this.$inheritors = document.querySelectorAll(\n      `[data-sortable-inheritor=${this.target.id}]`,\n    );\n    this.inheritors = [];\n    this.order = [];\n\n    // get direction (type of sortable \"horizontalni\" or \"vertikalni\")\n    this.direction = this.target.getAttribute('data-sortable-target');\n    this.trackingTouch = false;\n    this.before = false;\n    this.after = false;\n    this.evaluation = undefined;\n\n    this.mouse = {\n      x: (event) => event.clientX || event.touches[0].clientX,\n      y: (event) => event.clientY || event.touches[0].clientY,\n      x0: 0,\n      y0: 0,\n      x1: 0,\n      y1: 0,\n    };\n\n    this.dragged = {\n      el: null,\n      clone: null,\n      posRel: {},\n      rect: () => this.dragged.el.getBoundingClientRect(),\n      size: {},\n      type: null,\n    };\n\n    this.siblings = {\n      prev: null,\n      next: null,\n    };\n\n    this._onStart = this._onStart.bind(this);\n    this._onMove = this._onMove.bind(this);\n    this._onEnd = this._onEnd.bind(this);\n    this._update = this._update.bind(this);\n\n    this._setupInitialOrder();\n    this._setupInheritors();\n    this._addEventListeners();\n\n    this.cache = {\n      colors: []\n    };\n\n    // get colors for all feedback variants\n    if (this.feedback) {\n      this.cache.colors = this.feedback.map(feedback => feedback.barva);\n    }\n  }\n\n  _onStart(event) {\n    if (!event.target.hasAttribute('data-sortable-drag')) {\n      return;\n    }\n\n    // TODO: zastavit všechno audio on drag start\n    if (this.$players.length > 0) {\n      stopPlayingVideoPlayers(this.$players);\n    }\n\n    this.trackingTouch = true;\n\n    this.dragged.el = event.target;\n    this.dragged.type = event.target.getAttribute('data-sortable-drag');\n    this.dragged.clone = this.dragged.el.cloneNode(true);\n    this.dragged.posRel.top = this.dragged.el.offsetTop;\n    this.dragged.posRel.left = this.dragged.el.offsetLeft;\n    this.dragged.size.width = this.dragged.el.offsetWidth;\n    this.dragged.size.height = this.dragged.el.offsetHeight;\n\n    this.dragged.el.style.top = `${this.dragged.posRel.top}px`;\n    this.dragged.el.style.left = `${this.dragged.posRel.left}px`;\n    this.dragged.el.style.width = `${this.dragged.size.width}px`;\n    this.dragged.el.style.height = `${this.dragged.size.height}px`;\n    this.dragged.el.classList.add('is-dragged');\n\n    this.$container.classList.add('is-dragged');\n\n    this._addPlaceholder(this.dragged.el);\n    this._onOver();\n\n    this.mouse.x0 = this.mouse.x(event);\n    this.mouse.y0 = this.mouse.y(event);\n\n    event.preventDefault();\n  }\n\n  _onMove(event) {\n    if (!this.trackingTouch) {\n      return;\n    }\n\n    this.mouse.x1 = this.mouse.x(event) - this.mouse.x0;\n    this.mouse.y1 = this.mouse.y(event) - this.mouse.y0;\n\n    window.requestAnimationFrame(this._update);\n\n    this._onOver();\n  }\n\n  _onEnd(event) {\n    if (!this.trackingTouch) {\n      return;\n    }\n\n    this.trackingTouch = false;\n    this.$container.classList.remove('is-dragged');\n    this.dragged.el.classList.remove('is-dragged');\n    this.dragged.el.style.top = '';\n    this.dragged.el.style.left = '';\n    this.dragged.el.style.width = '';\n    this.dragged.el.style.height = '';\n    this.dragged.el.style.transform = '';\n\n    const $placeholder = this.$placeholder();\n    const rect = $placeholder.getBoundingClientRect();\n\n    switch (this.direction) {\n      case 'horizontal':\n        if (rect.left <= this.mouse.x(event) <= rect.right) {\n          this._onDrop();\n        }\n        break;\n      case 'vertical':\n        if (rect.top <= this.mouse.y(event) <= rect.bottom) {\n          this._onDrop();\n        }\n        break;\n\n      default:\n        break;\n    }\n\n    this._removePlaceholder();\n    this._updateOrder();\n    this._updateOrderInInheritors();\n    this._dispatchEvent();\n    this._checkAndResolveFeedback();\n  }\n\n  // _onEnter() {}\n\n  _onOver() {\n    this.before = false;\n    this.after = false;\n\n    this._getReference();\n\n    if (\n      this.siblings.next\n      && this.siblings.next.hasAttribute('data-sortable-drop')\n    ) {\n      const next = this.siblings.next.getBoundingClientRect();\n\n      switch (this.direction) {\n        case 'horizontal':\n          if (this.dragged.rect().right > next.left + next.width / 1.5) {\n            this.after = true;\n            this._addPlaceholder(this.siblings.next);\n          }\n          break;\n        case 'vertical':\n          if (this.dragged.rect().bottom > next.top + next.height / 1.5) {\n            this.after = true;\n            this._addPlaceholder(this.siblings.next);\n          }\n          break;\n\n        default:\n          break;\n      }\n    }\n\n    if (\n      this.siblings.prev\n      && this.siblings.prev.hasAttribute('data-sortable-drop')\n    ) {\n      const prev = this.siblings.prev.getBoundingClientRect();\n\n      switch (this.direction) {\n        case 'horizontal':\n          if (this.dragged.rect().left < prev.right - prev.width / 1.5) {\n            this.before = true;\n            this._addPlaceholder(this.siblings.prev);\n          }\n          break;\n        case 'vertical':\n          if (this.dragged.rect().top < prev.bottom - prev.height / 1.5) {\n            this.before = true;\n            this._addPlaceholder(this.siblings.prev);\n          }\n          break;\n\n        default:\n          break;\n      }\n    }\n  }\n\n  // _onLeave() {}\n\n  _onDrop() {\n    const $placeholder = this.$placeholder();\n\n    this._addEventListenerToItem(this.dragged.clone);\n    // TODO: přiřadit eventListenery audio playerům\n    if (this.dragged.clone.querySelector('[data-player-audio]')) {\n      AudioPlayer.addEventListeners(this.dragged.clone, this.showFeedback);\n    }\n\n    this.$container.insertBefore(this.dragged.clone, $placeholder);\n    this.dragged.el.parentElement.removeChild(this.dragged.el);\n  }\n\n  _update() {\n    this.dragged.el.style.transform = `translate3d(${this.mouse.x1}px, ${this.mouse.y1}px, 0) rotate(5deg)`;\n  }\n\n  _addPlaceholder(item) {\n    this._removePlaceholder();\n\n    const $placeholder = document.createElement('div');\n    $placeholder.classList.add('sortable-item', 'sortable-placeholder');\n    $placeholder.setAttribute('id', 'sortable-placeholder');\n    $placeholder.style.minHeight = `${this.dragged.size.height}px`;\n\n    if (this.dragged.el.querySelector('img')) {\n      const src = this.dragged.el.querySelector('img').getAttribute('src');\n      const img = document.createElement('img');\n      img.setAttribute('src', src);\n      $placeholder.appendChild(img);\n    }\n\n    if (this.after) {\n      this.$container.insertBefore($placeholder, item.nextElementSibling);\n    } else if (this.before) {\n      this.$container.insertBefore($placeholder, item);\n    } else {\n      this.$container.insertBefore($placeholder, item);\n    }\n  }\n\n  _removePlaceholder() {\n    const $placeholder = this.$placeholder();\n    if ($placeholder) $placeholder.parentElement.removeChild($placeholder);\n  }\n\n  _getReference() {\n    const $placeholder = this.$placeholder();\n    this.siblings.prev =\n      $placeholder.previousElementSibling === this.dragged.el\n        ? this.dragged.el.previousElementSibling\n        : $placeholder.previousElementSibling;\n    this.siblings.next =\n      $placeholder.nextElementSibling === this.dragged.el\n        ? this.dragged.el.nextElementSibling\n        : $placeholder.nextElementSibling;\n  }\n\n  _addEventListenerToItem($item) {\n    // touch events\n    $item.addEventListener('touchstart', this._onStart, false);\n    // mouse events\n    $item.addEventListener('mousedown', this._onStart, false);\n\n    if (this.dragged.type === 'svg') {\n      const svg = new SVG($item.querySelector('[data-svg-target]'));\n    }\n  }\n\n  _addEventListeners() {\n    // touch events\n    document.addEventListener('touchmove', this._onMove);\n    document.addEventListener('touchend', this._onEnd);\n    // mouse events\n    document.addEventListener('mousemove', this._onMove);\n    document.addEventListener('mouseup', this._onEnd);\n\n    this.$items.forEach(($item) => {\n      this._addEventListenerToItem($item);\n    });\n  }\n\n  // Methods for check if the array is sorted or not\n  // Return True: array is in the right state, False: array is NOT in the right state\n  // Array looks like: [1,2,3,4]\n  // eslint-disable-next-line class-methods-use-this\n  checkIfTheArrayIsGood(array) {\n    // condition for function some(), return if there is item in array which is not in right position\n    const elementInWrongPosition = (element, index) => index !== (element - 1);\n    // all has to be negate, to return the right condition (true: sorted, false:not sorted)\n    return !array.some(elementInWrongPosition);\n  }\n\n  // Method which check how many steps needs to be done to sort array\n  // Return: 0 -> 0 steps, array is sorted\n  //        1 -> 1 steps is needed for sort the array\n  //        2 -> 2 and more steps is needed for sort the array\n  // Array looks like: [1,2,3,4]\n  oneMove(array) {\n    if (this.checkIfTheArrayIsGood(array)) return 0; // Check if the array is sorted\n    for (let i = 0; i < array.length; i += 1) {\n      if (array[i] !== i + 1) {\n        const changedArray = [...array];\n        const element = changedArray[i];\n        changedArray.splice(i, 1);\n        changedArray.splice(element - 1, 0, element);\n\n        if (this.checkIfTheArrayIsGood(changedArray)) return 1; // Check if the array after 1 step is sorted\n      }\n    }\n    return 2; // In every other results the array needs more than 2 steps to be sorted\n  }\n\n  // After interaction with modul razeni this method is called to resolve a feedback button\n  _checkAndResolveFeedback() {\n    if (this.feedback) {\n      // Get the array of items (gets only their correct position - in int), example -> [1,3,4,2]\n      const arrayOfItems = [\n        ...this.target.querySelectorAll('[data-sortable-drag]'),\n      ].map((item) => parseInt(item.dataset.sortableSpravnaodpoved, 10));\n\n      // variable to map a feedback which is got from condition in JSON\n      let feedbackResult = 0;\n\n      // Check if the zpetnaVazba is 2 or 3 conditional\n      if (this.feedback.length === 2) {\n        if (!this.checkIfTheArrayIsGood(arrayOfItems)) {\n          feedbackResult = 1;\n        }\n      }\n      else {\n        feedbackResult = this.oneMove(arrayOfItems);\n      }\n\n      // map feedback via feedbackResult\n      const feedbackActual = this.feedback.find((feedback) => feedback.podminka === feedbackResult);\n\n      this.$buttonFeedback.classList.remove(...this.cache.colors);\n      this.$buttonFeedback.classList.add(feedbackActual.barva);\n      this.$buttonFeedbackText.innerText = feedbackActual.text;\n      this.evaluation = feedbackActual.splneno;\n    }\n    this.showFeedback();\n  }\n\n  _setupInitialOrder() {\n    this._updateOrder();\n  }\n\n  _setupInheritors() {\n    if (this.$inheritors.length > 0) {\n      this.inheritors = Array.from(this.$inheritors).map(($inheritor) => ({\n        $inheritor,\n        $container: $inheritor.querySelector('[data-sortable-inheritor-item]')\n          .parentElement,\n      }));\n    }\n  }\n\n  _updateOrder() {\n    this.order = Array.from(\n      this.target.querySelectorAll('[data-sortable-drag]'),\n    ).map(($item) => ({ id: parseInt($item.dataset.sortableIndex, 10) }));\n  }\n\n  _updateOrderInInheritors() {\n    if (this.$inheritors.length > 0) {\n      this.inheritors.forEach((inheritor) => {\n        this.order.forEach((item) => {\n          inheritor.$container.appendChild(\n            inheritor.$container.querySelector(\n              `[data-sortable-inheritor-item=\"${item.id}\"]`,\n            ),\n          );\n        });\n      });\n    }\n  }\n\n  _dispatchEvent() {\n    __dispatchEvent(\n      this.target,\n      'sortable.change',\n      {},\n      {\n        id: this.target.id,\n        evaluation: this.evaluation,\n        order: this.order,\n      },\n    );\n  }\n}\n","/* eslint-disable brace-style */\nimport {\n  __addClass,\n  __removeClass,\n  __hasClass,\n  __localPosition,\n  __globalPosition,\n  __dispatchEvent,\n} from '../../lib/utils';\nimport SVG from '../svg';\nimport SVGText from './svg-text';\n\nexport default class SVGRadialMenu {\n\n  constructor($radialMenu, $svgs) {\n    this.$radialMenu = $radialMenu;\n    this.$radialMenuItems = this.$radialMenu.querySelectorAll('[data-radial-menu-item]');\n    this.$colorItems = this.$radialMenu.querySelectorAll('.radial-menu-color');\n    this.$textItems = this.$radialMenu.querySelectorAll('.radial-menu-text');\n    this.$createTextItem = this.$radialMenu.querySelector('#create-text');\n    this.$removeItem = this.$radialMenu.querySelector('#remove-content');\n    this.$tooltip = this.$radialMenu.querySelector('[data-radial-menu-tooltip]');\n    this.$svgs = $svgs;\n\n    this.initialSetUp = true;\n\n    this.menuRadius = parseInt(window.getComputedStyle(this.$radialMenu.querySelector('.radial-menu-wrapper'), null).getPropertyValue('width'), 10) / 2;\n    this.itemRadius = parseInt(window.getComputedStyle(this.$radialMenu.querySelector('.radial-menu-item'), null).getPropertyValue('width'), 10) / 2;\n\n    this.init();\n  }\n\n  init() {\n    this.setUpRadialMenuItems();\n    this.addEventListenersToRadialMenu();\n\n    // activate radial menu when right click on svg\n    this.$svgs.forEach(($svg) => {\n      //define functions\n      const svgSpecificActions = $svg.getAttribute('data-svg-target').split(' ');\n      const colors = $svg.getAttribute('data-svg-colors');\n      const svgSpecificColor = colors ? colors.split(' ') : undefined;\n      const hasText = svgSpecificActions.includes('text');\n      const hasMoreColors = (svgSpecificColor && svgSpecificColor.length > 1) || !colors;\n\n      d3.select($svg).on('contextmenu', () => {\n        // mark this SVG as the active one\n        SVG.activate($svg);\n        // deselect all previously selected items\n        SVG.deselectItem();\n        // show radial menu buttons based on clicked element\n        // and .select appropriate elements based on clicked element\n        this.filterMenuButtons(d3.event.target, hasText, hasMoreColors);\n        this.showRadialMenu($svg, d3.event);\n        // prevent default 'contextmenu' event\n        d3.event.preventDefault();\n      });\n    });\n\n    this.initialSetUp = false;\n  }\n\n  setUpRadialMenuItems() {\n    // this.positionRadialMenuItems(this.$radialMenuItems);\n\n    this.$radialMenuItems.forEach(($item) => {\n      this.addEventListenersToRadialMenuItem($item);\n    });\n  }\n\n  positionRadialMenuItems($items) {\n    const _itemsLength = $items.length;\n    const _menuRadius = this.menuRadius;\n    const _itemRadius = this.itemRadius;\n    const _menuOffset = _menuRadius - _itemRadius;\n    const _interval = 0.6283185307;\n    // if more items center them\n    const _centerOffset = (-_interval / 2) + ((_itemsLength * _interval) / 2);\n\n    // make a \"flower\"\n    $items.forEach(($item, index) => {\n      // Calculate the angle at which the element will be placed.\n      // For a semicircle, we would use (index / _itemsLength) * Math.PI.\n      const angle = (Math.PI + ((index * _interval) * -1)) + _centerOffset;\n\n      // get position\n      const x = (_menuRadius * Math.sin(angle)) + _menuOffset;\n      const y = (_menuRadius * Math.cos(angle)) + _menuOffset;\n\n      // console.log('x: ' + x);\n      // console.log('y: ' + y);\n\n      $item.style.left = `${x.toFixed(1)}px`;\n      $item.style.top = `${y.toFixed(1)}px`;\n\n      // if (this.initialSetUp === true) {\n      //   this.addEventListenersToRadialMenuItem($item);\n      // }\n    });\n  }\n\n  addEventListenersToRadialMenu() {\n    this.onMouseLeave();\n\n    this.$radialMenu.addEventListener('click', (event) => {\n      this.hideRadialMenu(this.$radialMenu);\n      event.preventDefault();\n    });\n\n    this.$radialMenu.addEventListener('contextmenu', (event) => {\n      this.hideRadialMenu(this.$radialMenu);\n      event.preventDefault();\n    });\n  }\n\n  addEventListenersToRadialMenuItem(item) {\n    const $item = item;\n\n    // actions\n    const action = $item.getAttribute('data-radial-menu-item');\n    // remove item\n    if (action === 'remove-content') {\n      $item.addEventListener('click', () => {\n        SVG.removeItem(true);\n        this.hideRadialMenu();\n      }, false);\n    }\n    // create user text\n    else if (action === 'create-text') {\n      d3.select($item).on('click', () => {\n        SVGText.createText();\n        this.hideRadialMenu();\n      }, false);\n    }\n    // označit podobnost\n    else if (action === 'color-point-blue') {\n      $item.addEventListener('click', () => {\n        SVGRadialMenu.changeColor('blue');\n        this.hideRadialMenu();\n      }, false);\n    }\n    // označit rozdil\n    else if (action === 'color-point-red') {\n      $item.addEventListener('click', () => {\n        SVGRadialMenu.changeColor('red');\n        this.hideRadialMenu();\n      }, false);\n    }\n    // označit rozdil\n    else if (action === 'color-point-red') {\n      $item.addEventListener('click', () => {\n        SVGRadialMenu.changeColor('red');\n        this.hideRadialMenu();\n      }, false);\n    }\n    // přiřadit kategorii\n    // else if (action === 'category') {\n    //   const category = $item.getAttribute('data-category');\n    //   const categoryLabel = $item.getAttribute('data-radial-menu-item-tooltip');\n\n    //   $item.addEventListener('click', () => {\n    //     const $selected = document.querySelector('[data-svg-selected=\"true\"]');\n    //     const $parentForeignObject = $selected.parentElement;\n    //     let $category = $parentForeignObject.querySelector('.svg-category-label');\n\n    //     $selected.setAttribute('data-svg-category', category);\n\n    //     if (!$category) {\n    //       $category = document.createElement('div');\n    //       $category.classList.add('svg-category-label');\n    //       $parentForeignObject.prepend($category);\n    //     }\n\n    //     $category.innerText = categoryLabel;\n\n    //     this.hideRadialMenu();\n    //   }, false);\n    // }\n\n    // tooltip\n    $item.addEventListener('mouseenter', (event) => {\n      this.$tooltip.innerHTML = event.currentTarget.getAttribute('data-radial-menu-item-tooltip');\n      this.$tooltip.style.display = 'block';\n    }, false);\n    $item.addEventListener('mouseleave', () => {\n      this.$tooltip.innerHTML = '';\n      this.$tooltip.style.display = 'none';\n    }, false);\n  }\n\n  // Draw a SVG circle on click\n  static changeColor(color, element = '[data-svg-selected=\"true\"]') {\n    let $element = document.querySelector(element);\n    let nodeName = $element.nodeName;\n    let taskType = 'color';\n\n    __removeClass($element, 'red blue');\n    __addClass($element, color);\n\n    // DIV => text field  or circle\n    switch (nodeName) {\n      case 'path':\n        // $element = $element;\n        break;\n      case 'DIV':\n        if ($element.parentElement.childNodes[1]) {\n          $element = $element.parentElement.childNodes[1];\n        } else {\n          $element = $element.parentElement;\n        }\n        nodeName = $element.nodeName;\n        break;\n      default:\n        console.log('Nondefinated node type. :(', nodeName);\n    }\n\n    // if clone is changed, then dispatch create event\n    if (SVG.removeCloneConnectionManager($element)) taskType = 'create';\n\n    // get svg id from object id\n    const svgID = $element.id.split('_')[0];\n\n    // dispatch event that svg has changed\n    __dispatchEvent(document, 'svg.change', {}, {\n      svg: {\n        id: svgID,\n        task: taskType,\n        node: $element,\n        nodeName,\n        contextMenu: true,\n        color,\n      },\n    });\n  }\n\n  showRadialMenu($activeSVG, event) {\n    const $svg = $activeSVG || document.querySelector('[data-svg-active=\"true\"]');\n    // get global position of the right click event\n    const globalPosition = __globalPosition(event);\n    const localPosition = __localPosition($svg);\n    this.$radialMenu.setAttribute('data-local-x', localPosition.x);\n    this.$radialMenu.setAttribute('data-local-y', localPosition.y);\n    // set position of radial menu\n    // number of 13 is size of #radial-menu\n    this.$radialMenu.style.top = `${globalPosition.y - 7}px`;\n    this.$radialMenu.style.left = `${globalPosition.x - 7}px`;\n\n    // make a flower\n    const $activeRadialMenuItem = this.$radialMenu.querySelectorAll('.is-active');\n    this.positionRadialMenuItems($activeRadialMenuItem);\n\n    // show radial menu\n    __addClass(this.$radialMenu, 'is-active');\n\n    // return {\n    //   localPosition,\n    //   globalPosition,\n    // };\n  }\n\n  hideRadialMenu() {\n    // hide radial menu\n    __removeClass(this.$radialMenu, 'is-active');\n    // deactivate all SVGs\n    SVG.deactivate();\n    // deselect all SVG items\n    SVG.deselectItem();\n\n    // deactivate radial menu items when the menu is hidden\n    setTimeout(() => {\n      if (!__hasClass(this.$radialMenu, 'is-active')) {\n        this.$radialMenuItems.forEach(($item) => {\n          __removeClass($item, 'is-active');\n        });\n      }\n    }, 150);\n  }\n\n  onMouseLeave() {\n    let mouseLeaveDelay;\n\n    this.$radialMenu.addEventListener('mouseleave', () => {\n      mouseLeaveDelay = setTimeout(() => {\n        this.hideRadialMenu(this.$radialMenu);\n      }, 500);\n    });\n\n    this.$radialMenu.addEventListener('mouseenter', () => {\n      clearTimeout(mouseLeaveDelay);\n    });\n  }\n\n  filterMenuButtons(clickedItem, hasText, hasMoreColors) {\n    if (__hasClass(clickedItem, 'svg-path') || clickedItem.nodeName === 'path') {\n      if (hasText) {\n        __addClass(this.$createTextItem, 'is-active');\n      } else {\n        __removeClass(this.$createTextItem, 'is-active');\n      }\n      // __addClass(this.$removeItem, 'is-active');\n\n      if (hasMoreColors) {\n        this.$colorItems.forEach(($colorItem) => {\n          __addClass($colorItem, 'is-active');\n        });\n      }\n\n      this.$textItems.forEach(($textItem) => {\n        __removeClass($textItem, 'is-active');\n      });\n\n      // mark it as slected\n      // SVG.selectItem(clickedItem);\n    }\n    if (__hasClass(clickedItem, 'svg-circle')) {\n      if (hasText) {\n        __addClass(this.$createTextItem, 'is-active');\n      } else {\n        __removeClass(this.$createTextItem, 'is-active');\n      }\n      // __addClass(this.$removeItem, 'is-active');\n\n      if (hasMoreColors) {\n        this.$colorItems.forEach(($colorItem) => {\n          __addClass($colorItem, 'is-active');\n        });\n      }\n\n      this.$textItems.forEach(($textItem) => {\n        __removeClass($textItem, 'is-active');\n      });\n\n      // mark it as slected\n      // SVG.selectItem(clickedItem);\n    }\n    if (__hasClass(clickedItem, 'svg-textarea')) {\n      __removeClass(this.$createTextItem, 'is-active');\n      // __addClass(this.$removeItem, 'is-active');\n\n      if (!__hasClass(clickedItem, 'do-not-remove')) {\n        this.$colorItems.forEach(($colorItem) => {\n          __removeClass($colorItem, 'is-active');\n        });\n\n        this.$textItems.forEach(($textItem) => {\n          __addClass($textItem, 'is-active');\n        });\n      }\n\n      // mark it as slected\n      // SVG.selectItem(clickedItem);\n    }\n    if (clickedItem.nodeName === 'image') {\n      if (hasText) {\n        __addClass(this.$createTextItem, 'is-active');\n      } else {\n        __removeClass(this.$createTextItem, 'is-active');\n      }\n\n      __removeClass(this.$removeItem, 'is-active');\n\n      this.$colorItems.forEach(($colorItem) => {\n        __removeClass($colorItem, 'is-active');\n      });\n\n      this.$textItems.forEach(($textItem) => {\n        __removeClass($textItem, 'is-active');\n      });\n    }\n    else {\n      if (__hasClass(clickedItem, 'do-not-remove')) {\n        __removeClass(this.$removeItem, 'is-active');\n      } else {\n        if (hasText) {\n          __addClass(this.$createTextItem, 'is-active');\n        } else {\n          __removeClass(this.$createTextItem, 'is-active');\n        }\n        __addClass(this.$removeItem, 'is-active');\n      }\n      // mark it as slected\n      SVG.selectItem(clickedItem);\n    }\n  }\n}\n","import {\n  __mergeDeep,\n  __hasClass,\n  __addClass,\n  __removeClass,\n  __position,\n  __positionTranslated,\n  __remove,\n  __getRealDimensions,\n  __insertBefore,\n  __keycodeIsPrintableCharacter,\n  __toggleClass,\n  __dispatchEvent,\n} from '../../lib/utils';\nimport Component from '../component';\n\n\nexport default class Editor extends Component {\n\n  constructor($element) {\n    super($element);\n\n    // TODO: should extend default Component class and use this.target?\n    // this.$editor is better, more readable\n    this.$editor = this.target;\n    this.id = this.$editor.id;\n    // TODO: is DOM element before/after the editor itself.. move it to the editor?\n    this.settings = JSON.parse(document.querySelector(`[data-editor-id-reference=\"${this.id}\"]`).getAttribute('data-module-settings'));\n\n    this.opts = __mergeDeep(Editor.defaults, this.settings);\n\n    this.models = {\n      passive: [\n        'cteni',\n      ],\n      interactive: [\n        'predznaceny', 'zvyraznovani', 'komentáře', 'psani',\n      ],\n      withMenu: [\n        'predznaceny', 'zvyraznovani', 'komentáře',\n      ],\n    };\n\n    this.totalTagId = 0;\n\n    this.hasMenu = true;\n\n    this.selection = null;\n    this.lastSelectionSettings = {};\n    this.isCollapsed = null;\n    this.savedSelectionRange = null;\n    this.selectionAttributes = null;\n    this.dummyRangeElement = null;\n\n    this.selectionMouseDown = false;\n    this.selectionDirection = null;\n\n    this.hasEditableContentChanged = false;\n    this.lastPressedKey = null;\n\n    this.hasToolbar = false;\n    this.toolbar = {};\n\n    this.originalContent = {};\n    this.currentContent = {};\n\n    this._handlers = [];\n\n    this.wrapLastDeletesTimeoutClass = '';\n    this.wrapLastDeletesTimeoutFunction = () => { };\n    this.wrapLastAdditionsTimeoutClass = '';\n    this.wrapLastAdditionsTimeoutFunction = () => { };\n    this.isWrappingLastText = false;\n    this.isWriting = false;\n\n    this.$groupDeleted = null;\n\n    this.cache = {\n      body: document.body,\n      window,\n    };\n\n    this.init();\n  }\n\n  init() {\n    if (Editor._hasMenu(this.opts)) {\n      try {\n        this.$menu = this.$editor.querySelector(`.${this.opts.menuClass}`);\n\n        // TODO: generalize .item class via defaults and opts\n        this.$menuActions = this.$menu.querySelector('.menu').querySelectorAll('.menu-item');\n        this.$menuClose = this.$menu.querySelector('.close');\n      } catch (error) {\n        this.hasMenu = false;\n      }\n    } else {\n      this.hasMenu = false;\n    }\n\n    if (Editor._hasToolbar(this.opts)) {\n      this.hasToolbar = true;\n    }\n\n    this.$canvas = this.$editor.querySelector(`.${this.opts.canvasClass}`);\n\n    // only if the editor is INTERACTIVE\n    if (this.opts.funkce !== 'cteni') {\n      __addClass(this.$menu, 'hidden');\n\n      // only if the editor is for WRITING\n      if (this.opts.funkce === 'psani') {\n        this.originalContent.html = this.$canvas.innerHTML;\n        this.originalContent.text = this.$canvas.innerText;\n        this.currentContent.html = this.$canvas.innerHTML;\n        this.currentContent.text = this.$canvas.innerText;\n\n        this.wrapLastDeletesTimeoutClass = this._generateNewTagGroupClass();\n        this.wrapLastAdditionsTimeoutClass = this._generateNewTagGroupClass();\n      }\n\n      // only if the editor is with extra TOOLBAR\n      if (this.hasToolbar) {\n        this.toolbar.$element = this.$editor.querySelector('.editor-toolbar');\n        this.toolbar.$btnReset = this.toolbar.$element.querySelector('.editor-toolbar-action-reset');\n      }\n\n      this.registerEditableHandlers();\n    }\n\n    // only if the editor is with PREHIGHLIGHTED text\n    if (this.opts.funkce === 'predznaceny') {\n      this.initPreHighlightedTextOptions();\n    }\n\n  }\n\n  _generateNewTagId() {\n    this.totalTagId = this.totalTagId + 1;\n    return `${this.id}-${this.totalTagId}`;\n  }\n\n  _generateNewTagGroupClass() {\n    this.totalTagId = this.totalTagId + 1;\n    return `group-${this.id}-${this.totalTagId}`;\n  }\n\n  // add all eventListeners\n  // TODO: separate special case from universal ones?\n  registerEditableHandlers() {\n\n    this.$canvas.addEventListener('mousedown', this.handlerFocus.bind(this), false);\n    this.$canvas.addEventListener('focusout ', this.handlerFocus.bind(this), false);\n\n    // Necessary when mouseup is outside the $canvas element\n    // therefore we have to capture the event outside the element through body element\n    this.cache.body.addEventListener('mouseup', this.handlerFocus.bind(this), false);\n\n\n    if (this.opts.funkce === 'psani') {\n\n      this.$canvas.addEventListener('keydown', (e) => {\n\n        const selection = window.getSelection();\n        const keyCode = e.which || e.keyCode;\n        let keyName = e.key;\n\n        // show OK button or feedback\n        this.showFeedback();\n\n        // start DELETE\n        if (keyName === 'Backspace' || keyName === 'Delete') {\n          if (selection.rangeCount) {\n            window.clearTimeout(this.wrapLastDeletesTimeoutFunction);\n\n            const range = selection.getRangeAt(0);\n            const cloneRange = range.cloneRange();\n\n            if (this.lastSelectionSettings.isCollapsed) {\n\n              try {\n                cloneRange.setStart(range.startContainer, range.startOffset - 1);\n              } catch (e) {\n                // backspace was pressed at the beginning of the node\n                cloneRange.setStart(range.startContainer, range.startOffset);\n                cloneRange.collapse(true);\n              }\n\n            } else {\n              cloneRange.setStart(range.startContainer, range.startOffset);\n\n            }\n\n            cloneRange.setEnd(range.endContainer, range.endOffset);\n\n            // do nothing when it's space\n            const addedFragment = cloneRange.cloneContents();\n            const addedFragmentString = addedFragment.textContent.trim();\n\n            if ((addedFragmentString !== '' && addedFragmentString !== '&nbsp;') || this.isWrappingLastText) {\n\n              const dummyElementInner = document.createElement('span');\n              dummyElementInner.className = `user-removed-text-inner ${this.wrapLastDeletesTimeoutClass}`;\n\n              cloneRange.surroundContents(dummyElementInner);\n\n              selection.removeAllRanges();\n              selection.addRange(range);\n\n              this.wrapLastDeletesTimeoutFunction = setTimeout(() => {\n\n                this.isWrappingLastText = false;\n\n                // wrap all previous deletes to one element\n                const dummyElement = document.createElement('span');\n                dummyElement.contentEditable = false;\n                dummyElement.className = 'user-removed-text';\n\n                const newGeneratedId = this._generateNewTagId();\n                dummyElement.id = newGeneratedId;\n\n                const $elements = document.querySelectorAll(`.${this.wrapLastDeletesTimeoutClass}`);\n\n                __insertBefore(dummyElement, $elements[0]);\n\n                $elements.forEach((el, i) => {\n                  dummyElement.appendChild(el);\n                });\n\n\n                // create close button\n                const $btnClose = document.createElement('span');\n                $btnClose.className = this.opts.closeBtnClass;\n\n                const clickHandler = (e) => {\n                  const $nodeElement = e.currentTarget.parentNode;\n                  this._removeNodeKeepTextContent($nodeElement);\n                  e.stopPropagation();\n                };\n\n                $btnClose.addEventListener('click', clickHandler.bind(this));\n\n                document.getElementById(newGeneratedId).appendChild($btnClose);\n\n                this.wrapLastDeletesTimeout = true;\n                this.wrapLastDeletesTimeoutClass = this._generateNewTagGroupClass();\n\n              }, 700);\n\n              this.isWrappingLastText = true;\n\n              e.preventDefault();\n\n            } else {\n\n              if (!this.isWrappingLastText) {\n                // we're removing spaces, do nothing use browser's default behaviour, unless the wrapping is going on\n                return;\n              }\n              e.preventDefault();\n            }\n          }\n        }\n        // end DELETE\n\n        // start WRITING\n        else if (__keycodeIsPrintableCharacter(keyCode)) {\n\n          // if nothing is selected (selection is empty)\n          if (this.lastSelectionSettings.isCollapsed) {\n\n            // if \"space\" was written\n            if (keyCode === 32) {\n              if (!this.isWrappingLastText) {\n                // we're adding spaces, do nothing use browser's default behaviour, unless the wrapping is going on\n                return;\n              }\n              // fill a space as the keyname for the spacebar\n              keyName = ' ';\n            }\n\n            // The Selection.rangeCount read-only property returns the number of ranges in the selection.\n            if (selection.rangeCount) {\n\n              window.clearTimeout(this.wrapLastAdditionsTimeoutFunction);\n\n              const range = selection.getRangeAt(0);\n              const cloneRange = range.cloneRange();\n\n              cloneRange.setStart(range.startContainer, range.startOffset);\n              cloneRange.setEnd(range.endContainer, range.endOffset);\n\n              const textToAddElement = document.createElement('span');\n              textToAddElement.contentEditable = false;\n              textToAddElement.className = `user-inserted-text-inner ${this.wrapLastAdditionsTimeoutClass}`;\n              textToAddElement.innerHTML = keyName;\n\n              cloneRange.insertNode(textToAddElement);\n\n              // move the caret after the inserted character\n              range.setStartAfter(textToAddElement);\n\n              selection.removeAllRanges();\n              selection.addRange(range);\n\n              this.wrapLastAdditionsTimeoutFunction = setTimeout(() => {\n\n                this.isWrappingLastText = false;\n\n                // wrap all previous deletes to one element\n                const dummyElement = document.createElement('span');\n                dummyElement.contentEditable = false;\n                dummyElement.className = 'user-inserted-text';\n\n                const newGeneratedId = this._generateNewTagId();\n                dummyElement.id = newGeneratedId;\n\n                const $elements = document.querySelectorAll(`.${this.wrapLastAdditionsTimeoutClass}`);\n\n                __insertBefore(dummyElement, $elements[0]);\n\n                $elements.forEach((el, i) => {\n                  dummyElement.appendChild(el);\n                });\n\n\n                // create close button\n                const $btnClose = document.createElement('span');\n                $btnClose.className = this.opts.closeBtnClass;\n\n                const clickHandler = (e) => {\n                  const $nodeElement = e.currentTarget.parentNode;\n                  __remove($nodeElement);\n                  e.stopPropagation();\n                };\n\n                $btnClose.addEventListener('click', clickHandler.bind(this));\n                document.getElementById(newGeneratedId).appendChild($btnClose);\n\n                this.wrapLastAdditionsTimeoutClass = this._generateNewTagGroupClass();\n\n              }, 700);\n\n              this.isWrappingLastText = true;\n\n            }\n\n\n            if (this.hasEditableContentChanged === false) {\n              this.hasEditableContentChanged = true;\n            }\n\n            e.preventDefault();\n          }\n\n          // writing over existing text is selected\n          else {\n            window.clearTimeout(this.wrapLastAdditionsTimeoutFunction);\n\n            const range = selection.getRangeAt(0);\n            const cloneRange = range.cloneRange();\n\n            cloneRange.setStart(range.startContainer, range.startOffset);\n            cloneRange.setEnd(range.endContainer, range.endOffset);\n\n            // 1. handle deleting the text that was selected when writing started\n            if (this.isWriting === false && selection.toString().length > 0) {\n              // add deleted text node only for the first time and only if there is some selected text\n              this.$groupDeleted = document.createElement('span');\n              this.$groupDeleted.contentEditable = false;\n              this.$groupDeleted.className = 'user-removed-text';\n\n              const groupDeletedId = this._generateNewTagId();\n              this.$groupDeleted.id = groupDeletedId;\n\n              const $groupInnerDeleted = document.createElement('span');\n              $groupInnerDeleted.className = 'user-removed-text-inner';\n\n              this.$groupDeleted.appendChild($groupInnerDeleted);\n\n              cloneRange.surroundContents(this.$groupDeleted);\n\n              // create close button\n              const $btnClose = document.createElement('span');\n              $btnClose.className = this.opts.closeBtnClass;\n\n              const clickHandler = (e) => {\n                const $nodeElement = e.currentTarget.parentNode;\n                this._removeNodeKeepTextContent($nodeElement);\n                e.stopPropagation();\n              };\n\n              $btnClose.addEventListener('click', clickHandler.bind(this));\n              this.$groupDeleted.appendChild($btnClose);\n            }\n\n\n            // 2. adding new text\n            this.isWriting = true;\n\n            const $groupInnerAdded = document.createElement('span');\n            $groupInnerAdded.contentEditable = false;\n            $groupInnerAdded.className = `user-inserted-text-inner ${this.wrapLastAdditionsTimeoutClass}`;\n\n            // add a space so there is a space between the added and removed text\n            $groupInnerAdded.innerHTML = `${keyName}`;\n\n            // TODO: error after deleted selection\n            __insertBefore($groupInnerAdded, this.$groupDeleted);\n            range.setStartAfter($groupInnerAdded);\n\n            selection.removeAllRanges();\n            selection.addRange(range);\n\n            this.wrapLastAdditionsTimeoutFunction = setTimeout(() => {\n              this.isWriting = false;\n\n              // wrap all previous deletes to one element\n              const $groupAdded = document.createElement('span');\n              $groupAdded.contentEditable = false;\n              $groupAdded.className = 'user-inserted-text';\n\n              const newGeneratedId = this._generateNewTagId();\n              $groupAdded.id = newGeneratedId;\n\n              const $elements = document.querySelectorAll(`.${this.wrapLastAdditionsTimeoutClass}`);\n\n              __insertBefore($groupAdded, $elements[0]);\n\n              $elements.forEach((el, i) => {\n                $groupAdded.appendChild(el);\n              });\n\n              const $btnClose = document.createElement('span');\n              $btnClose.className = this.opts.closeBtnClass;\n\n              const clickHandler = (e) => {\n                const $nodeElement = e.currentTarget.parentNode;\n                __remove($nodeElement);\n                e.stopPropagation();\n              };\n\n              $btnClose.addEventListener('click', clickHandler.bind(this));\n              document.getElementById(newGeneratedId).appendChild($btnClose);\n\n              this.wrapLastAdditionsTimeoutClass = this._generateNewTagGroupClass();\n\n            }, 700);\n\n            e.preventDefault();\n          }\n        }\n        // end WRITING\n      });\n    }\n\n\n    if (this.hasMenu) {\n      this.registerMenuHandler();\n    }\n\n    if (this.hasToolbar) {\n      this.toolbar.$btnReset.addEventListener('click', () => {\n\n        const isConfirmed = confirm('Opravdu chcete vrátit text do původní podoby? Vaše změny se tímto ztratí.');\n\n        if (isConfirmed) {\n          this.$canvas.innerHTML = this.originalContent.html;\n        }\n\n      });\n    }\n\n  }\n\n  registerMenuHandler() {\n    for (let i = 0, len = this.$menuActions.length; i < len; i += 1) {\n      this.$menuActions[i].addEventListener('click', this.handlerMenuActions.bind(this), false);\n    }\n\n    this.$menuClose.addEventListener('click', this.handlerMenuClose.bind(this), false);\n  }\n\n  initPreHighlightedTextOptions() {\n    // Example of data from JSON:\n    //\n    // \"predznaceni\": [\n    //     {\n    //       \"vyraz\": \"Obracíme se na vás\",\n    //       \"data\": {\n    //         \"osoba\": \"my\",\n    //         \"slovesnyZpusob\": \"oznamovací\"\n    //       }\n    //     }\n    //   ]\n    // }\n    //\n    // In PUG, object for every item is injected into `data-text-option` so this JS has access to it\n\n    const dataAttr = 'data-text-option';\n\n    // loop over updated DOM via DOM manipulation\n    this.$textOptionsElements = this.$editor.querySelectorAll(`[${dataAttr}]`);\n    this.$textOptionsElements.forEach(($textOption) => {\n\n      $textOption.addEventListener('click', () => {\n        __toggleClass($textOption, this.opts.textOptions.selectedClass);\n        const idForSend = this.id.replace('editor-', '');\n\n        if (__hasClass($textOption, this.opts.textOptions.selectedClass)) {\n\n          // dispatch event that editor has changed\n          const tagData = JSON.parse($textOption.getAttribute('data-text-option'));\n\n          __dispatchEvent(document, 'editor.change', {}, {\n            text: {\n              id: idForSend,\n              task: 'add',\n              tagData,\n              value: $textOption.cloneNode(true),\n            },\n          });\n        } else {\n          // dispatch event that editor has changed\n          __dispatchEvent(document, 'editor.change', {}, {\n            text: {\n              id: idForSend,\n              task: 'remove',\n              value: $textOption,\n            },\n          });\n        }\n\n        // show OK button or feedback\n        this.showFeedback();\n      });\n\n    });\n\n  }\n\n  toggleMenu(clickClose = false) {\n\n    if (clickClose === true) {\n      __addClass(this.$menu, 'hidden');\n      return;\n    }\n\n    if (this.selectionMouseDown === true) {\n      __addClass(this.$menu, 'hidden');\n      return;\n    }\n\n    if (__hasClass(this.$menu, 'hidden') && this.selectionMouseDown === false) {\n      this._setmenuDimensions();\n      __removeClass(this.$menu, 'hidden');\n    }\n\n  }\n\n  _setmenuDimensions() {\n    const menuDimensions = __getRealDimensions(this.$menu);\n    const parentTranslatedPosition = __positionTranslated(this.$editor);\n    const parentDimensions = __position(this.$editor);\n\n    // let additionalSize = ( this.selectionDirection === \"right\" ) ?\n\n    const isOverflowAt = {\n      right: (this.selectionAttributes.left + this.selectionAttributes.width + menuDimensions.width + this.opts.menuMargin.x) > (parentTranslatedPosition.left + parentDimensions.width),\n      top: (this.selectionAttributes.top - menuDimensions.height - this.opts.menuMargin.y) < (parentTranslatedPosition.top),\n      bottom: (this.selectionAttributes.top + this.selectionAttributes.height + menuDimensions.height + this.opts.menuMargin.y) > (parentTranslatedPosition.top + parentDimensions.height),\n    };\n\n    let leftDimensions;\n    let topDimensions;\n\n    if (isOverflowAt.right) {\n\n      leftDimensions = this.selectionAttributes.left - menuDimensions.width - this.opts.menuMargin.x;\n\n    } else {\n\n      leftDimensions = this.selectionAttributes.left + this.selectionAttributes.width + this.opts.menuMargin.x;\n\n    }\n\n    if (isOverflowAt.top) {\n\n      topDimensions = this.selectionAttributes.top + menuDimensions.height + this.opts.menuMargin.y;\n\n    } else {\n\n      topDimensions = this.selectionAttributes.top - menuDimensions.height - this.opts.menuMargin.y;\n\n    }\n\n    this.$menu.style.left = `${leftDimensions}px`;\n    this.$menu.style.top = `${topDimensions}px`;\n\n  }\n\n  handlerMenuClose(e) {\n\n    this.toggleMenu(true);\n\n    e.preventDefault();\n\n  }\n\n  handlerMenuActions(e) {\n\n    const $el = e.currentTarget;\n    const command = $el.getAttribute('data-command');\n    const commandName = $el.getAttribute('data-command-name');\n\n    /* :TODO: Cache the options for given element to avoid JSON parsing each time */\n    const options = JSON.parse($el.getAttribute('data-command-options'));\n\n    this.setSelection(command, commandName, options);\n\n    e.preventDefault();\n\n  }\n\n  handlerFocus(e) {\n    const isMouseRightClick = e.which === 3;\n\n    if (isMouseRightClick) { return; }\n\n    if (__hasClass(e.target, 'node-close')) { return; }\n\n    if (__hasClass(e.target, 'node-selected')) { return; }\n\n    if (e.type === 'mousedown') {\n\n      // start tracking the mouse down\n      this.selectionMouseDown = true;\n\n      if (this.hasMenu === true) {\n        this.toggleMenu();\n      }\n\n    }\n\n    if (e.type === 'mouseup' && this.selectionMouseDown) {\n\n      // reset saved last selection settings\n      this.lastSelectionSettings = {};\n\n      this.selection = window.getSelection();\n      this.isCollapsed = this.lastSelectionSettings.isCollapsed = this.selection.isCollapsed;\n      this.savedSelectionRange = this.selection.getRangeAt(0);\n\n      this.selectionMouseDown = false;\n\n      this.lastSelectionSettings.anchorOffset = this.selection.anchorOffset;\n      this.lastSelectionSettings.focusOffset = this.selection.focusOffset;\n      this.lastSelectionSettings.text = this.savedSelectionRange.toString();\n\n      /* https://developer.mozilla.org/en-US/docs/Web/API/Selection/isCollapsed */\n      /* Returns a Boolean indicating whether the selection's start and end points are at the same position. */\n      /* display context menu only if the cursor is NOT at the same position */\n      if (this.selection.isCollapsed === false && this.savedSelectionRange.toString().trim() !== '') {\n\n        this.selectionDirection = (this.selection.anchorOffset <= this.selection.focusOffset) ? 'right' : 'left';\n\n        if (this.hasMenu === true) {\n\n          this._setSelectionPosition(); // :TODO: cannot be used in contentEditable editor yet\n\n          this.toggleMenu();\n        }\n\n      }\n\n    }\n\n  }\n\n  _setSelectionPosition() {\n\n    const dummyElement = document.createElement('span');\n    dummyElement.className = 'dummy-range-element';\n\n    this.savedSelectionRange.surroundContents(dummyElement);\n\n    const selectionPosition = __positionTranslated(dummyElement);\n    const selectionDimension = __position(dummyElement);\n\n    this.selectionAttributes = {\n      left: selectionPosition.left,\n      top: selectionPosition.top,\n      width: selectionDimension.width,\n      height: selectionDimension.height,\n    };\n\n    __removeClass(dummyElement, 'dummy-range-element');\n\n    this._removeNodeKeepTextContent(dummyElement);\n\n  }\n\n  _highlightContents($domEl, newTagId) {\n    $domEl.appendChild(this.savedSelectionRange.extractContents());\n    this.savedSelectionRange.insertNode($domEl);\n\n    $domEl.setAttribute('data-tag-id', newTagId);\n  }\n\n  _storeHighlightedContents($domEl, newTagId) {\n    const tagName = $domEl.getAttribute('data-command-name');\n\n    // get tag color\n    const classes = $domEl.getAttribute('class');\n    // const colors = classes.match(/(?<=node-text-)[a-z]*/g);\n    const classesArray = classes.split(' ');\n    let color = '';\n    classesArray.forEach((value) => {\n      if (value.includes('node-text-')) {\n        color = value.replace('node-text-', '');\n      }\n    });\n\n    // dispatch event that editor has changed\n    const idForSend = this.id.replace('editor-', '');\n    __dispatchEvent(document, 'editor.change', {}, {\n      text: {\n        id: idForSend,\n        task: 'add',\n        tagData: { tagName },\n        value: $domEl.cloneNode(true),\n        tagColor: color,\n      },\n    });\n  }\n\n  _removeNodeKeepTextContent(node) {\n    const text = node.textContent;\n    node.parentNode.insertBefore(document.createTextNode(text), node);\n    __remove(node);\n  }\n\n  _createCloseBtnForElement($parentEl, opts = {}) {\n\n    const $elClose = document.createElement('span');\n    $elClose.innerHTML = '×';\n    $elClose.setAttribute('class', opts.class);\n\n    const classesToToggle = opts.toggleClass.split(' ');\n\n\n    const clickHandler = (e) => {\n\n      const $closeBtn = e.currentTarget;\n      const $nodeElement = $closeBtn.parentNode;\n\n      $closeBtn.removeEventListener('click', clickHandler);\n      $nodeElement.removeChild($closeBtn);\n\n      if (undefined !== $nodeElement.commentRef) {\n\n        /* :TODO: temporary way to save the reference to the DOM element */\n        this.$editor.removeChild($nodeElement.commentRef);\n        $nodeElement.commentRef = null;\n\n      }\n\n      this._removeNodeKeepTextContent($nodeElement);\n\n      const tagName = $nodeElement.getAttribute('data-command-name');\n\n      // dispatch event that editor has changed\n      const idForSend = this.id.replace('editor-', '');\n      __dispatchEvent(document, 'editor.change', {}, {\n        text: {\n          id: idForSend,\n          task: 'remove',\n          tagData: { tagName },\n          value: $nodeElement,\n        },\n      });\n\n      e.stopPropagation();\n\n    };\n\n    $elClose.addEventListener('click', clickHandler.bind(this));\n\n    $parentEl.appendChild($elClose);\n\n  }\n\n  _calculateCommentPosition($node) /* : Object */ {\n\n    const nodePosition = __positionTranslated($node);\n\n    return {\n      left: `${nodePosition.left + parseInt($node.offsetWidth, 10) + this.opts.commentMargin.x}px`,\n      top: `${nodePosition.top + this.opts.commentMargin.y}px`,\n    };\n\n  }\n\n  _createCommentForNode($el, opts = {}) {\n\n    const commentTemplate = document.getElementById('comment-template').innerHTML;\n\n    const div = document.createElement('div');\n    div.innerHTML = commentTemplate;\n\n    const commentDiv = div.childNodes[1];\n\n    // attach js reference to the dom element\n    commentDiv.data = {};\n    commentDiv.data.nodeRef = $el;\n\n    const commentNewTextarea = commentDiv.querySelector('.comment-new-text');\n    const commentDivButtonSubmit = commentDiv.querySelector('button');\n    const commentCommentsContainer = commentDiv.querySelector('.comments-container');\n\n    const calculatedCommentPosition = this._calculateCommentPosition($el);\n\n    commentDiv.style.left = calculatedCommentPosition.left;\n    commentDiv.style.top = calculatedCommentPosition.top;\n\n    __addClass(commentDiv, opts.class);\n\n    commentDiv.addEventListener('click', (e) => {\n\n      if (__hasClass(e.target, 'close')) {\n\n        __addClass(commentDiv, 'hidden');\n        __removeClass($el, 'active');\n\n      }\n\n    });\n\n    commentDivButtonSubmit.addEventListener('click', (e) => {\n\n      if (commentNewTextarea.value !== '') {\n\n        const commentItem = document.createElement('div');\n        commentItem.className = 'comment-item';\n\n        commentItem.innerText = commentNewTextarea.value;\n\n        commentCommentsContainer.appendChild(commentItem);\n\n        commentNewTextarea.value = '';\n      }\n\n    });\n\n    this.$editor.append(commentDiv);\n\n    __addClass($el, 'comment-created');\n\n    /* :TODO: Temporary way to save the reference to the DOM element */\n    $el.commentRef = commentDiv;\n\n\n  }\n\n  _addCommentHandlerForElement($el, opts = {}) {\n\n    __addClass($el, 'has-comments');\n\n    function clickHandler(e) {\n\n      if (!__hasClass(e.target, 'node-close')) {\n\n        if (!__hasClass($el, 'comment-created')) {\n\n          this._createCommentForNode($el, opts);\n\n        } else {\n\n          /* recalculate comment div position */\n          const calculatedCommentPosition = this._calculateCommentPosition($el);\n\n          $el.commentRef.style.left = calculatedCommentPosition.left;\n          $el.commentRef.style.top = calculatedCommentPosition.top;\n\n          __removeClass($el.commentRef, 'hidden');\n\n        }\n\n        if (!__hasClass($el, 'active')) {\n\n          __addClass($el, 'active');\n\n        } else {\n\n          __removeClass($el, 'active');\n          __addClass($el.commentRef, 'hidden');\n\n        }\n\n      }\n\n      e.stopPropagation();\n\n    }\n\n    $el.addEventListener('click', clickHandler.bind(this));\n\n  }\n\n  setSelection(command, commandName, opts = {}) {\n\n    if (this.selection) {\n\n      if (command === 'toggle-class') {\n\n        const $el = document.createElement('span');\n        $el.setAttribute('class', opts.toggleClass);\n        $el.setAttribute('data-command-name', commandName);\n\n        const newTagId = this._generateNewTagId();\n\n        this._highlightContents($el, newTagId);\n\n        if (opts.closeBtn === true) {\n          this._createCloseBtnForElement($el, {\n            class: 'node-close',\n            toggleClass: opts.toggleClass,\n          });\n        }\n\n        if (opts.comments === true) {\n          this._addCommentHandlerForElement($el, {\n            class: opts.commentsClass,\n          });\n        }\n\n        this._storeHighlightedContents($el, newTagId);\n\n        if (opts.showCommentsOnInit === true) {\n          $el.click();\n        }\n\n      }\n\n      // hide context menu after selecting the action#\n      this.toggleMenu(true);\n\n      // show OK button or feedback\n      this.showFeedback();\n\n    }\n\n  }\n\n}\n\nEditor.defaults = {\n  menuClass: 'contextual-menu-component',\n  canvasClass: 'canvas',\n  resetBtnClass: 'reset',\n  closeBtnClass: 'node-close',\n  nodeSelectedClass: 'node-selected',\n  commentMargin: {\n    x: 50,\n    y: 0,\n  },\n  menuMargin: {\n    x: 15,\n    y: 15,\n  },\n  textOptions: {\n    enable: false,\n    animatedClass: 'active',\n    selectedClass: 'selected',\n    deselectedClass: 'deselected',\n  },\n\n};\n\nEditor._hasMenu = (opts) => opts.funkce !== 'cteni' && opts.funkce !== 'psani' && (opts.menu !== false && opts.menu !== undefined);\nEditor._hasToolbar = (opts) => opts.funkce === 'psani' || (opts.toolbar !== false && opts.toolbar !== undefined);\n","import { __toggleClass, __getHTML, __dispatchEvent } from '../lib/utils';\nimport Component from './component';\n\n// zoom the image\nexport default class Keywords extends Component {\n  constructor($element, opts = {}) {\n    super($element);\n    this.id = this.target.id;\n    this.function = this.target.getAttribute('data-keywords') || 'selekce-' || 'selekce+';\n    this.$controls = this.target.querySelectorAll('[data-keywords-control]');\n\n    this.opts = { ...Keywords.defaults, ...opts };\n\n    this.$itemsContainer = this.target.querySelector(`.${this.opts.itemsContainerClassName}`);\n\n    if (this.opts.inherit && this.opts.inherit.from.length > 0) {\n      // console.log(this.opts.inherit.from);\n      this.isInherited = true;\n    }\n    else {\n      this.$items = this.target.querySelectorAll(`.${this.opts.itemClassName}`);\n    }\n\n  }\n\n  init() {\n    switch (this.function) {\n      case 'selekce-':\n      case 'selekce+':\n        // we have data at the instantiation for importing\n        if (this.opts.import && this.opts.import.length > 0) {\n          this.$itemsContainer.innerHTML = Keywords._getHTMLFromItems(this.opts.import);\n        }\n\n        // console.log(this.id, this.isInherited);\n        if (this.isInherited) {\n          // if onInit, we copy the elements\n          // by their ids into the itemsContainer of this object\n          if (this.opts.inherit.onInit) {\n            this._regenerateItemsContainerFromInherited();\n          }\n        }\n\n        this._registerHandlers();\n        break;\n      case 'wordcloud':\n        this.$items.forEach(($item) => {\n          $item.setAttribute('data-keywords-item', 0);\n        });\n        this._changeSizeOfKeywordItem(this.opts.skala);\n        break;\n\n      default:\n        break;\n    }\n  }\n\n  _changeSizeOfKeywordItem(maxLevel) {\n    maxLevel = maxLevel ? parseInt(maxLevel, 10) : 4;\n\n    function setNewLevelValue($keyword, number, feedback) {\n      const oldValue = parseInt($keyword.getAttribute('data-keywords-item'), 10);\n      const newValue = oldValue + number;\n      const value = Math.abs(newValue) > maxLevel ? oldValue : newValue;\n      $keyword.setAttribute('data-keywords-item', value);\n\n      feedback();\n    }\n\n    this.$controls.forEach(($control) => {\n      const $keyword = $control.parentElement.parentElement;\n      const controlFunction = $control.getAttribute('data-keywords-control');\n\n      switch (controlFunction) {\n        case 'minus':\n          $control.addEventListener('click', (event) => {\n            setNewLevelValue($keyword, -1, this.showFeedback);\n            event.preventDefault();\n          });\n          break;\n\n        case 'plus':\n          $control.addEventListener('click', (event) => {\n            setNewLevelValue($keyword, 1, this.showFeedback);\n            event.preventDefault();\n          });\n          break;\n\n        default:\n          break;\n      }\n    });\n  }\n\n  _regenerateItemsContainerFromInherited() {\n    let tempContent = '';\n\n    this.opts.inherit.from.forEach((id) => {\n      const temp = document.getElementById(id).querySelector(`.${this.opts.itemsContainerClassName}`).innerHTML;\n      // rename ids of the original items to avoid duplicates in the DOM\n      tempContent += Keywords.renameItemsIds(id, this.id, temp);\n      // console.log(tempContent);\n    });\n\n    this.$itemsContainer.innerHTML = tempContent;\n\n    this.$items = this.target.querySelectorAll(`.${this.opts.itemClassName}`);\n  }\n\n  _registerHandlers() {\n\n    // this.target.querySelectorAll(`.${this.opts.itemClassName}`).forEach(($item) => {\n    this.$items.forEach(($item) => {\n      $item.addEventListener('click', this._clickEventHandler.bind(this), true);\n      document.addEventListener('keyword.change', (e) => { this._dispatchEventHandler(e, $item); }, false);\n    });\n\n  }\n\n\n  _clickEventHandler(e) {\n\n    if (e.type === 'click') {\n\n      __toggleClass(e.currentTarget, 'disabled');\n\n      // dispatch event that keyword has changed\n      __dispatchEvent(document, 'keyword.change', {}, {\n        keywords: {\n          id: this.id,\n          node: e.currentTarget,\n        },\n      });\n\n      this.showFeedback();\n    }\n  }\n\n  _dispatchEventHandler(e, $item) {\n    const { id, node } = e.detail.keywords;\n\n    if (this.isInherited && this.opts.inherit.from.includes(id)) {\n      const currentId = $item.id;\n      const nodeId = node.id;\n      const removeFeatureIdFromCurrentId = currentId.replace(this.id, '');\n      const removeFeatureIdFromNodeId = nodeId.replace(id, '');\n\n      if (removeFeatureIdFromCurrentId === removeFeatureIdFromNodeId) {\n        __toggleClass($item, 'disabled');\n      }\n    }\n  }\n}\n\n\nKeywords._getItemFromDOMElement = ($item) => ({\n  class: $item.className,\n  id: $item.getAttribute('id'),\n  text: $item.innerText,\n});\n\nKeywords._getItemsHTML = ($itemsContainer) => $itemsContainer.innerHTML;\n\nKeywords._getItemsFromHTML = ($itemsContainer, itemsClassName) => {\n  const $items = $itemsContainer.querySelectorAll(`.${itemsClassName}`);\n  const itemsArray = [];\n\n  $items.forEach(($item) => {\n    itemsArray.push(Keywords._getItemFromDOMElement($item));\n  });\n\n\n  return itemsArray;\n\n};\n\nKeywords._getDOMElementFromItem = (item) => {\n\n  const newDiv = document.createElement('div');\n  newDiv.setAttribute('class', item.class);\n  newDiv.setAttribute('id', item.id);\n  newDiv.innerHTML = item.text;\n\n  return __getHTML(newDiv);\n\n};\n\nKeywords._getHTMLFromItems = (items) => {\n\n  let contentHTML = '';\n\n  items.forEach((item) => {\n\n    contentHTML += Keywords._getDOMElementFromItem(item);\n\n  });\n\n  return contentHTML;\n\n};\n\n\nKeywords.renameItemsIds = (oldId, newId, itemsHTML) => {\n\n  const expString = new RegExp(oldId, 'g');\n\n  return itemsHTML.replace(expString, newId);\n\n};\n\nKeywords.defaults = {\n  itemsContainerClassName: 'keywords-items-container',\n  itemClassName: 'keywords-item',\n};\n","import { __removeClass, __toggleClass } from '../lib/utils';\nimport Component from './component';\n\n\nexport default class TestQuiz extends Component {\n\n  constructor(id, element, opts) {\n    super(element);\n\n    this.id = id;\n\n    this.opts = { ...TestQuiz.defaults, ...opts };\n\n    this.$questions = this.target.querySelectorAll(`.${this.opts.itemClass}`);\n    this.cache = {\n      answersCorrect: 0,\n      colors: [],\n      questions: [],\n    };\n\n    // get colors for all feedback variants\n    if (this.opts.zpetnaVazba) {\n      this.cache.colors = this.opts.zpetnaVazba.map((feedback) => feedback.barva);\n    }\n  }\n\n  init() {\n    this._registerHandlers();\n  }\n\n  _registerHandlers() {\n\n    this.$questions.forEach(($question, questionIndex) => {\n      // all questions are without answer by default\n      this.cache.questions.push({ answered: false });\n\n      const answerCorrect = parseInt($question.getAttribute('data-module-answer'), 10);\n      const $answers = $question.querySelectorAll(`.${this.opts.optionClass}`);\n\n      $answers.forEach(($answer, answerIndex) => {\n        $answer.addEventListener('click', () => {\n          const $answerCurrent = $answer;\n\n          // if already selected do nothing\n          if ($answerCurrent.classList.contains('selected')) {\n            return;\n          }\n\n          // remove the selection\n          $answers.forEach(($answersItem) => __removeClass($answersItem, this.opts.selectedClass));\n          // select the clicked one\n          __toggleClass($answerCurrent, this.opts.selectedClass);\n\n          // get sum of all corect answers\n          if (this.opts.zpetnaVazba) {\n            if (answerIndex === answerCorrect) {\n              this.cache.answersCorrect += 1;\n            } else if (this.cache.answersCorrect !== 0 && this.cache.questions[questionIndex].answered === true) {\n              this.cache.answersCorrect -= 1;\n            }\n            // loop through all \"zpetnaVazba\" to get the one with the fullfilled condition\n            const feedbackActual = this.opts.zpetnaVazba.find((feedback) => feedback.podminka.includes(this.cache.answersCorrect));\n\n            // show the right feedback message\n            this.$buttonFeedback.classList.remove(...this.cache.colors);\n            this.$buttonFeedback.classList.add(feedbackActual.barva);\n            this.$buttonFeedbackText.innerText = feedbackActual.text;\n          }\n\n          // note that this question has been answered (whether true or false)\n          this.cache.questions[questionIndex].answered = true;\n\n          // show OK button with feedback only when all question have been answered\n          if (this.cache.questions.find((question) => !question.answered) === undefined) {\n            this.showFeedback();\n          }\n\n        }, false);\n      });\n    });\n  }\n}\n\nTestQuiz.defaults = {\n  itemClass: 'test-quiz-item',\n  optionClass: 'option',\n  selectedClass: 'selected',\n};\n","/* eslint-disable max-classes-per-file */\n// [data-fullscreen]\nimport Component from './component';\nimport MagnifyingGlass from './magnifying-glass';\nimport { imageIsLoaded } from '../lib/utils';\n\nclass Fullscreen extends Component {\n  constructor($element) {\n    super($element);\n\n    this.$fullscreen = document.querySelector('[data-fullscreen=\"fullscreen\"]');\n    this.$fullscreenContainer = this.$fullscreen.querySelector('[data-fullscreen=\"container\"]');\n    this.$fullscreenTarget = this.$fullscreen.querySelector('[data-fullscreen=\"target\"]');\n\n    this.window = {};\n    this.image = {};\n\n    this.window.width = window.innerWidth;\n    this.window.height = window.innerHeight;\n    this.window.ratio = this.window.width / this.window.height;\n  }\n}\n\nexport default class FullscreenToggle extends Fullscreen {\n  constructor($element) {\n    super($element);\n\n    this.target.addEventListener('click', (event) => {\n      this.$fullscreenContainer.innerHTML = this.target.nextElementSibling.outerHTML;\n      this.$fullscreenTarget = this.$fullscreenContainer.firstElementChild;\n      this.$fullscreenTarget.removeAttribute('style');\n      this.$fullscreenTarget.removeAttribute('id');\n\n      switch (this.target.nextElementSibling.nodeName.toLowerCase()) {\n        case 'img':\n          setTimeout(() => {\n            imageIsLoaded(this.$fullscreenTarget.currentSrc)\n              .then(() => {\n                this.image.width = this.$fullscreenTarget.naturalWidth;\n                this.image.height = this.$fullscreenTarget.naturalHeight;\n                this.image.ratio = this.image.width / this.image.height;\n\n                this.setSize();\n\n                const magnifyingGlass = new MagnifyingGlass(this.$fullscreenTarget);\n              });\n          }, 10);\n          break;\n\n        case 'svg':\n          // eslint-disable-next-line no-case-declarations\n          const viewbox = this.$fullscreenTarget.getAttribute('viewBox').split(' ');\n\n          [, , this.image.width, this.image.height] = viewbox;\n          this.image.ratio = this.image.width / this.image.height;\n\n          this.setSize();\n\n          // eslint-disable-next-line no-case-declarations\n          const $svgTexts = this.$fullscreenTarget.querySelectorAll('textarea');\n          if ($svgTexts.length > 0) {\n            $svgTexts.forEach(($svgText) => {\n              const { id } = $svgText;\n              $svgText.removeAttribute('id');\n              $svgText.value = document.getElementById(id).value;\n              $svgText.readOnly = true;\n            });\n          }\n          break;\n\n        default:\n          break;\n      }\n\n      this.$fullscreen.classList.toggle('hidden');\n\n      this.showFeedback();\n\n      event.preventDefault();\n      event.stopPropagation();\n    }, false);\n\n  }\n\n  setSize() {\n    if (this.image.ratio >= this.window.ratio) {\n      this.$fullscreenTarget.style.width = '100%';\n      this.$fullscreenTarget.style.height = 'auto';\n    }\n    else {\n      this.$fullscreenTarget.style.width = 'auto';\n      this.$fullscreenTarget.style.height = `${this.window.height}px`;\n    }\n  }\n}\n","import Component from './component';\nimport { __dispatchEvent } from '../lib/utils';\n\nexport default class UserText extends Component {\n  constructor($element) {\n    super($element);\n    this.$userTexts = this.$slide.querySelectorAll('[data-textarea-target]');\n    this.$counter = this.target.nextElementSibling.querySelector('[data-usertext-counter]');\n    this.$wrapper = this.$counter.parentElement;\n\n    this.feedback = JSON.parse(this.target.getAttribute('data-feedback'));\n\n    this.lengthExpected = {\n      min: parseInt(this.target.getAttribute('minlength') === '0' ? 1 : this.target.getAttribute('minlength'), 10),\n      avg: null,\n      max: parseInt(this.target.getAttribute('maxlength') / 2, 10),\n    };\n    this.lengthExpected.avg = Math.floor((this.lengthExpected.max - this.lengthExpected.min) / 4 + this.lengthExpected.min);\n\n    this.cache = {\n      answersCorrect: 0,\n      colors: [\n        'color-red',\n        'color-orange',\n        'color-green',\n      ],\n      questions: [],\n    };\n\n    this.lastValue = '';\n    this.hadData = this.target.value && this.target.value.length > 0;\n    this.wasUsed = false;\n\n    if (this.hadData) {\n      this.updateCharacterCounter();\n    }\n\n    if (!HISTORYLAB.import.done) {\n      // duplicate source of different text element\n      this.toDuplicate = this.target.getAttribute('data-duplicate-text');\n      this.textDuplicateSources = this.toDuplicate ? this.toDuplicate.split(' ') : [];\n\n      // listen events\n      this.getEvents();\n      this.addEventListeners();\n    }\n  }\n\n  updateCharacterCounter(length = this.target.value.length) {\n    this.$wrapper.classList.remove(...this.cache.colors);\n    if (length < this.lengthExpected.min) this.$wrapper.classList.add(this.cache.colors[0]);\n    else if (length <= this.lengthExpected.avg) this.$wrapper.classList.add(this.cache.colors[1]);\n    else if (length > this.lengthExpected.avg) this.$wrapper.classList.add(this.cache.colors[2]);\n\n    this.$counter.innerText = length;\n    this.target.classList.add('is-used', !this.wasUsed);\n    this.wasUsed = true;\n  }\n\n  updateFeedback(length = this.target.value.length) {\n    if (!this.$buttonFeedback) return;\n\n    this.$buttonFeedback.classList.remove(...this.cache.colors);\n    if (length < this.lengthExpected.min) {\n      this.$buttonFeedback.classList.add(this.cache.colors[0]);\n      this.$buttonFeedbackText.innerText = this.feedback.none;\n    } else {\n\n      if (length <= this.lengthExpected.avg) {\n        this.$buttonFeedback.classList.add(this.cache.colors[1]);\n        this.$buttonFeedbackText.innerText = this.feedback.short;\n      }\n      else if (length > this.lengthExpected.avg) {\n        this.$buttonFeedback.classList.add(this.cache.colors[2]);\n        this.$buttonFeedbackText.innerText = this.feedback.ok;\n      }\n\n      this.target.setAttribute('data-textarea-target', 'success');\n      // check if all conditions of the same component on the same slide are met\n      const conditionAll = Array.from(this.$userTexts).find(($userText) => ($userText.getAttribute('data-textarea-target') !== 'success'));\n\n      if (conditionAll === undefined) {\n        // show OK button or feedback\n        this.showFeedback();\n      }\n    }\n  }\n\n  addEventListeners() {\n    // BLUR\n    this.target.addEventListener('blur', (event) => {\n      this.updateCharacterCounter();\n\n      if (event.target.value !== this.lastValue) {\n        const taskName = (this.lastValue === '') ? 'create' : 'change';\n        this.lastValue = event.target.value;\n\n        // dispatch event that text has changed\n        __dispatchEvent(document, 'text.change', {}, {\n          text: {\n            id: event.target.id,\n            task: taskName,\n            text: event.target.value,\n          },\n        });\n\n        // remove connection of any textfields\n        this.textDuplicateSources = [];\n      }\n    });\n\n    // KEYUP\n    this.target.addEventListener('keyup', (event) => {\n      event.stopPropagation();\n\n      const valueLength = this.target.value.length;\n      this.updateCharacterCounter(valueLength);\n      this.updateFeedback(valueLength);\n    });\n  }\n\n  getEvents() {\n    if (this.textDuplicateSources[0]) {\n\n      document.addEventListener('text.change', (e) => {\n        if (this.textDuplicateSources.includes(e.detail.text.id)) {\n\n          const taskName = (this.target.value === '') ? 'create' : 'change';\n          switch (e.detail.text.task) {\n            case 'create':\n            case 'change':\n              // if is something already there\n              if (this.target.value !== '') this.target.value += '\\n';\n\n              // if array length is one it means that can by connection line\n              if (this.textDuplicateSources.length === 1) {\n                this.target.value = e.detail.text.text;\n              } else {\n                this.target.value += `${e.detail.text.text}\\n`;\n              }\n\n              // dispatch event that text has changed\n              __dispatchEvent(document, 'text.change', {}, {\n                text: {\n                  id: this.target.id,\n                  task: taskName,\n                  text: this.target.value,\n                },\n              });\n\n              // make different first value if is need\n              this.lastValue = this.target.value;\n\n              this.updateCharacterCounter();\n              break;\n            default:\n              console.log('Nondefinated text events task. :(');\n          }\n        }\n      });\n    }\n  }\n}\n","import Component from '../component';\n\nexport default class AudioPlayerNormal extends Component {\n\n  constructor($element) {\n    super($element);\n\n    this.$playButton = this.target.querySelector('[data-player-control]');\n    this.$loadWave = this.target.querySelector('[data-audio-wave]');\n    this.$leftTime = this.target.querySelector('[data-audio-time-left]');\n    this.$audioDuration = this.target.querySelector('[data-audio-time-duration]');\n\n    this.wavesurfer = WaveSurfer.create({\n      container: this.$loadWave,\n      waveColor: '#A77977',\n      progressColor: '#FCE4E3',\n      height: 80,\n      responsive: true,\n      barWidth: 2,\n    });\n    this.wavesurfer.load(this.$loadWave.dataset.src);\n\n    this.initWave();\n  }\n\n  initWave() {\n    this.wavesurfer.on('ready', () => {\n      this.$leftTime.textContent = '0:00';\n      const duration = this.wavesurfer.getDuration();\n      const minutes = Math.floor((duration % 3600) / 60);\n      const seconds = (`00${Math.floor(duration % 60)}`).slice(-2);\n      this.$audioDuration.textContent = `${minutes}:${seconds}`;\n\n      this.addListenerAfterReady();\n    });\n  }\n\n  addListenerAfterReady() {\n    this.wavesurfer.on('audioprocess', (time) => {\n      const minutes = Math.floor((time % 3600) / 60);\n      const seconds = (`00${Math.floor(time % 60)}`).slice(-2);\n      this.$leftTime.textContent = `${minutes}:${seconds}`;\n    });\n\n    this.wavesurfer.on('finish', () => {\n      this.$playButton.setAttribute('data-player-control', 'paused');\n    });\n\n    this.$playButton.addEventListener('click', () => {\n      this.wavesurfer.playPause();\n\n      if (this.$playButton.getAttribute('data-player-control') === 'paused') {\n        this.$playButton.setAttribute('data-player-control', 'playing');\n      } else {\n        this.$playButton.setAttribute('data-player-control', 'paused');\n      }\n\n      this.showFeedback();\n    });\n\n    // stop audio prehravac kdyz se zapne dalsi slajd\n    const $nextSlides = document.querySelectorAll('[data-nav-button]');\n    $nextSlides.forEach(($nextSlide) => {\n      $nextSlide.addEventListener('click', () => {\n        if (this.$playButton.getAttribute('data-player-control') === 'playing') {\n          this.wavesurfer.playPause();\n          this.$playButton.setAttribute('data-player-control', 'paused');\n        }\n      });\n    });\n\n  }\n\n}\n","import AudioPlayer from './audio-player';\nimport { getSecondsMinutesFormat } from './media';\n\nexport default class AudioPlayerSimple extends AudioPlayer {\n  constructor($element) {\n    super($element);\n\n    this.$audio = this.target.querySelector('audio');\n    this.$timeLeft = this.target.querySelector('[data-audio-time-left]');\n    this.$duration = this.target.querySelector('[data-audio-time-duration]');\n\n    this.$duration.innerText = `/${getSecondsMinutesFormat(this.$audio.duration)}`;\n\n    AudioPlayer.addEventListeners(this.target, this.showFeedback);\n  }\n}\n","import Component from './component';\n\nexport default class FakeMap extends Component {\n  constructor($element) {\n    super($element);\n\n    this.$buttons = this.target.querySelectorAll('[data-fake-map=\"toggle\"]');\n    this.$maps = this.target.querySelectorAll('[data-fake-map=\"map\"]');\n    this.lastActiveIndex = 0;\n\n    this.addEventListenerToButtons();\n  }\n\n  switchMap($button, index) {\n    this.$maps[this.lastActiveIndex].classList.remove('active');\n    this.$buttons[this.lastActiveIndex].classList.remove('active');\n\n    this.$maps[index].classList.add('active');\n    $button.classList.add('active');\n\n    this.lastActiveIndex = index;\n  }\n\n  addEventListenerToButtons() {\n    this.$buttons.forEach(($button, index) => {\n\n      $button.addEventListener('click', (event) => {\n        this.switchMap($button, index);\n        this.showFeedback();\n\n        event.preventDefault();\n      });\n\n    });\n  }\n}\n","/* eslint-disable no-nested-ternary */\nimport Component from '../component';\nimport { getSecondsMinutesFormat, mediaEvents } from './media';\n\nexport default class VideoPlayer extends Component {\n  constructor($element, options) {\n    super($element);\n\n    this.$media = this.target.querySelector('video');\n    this.options = Object(options);\n    this.prefix = this.options.prefix || 'media';\n    this.lang = Object(this.options.lang);\n    // lang.currentTime\n    // lang.play\n    // lang.pause\n    // lang.minutes\n    // lang.seconds\n    // lang.leaveFullscreen\n    // lang.enterFullscreen\n\n    this.paused = null;\n    this.currentTime = null;\n    this.duration = null;\n    this.interval = null;\n\n    this.$document = this.target.ownerDocument;\n    this.$controls = this.target.querySelector('.media-player-controls');\n    // play/pause toggle\n    this.$play = this.$controls.querySelector('[data-player-control]');\n    this.$playSymbol = this.$play.querySelector('.media-play-symbol');\n    this.$pauseSymbol = this.$play.querySelector('.media-pause-symbol');\n    // time slider\n    this.$time = this.$controls.querySelector('[data-video-time-progress]');\n    this.$timeMeter = this.$time.querySelector('.media-meter.media-time-meter');\n    this.$timeRange = this.$time.querySelector('.media-range.media-time-range');\n\n    // current time text\n    this.$currentTimeText = this.$document.createTextNode('');\n    this.$currentTime = this.$controls.querySelector('[data-video-time-left]');\n    this.$currentTime.appendChild(this.$currentTimeText);\n\n    // duration time text\n    this.durationTime = this.$media.duration;\n    this.$durationTime = this.$controls.querySelector('[data-video-time-duration]');\n    this.$durationTime.innerText = getSecondsMinutesFormat(this.durationTime);\n    this.$durationTime.setAttribute(\n      'title',\n      `${VideoPlayer.timeToAural(\n        this.durationTime,\n        this.lang.minutes || 'minutes',\n        this.lang.seconds || 'seconds',\n      )}`,\n    );\n\n    // fullscreen button\n    this.$fullscreen = this.$controls.querySelector(\n      '.fullscreen-toggle',\n    );\n    this.$enterFullscreenSymbol = this.$fullscreen.querySelector(\n      '.media-enterFullscreen-symbol',\n    );\n    this.$leaveFullscreenSymbol = this.$fullscreen.querySelector(\n      '.media-leaveFullscreen-symbol',\n    );\n\n    // fullscreen api\n    this._fullscreenchange = 'onfullscreenchange' in this.target\n      ? 'fullscreenchange'\n      : 'onwebkitfullscreenchange' in this.target\n        ? 'webkitfullscreenchange'\n        : 'onMSFullscreenChange' in this.target\n          ? 'MSFullscreenChange'\n          : 'fullscreenchange';\n\n    this._requestFullscreen = this.target.requestFullscreen\n    || this.target.webkitRequestFullscreen\n    // || this.target.mozRequestFullScreen\n    || this.target.msRequestFullscreen;\n\n    this.onCanPlayStart = this.onCanPlayStart.bind(this);\n    this.onLoadStart = this.onLoadStart.bind(this);\n    this.onLoadedData = this.onLoadedData.bind(this);\n    this.onPlayChange = this.onPlayChange.bind(this);\n    this.onTimeChange = this.onTimeChange.bind(this);\n    this.onPlayClick = this.onPlayClick.bind(this);\n    this.onTimeKeydown = this.onTimeKeydown.bind(this);\n    this.onTimeClick = this.onTimeClick.bind(this);\n    this.onTimeKeydown = this.onTimeKeydown.bind(this);\n    this.onFullscreenClick = this.onFullscreenClick.bind(this);\n    this.onFullscreenChange = this.onFullscreenChange.bind(this);\n\n    // add event listeners\n    this.$media.addEventListener('canplaythrough', this.onCanPlayStart);\n    this.$media.addEventListener('loadstart', this.onLoadStart);\n    this.$media.addEventListener('loadeddata', this.onLoadedData);\n    this.$media.addEventListener('pause', this.onPlayChange);\n    this.$media.addEventListener('play', this.onPlayChange);\n    this.$media.addEventListener('timeupdate', this.onTimeChange);\n    this.$controls.addEventListener('click', this.onPlayClick, false);\n    // this.$play.addEventListener('click', this.onPlayClick, false);\n    this.$play.addEventListener('keydown', this.onTimeKeydown);\n    this.$time.addEventListener('click', this.onTimeClick, false);\n    this.$time.addEventListener('keydown', this.onTimeKeydown);\n    this.$fullscreen.addEventListener('click', this.onFullscreenClick, false);\n    // listen for fullscreen changes\n    document.addEventListener(\n      this._fullscreenchange,\n      this.onFullscreenChange,\n    );\n\n    // pointer events from time control\n    VideoPlayer.onDrag(this.$time, this.$timeRange, (percentage) => {\n      this.$media.currentTime = this.duration * Math.max(0, Math.min(1, percentage));\n\n      this.onTimeChange();\n    });\n\n    this.onLoadStart();\n  }\n\n  static _fullscreenElement() {\n    return document.fullscreenElement\n    || document.webkitFullscreenElement\n    // || document.mozFullScreenElement\n    || document.msFullscreenElement;\n  }\n\n  static _exitFullscreen() {\n    return document.exitFullscreen\n    || document.webkitCancelFullScreen\n    // || document.mozCancelFullScreen\n    || document.msExitFullscreen;\n  }\n\n  // when the play state changes\n  onPlayChange() {\n    if (this.paused !== this.$media.paused) {\n      this.paused = this.$media.paused;\n\n      this.$play.setAttribute(\n        'aria-label',\n        this.paused ? this.lang.play || 'play' : this.lang.pause || 'pause',\n      );\n      this.target.setAttribute(\n        'data-player-state',\n        this.paused ? 'paused' : 'playing',\n      );\n      this.$playSymbol.setAttribute('aria-hidden', !this.paused);\n      this.$pauseSymbol.setAttribute('aria-hidden', this.paused);\n\n      clearInterval(this.interval);\n\n      if (!this.paused) {\n        // listen for time changes every 30th of a second\n        this.interval = setInterval(this.onTimeChange, 34);\n      }\n\n      // dispatch new \"playchange\" event\n      this.$media.dispatchEvent(mediaEvents.playchange);\n    }\n  }\n\n  // when the time changes\n  onTimeChange() {\n    if (\n      this.currentTime !== this.$media.currentTime\n      || this.duration !== this.$media.duration\n    ) {\n      this.currentTime = this.$media.currentTime;\n      this.duration = this.$media.duration || 0;\n\n      const currentTimePercentage = this.currentTime / this.duration;\n      // const currentTimeCode = VideoPlayer.timeToTimecode(this.currentTime);\n      const currentTimeCode = getSecondsMinutesFormat(this.currentTime);\n      // const remainingTimeCode = VideoPlayer.timeToTimecode(\n      //   this.duration - Math.floor(this.currentTime),\n      // );\n\n      if (currentTimeCode !== this.$currentTimeText.nodeValue) {\n        this.$currentTimeText.nodeValue = currentTimeCode;\n\n        this.$currentTime.setAttribute(\n          'title',\n          `${VideoPlayer.timeToAural(\n            this.currentTime,\n            this.lang.minutes || 'minutes',\n            this.lang.seconds || 'seconds',\n          )}`,\n        );\n      }\n\n      // if (remainingTimeCode !== this.$remainingTimeText.nodeValue) {\n      //   this.$remainingTimeText.nodeValue = remainingTimeCode;\n\n      //   $(this.$remainingTime, {\n      //     title: `${VideoPlayer.timeToAural(\n      //       this.duration - this.currentTime,\n      //       this.lang.minutes || 'minutes',\n      //       this.lang.seconds || 'seconds',\n      //     )}`,\n      //   });\n      // }\n\n      this.$time.setAttribute('aria-valuenow', this.currentTime);\n      this.$time.setAttribute('aria-valuemin', 0);\n      this.$time.setAttribute('aria-valuemax', this.duration);\n\n      this.$timeMeter.style.width = `${currentTimePercentage * 100}%`;\n\n      // dispatch new \"timechange\" event\n      this.$media.dispatchEvent(mediaEvents.timechange);\n    }\n  }\n\n  // when media loads for the first time\n  onLoadStart() {\n    this.$media.removeEventListener('canplaythrough', this.onCanPlayStart);\n    this.$media.addEventListener('canplaythrough', this.onCanPlayStart);\n\n    this.onPlayChange();\n    this.onFullscreenChange();\n    this.onTimeChange();\n  }\n\n  // when the immediate current playback position is available\n  onLoadedData() {\n    this.onTimeChange();\n  }\n\n  // when the media can play\n  onCanPlayStart() {\n    this.$media.removeEventListener('canplaythrough', this.nCanPlayStart);\n\n    // dispatch new \"canplaystart\" event\n    this.$media.dispatchEvent(mediaEvents.canplaystart);\n\n\n    if (!this.paused || this.$media.autoplay) {\n      this.$media.play();\n    }\n  }\n\n  onFullscreenChange() {\n    const isFullscreen = this.target === VideoPlayer._fullscreenElement();\n\n    this.$fullscreen.setAttribute(\n      'aria-label',\n      isFullscreen\n        ? this.lang.leaveFullscreen || 'leave full screen'\n        : this.lang.enterFullscreen || 'enter full screen',\n    );\n    this.$enterFullscreenSymbol.setAttribute('aria-hidden', isFullscreen);\n    this.$leaveFullscreenSymbol.setAttribute('aria-hidden', !isFullscreen);\n  }\n\n  // when the play control is clicked\n  onPlayClick(event) {\n    event.preventDefault();\n    event.stopPropagation();\n\n    this.$media[this.$media.paused ? 'play' : 'pause']();\n  }\n\n  // when the time control\n  onTimeClick(event) {\n    event.stopPropagation();\n\n    // handle click if clicked without pointer\n    if (!event.pointerType && !event.detail) {\n      this.onPlayClick(event);\n    }\n  }\n\n  // click from fullscreen control\n  onFullscreenClick(event) {\n    event.stopPropagation();\n\n    if (this._requestFullscreen) {\n      if (this.target === VideoPlayer._fullscreenElement()) {\n        // exit fullscreen\n        VideoPlayer._exitFullscreen().call(document);\n      } else {\n        // enter fullscreen\n        this._requestFullscreen.call(this.target);\n\n        // maintain focus in internet explorer\n        this.$fullscreen.focus();\n\n        // maintain focus in safari\n        setTimeout(() => {\n          this.$fullscreen.focus();\n        }, 200);\n      }\n    } else if (this.$media.webkitSupportsFullscreen) {\n      // iOS allows fullscreen of the video itself\n      if (this.$media.webkitDisplayingFullscreen) {\n        // exit ios fullscreen\n        this.$media.webkitExitFullscreen();\n      } else {\n        // enter ios fullscreen\n        this.$media.webkitEnterFullscreen();\n      }\n\n      this.onFullscreenChange();\n    }\n  }\n\n  // keydown from play control or current time control\n  onTimeKeydown(event) {\n    const { keyCode, shiftKey } = event;\n\n    // 37: LEFT, 38: UP, 39: RIGHT, 40: DOWN\n    if (keyCode >= 37 && keyCode <= 40) {\n      event.preventDefault();\n\n      const offset = keyCode === 37 || keyCode === 39 ? keyCode - 38 : keyCode - 39;\n\n      this.$media.currentTime = Math.max(\n        0,\n        Math.min(\n          this.$media.duration,\n          this.$media.currentTime + offset * (shiftKey ? 10 : 1),\n        ),\n      );\n\n      this.onTimeChange();\n    }\n  }\n\n  // Handle Drag Ranges\n  static onDrag(target, innerTarget, listener) {\n    // eslint-disable-line max-params\n    const hasPointerEvent = undefined !== target.onpointerup;\n    const hasTouchEvent = undefined !== target.ontouchstart;\n    const pointerDown = hasPointerEvent\n      ? 'pointerdown'\n      : hasTouchEvent\n        ? 'touchstart'\n        : 'mousedown';\n    const pointerMove = hasPointerEvent\n      ? 'pointermove'\n      : hasTouchEvent\n        ? 'touchmove'\n        : 'mousemove';\n    const pointerUp = hasPointerEvent\n      ? 'pointerup'\n      : hasTouchEvent\n        ? 'touchend'\n        : 'mouseup';\n\n    // ...\n    const axisProp = 'clientX';\n\n    let window;\n    let start;\n    let end;\n\n    function onpointermove(event) {\n      // prevent browser actions on this event\n      event.preventDefault();\n\n      // the pointer coordinate\n      const position = axisProp in event\n        ? event[axisProp]\n        : (event.touches && event.touches[0] && event.touches[0][axisProp])\n            || 0;\n\n      // the percentage of the pointer along the container\n      const percentage = (position - start) / (end - start);\n\n      // call the listener with percentage\n      listener(percentage);\n    }\n\n    function onpointerdown(event) {\n      // window\n      window = target.ownerDocument.defaultView;\n\n      // client boundaries\n      const rect = innerTarget.getBoundingClientRect();\n\n      // the container start and end coordinates\n      start = rect.left;\n      end = rect.right;\n\n      onpointermove(event);\n\n      window.addEventListener(pointerMove, onpointermove);\n      window.addEventListener(pointerUp, onpointerup);\n    }\n\n    function onpointerup() {\n      window.removeEventListener(pointerMove, onpointermove);\n      window.removeEventListener(pointerUp, onpointerup);\n    }\n\n    // on pointer down\n    target.addEventListener(pointerDown, onpointerdown);\n  }\n\n  // Time To Timecode\n  // DEPRECATED (media.util)\n  // static timeToTimecode(time) {\n  //   return `${`0${Math.floor(time / 60)}`.slice(-2)}:${`0${Math.floor(\n  //     time % 60,\n  //   )}`.slice(-2)}`;\n  // }\n\n  // Time To Aural\n  // DEPRECATED (media.util)\n  static timeToAural(time, langMinutes, langSeconds) {\n    return `${Math.floor(time / 60)} ${langMinutes}, ${Math.floor(\n      time % 60,\n    )} ${langSeconds}`;\n  }\n}\n","/* eslint-disable linebreak-style */\nimport Component from './component';\nimport { __dispatchEvent } from '../lib/utils';\n\nexport default class Selectable extends Component {\n\n  constructor($element) {\n    super($element);\n\n    // TODO: is DOM element before/after the editor itself.. move it to the editor?\n    this.$settings = document.querySelector(`[data-selectable-id-reference=\"${this.target.id}\"]`);\n\n    this.feedback = JSON.parse(this.$settings.getAttribute('data-module-zpetnavazba'));\n    this.settings = JSON.parse(this.$settings.getAttribute('data-module-settings'));\n\n    this.$items = this.target.querySelectorAll('.selectable-item');\n\n    this.$inputs = this.target.querySelectorAll('input');\n    this.$inputs.forEach(($input) => {\n      this._changeClassIfChecked($input);\n      this._addEventListeners($input);\n    });\n\n    this.cache = {\n      answersCorrect: 0,\n      zpetnaVazba: false,\n      colors: [],\n      checkedInput: 0,\n    };\n\n    // get colors for all feedback variants\n    if (this.feedback) {\n      this.cache.zpetnaVazba = true;\n      this.cache.colors = this.feedback.map((feedback) => feedback.barva);\n    }\n\n  }\n\n  _addEventListeners($input) {\n    $input.addEventListener('change', () => {\n      this.$inputs.forEach(($input_) => {\n        this._changeClassIfChecked($input_);\n      });\n      this._checkAndResolveFeedback();\n    }, false);\n  }\n\n  /* eslint class-methods-use-this: [\"error\", { \"exceptMethods\": [\"_changeClassIfChecked\"] }] */\n  // TODO: might be possible with CSS only with `:checked` selector & sibling combinator`+` or `~`\n  _changeClassIfChecked($input) {\n    $input.parentNode.classList.toggle('is-checked', $input.checked === true);\n  }\n\n  _checkAndResolveFeedback() {\n    this.cache.answersCorrect = 0;\n    if (this.settings.viceOdpovedi) {\n      this.$items.forEach(($item, index) => {\n        if (this.$inputs[index].checked) {\n          this.cache.checkedInput += 1;\n        }\n        if (this.$inputs[index].checked && $item.hasAttribute('data-select-spravnaodpoved')) {\n          this.cache.answersCorrect += 1;\n        }\n        if (!this.$inputs[index].checked && !$item.hasAttribute('data-select-spravnaodpoved')) {\n          this.cache.answersCorrect += 1;\n        }\n      });\n    } else {\n      this.$items.forEach(($item, index) => {\n        if (this.$inputs[index].checked) {\n          this.cache.checkedInput += 1;\n        }\n        if (this.$inputs[index].checked && $item.hasAttribute('data-select-spravnaodpoved')) {\n          this.cache.answersCorrect += 1;\n        }\n      });\n    }\n\n    // Display feedback button (if no checkbox is select, the button is hidden)\n    if ((this.cache.checkedInput === 0 && !this.settings.vybrano) || (this.cache.checkedInput === this.$inputs.length && this.settings.vybrano) || this.settings.disableFeedback) {\n      this.hideFeedback();\n    } else {\n\n      if (this.cache.zpetnaVazba) {\n        const feedbackActual = this.feedback.find((feedback) => feedback.podminka.includes(this.cache.answersCorrect));\n        this.$buttonFeedback.classList.remove(...this.cache.colors);\n        this.$buttonFeedback.classList.add(feedbackActual.barva);\n        this.$buttonFeedbackText.innerText = feedbackActual.text;\n      }\n\n      this.showFeedback();\n    }\n\n    this.cache.checkedInput = 0;\n    this._dispatchEvent();\n  }\n\n  _dispatchEvent() {\n    const items = Array.from(this.$inputs).map(($input) => ({\n      checked: $input.checked,\n      id: $input.id,\n    }));\n\n    __dispatchEvent(this.target, 'selection.change', {}, {\n      id: this.target.id,\n      // task: 'change', // TODO: 'select', 'unselect' ?\n      items,\n    });\n  }\n}\n","/* eslint-disable no-case-declarations */\nimport Component from './component';\n\nexport default class NewTable extends Component {\n  constructor($element) {\n    super($element);\n    // duplicate source of different editor elements\n    this.dataFrom = this.target.parentNode.getAttribute('data-from');\n    this.dataSources = this.dataFrom ? this.dataFrom.split(' ') : [];\n    this.id = $element.getAttribute('id');\n    this.cache = {\n      tasks: [],\n    };\n\n    this.init();\n  }\n\n  init() {\n    const autofill = this.target.parentNode.getAttribute('data-autofill');\n\n    switch (autofill) {\n      case 'columns':\n        this._columnManager();\n        break;\n      case 'rows':\n        this._rowManager();\n        break;\n      case 'cells':\n        const allCells = this.target.querySelectorAll('.table-new__cell');\n\n        allCells.forEach(($cell) => {\n          const columnId = $cell.getAttribute('data-column-id');\n          const rowId = $cell.getAttribute('data-row-id');\n          // add listener only for cells in table\n          if (columnId && rowId) {\n            this._cellManager($cell, columnId, rowId);\n          }\n        });\n        break;\n      default:\n        console.log('NewTableERROR: Undefinated autofill key word!', autofill);\n    }\n  }\n\n  _rowManager() {\n    document.addEventListener('editor.change', (e) => {\n      const data = e.detail.text;\n\n      if (this.dataSources.includes(data.id)) {\n        let $tableRow;\n        let rightToAdd = true;\n\n        // get columns header\n        const $header = this.target.previousSibling;\n        const $headerCells = $header.firstChild.childNodes;\n\n        switch (data.task) {\n          case 'add':\n            $tableRow = document.createElement('div');\n            $tableRow.setAttribute('class', 'table-new__row');\n\n            $headerCells.forEach(($item) => {\n              const $rowCell = document.createElement('div');\n              $rowCell.setAttribute('class', 'table-new__cell');\n              const itemType = JSON.parse($item.getAttribute('data-type'));\n\n              // check if tagName is definated and than set variable to false\n              if (itemType.tagName && itemType.tagName !== data.tagData.tagName) {\n                rightToAdd = false;\n              }\n              else {\n                // add data to cell\n                this.fillCell(itemType, data, $rowCell);\n              }\n\n              // only add if it is right to add\n              if (rightToAdd) $tableRow.appendChild($rowCell);\n            });\n\n            // only add if it is right to add\n            if (rightToAdd) this.target.appendChild($tableRow);\n            break;\n          case 'remove':\n            const tableRows = this.target.childNodes;\n\n            tableRows.forEach(($row) => {\n              $row.childNodes.forEach(($cell, index) => {\n                const itemType = JSON.parse($headerCells[index].getAttribute('data-type'));\n\n                if (NewTable.isRightToDeleteHelper($cell, data.value, itemType)) {\n                  $tableRow = $row;\n\n                }\n              });\n            });\n\n            // olny if row for remove exists\n            if ($tableRow) {\n              // remove tasks from cache\n              $tableRow.childNodes.forEach(($cell) => {\n                this._removeTaskFromCache($cell);\n              });\n\n              $tableRow.remove();\n            }\n            break;\n          default:\n            console.log('NewTableERROR: Undefinated task for new table! (rowManager)');\n        }\n      }\n    });\n  }\n\n  // TODO: adding just specific tags names like in rowManager\n  _columnManager() {\n    document.addEventListener('editor.change', (e) => {\n      const data = e.detail.text;\n\n      if (this.dataSources.includes(data.id)) {\n        const $rows = this.target.childNodes;\n\n        switch (data.task) {\n          case 'add':\n            $rows.forEach(($row) => {\n              const $cell = document.createElement('div');\n              $cell.setAttribute('class', 'table-new__cell');\n\n              const $firstCell = $row.firstChild;\n              const itemType = JSON.parse($firstCell.getAttribute('data-type'));\n\n              // add data to cell\n              this.fillCell(itemType, data, $cell);\n\n              $row.appendChild($cell);\n            });\n            break;\n          case 'remove':\n            let columnIndex;\n            $rows.forEach(($row) => {\n              const $firstCell = $row.firstChild;\n              const itemType = JSON.parse($firstCell.getAttribute('data-type'));\n\n              $row.childNodes.forEach(($cell, index) => {\n                if (NewTable.isRightToDeleteHelper($cell, data.value, itemType)) {\n                  columnIndex = index;\n                }\n              });\n            });\n\n            this.target.childNodes.forEach(($row) => {\n              // remove tasks from cache\n              this._removeTaskFromCache($row.childNodes[columnIndex]);\n\n              $row.childNodes[columnIndex].remove();\n            });\n            break;\n          default:\n            console.log('NewTableERROR: Undefinated task for new table! (columnManager)');\n        }\n      }\n    });\n  }\n\n  _cellManager($cell, columnId, rowId) {\n    const itemType = JSON.parse(this._findCellType($cell));\n    const cellController = (data) => {\n      switch (data.task) {\n        case 'add':\n          const $tag = document.createElement('div');\n          this.fillCell(itemType, data, $cell);\n\n          $cell.appendChild($tag);\n          break;\n        case 'remove':\n          const $tags = $cell.querySelectorAll('div');\n          let removed = false;\n          for (let i = 0; i < $tags.length; i += 1) {\n            if (!removed && NewTable.isRightToDeleteHelper($tags[i], data.value, itemType)) {\n              // TODO: remove only childrens of $elm => empty div is still there\n              $tags[i].remove();\n              removed = true;\n            }\n          }\n          break;\n        default:\n          console.log('NewTableERROR: Undefinated task for new table! (cellManager)');\n      }\n    };\n\n    document.addEventListener('editor.change', (e) => {\n      const data = e.detail.text;\n\n      if (this.dataSources.includes(data.id) && (data.tagData.tagName === rowId || data.tagData.tagName === columnId)) {\n\n        if (!itemType.textId || itemType.textId === data.id) {\n          cellController(data);\n        }\n      }\n    });\n    document.addEventListener('draggable.drop', (e) => {\n      const data = e.detail;\n\n      if (this.dataSources.includes(data.id) && e.detail.columnId === columnId) {\n        // get text\n        const $span = data.$node.querySelector('span').cloneNode(true);\n        $span.classList.add('node-selected', 'node-text-gray');\n        $span.setAttribute('data-by', 'table-drop');\n\n        cellController({ task: data.task, value: $span });\n      }\n    });\n  }\n\n  fillCell(itemType, data, $node) {\n    let $innerItem;\n    let cacheObj;\n\n    // seed init or generate\n    let seed = 0;\n    if (this.cache.tasks.length > 0) {\n      const lastId = this.cache.tasks[this.cache.tasks.length - 1].id;\n      const idParts = lastId.split('-');\n      seed = +idParts[idParts.length - 1] + 1;\n    }\n\n    $node.classList.add(`table-new__cell--${itemType.name}`, `table-new__cell--${itemType.type}`);\n\n    switch (itemType.name) {\n      case 'dup-text':\n        $innerItem = document.createElement('div');\n        if (itemType.type === 'text') {\n          $innerItem.innerHTML = data.value.textContent;\n        }\n        else if (itemType.type === 'tag') {\n          // have to by clone, because if not it will by duplicatet do more tables it will be just in last one\n          $innerItem.appendChild(data.value.cloneNode(true));\n        }\n        break;\n      case 'select':\n        // create task in cache\n        cacheObj = { id: `${this.id}-select-${seed}`, answer: '', rightAnswer: data.tagData };\n        this.cache.tasks.push(cacheObj);\n\n        // create node in html\n        $innerItem = document.createElement(itemType.name);\n\n        $innerItem.setAttribute('id', cacheObj.id);\n        $innerItem.setAttribute('data-save', 'value');\n        $innerItem.setAttribute('tabindex', -1);\n\n        itemType.options.forEach((value) => {\n          const $option = document.createElement('option');\n          $option.innerHTML = value;\n          $innerItem.appendChild($option);\n        });\n\n        // add event listener\n        $innerItem.addEventListener('change', (event) => this._correctedAnswer(event, cacheObj));\n        break;\n      case 'input':\n      case 'textarea':\n        // create task in cache\n        cacheObj = { id: `${this.id}-input-${seed}`, answer: '', rightAnswer: data.tagData };\n        this.cache.tasks.push(cacheObj);\n\n        // create node in html\n        $innerItem = document.createElement(itemType.name);\n\n        $innerItem.setAttribute('id', cacheObj.id);\n        $innerItem.setAttribute('data-save', 'value');\n        $innerItem.setAttribute('tabindex', -1);\n\n        if (itemType.name === 'textarea') {\n          $innerItem.setAttribute('resize', cacheObj.id);\n        }\n\n        Object.keys(itemType.attributes).forEach((key) => {\n          $innerItem.setAttribute(key, itemType.attributes[key]);\n        });\n\n        // add event listener\n        $innerItem.addEventListener('change', (event) => this._correctedAnswer(event, cacheObj));\n        break;\n      case 'drop':\n        $innerItem = document.createElement('div');\n        const numberOfDrops = itemType.number ? itemType.number : -1;\n        // set attribute for draggable logic\n        $innerItem.setAttribute('data-drop-place', numberOfDrops);\n        break;\n      default:\n        $innerItem = document.createElement('div');\n        /*\n          if item Type name is value of data object from delivered cviceni feature\n          then use it and it's value set in table\n          else set empry value and show error\n       */\n        if (data.tagData[itemType.name]) {\n          $innerItem.innerHTML = data.tagData[itemType.name];\n        }\n        else {\n          $innerItem.innerHTML = ' ';\n          console.log('FillCellERROR: Undefinated object name.', itemType);\n        }\n    }\n    $node.appendChild($innerItem);\n  }\n\n  // prepare for more types of duplicate types\n  static isRightToDeleteHelper(elm, deliveredValue, itemType) {\n    let result;\n\n    if (itemType.name === 'dup-text') {\n      // fix for tags\n      // table div textContent include '×' as last char\n      // because it is in self span\n      let elemTextContent;\n      if (itemType.type === 'tag' && elm.textContent[elm.textContent.length - 1] === '×') {\n        elemTextContent = elm.textContent.slice(0, -1);\n      }\n      else {\n        elemTextContent = elm.textContent;\n      }\n      result = elemTextContent === deliveredValue.textContent;\n\n    } // different type then dup-text hasn't duplicate option\n    else {\n      result = false;\n    }\n\n    return result;\n  }\n\n  _findCellType($cell) {\n    const rowType = $cell.parentNode.firstChild.getAttribute('data-type');\n    if (rowType) return rowType;\n\n    // if rows header isn´t definated\n    const columnId = $cell.getAttribute('data-column-id');\n    const $columnHeader = this.target.parentNode.querySelector(`.table-new__cell--header[data-column-id=${columnId}]`);\n    if ($columnHeader) return $columnHeader.getAttribute('data-type');\n\n    return 'empty';\n  }\n\n  _correctedAnswer(event, cacheObj) {\n    this.cache.tasks.forEach((task) => {\n      if (task.id === cacheObj.id) {\n        task.answer = event.target.value;\n      }\n    });\n\n    // console.log('select change', this.cache);\n  }\n\n  _removeTaskFromCache($cell) {\n    this.cache.tasks.forEach((task, index) => {\n      if ($cell.firstChild.tagName === 'SELECT' || $cell.firstChild.tagName === 'INPUT' || $cell.firstChild.tagName === 'TEXTAREA') {\n        if ($cell.firstChild.id === task.id) {\n          this.cache.tasks.splice(index, 1);\n        }\n      }\n    });\n  }\n}\n","import Component from './component';\nimport { __dispatchEvent } from '../lib/utils';\n\n\nexport default class Draggable extends Component {\n  constructor($element) {\n    super($element);\n\n    this.idPrefix = 'drag-item';\n    // duplicate source of different editor elements\n    this.dataFrom = this.target.getAttribute('data-from');\n    this.dataSources = this.dataFrom ? this.dataFrom.split(' ') : [];\n\n    this.position = {\n      x: 0,\n      y: 0,\n      dx: 0,\n      dy: 0,\n    };\n    this.cache = {\n      // to know if draggable item was dropped or not and how many times\n      items: {},\n    };\n\n    this.$targetPrevious = null;\n    this.$targetCurrent = null;\n    this.$draggedItem = null;\n\n    this.objWidth = null;\n    this.objHeight = null;\n\n    this.init();\n  }\n\n  init() {\n    const $dragItems = this.target.querySelectorAll('.draggable__item');\n    $dragItems.forEach(($dragItem) => {\n      // get id\n      const id = $dragItem.getAttribute('data-id');\n      // inicial drop numbers\n      this.cache.items[id] = 0;\n      // use d3 container for $dragItem\n      this.dragAndDropEvents(d3.select($dragItem), id);\n    });\n\n    // initial handler for dropped item to svg\n    this.handleDeleteItemFromSvgDrop();\n\n    // initial handler for adding tags from text\n    this.handleAddTagsFromText();\n  }\n\n  // dropToken is used for handle usecase when user drag from drop-place to drop-place\n  dragAndDropEvents($dragItem, itemId, dropToken = true) {\n    // drag & drop\n    $dragItem.call(d3.drag()\n      .container(this.$slide)\n      .on('start', () => { this.onStart($dragItem); })\n      .on('drag', () => { this.onDrag($dragItem); })\n      .on('end', () => { this.onDrop($dragItem, itemId, dropToken); }));\n  }\n\n  onStart($dragItem) {\n\n    this.$slide.classList.add('is-dragging');\n\n    this.$targetPrevious = d3.event.sourceEvent.target;\n\n    // in this method is better to have classic html node\n    const $dragItemHTML = $dragItem.node();\n\n    // initial position\n    this.objWidth = $dragItemHTML.offsetWidth;\n    this.objHeight = $dragItemHTML.offsetHeight;\n    this.position.x = d3.event.sourceEvent.clientX - d3.event.sourceEvent.offsetX;\n    this.position.y = d3.event.sourceEvent.clientY - d3.event.sourceEvent.offsetY;\n    this.position.dx = 0;\n    this.position.dy = 0;\n\n    // get dragged node\n    // clone element if from DRAG place\n    if ($dragItemHTML.parentNode.hasAttribute('data-drag-place')) {\n      this.$draggedItem = $dragItemHTML.cloneNode(true);\n    }\n    // do not clone if from DROP place\n    else {\n      this.$draggedItem = $dragItemHTML;\n\n      // get table data\n      const $table = $dragItemHTML.closest('.table-new__body');\n      const $cell = $dragItemHTML.closest('.table-new__cell');\n      const columnId = $cell.getAttribute('data-column-id');\n\n      // dispatch event that item has been removed from drop place\n      __dispatchEvent(document, 'draggable.drop', {}, {\n        id: $table.id,\n        task: 'remove',\n        columnId,\n        // type: itemType,\n        $node: $dragItemHTML,\n      });\n    }\n\n    // add to body\n    document.body.appendChild(this.$draggedItem);\n    // convert back to d3 container\n    this.$draggedItem = d3.select(this.$draggedItem);\n\n    this.$draggedItem\n      .classed('is-dragged', true)\n      .classed('was-dropped', false)\n      .attr('style', `top:${this.position.y}px; left:${this.position.x}px;`);\n  }\n\n  onDrag($dragItem) {\n    // console.log($dragItem.node());\n    // update position\n    this.position.dx += d3.event.dx;\n    this.position.dy += d3.event.dy;\n\n    // move with dragging element\n    this.$draggedItem.style('transform', `translate3d(${this.position.dx}px, ${this.position.dy}px, 0) rotate(5deg)`);\n\n    this.$targetCurrent = d3.event.sourceEvent.target;\n    // check for make placeholder in drop place\n    if (this.$targetPrevious !== this.$targetCurrent) {\n\n      // remove placeholder in old target\n      const $placeholderOld = this.$targetPrevious.querySelector('.draggable__item--placeholder');\n      if ($placeholderOld) $placeholderOld.remove();\n\n      // create placeholder in new target\n      if (this.$targetCurrent.hasAttribute('data-drop-place')) {\n        const numberOfPossibleDrops = this.$targetCurrent.getAttribute('data-drop-place');\n        const numberOfDropsDone = this.$targetCurrent.childElementCount;\n\n        // console.log('ondrag', numberOfDropsDone);\n\n        if (numberOfPossibleDrops === '-1' || +numberOfPossibleDrops > numberOfDropsDone) {\n          // remove this class is important for creating placeholder from dragging item from drop place\n          const $placeholderNew = $dragItem.clone(true)\n            .classed('is-dragged', false)\n            .classed('draggable__item--placeholder', true)\n            .attr('style', 'outline: 0px;')\n            .node();\n\n          this.$targetCurrent.appendChild($placeholderNew);\n        }\n      }\n\n      // update target\n      this.$targetPrevious = this.$targetCurrent;\n    }\n  }\n\n  onDrop($dragItem, itemId, dropToken) {\n    this.$targetCurrent = d3.event.sourceEvent.target;\n\n    // when dropping within droppable normal DOM node\n    if (this.$targetCurrent.hasAttribute('data-drop-place')) {\n\n      // get placeholder\n      let $dropItem = this.$targetCurrent.querySelector('.draggable__item--placeholder');\n\n      if ($dropItem) {\n        const itemType = $dropItem.getAttribute('data-draggable-item');\n\n        // remove unneeded classes for dropItem\n        $dropItem.classList.remove('draggable__item--placeholder', 'was-dropped');\n        $dropItem.classList.add('dropped__item');\n\n        // update drops num\n        if (dropToken) {\n          $dragItem.classed('was-dropped', true);\n          this.cache.items[itemId] += 1;\n        }\n\n        if (itemType === 'svg') {\n          $dropItem.querySelector('[data-fullscreen=\"toggle\"]').remove();\n        }\n        else {\n          // add cross for remove item\n          const $rightElmChild = $dropItem.firstElementChild;\n          const $cross = document.createElement('span');\n          $cross.classList.add('node-close');\n          $cross.innerText = '×';\n\n          // remove svg from frop item\n          $rightElmChild.removeChild($rightElmChild.lastElementChild);\n          $rightElmChild.appendChild($cross);\n\n          // remove item after click on cross\n          $cross.addEventListener('click', () => {\n            this.removeDraggableItem($dropItem, itemId, dropToken);\n          });\n        }\n\n        // add events to clone for posible dragging back\n        // dropItem has to by in d3 container\n        this.dragAndDropEvents(d3.select($dropItem), itemId, false);\n      } // only click on drop item\n      else {\n        $dropItem = $dragItem.clone(true)\n          .classed('is-dragged', false)\n          .attr('style', 'outline: 0px;')\n          .node();\n\n        this.$targetCurrent.appendChild($dropItem);\n\n        // add events to clone for posible dragging back\n        // dropItem has to by in d3 container\n        this.dragAndDropEvents(d3.select($dropItem), itemId, false);\n      }\n\n      // get table data\n      const $table = this.$targetCurrent.closest('.table-new__body');\n      const $cell = this.$targetCurrent.closest('.table-new__cell');\n      const columnId = $cell.getAttribute('data-column-id');\n\n      // dispatch event that item has been dropped\n      __dispatchEvent(document, 'draggable.drop', {}, {\n        id: $table.id,\n        task: 'add',\n        columnId,\n        // type: itemType,\n        $node: $dropItem,\n      });\n\n      // remove draggedItem from DOM\n      this.$draggedItem.remove();\n    }\n    // when dropping within SVG\n    else {\n      // get svg\n      const $svg = this.$targetCurrent.closest('svg');\n      // check drop attribute\n      const svgCanDrop = $svg ? $svg.hasAttribute('data-svg-drop') : false;\n\n      // when dropping within droppable svg node\n      if (svgCanDrop) {\n\n        // see __localPosition in ../lib/utils\n        // however d3.event.offsetX does not work here\n        const getLocalPositionBasedOnBrowser = () => {\n          const $slideActive = $svg.closest('.half-slide-active');\n\n          if (platform.name === 'Firefox' && $slideActive) {\n            // this works for Firefox even in transformed container\n            return [\n              d3.mouse($svg)[0] - ($slideActive.offsetWidth + this.objWidth),\n              d3.mouse($svg)[1],\n            ];\n          }\n\n          // this works for Chrome\n          return d3.mouse($svg);\n        };\n\n        const position = getLocalPositionBasedOnBrowser();\n        const $node = this.$draggedItem.classed('is-dragged', false)\n          .attr('style', 'outline: 0px;')\n          .node();\n\n        // update drops num\n        $dragItem.classed('was-dropped', true);\n        this.cache.items[itemId] += 1;\n\n        // add to svg\n        // dispatch event that svg has changed\n        __dispatchEvent(document, 'svg.drop', {}, {\n          svg: {\n            id: $svg.id,\n            $node,\n            type: $node.getAttribute('data-draggable-item'),\n            position,\n            size: {\n              width: this.objWidth,\n              height: this.objHeight,\n            },\n          },\n        });\n\n        this.$draggedItem.remove();\n\n      }\n      // when dropping outside of droppable area\n      else {\n        // if it's last drop then remove drop class\n        this.removeDraggableItem(this.$draggedItem, itemId, dropToken);\n      }\n\n    }\n\n    this.$slide.classList.remove('is-dragging');\n  }\n\n  handleDeleteItemFromSvgDrop() {\n\n    document.addEventListener('svg.drop.delete', (event) => {\n      const { id, $object } = event.detail.item;\n\n      // console.log('smazano', id, $object);\n      const $sameItemFromDragPlace = this.target.querySelector(`div[data-id=${id}]`);\n\n      if ($sameItemFromDragPlace) {\n        // if it's last drop then remove drop class\n        if (this.cache.items[id] === 1) {\n          $sameItemFromDragPlace.classList.remove('was-dropped');\n        }\n\n        // update drop number of concrete item\n        this.cache.items[id] -= 1;\n      }\n    });\n  }\n\n  handleAddTagsFromText() {\n    // need if we drop more than one same item\n    let idSalt = 1;\n\n    document.addEventListener('editor.change', (e) => {\n      const data = e.detail.text;\n      const concreteTagName = this.target.getAttribute('data-tagName');\n\n      // if concreteTagName\n      if (this.dataSources.includes(data.id) && (!concreteTagName || concreteTagName === data.tagData.tagName)) {\n        let $newDaggabletItem;\n        let $tagTextSpan;\n        let textToAdd;\n        let newId;\n        let idParts;\n\n        switch (data.task) {\n          case 'add':\n            // clone hidden tag\n            $newDaggabletItem = this.target.firstElementChild.cloneNode(true);\n            $newDaggabletItem.classList.remove('hidden');\n\n            // find place where to add tags text\n            $tagTextSpan = $newDaggabletItem.querySelector('.keywords-item');\n\n            // get right text to add\n            textToAdd = data.value.textContent;\n            if (textToAdd[textToAdd.length - 1] === '×') {\n              textToAdd = textToAdd.slice(0, -1);\n            }\n\n            // add text\n            $tagTextSpan.firstElementChild.innerHTML = textToAdd;\n\n            // add color to draggable item\n            $newDaggabletItem.firstElementChild.classList.add(`node-text-${data.tagColor}`);\n            $tagTextSpan.classList.add(`node-text-${data.tagColor}`);\n\n            // create new id\n            newId = $newDaggabletItem.getAttribute('data-id');\n            idParts = newId.split('-');\n            idParts.splice(-1, 1, `dup-${idSalt}`);\n            newId = idParts.join('-');\n\n            // set new id\n            $newDaggabletItem.setAttribute('data-id', newId);\n\n            // add to cache\n            this.cache.items[newId] = 0;\n\n            idSalt += 1;\n            this.target.appendChild($newDaggabletItem);\n\n            // add listeners for drag'n'drop\n            this.dragAndDropEvents(d3.select($newDaggabletItem), newId);\n            break;\n          case 'remove':\n            this.target.childNodes.forEach(($cell) => {\n              if (Draggable.isRightToDeleteHelper($cell, data.value, $cell.getAttribute('data-draggable-item'))) {\n                $cell.remove();\n              }\n            });\n            break;\n          default:\n            console.log('NewTableERROR: Undefinated task for new table! (cellManager)');\n        }\n      }\n    });\n  }\n\n  removeDraggableItem($draggedItem, itemId, dropToken) {\n    // if it's last drop then remove drop class\n    if (this.cache.items[itemId] === 1) {\n      const $sameItemFromDragPlace = this.target.querySelector(`div[data-id=${itemId}]`);\n      $sameItemFromDragPlace.classList.remove('was-dropped');\n    }\n\n    // update drop number of concrete item\n    if (!dropToken) {\n      this.cache.items[itemId] -= 1;\n    }\n\n    // remove draggedItem from DOM\n    $draggedItem.remove();\n  }\n\n  // prepare for more types of duplicate types\n  static isRightToDeleteHelper(elm, deliveredValue, itemType) {\n    // fix for tags\n    // table div textContent include '×' as last char\n    // because it is in self span\n    let elemTextContent;\n    if (itemType === 'tag' && elm.textContent[elm.textContent.length - 1] === '×') {\n      elemTextContent = elm.textContent.slice(0, -1);\n    }\n    else {\n      elemTextContent = elm.textContent;\n    }\n    return elemTextContent === deliveredValue.textContent;\n  }\n}\n","/* eslint-disable no-unused-vars */\nimport MagnifyingGlass from './magnifying-glass';\nimport Sortable from './sortable';\nimport SVG from './svg';\nimport SVGRadialMenu from './svg-lib/svg-radial-menu';\nimport Editor from './editor/editor';\nimport Keywords from './keywords';\nimport TestQuiz from './test-quiz';\nimport FullscreenToggle from './fullscreen';\nimport UserText from './user-text';\nimport AudioPlayerNormal from './media/audio-player-normal';\nimport AudioPlayerSimple from './media/audio-player-simple';\nimport FakeMap from './fake-map';\nimport { stopPlayingVideoPlayers } from './media/media';\nimport VideoPlayer from './media/video';\nimport Selectable from './selectable';\nimport NewTable from './new-table';\nimport Draggable from './draggable';\n\nconst windowLoadComponents = () => {\n  console.log('windowLoad:components');\n\n  // Video player - normal\n  const $videoPlayers = document.querySelectorAll('[data-player-video]');\n  if ($videoPlayers.length > 0) {\n    $videoPlayers.forEach(($videoPlayer) => {\n      // console.log('$videoPlayer', $videoPlayer);\n      const videoPlayer = new VideoPlayer($videoPlayer);\n    });\n\n    document.addEventListener('slide.change', () => {\n      stopPlayingVideoPlayers($videoPlayers);\n    });\n  }\n\n  // Audio player - normal\n  const $audioPlayerNormals = document.querySelectorAll('[data-player-audio=\"normal\"]');\n  if ($audioPlayerNormals.length > 0) {\n    $audioPlayerNormals.forEach(($audioPlayerNormal) => {\n      const audioPlayerNormal = new AudioPlayerNormal($audioPlayerNormal);\n    });\n\n    // TODO > audio-player-normal.js#61\n    // document.addEventListener('slide.change', () => {\n    //   stopPlayingVideoPlayers($audioPlayerNormals);\n    // });\n  }\n\n  // Audio player — simple\n  const $audioPlayerSimples = document.querySelectorAll('[data-player-audio=\"simple\"]');\n  if ($audioPlayerSimples.length > 0) {\n    $audioPlayerSimples.forEach(($audioPlayerSimple) => {\n      const audioPlayerSimple = new AudioPlayerSimple($audioPlayerSimple);\n    });\n\n    document.addEventListener('slide.change', () => {\n      stopPlayingVideoPlayers($audioPlayerSimples);\n    });\n  }\n\n  // Fullscreen\n  const $fullscreenToggles = document.querySelectorAll('[data-fullscreen=\"toggle\"]');\n  if ($fullscreenToggles.length > 0) {\n    $fullscreenToggles.forEach(($fullscreenToggle) => {\n      const fullscreenToggle = new FullscreenToggle($fullscreenToggle);\n    });\n  }\n\n  // Magnifying glass\n  const $magnifyingGlass = document.querySelectorAll('[data-lupa-target]');\n  if ($magnifyingGlass.length > 0) {\n    for (let i = 0; i < $magnifyingGlass.length; i += 1) {\n      const magnifyingGlass = new MagnifyingGlass($magnifyingGlass[i]);\n    }\n  }\n\n  // Fake Map\n  const $fakeMaps = document.querySelectorAll('[data-fake-map=\"target\"]');\n  if ($fakeMaps.length > 0) {\n    for (let i = 0; i < $fakeMaps.length; i += 1) {\n      const fakeMap = new FakeMap($fakeMaps[i]);\n    }\n  }\n\n  //\n  // load these below in working mode only\n\n  // User texts\n  // - preview/working mode logic inside the component\n  //  - show\n  const $userTexts = document.querySelectorAll('[data-textarea-target=\"\"]');\n  if ($userTexts.length > 0) {\n    $userTexts.forEach(($userText) => {\n      const userText = new UserText($userText);\n    });\n  }\n\n  // SVG + Radial menu\n  // - preview/working mode logic in side the component\n  //  - to set max-width\n  const $svgs = document.querySelectorAll('[data-svg-target]');\n  if ($svgs.length > 0) {\n\n    if (HISTORYLAB.import.done !== true) {\n      // radial menu\n      const $radialMenu = document.querySelector('[data-radial-menu]');\n      if ($radialMenu) {\n        const radialMenu = new SVGRadialMenu($radialMenu, $svgs);\n      }\n    }\n\n    // svgs\n    // setSize is needed\n    $svgs.forEach(($svg) => {\n      const svg = new SVG($svg);\n    });\n  }\n\n  if (HISTORYLAB.import.done !== true) {\n\n    // Editor\n    const $editors = document.querySelectorAll('[data-editor]');\n    if ($editors.length > 0) {\n      $editors.forEach(($editor) => {\n        const editor = new Editor($editor);\n      });\n    }\n\n    // Test Quizes\n    const $testQuizs = document.querySelectorAll('[data-target-test-quiz]');\n    if ($testQuizs.length > 0) {\n      $testQuizs.forEach(($testQuiz) => {\n        const settings = document.querySelector(\n          `[data-test-quiz-id-reference=\"${$testQuiz.getAttribute(\n            'data-test-quiz-id',\n          )}\"]`,\n        );\n\n        const testQuiz = new TestQuiz(\n          $testQuiz.getAttribute('data-test-quiz-id'),\n          $testQuiz,\n          JSON.parse(settings.getAttribute('data-module-settings')),\n        );\n        testQuiz.init();\n      });\n    }\n\n    // New table\n    const $newTables = document.querySelectorAll('[data-new-table]');\n    if ($newTables.length > 0) {\n      $newTables.forEach(($newTable) => {\n        const newTable = new NewTable($newTable);\n      });\n    }\n\n    // Pretahovani\n    const $draggables = document.querySelectorAll('[data-draggable]');\n    if ($draggables.length > 0) {\n      $draggables.forEach(($draggable) => {\n        const draggable = new Draggable($draggable);\n      });\n    }\n\n    // Sortable\n    const $sortables = document.querySelectorAll('[data-sortable-target]');\n    if ($sortables.length > 0) {\n      $sortables.forEach(($sortable) => {\n        const sortable = new Sortable($sortable);\n      });\n    }\n\n    // Selectable\n    const $selectables = document.querySelectorAll('[data-selectable-target]');\n    if ($selectables.length > 0) {\n      $selectables.forEach(($selectable) => {\n        const selectable = new Selectable($selectable);\n      });\n    }\n\n    // Keywords selection\n    const $keywords = document.querySelectorAll('[data-keywords]');\n    if ($keywords.length > 0) {\n      $keywords.forEach(($keyword) => {\n        const settings = $keyword.hasAttribute('data-module-settings')\n          ? $keyword.getAttribute('data-module-settings')\n          : {};\n        const keywords = new Keywords($keyword, JSON.parse(settings));\n        keywords.init();\n      });\n    }\n  }\n};\n\nexport default windowLoadComponents;\n","/* eslint-disable consistent-return */\nimport domLoadComponents from './dom-load';\nimport windowLoadComponents from './window-load';\nimport unsupportedBrowsers from '../lib/unsupported-browsers';\n\n(() => {\n  if (unsupportedBrowsers()) return false;\n\n  // The DOMContentLoaded event fires when parsing of the current page is complete. DOMContentLoaded is a great event to use to hookup UI functionality to complex web pages.\n  document.addEventListener('DOMContentLoaded', domLoadComponents, false);\n\n  // The load event fires when all files have finished loading from all resources, including ads and images.\n  window.addEventListener('load', windowLoadComponents, false);\n})();\n","const unsupportedBrowsers = () => {\n\n  // feature detection for unsupported browsers\n  const isUnsupported = !Array.from\n    || !Element.prototype.matches\n    || !Element.prototype.closest\n    || typeof window.CustomEvent !== 'function'\n    || typeof Object.assign !== 'function';\n\n  if (isUnsupported) {\n    console.warn('Not supported browser.');\n\n    const $unsupported = document.querySelector('#unsupported');\n    $unsupported.querySelector('#unsupported-browser').innerHTML = ` ${platform.name} ${platform.version} `;\n    $unsupported.classList.remove('is-hidden');\n\n    return true;\n  }\n\n  return false;\n};\n\nexport default unsupportedBrowsers;\n"],"names":["domLoadComponents","console","log","Component","$element","target","$slide","this","closest","lang","document","documentElement","getAttribute","HISTORYLAB","done","$buttonFeedback","querySelector","$buttonFeedbackText","showFeedback","bind","classList","contains","remove","add","MagnifyingGlass","$canvas","ctx","_this","getContext","_onStart","_onMove","_onEnd","_update","_onResize","zoomGlassSize","targetBCR","zoomed","targetZoomed","x","y","trackingTouch","_addEventListeners","_initCanvas","window","requestAnimationFrame","width","height","dPR","devicePixelRation","style","scale","getBoundingClientRect","event","preventDefault","pageX","touches","pageY","TAU","Math","PI","radius","ratioX","max","min","left","ratioY","top","scaledTargetWidth","scaledTargetHeight","platform","os","family","indexOf","name","shadowColor","shadowBlur","shadowOffsetY","clearRect","fillStyle","beginPath","arc","closePath","fill","save","clip","drawImage","restore","transform","addEventListener","__createNewCustomEvent","options","data","defaults","bubbles","properties","Object","assign","CustomEvent","detail","__dispatchEvent","type","payload","dispatchEvent","__isObject","item","_typeof","Array","isArray","__insertBefore","newNode","referenceNode","parentNode","insertBefore","__insertAfter","nextSibling","__remove","el","removeChild","__localPosition","container","position","d3","offsetX","offsetY","mouse","format","__positionTranslated","curTransform","WebKitCSSMatrix","getComputedStyle","webkitTransform","body","pageYOffset","scrollTop","pageXOffset","scrollLeft","offsetLeft","m41","offsetTop","m42","__position","elAttibutes","__toggleClass","element","cls","__hasClass","__removeClass","__addClass","className","elements","classes","_elements","_classes","querySelectorAll","tagName","split","i","length","j","replace","RegExp","mediaEvents","playchange","timechange","canplaystart","stopPlayingVideoPlayers","$players","forEach","$player","$media","paused","pause","setAttribute","getSecondsMinutesFormat","seconds","duration","floor","minutes","toString","slice","AudioPlayer","$item","$audio","$playButton","$timeLeft","play","stopPropagation","innerText","currentTime","SVGDragNDrop","select","raise","classed","diff","attr","toFixed","SVGDraw","$svg","callback","sourceEvent","nodeName","line","curve","curveLinear","d","subject","x0","y0","id","active","append","datum","on","x1","y1","dx","dy","push","$thisPath","svg","task","node","contextMenu","pathEventsManager","color","d3svg","localPosition","circleEventsManager","elementPosition","selection","selectAll","nodes","idParts","$object","firstChild","call","drag","start","dragged","oldXCoordinate","oldYCoordinate","taskType","end","SVG","removeCloneConnectionManager","SVGText","maxLength","minLength","svgID","svgGroup","$radialMenu","hash","orientation","foreignObject","textarea","focus","textEventsManager","$node","isCreated","firstWrite","oldText","value","parentElement","childNodes","updateTextareaHeight","$target","wrongBool","isWrong","removeItem","scrollHeight","isBubble","_setSize","init","_initWhenDone","toDuplicate","svgSpecificActions","colors","svgSpecificColor","_initPath","_initCircle","_initComicBubbles","_getEvents","_getDropEvent","viewbox","rect","maxWidthAbsolute","innerWidth","maxHeightAbsolute","innerHeight","getHeight","maxWidth","setMaxWidth","_this2","p","renderPath","createCircle","_this3","$comicBubbles","$comicBubble","comicBubblesEventsManager","_this4","oldID","join","svgDuplicateSources","e","includes","$templateNode","localNodeID","_this5","_generateNewID","$localNode","_clonePath","_cloneComicBubbles","_cloneTextField","_cloneCircle","idSalt","_this6","size","multiply","$d3foreignObject","$dropItem","createElement","appendChild","firstElementChild","$foreignObject","cloneNode","selected","isRadial","$parent","allActiveSvgs","deactivate","pop","Sortable","$settings","feedback","JSON","parse","$container","$items","$droppables","$placeholder","$inheritors","inheritors","order","direction","before","after","evaluation","undefined","clientX","clientY","clone","posRel","siblings","prev","next","_setupInitialOrder","_setupInheritors","cache","map","barva","hasAttribute","offsetWidth","offsetHeight","_addPlaceholder","_onOver","right","_onDrop","bottom","_removePlaceholder","_updateOrder","_updateOrderInInheritors","_dispatchEvent","_checkAndResolveFeedback","_getReference","_addEventListenerToItem","addEventListeners","minHeight","src","img","nextElementSibling","previousElementSibling","array","some","index","checkIfTheArrayIsGood","changedArray","splice","arrayOfItems","_toConsumableArray","parseInt","dataset","sortableSpravnaodpoved","feedbackResult","oneMove","feedbackActual","find","podminka","text","splneno","from","$inheritor","sortableIndex","inheritor","SVGRadialMenu","$svgs","$radialMenuItems","$colorItems","$textItems","$createTextItem","$removeItem","$tooltip","initialSetUp","menuRadius","getPropertyValue","itemRadius","setUpRadialMenuItems","addEventListenersToRadialMenu","hasText","hasMoreColors","activate","deselectItem","filterMenuButtons","showRadialMenu","addEventListenersToRadialMenuItem","_itemsLength","_menuRadius","_itemRadius","_menuOffset","_centerOffset","angle","sin","cos","onMouseLeave","hideRadialMenu","action","createText","changeColor","innerHTML","currentTarget","display","$activeSVG","globalPosition","__globalPosition","$activeRadialMenuItem","positionRadialMenuItems","setTimeout","mouseLeaveDelay","clearTimeout","clickedItem","$colorItem","$textItem","selectItem","Editor","$editor","settings","opts","__mergeDeep","source","output","keys","key","models","passive","interactive","withMenu","totalTagId","hasMenu","lastSelectionSettings","isCollapsed","savedSelectionRange","selectionAttributes","dummyRangeElement","selectionMouseDown","selectionDirection","hasEditableContentChanged","lastPressedKey","hasToolbar","toolbar","originalContent","currentContent","_handlers","wrapLastDeletesTimeoutClass","wrapLastDeletesTimeoutFunction","wrapLastAdditionsTimeoutClass","wrapLastAdditionsTimeoutFunction","isWrappingLastText","isWriting","$groupDeleted","_hasMenu","$menu","menuClass","$menuActions","$menuClose","error","_hasToolbar","canvasClass","funkce","html","_generateNewTagGroupClass","$btnReset","registerEditableHandlers","initPreHighlightedTextOptions","handlerFocus","keycode","getSelection","keyCode","which","keyName","rangeCount","range","getRangeAt","cloneRange","setStart","startContainer","startOffset","collapse","setEnd","endContainer","endOffset","addedFragmentString","cloneContents","textContent","trim","dummyElementInner","surroundContents","removeAllRanges","addRange","dummyElement","contentEditable","newGeneratedId","_generateNewTagId","$elements","$btnClose","closeBtnClass","$nodeElement","_removeNodeKeepTextContent","getElementById","wrapLastDeletesTimeout","textToAddElement","insertNode","setStartAfter","groupDeletedId","$groupInnerDeleted","$groupInnerAdded","$groupAdded","registerMenuHandler","confirm","len","handlerMenuActions","handlerMenuClose","$textOptionsElements","$textOption","textOptions","selectedClass","idForSend","tagData","clickClose","_setmenuDimensions","leftDimensions","topDimensions","menuDimensions","translated","clonedElement","visibility","elDimensions","elPosition","__getRealDimensions","parentTranslatedPosition","parentDimensions","isOverflowAt","menuMargin","toggleMenu","$el","command","commandName","setSelection","anchorOffset","focusOffset","_setSelectionPosition","selectionPosition","selectionDimension","$domEl","newTagId","extractContents","classesArray","tagColor","createTextNode","$parentEl","$elClose","toggleClass","clickHandler","$closeBtn","removeEventListener","commentRef","nodePosition","commentMargin","commentTemplate","div","commentDiv","nodeRef","commentNewTextarea","commentDivButtonSubmit","commentCommentsContainer","calculatedCommentPosition","_calculateCommentPosition","commentItem","_createCommentForNode","_highlightContents","closeBtn","_createCloseBtnForElement","comments","_addCommentHandlerForElement","commentsClass","_storeHighlightedContents","showCommentsOnInit","click","resetBtnClass","nodeSelectedClass","enable","animatedClass","deselectedClass","menu","Keywords","$controls","$itemsContainer","itemsContainerClassName","inherit","isInherited","itemClassName","_getHTMLFromItems","onInit","_regenerateItemsContainerFromInherited","_registerHandlers","_changeSizeOfKeywordItem","skala","maxLevel","setNewLevelValue","$keyword","number","oldValue","newValue","abs","$control","tempContent","temp","renameItemsIds","_clickEventHandler","_dispatchEventHandler","keywords","currentId","nodeId","_getItemFromDOMElement","_getItemsHTML","_getItemsFromHTML","itemsClassName","itemsArray","_getDOMElementFromItem","newDiv","outerHTML","wrapper","__getHTML","items","contentHTML","oldId","newId","itemsHTML","expString","TestQuiz","$questions","itemClass","answersCorrect","questions","zpetnaVazba","$question","questionIndex","answered","answerCorrect","$answers","optionClass","$answer","answerIndex","$answerCurrent","$answersItem","question","FullscreenToggle","$fullscreenContainer","$fullscreenTarget","removeAttribute","toLowerCase","currentSrc","Promise","resolve","reject","Image","onload","onerror","then","image","naturalWidth","naturalHeight","ratio","setSize","$svgTexts","$svgText","readOnly","$fullscreen","toggle","UserText","$userTexts","$counter","$wrapper","lengthExpected","avg","lastValue","hadData","wasUsed","updateCharacterCounter","textDuplicateSources","getEvents","none","ok","conditionAll","$userText","taskName","valueLength","updateFeedback","AudioPlayerNormal","$loadWave","$leftTime","$audioDuration","wavesurfer","WaveSurfer","create","waveColor","progressColor","responsive","barWidth","load","initWave","getDuration","addListenerAfterReady","time","playPause","$nextSlide","AudioPlayerSimple","$duration","FakeMap","$buttons","$maps","lastActiveIndex","addEventListenerToButtons","$button","switchMap","VideoPlayer","prefix","interval","$document","ownerDocument","$play","$playSymbol","$pauseSymbol","$time","$timeMeter","$timeRange","$currentTimeText","$currentTime","durationTime","$durationTime","timeToAural","$enterFullscreenSymbol","$leaveFullscreenSymbol","_fullscreenchange","_requestFullscreen","requestFullscreen","webkitRequestFullscreen","msRequestFullscreen","onCanPlayStart","onLoadStart","onLoadedData","onPlayChange","onTimeChange","onPlayClick","onTimeKeydown","onTimeClick","onFullscreenClick","onFullscreenChange","onDrag","percentage","clearInterval","setInterval","currentTimePercentage","currentTimeCode","nodeValue","nCanPlayStart","autoplay","isFullscreen","_fullscreenElement","leaveFullscreen","enterFullscreen","pointerType","_exitFullscreen","webkitSupportsFullscreen","webkitDisplayingFullscreen","webkitExitFullscreen","webkitEnterFullscreen","shiftKey","offset","fullscreenElement","webkitFullscreenElement","msFullscreenElement","exitFullscreen","webkitCancelFullScreen","msExitFullscreen","innerTarget","listener","hasPointerEvent","onpointerup","hasTouchEvent","ontouchstart","pointerDown","pointerMove","pointerUp","onpointermove","defaultView","langMinutes","langSeconds","Selectable","$inputs","$input","_changeClassIfChecked","checkedInput","$input_","checked","viceOdpovedi","vybrano","disableFeedback","hideFeedback","NewTable","dataFrom","dataSources","tasks","autofill","_columnManager","_rowManager","$cell","columnId","rowId","_cellManager","$tableRow","rightToAdd","$headerCells","previousSibling","$rowCell","itemType","fillCell","$row","isRightToDeleteHelper","_removeTaskFromCache","$rows","$firstCell","columnIndex","_findCellType","cellController","$tag","$tags","removed","textId","$span","$innerItem","cacheObj","seed","answer","rightAnswer","$option","_correctedAnswer","attributes","numberOfDrops","rowType","$columnHeader","_this7","elm","deliveredValue","result","Draggable","idPrefix","$targetPrevious","$targetCurrent","$draggedItem","objWidth","objHeight","$dragItem","dragAndDropEvents","handleDeleteItemFromSvgDrop","handleAddTagsFromText","itemId","dropToken","onStart","onDrop","$dragItemHTML","$table","$placeholderOld","numberOfPossibleDrops","numberOfDropsDone","childElementCount","$placeholderNew","$slideActive","$rightElmChild","$cross","lastElementChild","removeDraggableItem","$sameItemFromDragPlace","$newDaggabletItem","$tagTextSpan","textToAdd","concreteTagName","windowLoadComponents","$videoPlayers","$videoPlayer","$audioPlayerNormals","$audioPlayerNormal","$audioPlayerSimples","$audioPlayerSimple","$fullscreenToggles","$fullscreenToggle","$magnifyingGlass","$fakeMaps","$editors","$testQuizs","$testQuiz","$newTables","$newTable","$draggables","$draggable","$sortables","$sortable","$selectables","$selectable","$keywords","Element","prototype","matches","warn","$unsupported","version","unsupportedBrowsers"],"mappings":"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"}