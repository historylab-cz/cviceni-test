{"version":3,"file":"components.build.js","sources":["../../../../src/js/components/component.js","../../../../src/js/components/magnifying-glass.js","../../../../src/js/lib/utils.js","../../../../src/js/components/photo-detail.js","../../../../src/js/components/media/media.js","../../../../src/js/components/media/audio-player.js","../../../../src/js/components/sortable.js","../../../../src/js/components/svg-lib/svg-dragndrop.js","../../../../src/js/components/svg-lib/svg-draw.js","../../../../src/js/components/svg-lib/svg-text.js","../../../../src/js/components/svg.js","../../../../src/js/components/svg-lib/svg-radial-menu.js","../../../../src/js/store/observer.js","../../../../src/js/store/store-constants.js","../../../../src/js/store/store.js","../../../../src/js/store/store-global.js","../../../../src/js/components/editor/editor.js","../../../../src/js/components/analytical-table.js","../../../../src/js/store/store-keywords.js","../../../../src/js/components/keywords.js","../../../../src/js/components/editor-tags-placeholder.js","../../../../src/js/components/test-quiz.js","../../../../src/js/components/generic-table.js","../../../../src/js/components/fullscreen.js","../../../../src/js/components/user-text.js","../../../../src/js/components/media/audio-player-normal.js","../../../../src/js/components/media/audio-player-simple.js","../../../../src/js/components/fake-map.js","../../../../src/js/components/media/video.js","../../../../src/js/components/components.js","../../../../src/js/components/dom-load.js","../../../../src/js/components/window-load.js"],"sourcesContent":["export default class Component {\n  constructor($element) {\n    this.target = $element;\n    this.$slide = this.target.closest('.slide');\n\n    if (this.$slide) {\n      this.$buttonFeedback = this.$slide.querySelector('[data-feedback-button]');\n      this.$buttonFeedbackText = this.$buttonFeedback.querySelector('span');\n    }\n\n    this.showFeedback = this.showFeedback.bind(this);\n  }\n\n  showFeedback() {\n    if (this.$buttonFeedback && this.$buttonFeedback.classList.contains('button-hidden')) {\n      this.$buttonFeedback.classList.remove('button-hidden');\n    }\n  }\n}\n","import Component from './component';\n\nexport default class MagnifyingGlass extends Component {\n  // https://www.youtube.com/watch?v=e8IwM3iqnL0\n  constructor($element) {\n    super($element);\n    // SVG lupa a ještě dynamicky měnícího se SVG,\n    // který není na počátku známé?\n    // if (el.nodeName === 'svg') {\n    //   console.log('SVG');\n    //   el.children[0].getAttribute('xlink:href')\n    // }\n    this.$element = document.querySelector('[data-lupa]');\n    this.$canvas = document.querySelector('[data-lupa-canvas]');\n    this.ctx = this.$canvas.getContext('2d');\n\n    this._onStart = this._onStart.bind(this);\n    this._onMove = this._onMove.bind(this);\n    this._onEnd = this._onEnd.bind(this);\n    this._update = this._update.bind(this);\n    this._onResize = this._onResize.bind(this);\n\n    this.zoomGlassSize = 230;\n    this.targetBCR = null;\n    this.zoomed = 0;\n    this.targetZoomed = 0;\n\n    this.x = 0;\n    this.y = 0;\n    this.trackingTouch = false;\n\n    this._addEventListeners();\n    this._initCanvas();\n    this._onResize();\n\n    window.requestAnimationFrame(this._update);\n  }\n\n  _initCanvas() {\n    const width = this.zoomGlassSize;\n    const height = this.zoomGlassSize;\n    // if retina makes canvas more dense\n    const dPR = window.devicePixelRation || 1;\n    this.$canvas.width = width * dPR;\n    this.$canvas.height = height * dPR;\n\n    this.$canvas.style.width = `${width}px`;\n    this.$canvas.style.height = `${height}px`;\n\n    this.ctx.scale(dPR, dPR);\n  }\n\n  _onResize() {\n    this.targetBCR = this.target.getBoundingClientRect();\n  }\n\n  _onStart(event) {\n    if (event.target !== this.target) {\n      return;\n    }\n\n    event.preventDefault();\n\n\n    this.x = event.pageX || event.touches[0].pageX;\n    this.y = event.pageY || event.touches[0].pageY;\n\n    this.trackingTouch = true;\n    this.targetZoomed = 1;\n    this.zoomed = 0;\n\n    window.requestAnimationFrame(this._update);\n  }\n\n  _onMove(event) {\n    if (!this.trackingTouch) {\n      return;\n    }\n\n    this.x = event.pageX || event.touches[0].pageX;\n    this.y = event.pageY || event.touches[0].pageY;\n  }\n\n  _onEnd() {\n    if (this.targetZoomed) {\n      // show OK button or feedback\n      this.showFeedback();\n    }\n\n    this.targetZoomed = 0;\n    this.trackingTouch = false;\n  }\n\n  _update() {\n    const TAU = Math.PI * 2;\n    const MAX_RADIUS = 100;\n    const radius = this.zoomed * MAX_RADIUS;\n\n    this.targetBCR = this.target.getBoundingClientRect();\n\n    // local coordinates (ratio <0,1>)\n    const ratioX =\n      // min. 0\n      Math.max(0,\n        // max. 1\n        Math.min(1, ((this.x - this.targetBCR.left) / this.targetBCR.width))\n      );\n    // console.log(ratioX);\n    const ratioY =\n      // min. 0\n      Math.max(0,\n        // max. 1\n        Math.min(1, ((this.y - this.targetBCR.top) / this.targetBCR.height))\n      );\n    // console.log(ratioY);\n\n    // actual zooming (scaling)\n    const imageScale = 2.5;\n    const scaledTargetWidth = this.targetBCR.width * imageScale;\n    const scaledTargetHeight = this.targetBCR.height * imageScale;\n\n    // Firefox on Windows has a bug because of the shadow\n    if (!(platform.os.family.indexOf('Windows') > -1 && platform.name.indexOf('Firefox') > -1)) {\n      // Shadow.\n      this.ctx.shadowColor = 'rgba(0,0,0,0.4)';\n      this.ctx.shadowBlur = 12;\n      this.ctx.shadowOffsetY = 8;\n    }\n\n    // Background.\n    this.ctx.clearRect(0, 0, this.zoomGlassSize, this.zoomGlassSize);\n    this.ctx.fillStyle = '#fff';\n    this.ctx.beginPath();\n    this.ctx.arc(\n      // x\n      this.zoomGlassSize / 2,\n      // y\n      (this.zoomGlassSize - 10) - radius,\n      // radius, startAngle, endAngle\n      radius, 0, TAU);\n    this.ctx.closePath();\n    this.ctx.fill();\n\n    // save the default state (without image)\n    this.ctx.save();\n\n    // Zoomed image.\n    this.ctx.beginPath();\n    this.ctx.arc(\n      // x\n      this.zoomGlassSize / 2,\n      // y\n      (this.zoomGlassSize - 10) - (radius + 1),\n      // radius, startAngle, endAngle\n      radius * 1.03, 0, TAU);\n    this.ctx.clip();\n    this.ctx.closePath();\n    this.ctx.drawImage(this.target,\n      // dx and dy (left and top)\n      (-ratioX * scaledTargetWidth) + (this.zoomGlassSize / 2),\n      (-ratioY * scaledTargetHeight) + (this.zoomGlassSize / 2),\n      // scaled width and height\n      scaledTargetWidth, scaledTargetHeight);\n\n    // go back to default state (without image)\n    // so next update starts fresh\n    this.ctx.restore();\n\n    // Position the parent $element.\n    this.$element.style.transform = `translate(${this.x}px, ${this.y}px)`;\n\n    // Update the zoom value.\n    this.zoomed += (this.targetZoomed - this.zoomed) / 4;\n\n    // Schedule another update if the zoom is fairly non-zero.\n    if (this.zoomed > 0.001) {\n      // if (this.zoomed > 0.001 && this.zoomed < 0.998) {\n      window.requestAnimationFrame(this._update);\n      // } else if (this.zoomed >= 0.998) {\n      //   this.zoomed = 1;\n    } else {\n      this.zoomed = 0;\n    }\n  }\n\n  _addEventListeners() {\n    // touch events\n    document.addEventListener('touchstart', this._onStart);\n    document.addEventListener('touchmove', this._onMove);\n    document.addEventListener('touchend', this._onEnd);\n    // mouse events\n    document.addEventListener('mousedown', this._onStart);\n    document.addEventListener('mousemove', this._onMove);\n    document.addEventListener('mouseup', this._onEnd);\n    // window events\n    window.addEventListener('resize', this._onResize);\n  }\n}\n","// https://stackoverflow.com/questions/901115/how-can-i-get-query-string-values-in-javascript#3855394\nexport function __getQueryStringParams() {\n  const parameters = window.location.search.substr(1).split('&');\n\n  if (parameters === '') {\n    return {};\n  }\n\n  const b = {};\n\n  for (let i = 0; i < parameters.length; i += 1) {\n    const p = parameters[i].split('=', 2);\n\n    if (p.length === 1) {\n      b[p[0]] = '';\n    } else {\n      b[p[0]] = decodeURIComponent(p[1].replace(/\\+/g, ' '));\n    }\n  }\n\n  return b;\n}\n\nexport function __createNewCustomEvent(name, options = {}, data = null) {\n  const defaults = {\n    // https://developer.mozilla.org/en-US/docs/Web/Guide/Events/Creating_and_triggering_events#Event_bubbling\n    bubbles: true,\n    // cancelBubble\n    // stopPropagation()\n    // cancelable\n    // composed\n    // currentTarget\n    // defaultPrevented\n    // preventDefault()\n    // eventPhase\n    // returnValue\n    // preventDefault()\n    // defaultPrevented\n    // target\n    // timeStamp\n    // type\n    // isTrusted\n  };\n\n  const properties = Object.assign(defaults, options);\n\n  return new CustomEvent(name, {\n    detail: data,\n    ...properties,\n  });\n}\n\nexport function __dispatchEvent($element, type, options, payload) {\n  const event = __createNewCustomEvent(type, options, payload);\n\n  $element.dispatchEvent(event);\n}\n\n/* https://plainjs.com/javascript/events/trigger-an-event-11/ */\nexport function __triggerEvent(el, type) {\n\n  if ('createEvent' in document) {\n    // modern browsers, IE9+\n    const e = new Event(type);\n    el.dispatchEvent(e);\n  } else {\n    // IE 8\n    const e = document.createEventObject();\n    e.eventType = type;\n    el.fireEvent('on'+e.eventType, e);\n  }\n}\n\nexport function __keycodeIsPrintableCharacter(keycode) {\n\n  const valid =\n    (keycode > 47 && keycode < 58) || // number keys\n    keycode == 32 || keycode == 13 || // spacebar & return key(s) (if you want to allow carriage returns)\n    (keycode > 64 && keycode < 91) || // letter keys\n    (keycode > 95 && keycode < 112) || // numpad keys\n    (keycode > 185 && keycode < 193) || // ;=,-./` (in order)\n    (keycode > 218 && keycode < 223); // [\\]' (in order)\n  // https://stackoverflow.com/questions/12467240/determine-if-javascript-e-keycode-is-a-printable-non-control-character#answer-12467610\n\n  return valid;\n\n}\n\nexport function __isObject(item) {\n  return (item && typeof item === 'object' && !Array.isArray(item));\n}\n\n// https://stackoverflow.com/questions/27936772/how-to-deep-merge-instead-of-shallow-merge\n// Maybe use lodash ? https://lodash.com/docs/4.17.10#defaultsDeep\nexport function __mergeDeep(target, source) {\n  const output = Object.assign({}, target);\n  if (__isObject(target) && __isObject(source)) {\n    Object.keys(source).forEach((key) => {\n      if (__isObject(source[key])) {\n        if (!(key in target)) {\n          Object.assign(output, { [key]: source[key] });\n        } else {\n          output[key] = __mergeDeep(target[key], source[key]);\n        }\n      } else {\n        Object.assign(output, { [key]: source[key] });\n      }\n    });\n  }\n  return output;\n}\n\nexport function __isObjectEmpty(object) {\n  return !Object.keys(object).length;\n}\n\nexport function __insertBefore(newNode, referenceNode) {\n  referenceNode.parentNode.insertBefore(newNode, referenceNode);\n}\n\nexport function __insertAfter(newNode, referenceNode) {\n\n  referenceNode.parentNode.insertBefore(newNode, referenceNode.nextSibling);\n\n}\n\nexport function __getRealDimensions(el, translated = true) {\n\n  const clonedElement = el.cloneNode(true);\n\n  clonedElement.style.visibility = 'hidden';\n  clonedElement.style.display = 'block';\n\n  __insertAfter(clonedElement, el);\n\n  const elDimensions = clonedElement.getBoundingClientRect();\n  const elPosition = (translated) ? __positionTranslated(clonedElement) : __position(clonedElement);\n\n\n  __remove(clonedElement);\n\n  return {\n    width: elDimensions.width,\n    height: elDimensions.height,\n    top: elPosition.top,\n    left: elPosition.left,\n  };\n\n}\n\nexport function __remove(el /* :HTMLElement */) {\n\n  el.parentNode.removeChild(el);\n\n}\n\n\nexport function __getHTML(node) {\n\n  if (!node || !node.tagName) { return; }\n  if (node.outerHTML) { return node.outerHTML; }\n\n  // polyfill:\n  const wrapper = document.createElement('div');\n  wrapper.appendChild(node.cloneNode(true));\n  return wrapper.innerHTML;\n\n}\n\nexport function __getText(el) {\n  return el.innerText || el.textContent;\n}\n\nexport function __globalPosition(event) {\n  // d3.event\n  // The current event, if any. This is set during the invocation of an event listener, and is reset after the listener terminates. Use this to access standard event fields such as event.timeStamp and methods such as event.preventDefault. While you can use the native event.pageX and event.pageY, it is often more convenient to transform the event position to the local coordinate system of the container that received the event using d3.mouse, d3.touch or d3.touches.\n  // If you use Babel, Webpack, or another ES6-to-ES5 bundler, be aware that the value of d3.event changes during an event! An import of d3.event must be a live binding, so you may need to configure the bundler to import from D3’s ES6 modules rather than from the generated UMD bundle; not all bundlers observe jsnext:main. Also beware of conflicts with the window.event global.\n  return {\n    x: event.pageX,\n    y: event.pageY,\n  };\n}\n\nexport function __localPosition(container) {\n  // d3.mouse\n  // Returns the x and y coordinates of the current event relative to the specified container. The container may be an HTML or SVG container element, such as a G element or an SVG element. The coordinates are returned as a two-element array of numbers [x, y].\n  // BUG: d3.mouse doesn’t observe CSS transform on Firefox — https://github.com/d3/d3-selection/issues/81\n  const pos = d3.mouse(container);\n  return {\n    x: d3.format('.0f')(pos[0]),\n    y: d3.format('.0f')(pos[1]),\n  };\n}\n\nexport function __positionTranslated(el) {\n\n\n  const curTransform = new WebKitCSSMatrix(window.getComputedStyle(el).webkitTransform);\n\n  const body = document.body;\n\n  const scrollTop = window.pageYOffset || body.scrollTop;\n  const scrollLeft = window.pageXOffset || body.scrollLeft;\n\n  return {\n    left: el.offsetLeft + curTransform.m41,\n    top: el.offsetTop + curTransform.m42,\n  };\n\n}\n\nexport function __position(el) {\n\n  const elAttibutes = el.getBoundingClientRect();\n  const body = document.body;\n\n  const scrollTop = window.pageYOffset || body.scrollTop;\n  const scrollLeft = window.pageXOffset || body.scrollLeft;\n\n  return {\n    left: elAttibutes.left + scrollLeft,\n    top: elAttibutes.top + scrollTop,\n    height: elAttibutes.height,\n    width: elAttibutes.width,\n  };\n}\n\n// TODO: check for https://github.com/vladocar/nanoJS/\nexport function __toggleClass(element, cls) {\n  if (__hasClass(element, cls)) {\n    __removeClass(element, cls);\n  } else {\n    __addClass(element, cls);\n  }\n}\n\nexport function __hasClass(element, cls) {\n  // if there are no elements or classes, we're done\n  if (!element || !cls) return false;\n  return (element.classList) ? element.classList.contains(cls) : (`${element.className} `).indexOf(`${cls} `) > -1;\n}\n\nexport function __addClass(elements, classes) {\n  let _elements = elements;\n  let _classes = classes;\n\n  // if there are no elements or classes, we're done\n  if (!_elements || !_classes) { return; }\n\n  if (typeof (_elements) === 'string') {\n    // if we have a selector, get the chosen _elements\n    _elements = document.querySelectorAll(_elements);\n  } else if (_elements.tagName) {\n    // if we have a single DOM element, make it an array to simplify behavior\n    _elements = [_elements];\n  }\n\n  if (typeof (_classes) === 'string') {\n    // make an array from string _classes\n    _classes = _classes.split(' ');\n  } else {\n    console.log('Class argument must be string with spaces in between class names.');\n    return;\n  }\n\n  // add class to all chosen _elements\n  for (let i = 0; i < _elements.length; i += 1) {\n    // check classList support\n    if (_elements[i].classList) {\n      _elements[i].classList.add(..._classes);\n    } else if (!__hasClass(_elements[i], ..._classes)) {\n      for (let j = 0; j < _classes.length; j += 1) {\n        _elements[i].classes += ` ${_classes[j]}`;\n      }\n    }\n  }\n}\n\nexport function __removeClass(elements, classes) {\n  let _elements = elements;\n  let _classes = classes;\n\n  // if there are no elements or classes, we're done\n  if (!_elements || !_classes) { return; }\n\n  if (typeof (_elements) === 'string') {\n    // if we have a selector, get the chosen _elements\n    _elements = document.querySelectorAll(_elements);\n  } else if (_elements.tagName) {\n    // if we have a single DOM element, make it an array to simplify behavior\n    _elements = [_elements];\n  }\n\n  if (typeof (_classes) === 'string') {\n    // make an array from string _classes\n    _classes = _classes.split(' ');\n  } else {\n    console.log('Class argument must be string with spaces in between class names.');\n    return;\n  }\n\n  // remove class from all chosen _elements\n  for (let i = 0; i < _elements.length; i += 1) {\n    // check classList support\n    if (_elements[i].classList) {\n      _elements[i].classList.remove(..._classes);\n    } else {\n      for (let j = 0; j < _classes.length; j += 1) {\n        _elements[i].className = _elements[i].className.replace(new RegExp(`\\\\b${classes[j]}\\\\b`, 'g'), '');\n      }\n    }\n  }\n}\n","import { __addClass, __removeClass, __hasClass } from '../lib/utils';\nimport Component from './component';\n\n// zoom the image\nexport default class PhotoDetail extends Component {\n  constructor(element) {\n    super(element);\n    this.zoomIntensity = 3;\n    this.targetContainer = this.target.parentElement;\n\n    this._onClick = this._onClick.bind(this);\n    this._onMove = this._onMove.bind(this);\n    // TODO: if window size has changed\n    this._onResize = this._onResize.bind(this);\n\n    this._getImageDimensions();\n    this._addEventListeners();\n  }\n\n  _getImageDimensions() {\n    // returns the size of the scaled image\n    // and its position relative to the viewport\n    this.targetBCR = this.target.getBoundingClientRect();\n\n    // we just need to set the height of the container\n    // only for on window load and on window resize\n    // width is 100% of its container\n    this.targetContainer.style.height = `${this.targetBCR.height}px`;\n\n    // TODO: count image side ratio\n  }\n\n  _onResize() {\n    // returns the size of the scaled image\n    // and its position relative to the viewport\n    this.targetBCR = this.target.getBoundingClientRect();\n  }\n\n  _onClick(event) {\n    if (event.target !== this.target) {\n      return;\n    }\n\n    // Cancels the event if it is cancelable, without stopping further propagation of the event.\n    event.preventDefault();\n\n    // to zoom\n    if (!__hasClass(this.target, 'enlarged')) {\n\n      this._onResize();\n\n      // add state class\n      __addClass(this.target, 'enlarged');\n\n      // get mouse event position\n      this.x = event.clientX || event.touches[0].pageX;\n      this.y = event.clientY || event.touches[0].pageY;\n\n      // set position\n      this.target.style.top = `${this.positionY}%`;\n      this.target.style.left = `${this.positionX}%`;\n    } else {\n      // to unzoom\n      // remove move state class if present\n      if (__hasClass(this.target, 'detail-move')) {\n        __removeClass(this.target, 'detail-move');\n      }\n\n      // remove zoom state class\n      __removeClass(this.target, 'enlarged');\n\n      // remove zoomed position\n      this.target.style.left = '';\n      this.target.style.top = '';\n    }\n  }\n\n  _onMove(event) {\n    if (event.target !== this.target || !__hasClass(this.target, 'enlarged')) {\n      return;\n    }\n\n    // run only it was zoomed already\n    if (__hasClass(this.target, 'enlarged')) {\n\n      // add state class\n      if (!__hasClass(this.target, 'detail-move')) {\n        __addClass(this.target, 'detail-move');\n      }\n\n      // track mouse event position\n      this.x = event.clientX || event.touches[0].pageX;\n      this.y = event.clientY || event.touches[0].pageY;\n\n      // get position\n      this.target.style.top = `${this.positionY}%`;\n      this.target.style.left = `${this.positionX}%`;\n    }\n\n  }\n\n  static get positionY() {\n    return (((this.y - this.targetBCR.top) / this.targetBCR.height) * -100) * (this.zoomIntensity - 1);\n  }\n  static get positionX() {\n    return (((this.x - this.targetBCR.left) / this.targetBCR.width) * -100) * (this.zoomIntensity - 1);\n  }\n\n  _addEventListeners() {\n    // touch events\n    document.addEventListener('touchstart', this._onClick);\n    document.addEventListener('touchmove', this._onMove);\n    // mouse events\n    document.addEventListener('mousedown', this._onClick);\n    document.addEventListener('mousemove', this._onMove);\n    // window events\n    // window.addEventListener('resize', this._onResize);\n  }\n}\n","import { __createNewCustomEvent } from '../../lib/utils';\n\nconst mediaEvents = {\n  playchange: __createNewCustomEvent('playchange'),\n  timechange: __createNewCustomEvent('timechange'),\n  canplaystart: __createNewCustomEvent('canplaystart'),\n};\n\nfunction stopPlayingVideoPlayers($players) {\n  // pause all other playing media tracks\n  $players.forEach(($player) => {\n    const $media = $player.querySelector('audio') || $player.querySelector('video');\n    if ($media && !$media.paused) {\n      $media.pause();\n      $player\n        .querySelector('[data-player-control]')\n        .setAttribute('data-player-control', 'paused');\n    }\n  });\n}\n\nfunction getSecondsMinutesFormat(seconds) {\n  const duration = {\n    seconds: Math.floor(seconds),\n    minutes: Math.floor(seconds / 60),\n  };\n\n  duration.seconds = (duration.seconds - (duration.minutes * 60)).toString(10);\n\n  return `${duration.minutes}:${(`0${duration.seconds}`).slice(-2)}`;\n}\n\nexport {\n  getSecondsMinutesFormat,\n  stopPlayingVideoPlayers,\n  mediaEvents,\n};\n","import Component from '../component';\nimport { getSecondsMinutesFormat, stopPlayingVideoPlayers } from './media';\n\nexport default class AudioPlayer extends Component {\n  // eslint-disable-next-line no-useless-constructor\n  constructor($element) {\n    super($element);\n  }\n\n  // TODO: move to audio-simple.js\n  static addEventListeners($item, showFeedback) {\n    const $players = document.querySelectorAll('[data-player-audio]');\n    const $audio = $item.querySelector('audio');\n    const $playButton = $item.querySelector('[data-player-control]');\n    const $timeLeft = $item.querySelector('[data-audio-time-left]');\n\n    $playButton.addEventListener('click', (event) => {\n      if ($playButton.getAttribute('data-player-control') === 'paused') {\n        // TODO: abstract\n        stopPlayingVideoPlayers(Array.from($players));\n        $audio.play();\n        $playButton.setAttribute('data-player-control', 'playing');\n      } else {\n        // TODO: abstract\n        $audio.pause();\n        $playButton.setAttribute('data-player-control', 'paused');\n      }\n\n      showFeedback();\n\n      event.stopPropagation();\n    }, false);\n\n    // do not propagate audio control events higher into the dom\n    $playButton.addEventListener('mousedown', (event) => {\n      event.stopPropagation();\n    }, false);\n\n    $audio.addEventListener('timeupdate', () => {\n      $timeLeft.innerText = getSecondsMinutesFormat($audio.currentTime);\n    });\n\n    $audio.addEventListener('ended', () => {\n      $playButton.setAttribute('data-player-control', 'paused');\n    });\n  }\n}\n","import Component from './component';\nimport AudioPlayer from './media/audio-player';\nimport { stopPlayingVideoPlayers } from './media/media';\n\nexport default class Sortable extends Component {\n  constructor($element) {\n    super($element);\n\n    this.container = this.target;\n    this.items = $element.querySelectorAll('[data-sortable-drag]');\n    this.droppables = $element.querySelectorAll('[data-sortable-drop]');\n    this.placeholder = () => document.querySelector('#sortable-placeholder');\n    this.$players = this.container.querySelectorAll('[data-player-audio]');\n\n    // get direction (type of sortable \"horizontalni\" or \"vertikalni\")\n    this.direction = this.target.getAttribute('data-sortable-target');\n    this.trackingTouch = false;\n    this.before = false;\n    this.after = false;\n\n    this.mouse = {\n      x: event => event.clientX || event.touches[0].clientX,\n      y: event => event.clientY || event.touches[0].clientY,\n      x0: 0,\n      y0: 0,\n      x1: 0,\n      y1: 0,\n    };\n\n    this.dragged = {\n      el: null,\n      clone: null,\n      posRel: {},\n      rect: () => this.dragged.el.getBoundingClientRect(),\n      size: {},\n    };\n\n    this.siblings = {\n      prev: null,\n      next: null,\n    };\n\n    this._onStart = this._onStart.bind(this);\n    this._onMove = this._onMove.bind(this);\n    this._onEnd = this._onEnd.bind(this);\n    this._update = this._update.bind(this);\n\n    this._addEventListeners();\n  }\n\n  _onStart(event) {\n    if (!event.target.hasAttribute('data-sortable-drag')) {\n      return;\n    }\n\n    // TODO: zastavit všechno audio on drag start\n    if (this.$players.length > 0) {\n      stopPlayingVideoPlayers(this.$players);\n    }\n\n\n    this.trackingTouch = true;\n\n    this.dragged.el = event.target;\n    this.dragged.clone = this.dragged.el.cloneNode(true);\n    this.dragged.posRel.top = this.dragged.el.offsetTop;\n    this.dragged.posRel.left = this.dragged.el.offsetLeft;\n    this.dragged.size.width = this.dragged.el.offsetWidth;\n    this.dragged.size.height = this.dragged.el.offsetHeight;\n\n    this.dragged.el.style.top = `${this.dragged.posRel.top}px`;\n    this.dragged.el.style.left = `${this.dragged.posRel.left}px`;\n    this.dragged.el.style.width = `${this.dragged.size.width}px`;\n    this.dragged.el.style.height = `${this.dragged.size.height}px`;\n    this.dragged.el.classList.add('is-dragged');\n\n    this.container.classList.add('is-dragged');\n\n    this._addPlaceholder(this.dragged.el);\n    this._onOver(event);\n\n    this.mouse.x0 = this.mouse.x(event);\n    this.mouse.y0 = this.mouse.y(event);\n\n    event.preventDefault();\n  }\n\n  _onMove(event) {\n    if (!this.trackingTouch) {\n      return;\n    }\n\n    this.mouse.x1 = this.mouse.x(event) - this.mouse.x0;\n    this.mouse.y1 = this.mouse.y(event) - this.mouse.y0;\n\n    window.requestAnimationFrame(this._update);\n\n    this._onOver(event);\n  }\n\n  _onEnd(event) {\n    if (!this.trackingTouch) {\n      return;\n    }\n\n    this.trackingTouch = false;\n    this.container.classList.remove('is-dragged');\n    this.dragged.el.classList.remove('is-dragged');\n    this.dragged.el.style.top = '';\n    this.dragged.el.style.left = '';\n    this.dragged.el.style.width = '';\n    this.dragged.el.style.height = '';\n    this.dragged.el.style.transform = '';\n\n    const placeholder = this.placeholder();\n    const rect = placeholder.getBoundingClientRect();\n\n    switch (this.direction) {\n      case 'horizontal':\n        if (rect.left <= this.mouse.x(event) <= rect.right) {\n          this._onDrop();\n        }\n        break;\n      case 'vertical':\n        if (rect.top <= this.mouse.y(event) <= rect.bottom) {\n          this._onDrop();\n        }\n        break;\n\n      default:\n        break;\n    }\n\n    this._removePlaceholder();\n  }\n\n  // _onEnter() {}\n\n  _onOver(event) {\n    this.before = false;\n    this.after = false;\n\n    this._getReference();\n\n    if (\n      this.siblings.next\n      && this.siblings.next.hasAttribute('data-sortable-drop')\n    ) {\n      const next = this.siblings.next.getBoundingClientRect();\n\n      switch (this.direction) {\n        case 'horizontal':\n          if (this.dragged.rect().right > (next.left + (next.width / 1.5))) {\n            this.after = true;\n            this._addPlaceholder(this.siblings.next);\n          }\n          break;\n        case 'vertical':\n          if (this.dragged.rect().bottom > (next.top + (next.height / 1.5))) {\n            this.after = true;\n            this._addPlaceholder(this.siblings.next);\n          }\n          break;\n\n        default:\n          break;\n      }\n    }\n\n    if (\n      this.siblings.prev\n      && this.siblings.prev.hasAttribute('data-sortable-drop')\n    ) {\n      const prev = this.siblings.prev.getBoundingClientRect();\n\n      switch (this.direction) {\n        case 'horizontal':\n          if (this.dragged.rect().left < (prev.right - (prev.width / 1.5))) {\n            this.before = true;\n            this._addPlaceholder(this.siblings.prev);\n          }\n          break;\n        case 'vertical':\n          if (this.dragged.rect().top < (prev.bottom - (prev.height / 1.5))) {\n            this.before = true;\n            this._addPlaceholder(this.siblings.prev);\n          }\n          break;\n\n        default:\n          break;\n      }\n    }\n  }\n\n  // _onLeave() {}\n\n  _onDrop() {\n    const placeholder = this.placeholder();\n\n    this._addEventListenerToItem(this.dragged.clone);\n    // TODO: přiřadit eventListenery audio playerům\n    if (this.dragged.clone.querySelector('[data-player-audio]')) {\n      AudioPlayer.addEventListeners(this.dragged.clone, this.showFeedback);\n    }\n\n    this.container.insertBefore(this.dragged.clone, placeholder);\n    this.dragged.el.parentNode.removeChild(this.dragged.el);\n\n    // show OK button or feedback\n    this.showFeedback();\n  }\n\n  _update() {\n    this.dragged.el.style.transform = `translate3d(${this.mouse.x1}px, ${\n      this.mouse.y1\n    }px, 0) rotate(5deg)`;\n  }\n\n  _addPlaceholder(item) {\n    this._removePlaceholder();\n\n    const placeholder = document.createElement('div');\n    placeholder.classList.add('sortable-item', 'sortable-placeholder');\n    placeholder.setAttribute('id', 'sortable-placeholder');\n    placeholder.style.minHeight = `${this.dragged.size.height}px`;\n\n    if (this.dragged.el.querySelector('img')) {\n      const src = this.dragged.el.querySelector('img').getAttribute('src');\n      const img = document.createElement('img');\n      img.setAttribute('src', src);\n      placeholder.appendChild(img);\n    }\n\n    if (this.after) {\n      this.container.insertBefore(placeholder, item.nextElementSibling);\n    } else if (this.before) {\n      this.container.insertBefore(placeholder, item);\n    } else {\n      this.container.insertBefore(placeholder, item);\n    }\n  }\n\n  _removePlaceholder() {\n    const placeholder = this.placeholder();\n    if (placeholder) placeholder.parentNode.removeChild(placeholder);\n  }\n\n  _getReference() {\n    const placeholder = this.placeholder();\n    this.siblings.prev = placeholder.previousElementSibling === this.dragged.el\n      ? this.dragged.el.previousElementSibling\n      : placeholder.previousElementSibling;\n    this.siblings.next = placeholder.nextElementSibling === this.dragged.el\n      ? this.dragged.el.nextElementSibling\n      : placeholder.nextElementSibling;\n  }\n\n  _addEventListenerToItem($item) {\n    // touch events\n    $item.addEventListener('touchstart', this._onStart, false);\n    // mouse events\n    $item.addEventListener('mousedown', this._onStart, false);\n  }\n\n  _addEventListeners() {\n    // touch events\n    document.addEventListener('touchmove', this._onMove);\n    document.addEventListener('touchend', this._onEnd);\n    // mouse events\n    document.addEventListener('mousemove', this._onMove);\n    document.addEventListener('mouseup', this._onEnd);\n\n    for (let i = 0; i < this.items.length; i += 1) {\n      this._addEventListenerToItem(this.items[i]);\n    }\n  }\n}\n","export default class SVGDragNDrop {\n  // static drag(id) {\n  //   d3.drag()\n  //     .on('start', () => {\n  //       SVGDragNDrop.start(id);\n  //     })\n  //     .on('drag', () => {\n  //       SVGDragNDrop.dragged(id);\n  //     })\n  //     .on('end', () => {\n  //       SVGDragNDrop.end(id);\n  //     });\n  // }\n\n  static start(element) {\n    d3.select(element).raise().classed('is-dragged', true);\n  }\n\n  static dragged(element, diff) {\n\n    d3.select(element)\n      .attr('x', (d3.event.x - diff.x).toFixed())\n      .attr('y', (d3.event.y - diff.y).toFixed());\n  }\n\n  static end(element, type, diff) {\n\n    d3.select(element)\n      .attr('x', (d3.event.x - diff.x).toFixed())\n      .attr('y', (d3.event.y - diff.y).toFixed())\n      // neumožňuje v jiných funkcí s tímto objektem dále pracovat,\n      // protože pracují s id\n      // .attr('id', `${type}-${d3.event.x.toFixed()}-${d3.event.y.toFixed()}`)\n      .classed('is-dragged', false);\n  }\n}\n","import { __localPosition, __dispatchEvent } from '../../lib/utils';\n\n// import SVG from '../svg';\nimport SVGDragNDrop from './svg-dragndrop';\n\nexport default class SVGDraw {\n  // static selectPath(svg) {\n  //   // https://bl.ocks.org/mbostock/8027637\n  // }\n\n  static renderPath($svg, callback) {\n    if (d3.event.sourceEvent.target.nodeName === 'image') {\n\n      const line = d3.line()\n        // removed smooth curve to get rid of loong decimals\n        // see https://github.com/d3/d3-path/issues/10\n        .curve(d3.curveLinear); // _dragStarted\n\n      const format = d3.format('.0f');\n      const d = d3.event.subject;\n      // origin\n      let x0 = format(d3.event.x);\n      let y0 = format(d3.event.y);\n\n      const id = `path-${x0}-${y0}`;\n\n      const active = d3.select(`#${$svg.id} .svg-view`).append('svg:path')\n        // .attr('marker-start', 'url('#marker-circle-blue')')\n        // .attr('marker-end', 'url('#marker-arrow-blue')')\n        .attr('data-svg-path', '')\n        .attr('class', 'svg-path')\n        .attr('id', id)\n        .datum(d);\n\n      // github.com/d3/d3-drag#event_on\n      d3.event\n        .on('drag', () => {\n          // current position\n          const x1 = format(d3.event.x);\n          const y1 = format(d3.event.y);\n          // distance from origin\n          const dx = x1 - x0;\n          const dy = y1 - y0;\n\n          // if the distance of drag event is too large, make new origin\n          if ((dx * dx) + (dy * dy) > 300) d.push([x0 = x1, y0 = y1]);\n          // smooth line, correct last point\n          else d[d.length - 1] = [x1, y1];\n\n          active.attr('d', line);\n        })\n        .on('end', () => {\n          const $thisPath = d3.select(`#${id}`);\n          if ($thisPath) {\n            if ($thisPath.attr('d')) {\n              if ($thisPath.attr('d').length < 40) {\n                $thisPath.remove();\n              }\n            } else if (!$thisPath.attr('d')) {\n              $thisPath.remove();\n            }\n          }\n\n          // dispatch event that svg has changed\n          __dispatchEvent(document, 'svg.change', {}, { svg: { id: $svg.id, activity: 'createPath', target: id } });\n\n          callback();\n        });\n\n      d3.select(`#${id}`).on('click', () => {\n        d3.select(`#${id}`).remove();\n\n        // dispatch event that svg has changed\n        __dispatchEvent(document, 'svg.change', {}, { svg: { id: $svg.id, activity: 'deletePath', target: id } });\n        d3.event.preventDefault();\n      }, false);\n\n    }\n\n  }\n\n  // Draw a SVG circle on click\n  static createCircle($svg, color = 'blue') {\n    const d3svg = d3.select(`#${$svg.id} .svg-view`);\n    const canvas = document.querySelector(`#${$svg.id} .svg-view`);\n    const localPosition = __localPosition($svg);\n    const id = `circle-${localPosition.x}-${localPosition.y}`;\n    const hash = `#${id}`;\n    // circle wrapper\n    const foreignObject = d3svg.append('svg:foreignObject')\n      .attr('data-svg-circle', '')\n      .attr('id', id)\n      .attr('x', localPosition.x)\n      .attr('y', localPosition.y)\n      .attr('width', 1)\n      .attr('height', 1);\n\n    // TODO:\n    // standalone function\n    // same for all draggable svg elements\n    const element = document.querySelector(hash);\n    let elementPosition = [\n      element.getAttribute('x'),\n      element.getAttribute('y'),\n    ];\n    let diff = {};\n\n    const circle = foreignObject.append('xhtml:div')\n      .attr('class', 'svg-circle')\n      .on('click', () => {\n\n        // dispatch event that svg has changed\n        __dispatchEvent(document, 'svg.change', {}, { svg: { id: $svg.id, activity: 'deleteTextOrCircle', target: id } });\n\n        d3.select(d3.event.target.parentNode).remove();\n      })\n      .call(d3.drag()\n        .container(canvas)\n        .subject(element)\n        .on('start', () => {\n          diff = {\n            x: d3.event.x - elementPosition[0],\n            y: d3.event.y - elementPosition[1],\n          };\n\n          SVGDragNDrop.start(hash);\n        })\n        .on('drag', () => {\n          SVGDragNDrop.dragged(hash, diff);\n        })\n        .on('end', () => {\n          SVGDragNDrop.end(hash, 'circle', diff);\n\n          elementPosition = [\n            element.getAttribute('x'),\n            element.getAttribute('y'),\n          ];\n\n          // dispatch event that svg has changed\n          __dispatchEvent(document, 'svg.change', {}, { svg: { id: $svg.id, activity: 'createCircle', target: id } });\n        }),\n      // eslint-disable-next-line function-paren-newline\n      );\n\n      // dispatch event that svg has changed\n      __dispatchEvent(document, 'svg.change', {}, { svg: { id: $svg.id, activity: 'createCircle', target: id } });\n  }\n}\n","import { __addClass, __removeClass, __hasClass, __dispatchEvent } from '../../lib/utils';\n\nimport SVG from '../svg';\nimport SVGDragNDrop from './svg-dragndrop';\n\nexport default class SVGText {\n  static createText(maxLength = 333, minLength = 2) {\n    const $svg = document.querySelector('[data-svg-active=\"true\"]');\n    const svgID = $svg.id;\n    const svgGroup = d3.select($svg).select('.svg-view');\n\n    const $canvas = $svg.querySelector('.svg-view');\n    const $radialMenu = document.querySelector('[data-radial-menu]');\n    const localPosition = {\n      x: $radialMenu.getAttribute('data-local-x'),\n      y: $radialMenu.getAttribute('data-local-y'),\n    };\n    const boxId = `svg-textBox-${localPosition.x}-${localPosition.y}`;\n    const id = `svg-text-${localPosition.x}-${localPosition.y}`;\n    const hash = `#${id}`;\n    const orientation = {\n      x: (svgGroup.attr('width') - localPosition.x) > 320 ? 'right' : 'left',\n      y: (svgGroup.attr('height') - localPosition.y) > 60 ? 'bottom' : 'top',\n    };\n\n    // text wrapper\n    const foreignObject = svgGroup.append('svg:foreignObject')\n      .attr('class', `svg-text orientation-${orientation.x} orientation-${orientation.y}`)\n      .attr('data-svg-text', '')\n      .attr('id', boxId)\n      .attr('x', localPosition.x)\n      .attr('y', localPosition.y)\n      .attr('width', 1)\n      .attr('height', 1);\n\n    // create visual point of interest for text input\n    foreignObject.append('xhtml:div')\n      .attr('class', 'svg-circle svg-circle-text');\n    // create text input\n    const textarea = foreignObject.append('xhtml:textarea')\n      .attr('maxlength', maxLength)\n      .attr('tabindex', '-1')\n      .attr('id', id)\n      .attr('class', 'svg-textarea')\n      .attr('data-save', '')\n      .attr('data-svg-textarea-target', svgID);\n\n    // set focus to the new text input\n    document.querySelector(`${hash}`).focus();\n\n    // TODO\n    // standalone function\n    // same for all draggable svg elements\n    const element = document.querySelector(hash).parentNode;\n    let elementPosition = [\n      element.getAttribute('x'),\n      element.getAttribute('y'),\n    ];\n    let diff = {};\n\n    // dispatch event that svg has changed\n    __dispatchEvent(document, 'svg.change', {}, { svg: { id: svgID, activity: 'createText', target: boxId} });\n\n    d3.select(`${hash}`)\n      // drag & drop\n      .call(d3.drag()\n        .container($canvas)\n        .subject(element)\n        .on('start', () => {\n          diff = {\n            x: d3.event.x - elementPosition[0],\n            y: d3.event.y - elementPosition[1],\n          };\n\n          SVGDragNDrop.start(element);\n        })\n        .on('drag', () => {\n          SVGDragNDrop.dragged(element, diff);\n        })\n        .on('end', () => {\n          SVGDragNDrop.end(element, 'text', diff);\n\n          elementPosition = [\n            element.getAttribute('x'),\n            element.getAttribute('y'),\n          ];\n\n          // dispatch event that svg has changed\n          __dispatchEvent(document, 'svg.change', {}, { svg: { id: svgID, activity: 'createText', target: boxId} });\n        }))\n      // keystroke\n      // control height of the text input on every key stroke\n      .on('keyup', () => {\n        SVGText.updateTextareaHeight(d3.event.target);\n\n        // dispatch event that svg has changed\n        __dispatchEvent(document, 'svg.change', {}, { svg: { id: svgID, activity: 'changeText', target: id, data: d3.event.target.value} });\n      })\n      // loss of focus\n      .on('blur', () => {\n        const target = d3.event.target;\n        const value = target.value;\n\n        if (value.length === 0) {\n          SVG.removeItem(hash);\n          return;\n        }\n        if (value.length < minLength) {\n          __addClass(target, 'is-wrong');\n        } else if ((value.length >= minLength) && __hasClass(target, 'is-wrong')) {\n          __removeClass(target, 'is-wrong');\n        }\n      })\n      // gain focus\n      .on('focus', () => {\n        d3.select(element).raise();\n      });\n  }\n\n  static updateTextareaHeight($target) {\n    $target.style.height = '1px';\n    $target.style.height = `${22 + $target.scrollHeight}px`;\n  }\n}\n","/* eslint-disable brace-style */\nimport Component from './component';\nimport { __dispatchEvent, __removeClass, __addClass} from '../lib/utils';\nimport SVGDraw from './svg-lib/svg-draw';\nimport SVGText from './svg-lib/svg-text';\n\nexport default class SVG extends Component {\n  constructor($element) {\n    super($element);\n\n    this.init();\n  }\n\n  init() {\n    // make array from data-attributes (contains what kind of actions can user do on this svg)\n    const svgSpecificActions = this.target.getAttribute('data-svg-target').split(' ');\n    for (let i = 0; i < svgSpecificActions.length; i += 1) {\n      if (svgSpecificActions[i] === 'kresleni') {\n        this._initPath(this.showFeedback);\n      }\n      else if (svgSpecificActions[i] === 'znacky') {\n        this._initCircle(this.showFeedback);\n      }\n      // else if (svgSpecificActions[i] === 'text') {\n      //   this._initText();\n      // }\n    }\n\n    // this._initZoom();\n    // fix for IE\n    this._setSize();\n    // comic bubbles if exists\n    this._initComicBubbles();\n\n    // duplicate source of different svg element\n    const svgDuplicateSources = this.target.getAttribute('duplicate-svg').split(' ');\n    if (svgDuplicateSources[0]) {\n      this._getEvents(svgDuplicateSources);\n    }\n  }\n\n  _setSize() {\n    // TODO: set size on window resize\n    const viewbox = this.target.getAttribute('viewBox').split(' ');\n    const height = this.target.getBoundingClientRect().height;\n    const scale = height / viewbox[3];\n\n    this.target.style.maxWidth = `${viewbox[2] * scale}px`;\n  }\n\n  // _initZoom() {\n  //   const view = d3.select(`#${this.target.id} .svg-view`);\n  //   const size = [\n  //     view.attr('width'),\n  //     view.attr('height'),\n  //   ];\n  //   SVGZoom.zoom(this.target, view, size);\n  // }\n\n  _initPath(callback) {\n    d3.select(this.target)\n      .call(d3.drag()\n        .container(() => this.target)\n        .subject(() => {\n          const p = [d3.event.x.toFixed(), d3.event.y.toFixed()];\n\n          return [p, p];\n        })\n        .on('start', () => {\n          SVGDraw.renderPath(this.target, callback);\n        }));\n  }\n  // _initText() {\n  //   d3.select(this.target).on('click', () => {\n  //     SVGText.openTextDialog(this.target);\n  //     d3.event.preventDefault();\n  //   });\n  // }\n\n  _initCircle(callback) {\n    d3.select(this.target).on('click', () => {\n      const item = d3.event.target;\n      const nodeName = item.nodeName;\n      const validPlace = (nodeName === 'image');\n      // const isCircle = (__hasClass(item, 'svg-circle'));\n\n      if (!validPlace) {\n        return;\n      }\n\n      SVGDraw.createCircle(this.target);\n      callback();\n\n      d3.event.preventDefault();\n    }, false);\n  }\n\n  _initComicBubbles() {\n    const comicBubbles = this.target.querySelectorAll('.svg-komiks .svg-textarea');\n\n    if (comicBubbles) {\n      d3.selectAll(comicBubbles).on('keyup', () => {\n        SVGText.updateTextareaHeight(d3.event.target);\n      });\n    }\n  }\n\n  _getEvents(svgDuplicateSources) {\n    let node = null;\n    let textNode = null;\n    let pathNode = null;\n    let circleNode = null;\n    let textBox = null;\n\n    document.addEventListener('svg.change', (e) => {\n      //new interactive elements which are duplicatet have same id and \"-clone\"\n      if (svgDuplicateSources.includes(e.detail.svg.id)) {\n        switch (e.detail.svg.activity) {\n          case 'createPath':\n            pathNode = this.target.querySelector(\"#\" + e.detail.svg.target);\n            if (pathNode) {\n              pathNode.remove();\n            }\n            console.log('createPath');\n            pathNode = document.querySelector(\"#\" + e.detail.svg.target);\n            if (pathNode) {\n              const pathClone = pathNode.cloneNode( true);\n              this.target.appendChild(pathClone);\n            }\n            break;\n          case 'deletePath':\n            console.log('deletePath');\n            pathNode = this.target.querySelector(\"#\" + e.detail.svg.target);\n            pathNode.remove();\n            break;\n          case 'createCircle':\n            //if exists remove => use for drag'a'drop\n            circleNode = this.target.querySelector(\"#\" + e.detail.svg.target + \"-clone\");\n            if (circleNode) {\n              circleNode.remove();\n            }\n            console.log('createCircle');\n            circleNode = document.querySelector(\"#\" + e.detail.svg.target);\n            if (circleNode) {\n              const circleClone = circleNode.cloneNode( true);\n              circleClone.id = circleClone.id + \"-clone\";\n              this.target.appendChild(circleClone);\n            }\n            break;\n          case 'changeColorCircle':\n            console.log('changeColorCircle');\n            circleNode = this.target.querySelector(\"#\" + e.detail.svg.target + \"-clone\").childNodes[0];\n            if (circleNode) {\n              __removeClass(circleNode, 'red blue');\n              __addClass(circleNode, e.detail.svg.color);\n            }\n            break;\n          case 'createText':\n            //if exists remove => use for drag'a'drop\n            textNode = this.target.querySelector(\"#\" + e.detail.svg.target + \"-clone\");\n            if (textNode) {\n              textNode.remove();\n            }\n            console.log('createText');\n            textBox = document.querySelector(\"#\" + e.detail.svg.target);\n            if (textBox) {\n              const textBoxClone = textBox.cloneNode(true);\n              textBoxClone.id = textBoxClone.id + \"-clone\";\n\n              //universal way how to change id of duplicated texarea\n              //textBoxClone.childNodes[1].id = textBoxClone.childNodes[1].id + \"-clone\";\n              for (let elem of textBoxClone.childNodes) {\n                if (elem.type === 'textarea') {\n                  elem.id = elem.id + \"-clone\";\n                }\n              }\n\n              this.target.appendChild(textBoxClone);\n            }\n            break;\n          case 'changeText':\n            console.log('changeText');\n            textNode = this.target.querySelector(\"#\" + e.detail.svg.target + \"-clone\");\n            textNode.value = e.detail.svg.data;\n            break;\n          case 'deleteTextOrCircle':\n            console.log('deleteTextOrCircle');\n            node = this.target.querySelector(\"#\" + e.detail.svg.target + \"-clone\");\n            node.remove();\n            break;\n        }\n      }\n    });\n  }\n\n  static selectItem(item) {\n    item.setAttribute('data-svg-selected', 'true');\n  }\n\n  // Remove 'selected' classname from element within SVG\n  static deselectItem() {\n    // previously \"selected\" elements\n    const selected = document.querySelectorAll('[data-svg-selected=\"true\"]');\n    // unselect them\n    for (let i = 0; i < selected.length; i += 1) {\n      selected[i].setAttribute('data-svg-selected', 'false');\n    }\n  }\n\n  // Remove element from within SVG\n  static removeItem(item = '[data-svg-selected=\"true\"]') {\n    const svg = document.querySelector(\"div[class~=active-slide] svg[class~=svg]\");\n    const $parent = document.querySelector(item).parentNode;\n\n    // dispatch event that svg has changed\n    __dispatchEvent(document, 'svg.change', {}, { svg: { id: svg.id, activity: 'deleteTextOrCircle', target: $parent.id } });\n\n    if ($parent.nodeName === 'foreignObject') {\n      d3.select($parent).remove();\n    } else {\n      d3.select(item).remove();\n    }\n  }\n\n  // Unmark all SVGs with 'svg-active' classname\n  static deactivate() {\n    const allActiveSvgs = document.querySelectorAll('[data-svg-active=\"true\"]');\n    for (let i = 0; i < allActiveSvgs.length; i += 1) {\n      allActiveSvgs[i].setAttribute('data-svg-active', 'false');\n    }\n  }\n\n  // Mark active SVG with 'svg-active' classname\n  static activate(svg) {\n    SVG.deactivate();\n    svg.setAttribute('data-svg-active', 'true');\n  }\n}\n","/* eslint-disable brace-style */\nimport {\n  __addClass,\n  __removeClass,\n  __hasClass,\n  __localPosition,\n  __globalPosition,\n  __dispatchEvent\n} from '../../lib/utils';\nimport SVG from '../svg';\nimport SVGText from './svg-text';\n\nexport default class SVGRadialMenu {\n\n  constructor($radialMenu, $svgs) {\n    this.$radialMenu = $radialMenu;\n    this.$radialMenuItems = this.$radialMenu.querySelectorAll('[data-radial-menu-item]');\n    this.$colorItems = this.$radialMenu.querySelectorAll('.radial-menu-color');\n    this.$textItems = this.$radialMenu.querySelectorAll('.radial-menu-text');\n    this.$createTextItem = this.$radialMenu.querySelector('#create-text');\n    this.$removeItem = this.$radialMenu.querySelector('#remove-content');\n    this.$tooltip = this.$radialMenu.querySelector('[data-radial-menu-tooltip]');\n    this.$svgs = $svgs;\n\n    this.initialSetUp = true;\n\n    this.menuRadius = parseInt(window.getComputedStyle(this.$radialMenu.querySelector('.radial-menu-wrapper'), null).getPropertyValue('width'), 10) / 2;\n    this.itemRadius = parseInt(window.getComputedStyle(this.$radialMenu.querySelector('.radial-menu-item'), null).getPropertyValue('width'), 10) / 2;\n\n    this.init();\n  }\n\n  init() {\n    this.setUpRadialMenuItems();\n    this.addEventListenersToRadialMenu();\n\n    // activate radial menu when right click on svg\n    Array.from(this.$svgs).forEach(($svg) => {\n      d3.select($svg).on('contextmenu', () => {\n        // mark this SVG as the active one\n        SVG.activate($svg);\n        // deselect all previously selected items\n        SVG.deselectItem();\n        // show radial menu buttons based on clicked element\n        // and .select appropriate elements based on clicked element\n        this.filterMenuButtons(d3.event.target);\n        this.showRadialMenu($svg, d3.event);\n        // prevent default 'contextmenu' event\n        d3.event.preventDefault();\n      });\n    });\n\n    this.initialSetUp = false;\n  }\n\n  setUpRadialMenuItems() {\n    // this.positionRadialMenuItems(this.$radialMenuItems);\n\n    Array.from(this.$radialMenuItems).forEach(($item) => {\n      this.addEventListenersToRadialMenuItem($item);\n    });\n  }\n\n  positionRadialMenuItems($items) {\n    const _itemsLength = $items.length;\n    const _menuRadius = this.menuRadius;\n    const _itemRadius = this.itemRadius;\n    const _menuOffset = _menuRadius - _itemRadius;\n    const _interval = 0.6283185307;\n    // if more items center them\n    const _centerOffset = (-_interval / 2) + ((_itemsLength * _interval) / 2);\n\n    // make a \"flower\"\n    Array.from($items).forEach(($item, index) => {\n      // Calculate the angle at which the element will be placed.\n      // For a semicircle, we would use (index / _itemsLength) * Math.PI.\n      const angle = (Math.PI + ((index * _interval) * -1)) + _centerOffset;\n\n      // get position\n      const x = (_menuRadius * Math.sin(angle)) + _menuOffset;\n      const y = (_menuRadius * Math.cos(angle)) + _menuOffset;\n\n      // console.log('x: ' + x);\n      // console.log('y: ' + y);\n\n      $item.style.left = `${x.toFixed(1)}px`;\n      $item.style.top = `${y.toFixed(1)}px`;\n\n      // if (this.initialSetUp === true) {\n      //   this.addEventListenersToRadialMenuItem($item);\n      // }\n    });\n  }\n\n  addEventListenersToRadialMenu() {\n    this.onMouseLeave();\n\n    this.$radialMenu.addEventListener('click', (event) => {\n      this.hideRadialMenu(this.$radialMenu);\n      event.preventDefault();\n    });\n\n    this.$radialMenu.addEventListener('contextmenu', (event) => {\n      this.hideRadialMenu(this.$radialMenu);\n      event.preventDefault();\n    });\n  }\n\n  addEventListenersToRadialMenuItem(item) {\n    const $item = item;\n\n    // actions\n    const action = $item.getAttribute('data-radial-menu-item');\n    // remove item\n    if (action === 'remove-content') {\n      $item.addEventListener('click', () => {\n        SVG.removeItem();\n        this.hideRadialMenu();\n      }, false);\n    }\n    // create user text\n    else if (action === 'create-text') {\n      d3.select($item).on('click', () => {\n        SVGText.createText();\n        this.hideRadialMenu();\n      }, false);\n    }\n    // označit podobnost\n    else if (action === 'color-point-blue') {\n      $item.addEventListener('click', () => {\n        SVGRadialMenu.changeColor('blue');\n        this.hideRadialMenu();\n      }, false);\n    }\n    // označit rozdil\n    else if (action === 'color-point-red') {\n      $item.addEventListener('click', () => {\n        SVGRadialMenu.changeColor('red');\n        this.hideRadialMenu();\n      }, false);\n    }\n    // označit rozdil\n    else if (action === 'color-point-red') {\n      $item.addEventListener('click', () => {\n        SVGRadialMenu.changeColor('red');\n        this.hideRadialMenu();\n      }, false);\n    }\n    // přiřadit kategorii\n    // else if (action === 'category') {\n    //   const category = $item.getAttribute('data-category');\n    //   const categoryLabel = $item.getAttribute('data-radial-menu-item-tooltip');\n\n    //   $item.addEventListener('click', () => {\n    //     const $selected = document.querySelector('[data-svg-selected=\"true\"]');\n    //     const $parentForeignObject = $selected.parentNode;\n    //     let $category = $parentForeignObject.querySelector('.svg-category-label');\n\n    //     $selected.setAttribute('data-svg-category', category);\n\n    //     if (!$category) {\n    //       $category = document.createElement('div');\n    //       $category.classList.add('svg-category-label');\n    //       $parentForeignObject.prepend($category);\n    //     }\n\n    //     $category.innerText = categoryLabel;\n\n    //     this.hideRadialMenu();\n    //   }, false);\n    // }\n\n    // tooltip\n    $item.addEventListener('mouseenter', (event) => {\n      this.$tooltip.innerHTML = event.currentTarget.getAttribute('data-radial-menu-item-tooltip');\n      this.$tooltip.style.display = 'block';\n    }, false);\n    $item.addEventListener('mouseleave', () => {\n      this.$tooltip.innerHTML = '';\n      this.$tooltip.style.display = 'none';\n    }, false);\n  }\n\n  // Draw a SVG circle on click\n  static changeColor(color) {\n    const svg = document.querySelector(\"div[class~=active-slide] svg[class~=svg]\");\n    const $selected = document.querySelector('[data-svg-selected=\"true\"]');\n    __removeClass($selected, 'red blue');\n    __addClass($selected, color);\n\n    // dispatch event that svg has changed\n    __dispatchEvent(document, 'svg.change', {}, { svg: { id: svg.id, activity: 'changeColorCircle', target: $selected.parentNode.id, color: color } });\n  }\n\n  showRadialMenu($activeSVG, event) {\n    const $svg = $activeSVG || document.querySelector('[data-svg-active=\"true\"]');\n    // get global position of the right click event\n    const globalPosition = __globalPosition(event);\n    const localPosition = __localPosition($svg);\n    this.$radialMenu.setAttribute('data-local-x', localPosition.x);\n    this.$radialMenu.setAttribute('data-local-y', localPosition.y);\n    // set position of radial menu\n    // number of 13 is size of #radial-menu\n    this.$radialMenu.style.top = `${globalPosition.y - 7}px`;\n    this.$radialMenu.style.left = `${globalPosition.x - 7}px`;\n\n    // make a flower\n    const $activeRadialMenuItem = this.$radialMenu.querySelectorAll('.is-active');\n    this.positionRadialMenuItems($activeRadialMenuItem);\n\n    // show radial menu\n    __addClass(this.$radialMenu, 'is-active');\n\n    // return {\n    //   localPosition,\n    //   globalPosition,\n    // };\n  }\n\n  hideRadialMenu() {\n    // hide radial menu\n    __removeClass(this.$radialMenu, 'is-active');\n    // deactivate all SVGs\n    SVG.deactivate();\n    // deselect all SVG items\n    SVG.deselectItem();\n\n    // deactivate radial menu items when the menu is hidden\n    setTimeout(() => {\n      if (!__hasClass(this.$radialMenu, 'is-active')) {\n        Array.from(this.$radialMenuItems).forEach(($item) => {\n          __removeClass($item, 'is-active');\n        });\n      }\n    }, 150);\n  }\n\n  onMouseLeave() {\n    let mouseLeaveDelay;\n\n    this.$radialMenu.addEventListener('mouseleave', () => {\n      mouseLeaveDelay = setTimeout(() => {\n        this.hideRadialMenu(this.$radialMenu);\n      }, 500);\n    });\n\n    this.$radialMenu.addEventListener('mouseenter', () => {\n      clearTimeout(mouseLeaveDelay);\n    });\n  }\n\n  filterMenuButtons(clickedItem) {\n    if (__hasClass(clickedItem, 'svg-path') || clickedItem.nodeName === 'path') {\n      __addClass(this.$createTextItem, 'is-active');\n      // __addClass(this.$removeItem, 'is-active');\n\n      Array.from(this.$colorItems).forEach(($colorItem) => {\n        __addClass($colorItem, 'is-active');\n      });\n\n      Array.from(this.$textItems).forEach(($textItem) => {\n        __removeClass($textItem, 'is-active');\n      });\n\n      // mark it as slected\n      // SVG.selectItem(clickedItem);\n    }\n    if (__hasClass(clickedItem, 'svg-circle')) {\n      __addClass(this.$createTextItem, 'is-active');\n      // __addClass(this.$removeItem, 'is-active');\n\n      Array.from(this.$colorItems).forEach(($colorItem) => {\n        __addClass($colorItem, 'is-active');\n      });\n\n      Array.from(this.$textItems).forEach(($textItem) => {\n        __removeClass($textItem, 'is-active');\n      });\n\n      // mark it as slected\n      // SVG.selectItem(clickedItem);\n    }\n    if (__hasClass(clickedItem, 'svg-textarea')) {\n      __removeClass(this.$createTextItem, 'is-active');\n      // __addClass(this.$removeItem, 'is-active');\n\n      if (!__hasClass(clickedItem, 'do-not-remove')) {\n        Array.from(this.$colorItems).forEach(($colorItem) => {\n          __removeClass($colorItem, 'is-active');\n        });\n\n        Array.from(this.$textItems).forEach(($textItem) => {\n          __addClass($textItem, 'is-active');\n        });\n      }\n\n      // mark it as slected\n      // SVG.selectItem(clickedItem);\n    }\n    if (clickedItem.nodeName === 'image') {\n      __addClass(this.$createTextItem, 'is-active');\n      __removeClass(this.$removeItem, 'is-active');\n\n      Array.from(this.$colorItems).forEach(($colorItem) => {\n        __removeClass($colorItem, 'is-active');\n      });\n\n      Array.from(this.$textItems).forEach(($textItem) => {\n        __removeClass($textItem, 'is-active');\n      });\n    }\n    else {\n      if (__hasClass(clickedItem, 'do-not-remove')) {\n        __removeClass(this.$removeItem, 'is-active');\n      } else {\n        __addClass(this.$removeItem, 'is-active');\n      }\n      // mark it as slected\n      SVG.selectItem(clickedItem);\n    }\n  }\n}\n","export default class Observer {\n\n  constructor() {\n    this._events = [];\n  }\n\n  /**\n   * Add event listener\n   *\n   * {String} events - e.g. 'my-event-1 my-event-2'\n   * {Function} fn - event listener\n   */\n  on(events, fn) {\n\n    events = this._split(events);\n\n    events.forEach((event) => {\n\n      if (!this._events[event]) {\n        this._events[event] = [];\n      }\n\n      this._events[event].push(fn);\n    });\n\n  }\n\n  off(events, fn) {\n\n    events = this._split(events);\n\n    events.forEach((event) => {\n\n      if (!this._events[event]) { return; }\n\n      this.events[event] = this._events[event].filter((current_fn) => {\n        return current_fn !== fn;\n      });\n\n    });\n\n\n  }\n\n  // something like dispatchEvent\n  trigger(events, args) {\n\n    events = this._split(events);\n\n    // console.log(events);\n\n    events.forEach((event) => {\n\n      if (!this._events[event]) { return; }\n\n      this._events[event].forEach((fn) => {\n        fn.call(this, event, args);\n      });\n\n    });\n\n  }\n\n  _split(events) {\n    return events.replace(/^\\s+|\\s+$/g, '').split(/\\s+/);\n  }\n\n}\n","const actionTypes = {\n  editor: {\n    id: 'editor',\n    ADD_TAG: 'editor:ADD_TAG',\n    DELETE_TAG: 'editor:DELETE_TAG',\n    UPDATE_TAG: 'editor:UPDATE_TAG',\n    CHANGE: 'editor:CHANGE',\n  },\n  keywords: {\n    id: 'keywords',\n    CHANGE: 'keywords:CHANGE'\n  },\n  testQuiz: {\n    id: 'testQuiz',\n    ADD_ANSWER: 'testQuiz:ADD_ANSWER',\n    REMOVE_ANSWER: 'testQuiz:REMOVE_ANSWER',\n    UPDATE_ANSWER: 'testQuiz:UPDATE_ANSWER',\n    CHANGE: 'testQuiz:CHANGE',\n  },\n  textOptions: {\n    id: 'textOptions',\n    ADD: 'textOptions:ADD',\n    DELETE: 'textOptions:DELETE',\n    UPDATE: 'textOptions:UPDATE',\n    CHANGE: 'textOptions:CHANGE'\n  },\n  store: {\n    id: 'store',\n    ADD: 'ADD',\n    DELETE: 'DELETE',\n    UPDATE: 'UPDATE',\n    CHANGE: 'CHANGE',\n  }\n};\n\n\nexport default actionTypes;\n","import Observer from './observer';\nimport actionTypes from './store-constants';\n\n/*\nconst tagContainer: Object = {\n  editorId?: number,\n  id: string,\n  tagName: string,\n  tag: HTMLElement,\n  data?: Object\n}\n*/\n\n\nclass Store extends Observer {\n\n  constructor() {\n\n    super();\n\n    /* here the global space for storing objects and data */\n    this._data = {};\n    this._data.tags = [];\n  }\n\n  _checkTagExists(tagId) {\n    let tagExists = false;\n    this._data.tags.forEach((item, i) => {\n\n      if (item.id === tagId) {\n        tagExists = { item, index: i };\n      }\n\n    });\n\n    return tagExists;\n  }\n\n  addTag(tagContainer) {\n\n    if (this._data.tags.length === 0 || !this._checkTagExists(tagContainer.id)) {\n\n      if (undefined === tagContainer.data.userSelectedNodeItems) {\n        tagContainer.data.userSelectedNodeItems = [];\n      }\n\n      this._data.tags.push(tagContainer);\n\n      store.trigger(actionTypes.editor.CHANGE, {\n        action: {\n          id: actionTypes.editor.id,\n          type: actionTypes.editor.ADD_TAG,\n          data: {\n            tagContainer,\n          },\n        },\n\n      });\n\n    } else {\n      throw new Error('Tag already exists! Will not add it.');\n    }\n\n  }\n\n  deleteTag(tagContainer) {\n\n    let tagExists = this._checkTagExists(tagContainer.id);\n\n    if (false !== tagExists) {\n\n      this._data.tags.splice(tagExists.index, 1);\n\n      store.trigger(actionTypes.editor.CHANGE, {\n        action: {\n          id: actionTypes.editor.id,\n          type: actionTypes.editor.DELETE_TAG,\n          data: {\n            tagContainer: { editorId: tagContainer.editorId, id: tagContainer.id, tagName: tagContainer.tagName, data: {} },\n          },\n        },\n\n      });\n\n      return true;\n\n    } else {\n      throw new Error('Tag does not exist! Will not delete it.');\n    }\n\n  }\n\n  getAllTags(opts) {\n\n\n    if (undefined === opts || !opts.editorId) { return this._data.tags }\n\n    const selectedTags = this._data.tags.filter((item) => {\n      return item.editorId === opts.editorId;\n    });\n\n    return selectedTags;\n  }\n\n  getTagsBy(opts) {\n\n    const allowedKeys = ['editorId', 'id', 'tagName'];\n\n    if (opts === undefined) { return false}\n    if ( allowedKeys.indexOf( opts.key ) === -1 ) {return false}\n\n    if (!Array.isArray(opts.value)) {\n      opts.value = [opts.value];\n    }\n\n    // console.log(opts.value);\n    // console.log(this._data.tags);\n\n    const selectedTags = this._data.tags.filter((item) => {\n\n      return ( item[opts.key] === opts.value[0] ) || ( item[opts.key] === opts.value[1] );\n\n    });\n\n    return selectedTags;\n\n  }\n\n  getLastTag(opts) {\n\n    if (undefined === opts || !opts.editorId) {\n      return this._data.tags[this._data.tags.length - 1];\n    }\n\n    const selectedTags = this._data.tags.filter((item) => {\n      return item.editorId === opts.editorId;\n    });\n\n    return selectedTags[selectedTags.length - 1];\n  }\n\n}\n\nconst store = new Store();\nexport default store;\n","import Observer from './observer';\nimport actionTypes from './store-constants';\n\nclass StoreGlobal extends Observer {\n\n  constructor() {\n\n    super();\n\n    /* here the global space for storing objects and data */\n    this._data = [];\n\n  }\n\n  _checkExists(id) {\n    let objectExists = false;\n    this._data.forEach((item, i) => {\n\n      if (item.id === id) {\n        objectExists = { item, index: i };\n      }\n\n    });\n\n    return objectExists;\n  }\n\n  add(data) {\n\n    // console.log('add global called');\n\n    if (this._data.length === 0 || !this._checkExists(data.id)) {\n\n      this._data.push(data);\n\n      store.trigger(actionTypes.textOptions.id, {\n        action: {\n          type: actionTypes.textOptions.ADD,\n        },\n        data,\n      });\n\n    } else {\n      throw new Error('Object already exists! Will not add it.');\n    }\n\n  }\n\n  delete(data) {\n\n    const objectExists = this._checkExists(data.id);\n\n    if (objectExists !== false) {\n\n      this._data.splice(objectExists.index, 1);\n\n      store.trigger(actionTypes.textOptions.id, {\n        action: {\n          type: actionTypes.textOptions.DELETE,\n        },\n        data,\n      });\n\n      return true;\n\n    }\n    throw new Error('Tag does not exist! Will not delete it.');\n\n\n  }\n\n  getAll(opts) {\n\n    if (undefined === opts || !opts.editor) { return this._data; }\n\n    const selectedObjs = this._data.filter(item => item.id === opts.id);\n\n    return selectedObjs;\n  }\n\n  getBy(opts) {\n\n    const allowedKeys = ['id'];\n\n    if ((opts === undefined) || (allowedKeys.indexOf(opts.key) === -1)) {\n      return false;\n    }\n\n    if (!Array.isArray(opts.value)) {\n      opts.value = [opts.value];\n    }\n\n    const selectedObjs = this._data.filter(item => (item[opts.key] === opts.value[0]) || (item[opts.key] === opts.value[1]));\n\n    return selectedObjs;\n\n  }\n\n  getLast(opts) {\n\n    if (undefined === opts || !opts.editor) {\n      return this._data[this._data.length - 1];\n    }\n\n    const selectedObjs = this._data.filter(item => item.id === opts.id);\n\n    return selectedObjs[selectedObjs.length - 1];\n  }\n\n}\n\nconst store = new StoreGlobal();\nexport default store;\n","import {\n  __mergeDeep, __hasClass, __addClass, __removeClass, __position, __positionTranslated, __remove, __getRealDimensions, __insertBefore, __keycodeIsPrintableCharacter, __toggleClass,\n} from '../../lib/utils';\nimport store from '../../store/store';\nimport storeGlobal from '../../store/store-global';\nimport Component from '../component';\n// import actionTypes from '../store/store-constants';\n\n\nexport default class Editor extends Component {\n\n  constructor(element) {\n    super(element);\n\n    // TODO: should extend default Component class and use this.target?\n    // this.$editor is better, more readable\n    this.$editor = this.target;\n    this.id = this.$editor.id;\n    // TODO: is DOM element before/after the editor itself.. move it to the editor?\n    this.settings = JSON.parse(document.querySelector(`[data-editor-id-reference=\"${this.id}\"]`).getAttribute('data-module-settings'));\n\n    this.opts = __mergeDeep(Editor.defaults, this.settings);\n\n    this.models = {\n      passive: [\n        'cteni',\n      ],\n      interactive: [\n        'predznaceny', 'zvyraznovani', 'komentáře', 'psani',\n      ],\n      withMenu: [\n        'predznaceny', 'zvyraznovani', 'komentáře',\n      ],\n    };\n\n    this.totalTagId = 0;\n\n    this.hasMenu = true;\n\n    this.selection = null;\n    this.lastSelectionSettings = {};\n    this.isCollapsed = null;\n    this.savedSelectionRange = null;\n    this.selectionAttributes = null;\n    this.dummyRangeElement = null;\n\n    this.selectionMouseDown = false;\n    this.selectionDirection = null;\n\n    this.hasEditableContentChanged = false;\n    this.lastPressedKey = null;\n\n    this.hasToolbar = false;\n    this.toolbar = {};\n\n    this.originalContent = {};\n    this.currentContent = {};\n\n    this._handlers = [];\n\n    this.wrapLastDeletesTimeoutClass = '';\n    this.wrapLastDeletesTimeoutFunction = () => { };\n    this.wrapLastAdditionsTimeoutClass = '';\n    this.wrapLastAdditionsTimeoutFunction = () => { };\n    this.isWrappingLastText = false;\n    this.isWriting = false;\n\n    this.$groupDeleted = null;\n\n    this.cache = {\n      body: document.body,\n      window,\n    };\n\n    this.init();\n  }\n\n  init() {\n    if (Editor._hasMenu(this.opts)) {\n      try {\n        this.$menu = this.$editor.getElementsByClassName(this.opts.menuClass)[0];\n\n        // TODO: generalize .item class via defaults and opts\n        this.$menuActions = this.$menu.getElementsByClassName('menu')[0].getElementsByClassName('menu-item');\n        this.$menuClose = this.$menu.getElementsByClassName('close')[0];\n      } catch (error) {\n        this.hasMenu = false;\n      }\n    } else {\n      this.hasMenu = false;\n    }\n\n    if (Editor._hasToolbar(this.opts)) {\n      this.hasToolbar = true;\n    }\n\n    this.$canvas = this.$editor.getElementsByClassName(this.opts.canvasClass)[0];\n\n    // only if the editor is INTERACTIVE\n    if (this.opts.funkce !== 'cteni') {\n      __addClass(this.$menu, 'hidden');\n\n      // only if the editor is for WRITING\n      if (this.opts.funkce === 'psani') {\n        this.originalContent.html = this.$canvas.innerHTML;\n        this.originalContent.text = this.$canvas.innerText;\n        this.currentContent.html = this.$canvas.innerHTML;\n        this.currentContent.text = this.$canvas.innerText;\n\n        this.wrapLastDeletesTimeoutClass = this._generateNewTagGroupClass();\n        this.wrapLastAdditionsTimeoutClass = this._generateNewTagGroupClass();\n      }\n\n      // only if the editor is with extra TOOLBAR\n      if (this.hasToolbar) {\n        this.toolbar.$element = this.$editor.getElementsByClassName('editor-toolbar')[0];\n        this.toolbar.$btnReset = this.toolbar.$element.getElementsByClassName('editor-toolbar-action-reset')[0];\n      }\n\n      this.registerEditableHandlers();\n    }\n\n    // only if the editor is with PREHIGHLIGHTED text\n    if (this.opts.funkce === 'predznaceny') {\n      this.initPreHighlightedTextOptions();\n    }\n\n  }\n\n  _generateNewTagId() {\n    this.totalTagId = this.totalTagId + 1;\n    return `${this.id}-${this.totalTagId}`;\n  }\n\n  _generateNewTagGroupClass() {\n    this.totalTagId = this.totalTagId + 1;\n    return `group-${this.id}-${this.totalTagId}`;\n  }\n\n  // add all eventListeners\n  // TODO: separate special case from universal ones?\n  registerEditableHandlers() {\n\n    this.$canvas.addEventListener('mousedown', this.handlerFocus.bind(this), false);\n    this.$canvas.addEventListener('focusout ', this.handlerFocus.bind(this), false);\n\n    // Necessary when mouseup is outside the $canvas element\n    // therefore we have to capture the event outside the element through body element\n    this.cache.body.addEventListener('mouseup', this.handlerFocus.bind(this), false);\n\n\n    if (this.opts.funkce === 'psani') {\n\n      this.$canvas.addEventListener('keydown', (e) => {\n\n        const selection = window.getSelection();\n        const keyCode = e.which || e.keyCode;\n        let keyName = e.key;\n\n        // show OK button or feedback\n        this.showFeedback();\n\n        // start DELETE\n        if (keyName === 'Backspace' || keyName === 'Delete') {\n          if (selection.rangeCount) {\n            window.clearTimeout(this.wrapLastDeletesTimeoutFunction);\n\n            const range = selection.getRangeAt(0);\n            const cloneRange = range.cloneRange();\n\n            if (this.lastSelectionSettings.isCollapsed) {\n\n              try {\n                cloneRange.setStart(range.startContainer, range.startOffset - 1);\n              } catch (e) {\n                // backspace was pressed at the beginning of the node\n                cloneRange.setStart(range.startContainer, range.startOffset);\n                cloneRange.collapse(true);\n              }\n\n            } else {\n              cloneRange.setStart(range.startContainer, range.startOffset);\n\n            }\n\n            cloneRange.setEnd(range.endContainer, range.endOffset);\n\n            // do nothing when it's space\n            const addedFragment = cloneRange.cloneContents();\n            const addedFragmentString = addedFragment.textContent.trim();\n\n            if ((addedFragmentString !== '' && addedFragmentString !== '&nbsp;') || this.isWrappingLastText) {\n\n              const dummyElementInner = document.createElement('span');\n              dummyElementInner.className = `user-removed-text-inner ${this.wrapLastDeletesTimeoutClass}`;\n\n              cloneRange.surroundContents(dummyElementInner);\n\n              selection.removeAllRanges();\n              selection.addRange(range);\n\n              this.wrapLastDeletesTimeoutFunction = setTimeout(() => {\n\n                this.isWrappingLastText = false;\n\n                // wrap all previous deletes to one element\n                const dummyElement = document.createElement('span');\n                dummyElement.contentEditable = false;\n                dummyElement.className = 'user-removed-text';\n\n                const newGeneratedId = this._generateNewTagId();\n                dummyElement.id = newGeneratedId;\n\n                const elements = Array.from(document.getElementsByClassName(this.wrapLastDeletesTimeoutClass));\n\n                __insertBefore(dummyElement, elements[0]);\n\n                elements.forEach((el, i) => {\n                  dummyElement.appendChild(el);\n                });\n\n\n                // create close button\n                const $btnClose = document.createElement('span');\n                $btnClose.className = this.opts.closeBtnClass;\n\n                const clickHandler = (e) => {\n                  const $nodeElement = e.currentTarget.parentNode;\n                  this._removeNodeKeepTextContent($nodeElement);\n                  e.stopPropagation();\n                };\n\n                $btnClose.addEventListener('click', clickHandler.bind(this));\n\n                document.getElementById(newGeneratedId).appendChild($btnClose);\n\n                this.wrapLastDeletesTimeout = true;\n                this.wrapLastDeletesTimeoutClass = this._generateNewTagGroupClass();\n\n              }, 700);\n\n              this.isWrappingLastText = true;\n\n              e.preventDefault();\n\n            } else {\n\n              if (!this.isWrappingLastText) {\n                // we're removing spaces, do nothing use browser's default behaviour, unless the wrapping is going on\n                return;\n              }\n              e.preventDefault();\n            }\n          }\n        }\n        // end DELETE\n\n        // start WRITING\n        else if (__keycodeIsPrintableCharacter(keyCode)) {\n\n          // if nothing is selected (selection is empty)\n          if (this.lastSelectionSettings.isCollapsed) {\n\n            // if \"space\" was written\n            if (keyCode === 32) {\n              if (!this.isWrappingLastText) {\n                // we're adding spaces, do nothing use browser's default behaviour, unless the wrapping is going on\n                return;\n              }\n              // fill a space as the keyname for the spacebar\n              keyName = ' ';\n            }\n\n            // The Selection.rangeCount read-only property returns the number of ranges in the selection.\n            if (selection.rangeCount) {\n\n              window.clearTimeout(this.wrapLastAdditionsTimeoutFunction);\n\n              const range = selection.getRangeAt(0);\n              const cloneRange = range.cloneRange();\n\n              cloneRange.setStart(range.startContainer, range.startOffset);\n              cloneRange.setEnd(range.endContainer, range.endOffset);\n\n              const textToAddElement = document.createElement('span');\n              textToAddElement.contentEditable = false;\n              textToAddElement.className = `user-inserted-text-inner ${this.wrapLastAdditionsTimeoutClass}`;\n              textToAddElement.innerHTML = keyName;\n\n              cloneRange.insertNode(textToAddElement);\n\n              // move the caret after the inserted character\n              range.setStartAfter(textToAddElement);\n\n              selection.removeAllRanges();\n              selection.addRange(range);\n\n              this.wrapLastAdditionsTimeoutFunction = setTimeout(() => {\n\n                this.isWrappingLastText = false;\n\n                // wrap all previous deletes to one element\n                const dummyElement = document.createElement('span');\n                dummyElement.contentEditable = false;\n                dummyElement.className = 'user-inserted-text';\n\n                const newGeneratedId = this._generateNewTagId();\n                dummyElement.id = newGeneratedId;\n\n                const elements = Array.from(document.getElementsByClassName(this.wrapLastAdditionsTimeoutClass));\n\n                __insertBefore(dummyElement, elements[0]);\n\n                elements.forEach((el, i) => {\n                  dummyElement.appendChild(el);\n                });\n\n\n                // create close button\n                const $btnClose = document.createElement('span');\n                $btnClose.className = this.opts.closeBtnClass;\n\n                const clickHandler = (e) => {\n                  const $nodeElement = e.currentTarget.parentNode;\n                  __remove($nodeElement);\n                  e.stopPropagation();\n                };\n\n                $btnClose.addEventListener('click', clickHandler.bind(this));\n                document.getElementById(newGeneratedId).appendChild($btnClose);\n\n                this.wrapLastAdditionsTimeoutClass = this._generateNewTagGroupClass();\n\n              }, 700);\n\n              this.isWrappingLastText = true;\n\n            }\n\n\n            if (this.hasEditableContentChanged === false) {\n              this.hasEditableContentChanged = true;\n            }\n\n            e.preventDefault();\n          }\n\n          // writing over existing text is selected\n          else {\n            window.clearTimeout(this.wrapLastAdditionsTimeoutFunction);\n\n            const range = selection.getRangeAt(0);\n            const cloneRange = range.cloneRange();\n\n            cloneRange.setStart(range.startContainer, range.startOffset);\n            cloneRange.setEnd(range.endContainer, range.endOffset);\n\n            // 1. handle deleting the text that was selected when writing started\n            if (this.isWriting === false && selection.toString().length > 0) {\n              // add deleted text node only for the first time and only if there is some selected text\n              this.$groupDeleted = document.createElement('span');\n              this.$groupDeleted.contentEditable = false;\n              this.$groupDeleted.className = 'user-removed-text';\n\n              const groupDeletedId = this._generateNewTagId();\n              this.$groupDeleted.id = groupDeletedId;\n\n              const $groupInnerDeleted = document.createElement('span');\n              $groupInnerDeleted.className = 'user-removed-text-inner';\n\n              this.$groupDeleted.appendChild($groupInnerDeleted);\n\n              cloneRange.surroundContents(this.$groupDeleted);\n\n              // create close button\n              const $btnClose = document.createElement('span');\n              $btnClose.className = this.opts.closeBtnClass;\n\n              const clickHandler = (e) => {\n                const $nodeElement = e.currentTarget.parentNode;\n                this._removeNodeKeepTextContent($nodeElement);\n                e.stopPropagation();\n              };\n\n              $btnClose.addEventListener('click', clickHandler.bind(this));\n              this.$groupDeleted.appendChild($btnClose);\n            }\n\n\n            // 2. adding new text\n            this.isWriting = true;\n\n            const $groupInnerAdded = document.createElement('span');\n            $groupInnerAdded.contentEditable = false;\n            $groupInnerAdded.className = `user-inserted-text-inner ${this.wrapLastAdditionsTimeoutClass}`;\n\n            // add a space so there is a space between the added and removed text\n            $groupInnerAdded.innerHTML = `${keyName}`;\n\n            // TODO: error after deleted selection\n            __insertBefore($groupInnerAdded, this.$groupDeleted);\n            range.setStartAfter($groupInnerAdded);\n\n            selection.removeAllRanges();\n            selection.addRange(range);\n\n            this.wrapLastAdditionsTimeoutFunction = setTimeout(() => {\n              this.isWriting = false;\n\n              // wrap all previous deletes to one element\n              const $groupAdded = document.createElement('span');\n              $groupAdded.contentEditable = false;\n              $groupAdded.className = 'user-inserted-text';\n\n              const newGeneratedId = this._generateNewTagId();\n              $groupAdded.id = newGeneratedId;\n\n              const elements = Array.from(document.getElementsByClassName(this.wrapLastAdditionsTimeoutClass));\n\n              __insertBefore($groupAdded, elements[0]);\n\n              elements.forEach((el, i) => {\n                $groupAdded.appendChild(el);\n              });\n\n              const $btnClose = document.createElement('span');\n              $btnClose.className = this.opts.closeBtnClass;\n\n              const clickHandler = (e) => {\n                const $nodeElement = e.currentTarget.parentNode;\n                __remove($nodeElement);\n                e.stopPropagation();\n              };\n\n              $btnClose.addEventListener('click', clickHandler.bind(this));\n              document.getElementById(newGeneratedId).appendChild($btnClose);\n\n              this.wrapLastAdditionsTimeoutClass = this._generateNewTagGroupClass();\n\n            }, 700);\n\n            e.preventDefault();\n          }\n        }\n        // end WRITING\n      });\n    }\n\n\n    if (this.hasMenu) {\n      this.registerMenuHandler();\n    }\n\n    if (this.hasToolbar) {\n      this.toolbar.$btnReset.addEventListener('click', () => {\n\n        const isConfirmed = confirm('Opravdu chcete vrátit text do původní podoby? Vaše změny se tímto ztratí.');\n\n        if (isConfirmed) {\n          this.$canvas.innerHTML = this.originalContent.html;\n        }\n\n      });\n    }\n\n  }\n\n  registerMenuHandler() {\n    for (let i = 0, len = this.$menuActions.length; i < len; i += 1) {\n      this.$menuActions[i].addEventListener('click', this.handlerMenuActions.bind(this), false);\n    }\n\n    this.$menuClose.addEventListener('click', this.handlerMenuClose.bind(this), false);\n  }\n\n  initPreHighlightedTextOptions() {\n    const dataAttr = 'data-text-option';\n\n    // loop over updated DOM via DOM manipulation\n    this.$textOptionsElements = this.$editor.querySelectorAll(`[${dataAttr}]`);\n    Array.from(this.$textOptionsElements).forEach(($textOption) => {\n\n      $textOption.addEventListener('click', () => {\n        __toggleClass($textOption, this.opts.textOptions.selectedClass);\n\n        if (__hasClass($textOption, this.opts.textOptions.selectedClass)) {\n          storeGlobal.add({\n            editor: this.id,\n            id: $textOption.id,\n            tag: $textOption,\n            data: JSON.parse($textOption.getAttribute(dataAttr)),\n          });\n        } else {\n          storeGlobal.delete({\n            editor: this.id,\n            id: $textOption.id,\n          });\n        }\n\n        // show OK button or feedback\n        this.showFeedback();\n      });\n\n    });\n\n  }\n\n  toggleMenu(clickClose = false) {\n\n    if (clickClose === true) {\n      __addClass(this.$menu, 'hidden');\n      return;\n    }\n\n    if (this.selectionMouseDown === true) {\n      __addClass(this.$menu, 'hidden');\n      return;\n    }\n\n    if (__hasClass(this.$menu, 'hidden') && this.selectionMouseDown === false) {\n      this._setmenuDimensions();\n      __removeClass(this.$menu, 'hidden');\n    }\n\n  }\n\n  _setmenuDimensions() {\n    const menuDimensions = __getRealDimensions(this.$menu);\n    const parentTranslatedPosition = __positionTranslated(this.$editor);\n    const parentDimensions = __position(this.$editor);\n\n    // let additionalSize = ( this.selectionDirection === \"right\" ) ?\n\n    const isOverflowAt = {\n      right: (this.selectionAttributes.left + this.selectionAttributes.width + menuDimensions.width + this.opts.menuMargin.x) > (parentTranslatedPosition.left + parentDimensions.width),\n      top: (this.selectionAttributes.top - menuDimensions.height - this.opts.menuMargin.y) < (parentTranslatedPosition.top),\n      bottom: (this.selectionAttributes.top + this.selectionAttributes.height + menuDimensions.height + this.opts.menuMargin.y) > (parentTranslatedPosition.top + parentDimensions.height),\n    };\n\n    let leftDimensions;\n    let topDimensions;\n\n    if (isOverflowAt.right) {\n\n      leftDimensions = this.selectionAttributes.left - menuDimensions.width - this.opts.menuMargin.x;\n\n    } else {\n\n      leftDimensions = this.selectionAttributes.left + this.selectionAttributes.width + this.opts.menuMargin.x;\n\n    }\n\n    if (isOverflowAt.top) {\n\n      topDimensions = this.selectionAttributes.top + menuDimensions.height + this.opts.menuMargin.y;\n\n    } else {\n\n      topDimensions = this.selectionAttributes.top - menuDimensions.height - this.opts.menuMargin.y;\n\n    }\n\n    this.$menu.style.left = `${leftDimensions}px`;\n    this.$menu.style.top = `${topDimensions}px`;\n\n  }\n\n  handlerMenuClose(e) {\n\n    this.toggleMenu(true);\n\n    e.preventDefault();\n\n  }\n\n  handlerMenuActions(e) {\n\n    const $el = e.currentTarget;\n    const command = $el.getAttribute('data-command');\n    const commandName = $el.getAttribute('data-command-name');\n\n    /* :TODO: Cache the options for given element to avoid JSON parsing each time */\n    const options = JSON.parse($el.getAttribute('data-command-options'));\n\n    this.setSelection(command, commandName, options);\n\n    e.preventDefault();\n\n  }\n\n  handlerFocus(e) {\n    const isMouseRightClick = e.which === 3;\n\n    if (isMouseRightClick) { return; }\n\n    if (__hasClass(e.target, 'node-close')) { return; }\n\n    if (__hasClass(e.target, 'node-selected')) { return; }\n\n    if (e.type === 'mousedown') {\n\n      // start tracking the mouse down\n      this.selectionMouseDown = true;\n\n      if (this.hasMenu === true) {\n        this.toggleMenu();\n      }\n\n    }\n\n    if (e.type === 'mouseup' && this.selectionMouseDown) {\n\n      // reset saved last selection settings\n      this.lastSelectionSettings = {};\n\n      this.selection = window.getSelection();\n      this.isCollapsed = this.lastSelectionSettings.isCollapsed = this.selection.isCollapsed;\n      this.savedSelectionRange = this.selection.getRangeAt(0);\n\n      this.selectionMouseDown = false;\n\n      this.lastSelectionSettings.anchorOffset = this.selection.anchorOffset;\n      this.lastSelectionSettings.focusOffset = this.selection.focusOffset;\n      this.lastSelectionSettings.text = this.savedSelectionRange.toString();\n\n      /* https://developer.mozilla.org/en-US/docs/Web/API/Selection/isCollapsed */\n      /* Returns a Boolean indicating whether the selection's start and end points are at the same position. */\n      /* display context menu only if the cursor is NOT at the same position */\n      if (this.selection.isCollapsed === false && this.savedSelectionRange.toString().trim() !== '') {\n\n        this.selectionDirection = (this.selection.anchorOffset <= this.selection.focusOffset) ? 'right' : 'left';\n\n        if (this.hasMenu === true) {\n\n          this._setSelectionPosition(); // :TODO: cannot be used in contentEditable editor yet\n\n          this.toggleMenu();\n        }\n\n      }\n\n    }\n\n  }\n\n  _setSelectionPosition() {\n\n    const dummyElement = document.createElement('span');\n    dummyElement.className = 'dummy-range-element';\n\n    this.savedSelectionRange.surroundContents(dummyElement);\n\n    const selectionPosition = __positionTranslated(dummyElement);\n    const selectionDimension = __position(dummyElement);\n\n    this.selectionAttributes = {\n      left: selectionPosition.left,\n      top: selectionPosition.top,\n      width: selectionDimension.width,\n      height: selectionDimension.height,\n    };\n\n    __removeClass(dummyElement, 'dummy-range-element');\n\n    this._removeNodeKeepTextContent(dummyElement);\n\n  }\n\n  _extractAndSaveContents($domEl) {\n    $domEl.appendChild(this.savedSelectionRange.extractContents());\n    this.savedSelectionRange.insertNode($domEl);\n\n    const tagName = $domEl.getAttribute('data-command-name');\n    const newTagId = this._generateNewTagId();\n\n    $domEl.setAttribute('data-tag-id', newTagId);\n\n    store.addTag({\n      editor: this.id,\n      id: newTagId,\n      tag: $domEl,\n      tagName,\n      data: {},\n    });\n\n  }\n\n  _removeNodeKeepTextContent(node) {\n    const text = node.textContent;\n    node.parentNode.insertBefore(document.createTextNode(text), node);\n    __remove(node);\n  }\n\n  _createCloseBtnForElement(parentEl, opts = {}) {\n\n    const $elClose = document.createElement('span');\n    $elClose.setAttribute('class', opts.class);\n\n    const classesToToggle = opts.toggleClass.split(' ');\n\n\n    const clickHandler = (e) => {\n\n      const $closeBtn = e.currentTarget;\n      const $nodeElement = $closeBtn.parentNode;\n\n      $closeBtn.removeEventListener('click', clickHandler);\n      $nodeElement.removeChild($closeBtn);\n\n      if (undefined !== $nodeElement.commentRef) {\n\n        /* :TODO: temporary way to save the reference to the DOM element */\n        this.$editor.removeChild($nodeElement.commentRef);\n        $nodeElement.commentRef = null;\n\n      }\n\n      this._removeNodeKeepTextContent($nodeElement);\n\n      const tagName = $nodeElement.getAttribute('data-command-name');\n\n      store.deleteTag({\n        editor: this.id,\n        id: $nodeElement.getAttribute('data-tag-id'),\n        tag: $nodeElement,\n        tagName,\n        data: {},\n      });\n\n      e.stopPropagation();\n\n    };\n\n    $elClose.addEventListener('click', clickHandler.bind(this));\n\n    parentEl.appendChild($elClose);\n\n  }\n\n  _calculateCommentPosition($node) /* : Object */ {\n\n    const nodePosition = __positionTranslated($node);\n\n    return {\n      left: `${nodePosition.left + parseInt($node.offsetWidth, 10) + this.opts.commentMargin.x}px`,\n      top: `${nodePosition.top + this.opts.commentMargin.y}px`,\n    };\n\n  }\n\n  _createCommentForNode($el, opts = {}) {\n\n    const commentTemplate = document.getElementById('comment-template').innerHTML;\n\n    const div = document.createElement('div');\n    div.innerHTML = commentTemplate;\n\n    const commentDiv = div.childNodes[1];\n\n    // attach js reference to the dom element\n    commentDiv.data = {};\n    commentDiv.data.nodeRef = $el;\n\n    const commentNewTextarea = commentDiv.getElementsByClassName('comment-new-text')[0];\n    const commentDivButtonSubmit = commentDiv.getElementsByTagName('button')[0];\n    const commentCommentsContainer = commentDiv.getElementsByClassName('comments-container')[0];\n\n    const calculatedCommentPosition = this._calculateCommentPosition($el);\n\n    commentDiv.style.left = calculatedCommentPosition.left;\n    commentDiv.style.top = calculatedCommentPosition.top;\n\n    __addClass(commentDiv, opts.class);\n\n    commentDiv.addEventListener('click', (e) => {\n\n      if (__hasClass(e.target, 'close')) {\n\n        __addClass(commentDiv, 'hidden');\n        __removeClass($el, 'active');\n\n      }\n\n    });\n\n    commentDivButtonSubmit.addEventListener('click', (e) => {\n\n      if (commentNewTextarea.value !== '') {\n\n        const commentItem = document.createElement('div');\n        commentItem.className = 'comment-item';\n\n        commentItem.innerText = commentNewTextarea.value;\n\n        commentCommentsContainer.appendChild(commentItem);\n\n        commentNewTextarea.value = '';\n      }\n\n    });\n\n    this.$editor.append(commentDiv);\n\n    __addClass($el, 'comment-created');\n\n    /* :TODO: Temporary way to save the reference to the DOM element */\n    $el.commentRef = commentDiv;\n\n\n  }\n\n  _addCommentHandlerForElement($el, opts = {}) {\n\n    __addClass($el, 'has-comments');\n\n    function clickHandler(e) {\n\n      if (!__hasClass(e.target, 'node-close')) {\n\n        if (!__hasClass($el, 'comment-created')) {\n\n          this._createCommentForNode($el, opts);\n\n        } else {\n\n          /* recalculate comment div position */\n          const calculatedCommentPosition = this._calculateCommentPosition($el);\n\n          $el.commentRef.style.left = calculatedCommentPosition.left;\n          $el.commentRef.style.top = calculatedCommentPosition.top;\n\n          __removeClass($el.commentRef, 'hidden');\n\n        }\n\n        if (!__hasClass($el, 'active')) {\n\n          __addClass($el, 'active');\n\n        } else {\n\n          __removeClass($el, 'active');\n          __addClass($el.commentRef, 'hidden');\n\n        }\n\n      }\n\n      e.stopPropagation();\n\n    }\n\n    $el.addEventListener('click', clickHandler.bind(this));\n\n  }\n\n  setSelection(command, commandName, opts = {}) {\n\n    if (this.selection) {\n\n      if (command === 'toggle-class') {\n\n        const $el = document.createElement('span');\n        $el.setAttribute('class', opts.toggleClass);\n        $el.setAttribute('data-command-name', commandName);\n\n        if (opts.closeBtn === true) {\n          this._createCloseBtnForElement($el, {\n            class: 'node-close',\n            toggleClass: opts.toggleClass,\n          });\n        }\n\n        if (opts.comments === true) {\n          this._addCommentHandlerForElement($el, {\n            class: opts.commentsClass,\n          });\n        }\n\n        this._extractAndSaveContents($el);\n\n        if (opts.showCommentsOnInit === true) {\n          $el.click();\n        }\n\n      }\n\n      // hide context menu after selecting the action#\n      this.toggleMenu(true);\n\n      // show OK button or feedback\n      this.showFeedback();\n\n    }\n\n  }\n\n}\n\nEditor.defaults = {\n  menuClass: 'contextual-menu-component',\n  canvasClass: 'canvas',\n  resetBtnClass: 'reset',\n  closeBtnClass: 'node-close',\n  nodeSelectedClass: 'node-selected',\n  commentMargin: {\n    x: 50,\n    y: 0,\n  },\n  menuMargin: {\n    x: 15,\n    y: 15,\n  },\n  textOptions: {\n    enable: false,\n    animatedClass: 'active',\n    selectedClass: 'selected',\n    deselectedClass: 'deselected',\n  },\n\n};\n\nEditor._hasMenu = opts => opts.funkce !== 'cteni' && opts.funkce !== 'psani' && (opts.menu !== false && opts.menu !== undefined);\nEditor._hasToolbar = opts => opts.funkce === 'psani' || (opts.toolbar !== false && opts.toolbar !== undefined);\n","import { __hasClass, __getHTML, __remove } from '../lib/utils';\nimport store from '../store/store';\nimport actionTypes from '../store/store-constants';\nimport Component from './component';\n\n\nexport default class AnalyticalTable extends Component {\n\n  constructor(id, element, opts) {\n    super(element);\n\n    this.id = id;\n\n    this.opts = Object.assign({}, AnalyticalTable.defaults, opts);\n\n    this.isAdvanced = this.opts.isAdvanced;\n\n    this.rowIndex = 0;\n\n    this.tableResult = this.target.getElementsByClassName('table-result')[0];\n    this.tableResultBody = this.tableResult.getElementsByClassName('table-body')[0];\n    this.tableSelectedItems = this.target.getElementsByClassName('table-selected-items')[0];\n    this.tableSelectedItemsBody = this.tableSelectedItems.getElementsByClassName('table-body')[0];\n\n    this.activeDragged = null;\n\n    // choose the HTML for a row according to whether we work with the advanced version of a table\n    this._getRowHTML = (this.isAdvanced) ? AnalyticalTable._getAdvancedRowHTML : AnalyticalTable._getRowHTML;\n\n  }\n\n  init() {\n    this._registerStoreHandlers(this.tableResultBody, this.tableSelectedItemsBody);\n    this._registerHandlers();\n  }\n\n  _registerStoreHandlers(tableResultBody, tableSelectedItemsBody) {\n\n    store.on(actionTypes.editor.CHANGE, (event, payload) => {\n\n      const action = payload.action;\n      let addedTagContainer;\n      let $node;\n      // let deletedItem;\n\n      switch (action.type) {\n\n        case actionTypes.editor.ADD_TAG:\n\n          addedTagContainer = action.data.tagContainer;\n\n          switch (addedTagContainer.tagName) {\n\n            case this.opts.casti[1].sloupce[0].tag:\n\n              tableResultBody.insertAdjacentHTML('beforeend', this._getRowHTML(__getHTML(addedTagContainer.tag), addedTagContainer.id));\n\n\n              // TODO: fix this\n              if (this.opts.letSecondCaseRunIfSame || this.opts.casti[1].sloupce[0].tag === this.opts.casti[1].sloupce[1].tag) {\n\n              } else {\n                break;\n              }\n            // break;\n\n            case this.opts.casti[1].sloupce[1].tag:\n\n\n              $node = addedTagContainer.tag.cloneNode(true);\n              $node.setAttribute('draggable', true);\n              $node.addEventListener('click', this._handlerDraggable.bind(this), false);\n              $node.addEventListener('dragstart', this._handlerDraggable.bind(this), false);\n              $node.addEventListener('dragend', this._handlerDraggable.bind(this), false);\n              $node.addEventListener('drag', this._handlerDraggable.bind(this), false);\n\n              tableSelectedItemsBody.appendChild($node);\n\n\n              break;\n\n            default:\n              break;\n\n          }\n          break;\n\n        case actionTypes.editor.DELETE_TAG:\n\n          addedTagContainer = action.data.tagContainer;\n\n          // console.log(\"from DELETE_TAG action\", addedTagContainer);\n\n          // simple analytical table tasks\n          // const deletedItems = document.querySelectorAll(`[data-tag-id=\"${addedTagContainer.id}\"]`);\n\n          Array.prototype.forEach.call(document.querySelectorAll(`[data-tag-id=\"${addedTagContainer.id}\"]`), ($node) => {\n\n            if (__hasClass($node.parentNode, 'cell-read-only')) {\n              // we have to remove the whole row from the table\n              // --> cell --> table-row\n              __remove($node.parentNode.parentNode);\n\n            } else {\n              __remove($node);\n            }\n\n          });\n\n          break;\n\n        default:\n          break;\n      }\n\n\n    });\n\n  }\n\n  _registerHandlers() {\n\n    this.target.addEventListener('dragover', this._handlerDrop.bind(this), false);\n    this.target.addEventListener('dragleave', this._handlerDrop.bind(this), false);\n    this.target.addEventListener('drop', this._handlerDrop.bind(this), false);\n\n  }\n\n\n  _handlerDraggable(e) {\n\n    if (e.type === 'dragstart') {\n      e.dataTransfer.setData('text/plain', 'node');\n      e.dataTransfer.dropEffect = '';\n      e.target.style.opacity = 0.5;\n\n      this.activeDragged = e.target.cloneNode(true);\n    }\n\n    if (e.type === 'dragend') {\n      e.target.style.opacity = 1;\n\n      // show OK button or feedback\n      this.showFeedback();\n    }\n\n    return false;\n\n  }\n\n  _handlerDrop(e) {\n\n    if (__hasClass(e.target, 'dashboard-canvas-widget-content')) {\n\n      if (e.type === 'dragover') {\n\n        e.preventDefault();\n        e.dataTransfer.dropEffect = '';\n        e.target.style.background = '#eee';\n      }\n\n      if (e.type === 'dragleave') {\n\n        e.target.style.background = '#fff';\n\n      }\n\n      if (e.type === 'drop') {\n\n\n        e.preventDefault();\n\n        e.target.style.background = '#fff';\n        this.activeDragged.style.opacity = 1;\n\n\n        this.activeDragged.addEventListener('click', (e) => {\n\n          if (__hasClass(e.target, 'node-close')) {\n\n            e.target.parentNode.remove();\n\n          }\n\n        });\n\n        e.target.appendChild(this.activeDragged);\n\n\n      }\n\n\n    }\n\n\n    return false;\n\n  }\n\n\n}\n\nAnalyticalTable.defaults = {\n  isAdvanced: false,\n};\n\n\nAnalyticalTable._getRowHTML = (nodeHTML, index = 0) => {\n\n  const tableRowTemplate = `\n    <div class=\"table-row\">\n      <div class=\"cell cell-read-only cell-border-right\">${nodeHTML}</div>\n      <div class=\"cell dashboard-canvas-widget-content\"></div>\n    </div>\n  `;\n\n  return tableRowTemplate;\n\n};\n\nAnalyticalTable._getAdvancedRowHTML = (nodeHTML, index = 0) => {\n\n  const tableRowTemplate = `\n    <div class=\"table-row\">\n      <div class=\"cell cell-read-only cell-border-right\">${nodeHTML}</div>\n      <div class=\"cell dashboard-canvas-widget-content cell-border-right\"></div>\n      <div class=\"cell table-input\">\n        <input id=\"table-akteri-vztahy-input-${index}\" data-input-target=\"\" data-save=\"value\" type=\"text\" placeholder=\"Vztah aktérů…\" tabindex=\"-1\">\n      </div>\n    </div>\n  `;\n\n  return tableRowTemplate;\n\n};\n","import Observer from './observer';\nimport actionTypes from './store-constants';\n\n/*\nconst tagContainer: Object = {\n  editorId?: number,\n  id: string,\n  tag: HTMLElement,\n  data?: Object\n}\n*/\n\n\nclass StoreKeywords extends Observer {\n\n  constructor() {\n\n    super();\n\n    /* here the global space for storing objects and data */\n    this._data = {};\n\n  }\n\n\n  change(keywordsId, newItems, newItemsHTML) {\n\n    if (!this._data[keywordsId]) {\n      this._data[keywordsId] = {};\n    }\n\n    this._data[keywordsId].items = newItems;\n    this._data[keywordsId].itemsHTML = newItemsHTML;\n\n    store.trigger(actionTypes.keywords.CHANGE, {\n      action: {\n        id: actionTypes.keywords.id,\n        type: actionTypes.keywords.CHANGE,\n        data: {\n          keywordsId: keywordsId,\n          newItems: newItems,\n          newItemsHTML: newItemsHTML\n        },\n      },\n\n    });\n\n  }\n\n  export() {\n    return this._data;\n  }\n\n}\n\nconst store = new StoreKeywords();\nexport default store;\n","import { __toggleClass, __getHTML } from '../lib/utils';\nimport Component from './component';\nimport store from '../store/store-keywords';\nimport actionTypes from '../store/store-constants';\n\n// zoom the image\nexport default class Keywords extends Component {\n  constructor($element, opts = {}) {\n    super($element);\n    this.id = this.target.id;\n    this.function = this.target.getAttribute('data-keywords') || 'selekce';\n    this.$controls = Array.from(this.target.querySelectorAll('[data-keywords-control]'));\n\n    this.opts = Object.assign({}, Keywords.defaults, opts);\n\n    this.$itemsContainer = this.target.getElementsByClassName(this.opts.itemsContainerClassName)[0];\n\n    if (this.opts.inherit && this.opts.inherit.from.length > 0) {\n      // console.log(this.opts.inherit.from);\n      this.isInherited = true;\n    } else {\n      this.$items = this.target.getElementsByClassName(this.opts.itemClassName);\n    }\n\n  }\n\n  init() {\n    switch (this.function) {\n      case 'selekce':\n        // we have data at the instantiation for importing\n        if (this.opts.import && this.opts.import.length > 0) {\n          this.$itemsContainer.innerHTML = Keywords._getHTMLFromItems(this.opts.import);\n        }\n\n        // save the state of all instances on Init\n        /* :TODO: a possible duplicity when the instance has the isInherited set to TRUE */\n        store.change(\n          this.id,\n          Keywords._getItemsFromHTML(this.$itemsContainer, this.opts.itemClassName),\n          Keywords._getItemsHTML(this.$itemsContainer),\n        );\n\n        // console.log(this.id, this.isInherited);\n        if (this.isInherited) {\n          // if onInit, we copy the elements\n          // by their ids into the itemsContainer of this object\n          if (this.opts.inherit.onInit) {\n            this._regenerateItemsContainerFromInherited();\n          }\n\n          this._registerStoreHandlers();\n        }\n\n        this._registerHandlers();\n        break;\n\n      case 'wordcloud':\n        Array.from(this.$items).forEach(($item) => {\n          $item.setAttribute('data-keywords-item', 0);\n        });\n        this._changeSizeOfKeywordItem(this.opts.skala);\n        break;\n\n      default:\n        break;\n    }\n  }\n\n  _changeSizeOfKeywordItem(maxLevel) {\n    maxLevel = maxLevel ? parseInt(maxLevel, 10) : 4;\n\n    function setNewLevelValue($keyword, number, feedback) {\n      const oldValue = parseInt($keyword.getAttribute('data-keywords-item'), 10);\n      const newValue = oldValue + number;\n      const value = Math.abs(newValue) > maxLevel ? oldValue : newValue;\n      $keyword.setAttribute('data-keywords-item', value);\n\n      feedback();\n    }\n\n    this.$controls.forEach(($control) => {\n      const $keyword = $control.parentElement.parentElement;\n      const controlFunction = $control.getAttribute('data-keywords-control');\n\n      switch (controlFunction) {\n        case 'minus':\n          $control.addEventListener('click', (event) => {\n            setNewLevelValue($keyword, -1, this.showFeedback);\n            event.preventDefault();\n          });\n          break;\n\n        case 'plus':\n          $control.addEventListener('click', (event) => {\n            setNewLevelValue($keyword, 1, this.showFeedback);\n            event.preventDefault();\n          });\n          break;\n\n        default:\n          break;\n      }\n    });\n  }\n\n  _regenerateItemsContainerFromInherited() {\n    let tempContent = '';\n\n    this.opts.inherit.from.forEach((id) => {\n      const temp = document.getElementById(id).getElementsByClassName(this.opts.itemsContainerClassName)[0].innerHTML;\n      // rename ids of the original items to avoid duplicates in the DOM\n      tempContent += Keywords.renameItemsIds(id, this.id, temp);\n      // console.log(tempContent);\n    });\n\n    this.$itemsContainer.innerHTML = tempContent;\n\n    this.$items = this.target.getElementsByClassName(this.opts.itemClassName);\n\n    store.change(\n      this.id,\n      Keywords._getItemsFromHTML(this.$itemsContainer, this.opts.itemClassName),\n      Keywords._getItemsHTML(this.$itemsContainer),\n    );\n\n  }\n\n  _registerHandlers() {\n\n    Array.from(this.target.getElementsByClassName(this.opts.itemClassName)).forEach(($item) => {\n      $item.addEventListener('click', this._eventHandler.bind(this), true);\n    });\n\n  }\n\n  _registerStoreHandlers() {\n    store.on(actionTypes.keywords.CHANGE, (event, payload) => {\n\n      const action = payload.action;\n      const data = payload.action.data;\n\n      switch (action.type) {\n\n        case actionTypes.keywords.CHANGE:\n\n          // if there are other objects this object inherits items from, update the html\n          if (this.opts.inherit.from.indexOf(data.keywordsId) > -1) {\n            this._regenerateItemsContainerFromInherited();\n\n            // regenerate event handlers\n            this._registerHandlers();\n          }\n\n          break;\n\n        default:\n          break;\n      }\n\n    });\n\n  }\n\n\n  _eventHandler(e) {\n\n    if (e.type === 'click') {\n      // console.log(e.target, e.currentTarget);\n      __toggleClass(e.currentTarget, 'disabled');\n\n      store.change(\n        this.id,\n        Keywords._getItemsFromHTML(this.$itemsContainer, this.opts.itemClassName),\n        Keywords._getItemsHTML(this.$itemsContainer),\n      );\n\n      this.showFeedback();\n    }\n\n  }\n\n}\n\n\nKeywords._getItemFromDOMElement = $item => ({\n  class: $item.className,\n  id: $item.getAttribute('id'),\n  text: $item.innerText,\n});\n\nKeywords._getItemsHTML = $itemsContainer => $itemsContainer.innerHTML;\n\nKeywords._getItemsFromHTML = ($itemsContainer, itemsClassName) => {\n  const $items = $itemsContainer.getElementsByClassName(itemsClassName);\n  const itemsArray = [];\n\n  Array.from($items).forEach(($item) => {\n    itemsArray.push(Keywords._getItemFromDOMElement($item));\n  });\n\n\n  return itemsArray;\n\n};\n\nKeywords._getDOMElementFromItem = (item) => {\n\n  const newDiv = document.createElement('div');\n  newDiv.setAttribute('class', item.class);\n  newDiv.setAttribute('id', item.id);\n  newDiv.innerHTML = item.text;\n\n  return __getHTML(newDiv);\n\n};\n\nKeywords._getHTMLFromItems = (items) => {\n\n  let contentHTML = '';\n\n  items.forEach((item) => {\n\n    contentHTML += Keywords._getDOMElementFromItem(item);\n\n  });\n\n  return contentHTML;\n\n};\n\n\nKeywords.renameItemsIds = (oldId, newId, itemsHTML) => {\n\n  const expString = new RegExp(oldId, 'g');\n\n  return itemsHTML.replace(expString, newId);\n\n};\n\nKeywords.defaults = {\n  itemsContainerClassName: 'keywords-items-container',\n  itemClassName: 'keywords-item',\n};\n","import { __getHTML } from '../lib/utils';\n\nimport store from '../store/store';\nimport actionTypes from '../store/store-constants';\n\n// zoom the image\nexport default class EditorTagsPlaceholder {\n  constructor(element, opts = {}) {\n\n    this.$element = element;\n    this.id = this.$element.getAttribute('id');\n\n    this.opts = Object.assign({}, EditorTagsPlaceholder.defaults, opts);\n\n    this.commandNames = JSON.parse(this.$element.getAttribute(this.opts.itemSubscribeAttributeClassName));\n    this.$itemsContainer = this.$element.getElementsByClassName(this.opts.itemsContainerClassName)[0];\n\n  }\n\n  init() {\n\n    this._registerStoreHandlers();\n\n  }\n\n\n  _registerStoreHandlers() {\n\n    store.on(actionTypes.editor.CHANGE, (event, payload) => {\n\n      const action = payload.action;\n      const data = payload.action.data;\n      const tagContainer = data.tagContainer;\n\n      if (this.commandNames.indexOf(tagContainer.tagName) > -1) {\n\n        const tags = store.getTagsBy({key: 'tagName', value: this.commandNames});\n\n        let content = \"\";\n\n        tags.forEach((tag) => {\n\n          content += __getHTML( tag.tag );\n\n        });\n\n        this.$itemsContainer.innerHTML = content;\n\n      }\n\n  });\n\n  }\n\n\n\n}\n\n\n\n\n\nEditorTagsPlaceholder.defaults = {\n  itemsContainerClassName: \"editor-tags-placeholder-content\",\n  itemSubscribeAttributeClassName: 'data-placeholder-editor-subscribe'\n\n};\n","import { __removeClass, __toggleClass } from '../lib/utils';\nimport Component from './component';\n// import store from '../store/store';\n// import actionTypes from '../store/store-constants';\n\n\nexport default class TestQuiz extends Component {\n\n  constructor(id, element, opts) {\n    super(element);\n\n    this.id = id;\n\n    this.opts = Object.assign({}, TestQuiz.defaults, opts);\n\n    this.$questions = this.target.getElementsByClassName(this.opts.itemClass);\n    this.cache = {\n      answersCorrect: 0,\n      colors: [],\n      questions: [],\n    };\n\n    // get colors for all feedback variants\n    if (this.opts.zpetnaVazba) {\n      this.cache.colors = this.opts.zpetnaVazba.map(feedback => feedback.barva);\n    }\n  }\n\n  init() {\n    // this._registerStoreHandlers();\n    this._registerHandlers();\n  }\n\n  _registerHandlers() {\n\n    Array.from(this.$questions).forEach(($question, questionIndex) => {\n      // all questions are without answer by default\n      this.cache.questions.push({ answered: false });\n\n      const answerCorrect = parseInt($question.getAttribute('data-module-answer'), 10);\n      const $answers = Array.from($question.getElementsByClassName(this.opts.optionClass));\n\n      $answers.forEach(($answer, answerIndex) => {\n        $answer.addEventListener('click', () => {\n          const $answerCurrent = $answer;\n\n          // if already selected do nothing\n          if ($answerCurrent.classList.contains('selected')) {\n            return;\n          }\n\n          // remove the selection\n          $answers.forEach($answersItem => __removeClass($answersItem, this.opts.selectedClass));\n          // select the clicked one\n          __toggleClass($answerCurrent, this.opts.selectedClass);\n\n          // get sum of all corect answers\n          if (this.opts.zpetnaVazba) {\n            if (answerIndex === answerCorrect) {\n              this.cache.answersCorrect += 1;\n            } else if (this.cache.answersCorrect !== 0 && this.cache.questions[questionIndex].answered === true) {\n              this.cache.answersCorrect -= 1;\n            }\n            // loop through all \"zpetnaVazba\" to get the one with the fullfilled condition\n            const feedbackActual = this.opts.zpetnaVazba.find(feedback => feedback.podminka.includes(this.cache.answersCorrect));\n\n            // show the right feedback message\n            this.$buttonFeedback.classList.remove(...this.cache.colors);\n            this.$buttonFeedback.classList.add(feedbackActual.barva);\n            this.$buttonFeedbackText.innerText = feedbackActual.text;\n          }\n\n          // note that this question has been answered (whether true or false)\n          this.cache.questions[questionIndex].answered = true;\n\n          // show OK button with feedback only when all question have been answered\n          if (this.cache.questions.find(question => !question.answered) === undefined) {\n            this.showFeedback();\n          }\n\n        }, false);\n      });\n    });\n  }\n}\n\nTestQuiz.defaults = {\n  itemClass: 'test-quiz-item',\n  optionClass: 'option',\n  selectedClass: 'selected',\n};\n","import { __remove } from '../lib/utils';\nimport storeGlobal from '../store/store-global';\nimport actionTypes from '../store/store-constants';\nimport Component from './component';\n\n\nexport default class GenericTable extends Component {\n\n  constructor($element, opts) {\n    super($element);\n\n    this.id = this.target.id;\n    this.opts = Object.assign({}, GenericTable.defaults, opts);\n\n    this.rowIndex = 0;\n\n    this.$tableResultBody = this.target.getElementsByClassName('table-body')[0];\n\n    this.dataSettings = this.opts.data;\n\n    this.cache = {\n      tasksToComplete: 0,\n      tasksCompleted: 0,\n      tasks: [],\n    };\n  }\n\n  init() {\n\n    if (this.dataSettings.source === 'store') {\n      this._registerStoreHandlers();\n    }\n\n    // this._registerHandlers();\n  }\n\n  _registerStoreHandlers() {\n\n    // register store event handler\n    // in tabulkaObecna JSON settings, subscribe is an array, here we need a string of strings separated by spaces\n    storeGlobal.on(this.dataSettings.subscribe.join(' '), (event, payload) => {\n      const action = payload.action;\n      const data = payload.data;\n\n      switch (action.type) {\n\n        case actionTypes[event].ADD: {\n          this.$tableResultBody.insertAdjacentHTML('beforeend', GenericTable._getRowHTML(data));\n\n          const $allRows = this.$tableResultBody.querySelectorAll('.table-row');\n          const $lastRow = $allRows[$allRows.length - 1];\n\n          const $newSelects = $lastRow.querySelectorAll('select');\n\n          this.cache.tasksToComplete += $newSelects.length;\n\n          Array.from($newSelects).forEach(($select) => {\n            this.cache.tasks.push({ answered: false });\n            const taskNumber = this.cache.tasks.length - 1;\n\n            $select.addEventListener('change', () => {\n              if (this.cache.tasks[taskNumber].answered === false) {\n                this.cache.tasksCompleted += 1;\n                this.cache.tasks[taskNumber].answered = true;\n              }\n              if (this.cache.tasksToComplete === this.cache.tasksCompleted) {\n                // show OK button or feedback\n                this.showFeedback();\n              }\n            });\n          });\n          break;\n        }\n        case actionTypes[event].DELETE: {\n          const $row = document.getElementById(`${data.id}_table`);\n          __remove($row);\n          this.cache.tasksToComplete -= $row.querySelectorAll('select').length;\n          this.cache.tasksCompleted -= $row.querySelectorAll('select').length;\n\n          if (this.cache.tasksToComplete <= this.cache.tasksCompleted) {\n            // show OK button or feedback\n            this.showFeedback();\n          }\n\n          break;\n        }\n        default:\n          break;\n      }\n\n    });\n\n  }\n\n\n}\n\nGenericTable.defaults = {};\n\n// data.data.text: editor text name\n// data.data.vyraz selected text option text value\nGenericTable._getRowHTML = (data) => {\n  const tableRowTemplate = `\n    <div class=\"table-row\" id=\"${data.id}_table\">\n      <div class=\"cell\">${data.data.text}</div>\n      <div class=\"cell\">${data.data.vyraz}</div>\n      <div class=\"cell\">\n        <select id=\"${data.id}-select-osoba\" name=\"osoba\" data-save=\"value\">\n          <option>Vyberte osobu</option>\n          <option>já</option>\n          <option>ty</option>\n          <option>on/ona/ono</option>\n          <option>my</option>\n          <option>vy</option>\n          <option>oni/ony/ona</option>\n          <option>infinitiv</option>\n        </select>\n      </div>\n      <div class=\"cell\">\n        <select id=\"${data.id}-select-zpusob\" name=\"zpusob\" data-save=\"value\">\n          <option>Vyberte způsob</option>\n          <option>oznamovací</option>\n          <option>podmiňovací</option>\n          <option>rozkazovací</option>\n          <option id=\"select-zpusob-infinitiv\">infinitiv</option>\n        </select>\n      </div>\n    </div>\n  `;\n\n  return tableRowTemplate;\n\n};\n","// [data-fullscreen]\nimport Component from './component';\n\nclass Fullscreen extends Component {\n  constructor($element) {\n    super($element);\n\n    this.$fullscreen = document.querySelector('[data-fullscreen=\"target\"]');\n    this.$fullscreenImage = this.$fullscreen.querySelector('[data-fullscreen=\"image\"]');\n\n    this.window = {};\n    this.image = {};\n\n    this.window.width = window.innerWidth;\n    this.window.height = window.innerHeight;\n    this.window.ratio = this.window.width / this.window.height;\n\n    this.$fullscreenImage.onload = () => {\n      this.image.width = this.$fullscreenImage.naturalWidth;\n      this.image.height = this.$fullscreenImage.naturalHeight;\n      this.image.ratio = this.image.width / this.image.height;\n\n      if (this.image.ratio >= this.window.ratio) {\n        this.$fullscreenImage.style.width = '100%';\n        this.$fullscreenImage.style.height = 'auto';\n      } else {\n        this.$fullscreenImage.style.width = 'auto';\n        this.$fullscreenImage.style.height = `${this.window.height}px`;\n      }\n    };\n\n  }\n}\n\nexport default class FullscreenToggle extends Fullscreen {\n  constructor($element) {\n    super($element);\n\n    this.target.addEventListener('click', (event) => {\n      this.$fullscreenImage.src = this.target.nextElementSibling.src;\n      this.$fullscreen.classList.toggle('hidden');\n\n      this.showFeedback();\n\n      event.preventDefault();\n      event.stopPropagation();\n    }, false);\n\n  }\n}\n","import Component from './component';\n\nexport default class UserText extends Component {\n  constructor($element) {\n    super($element);\n    this.$userTexts = this.$slide.querySelectorAll('[data-textarea-target]');\n\n    this.lengthExpected = {\n      min: parseInt(this.target.getAttribute('minlength') === '0' ? 1 : this.target.getAttribute('minlength'), 10),\n      avg: null,\n      max: parseInt(this.target.getAttribute('maxlength') / 2, 10),\n    };\n    this.lengthExpected.avg = Math.floor((this.lengthExpected.max - this.lengthExpected.min) / 4 + this.lengthExpected.min);\n\n    this.cache = {\n      answersCorrect: 0,\n      colors: [\n        'color-red',\n        'color-orange',\n        'color-green',\n      ],\n      questions: [],\n    };\n\n    this.sendFeedback();\n  }\n\n  sendFeedback() {\n    this.target.addEventListener('keyup', (event) => {\n      event.stopPropagation();\n\n      const valueLength = this.target.value.length;\n\n      // CONDITION: type three chars at least\n      // TODO: should be variable, a paramater from JSON\n      this.$buttonFeedback.classList.remove(...this.cache.colors);\n      if (valueLength < this.lengthExpected.min) {\n        this.$buttonFeedback.classList.add(this.cache.colors[0]);\n        this.$buttonFeedbackText.innerText = 'Napiš něco!';\n      } else {\n\n        if (valueLength <= this.lengthExpected.avg) {\n          this.$buttonFeedback.classList.add(this.cache.colors[1]);\n          this.$buttonFeedbackText.innerText = 'Není toho moc.';\n        }\n        else if (valueLength > this.lengthExpected.avg) {\n          this.$buttonFeedback.classList.add(this.cache.colors[2]);\n          this.$buttonFeedbackText.innerText = 'Mám hotovo!';\n        }\n\n        this.target.setAttribute('data-textarea-target', 'success');\n        // check if all conditions of the same component on the same slide are met\n        const conditionAll = Array.from(this.$userTexts).find($userText => ($userText.getAttribute('data-textarea-target') !== 'success'));\n\n        if (conditionAll === undefined) {\n          // show OK button or feedback\n          this.showFeedback();\n        }\n      }\n    });\n  }\n}\n","import Component from '../component';\n\nexport default class AudioPlayerNormal extends Component {\n\n  constructor($element) {\n    super($element);\n\n    this.$playButton = this.target.querySelector('[data-player-control]');\n    this.$loadWave = this.target.querySelector('[data-audio-wave]');\n    this.$leftTime = this.target.querySelector('[data-audio-time-left]');\n    this.$audioDuration = this.target.querySelector('[data-audio-time-duration]');\n\n    this.wavesurfer = WaveSurfer.create({\n      container: this.$loadWave,\n      waveColor: '#A77977',\n      progressColor: '#FCE4E3',\n      height: 80,\n      responsive: true,\n      barWidth: 2,\n    });\n    this.wavesurfer.load(this.$loadWave.dataset.src);\n\n    this.initWave();\n  }\n\n  initWave() {\n    this.wavesurfer.on('ready', () => {\n      this.$leftTime.textContent = '0:00';\n      const duration = this.wavesurfer.getDuration();\n      const minutes = Math.floor((duration % 3600) / 60);\n      const seconds = (`00${Math.floor(duration % 60)}`).slice(-2);\n      this.$audioDuration.textContent = `${minutes}:${seconds}`;\n\n      this.addListenerAfterReady();\n    });\n  }\n\n  addListenerAfterReady() {\n    this.wavesurfer.on('audioprocess', (time) => {\n      const minutes = Math.floor((time % 3600) / 60);\n      const seconds = (`00${Math.floor(time % 60)}`).slice(-2);\n      this.$leftTime.textContent = `${minutes}:${seconds}`;\n    });\n\n    this.wavesurfer.on('finish', () => {\n      this.$playButton.setAttribute('data-player-control', 'paused');\n    });\n\n    this.$playButton.addEventListener('click', () => {\n      this.wavesurfer.playPause();\n\n      if (this.$playButton.getAttribute('data-player-control') === 'paused') {\n        this.$playButton.setAttribute('data-player-control', 'playing');\n      } else {\n        this.$playButton.setAttribute('data-player-control', 'paused');\n      }\n\n      this.showFeedback();\n    });\n\n    // stop audio prehravac kdyz se zapne dalsi slajd\n    const $nextSlides = document.querySelectorAll('[data-nav-button]');\n    Array.from($nextSlides).forEach(($nextSlide) => {\n      $nextSlide.addEventListener('click', () => {\n        if (this.$playButton.getAttribute('data-player-control') === 'playing') {\n          this.wavesurfer.playPause();\n          this.$playButton.setAttribute('data-player-control', 'paused');\n        }\n      });\n    });\n\n  }\n\n}\n","import AudioPlayer from './audio-player';\nimport { getSecondsMinutesFormat } from './media';\n\nexport default class AudioPlayerSimple extends AudioPlayer {\n  constructor($element) {\n    super($element);\n\n    this.$audio = this.target.querySelector('audio');\n    this.$timeLeft = this.target.querySelector('[data-audio-time-left]');\n    this.$duration = this.target.querySelector('[data-audio-time-duration]');\n\n    this.$duration.innerText = `/${getSecondsMinutesFormat(this.$audio.duration)}`;\n\n    AudioPlayer.addEventListeners(this.target, this.showFeedback);\n  }\n}\n","import Component from './component';\n\nexport default class FakeMap extends Component {\n  constructor($element) {\n    super($element);\n\n    this.$buttons = this.target.querySelectorAll('[data-fake-map=\"toggle\"]');\n    this.$maps = this.target.querySelectorAll('[data-fake-map=\"map\"]');\n    this.lastActiveIndex = 0;\n\n    this.addEventListenerToButtons();\n  }\n\n  switchMap($button, index) {\n    this.$maps[this.lastActiveIndex].classList.remove('active');\n    this.$buttons[this.lastActiveIndex].classList.remove('active');\n\n    this.$maps[index].classList.add('active');\n    $button.classList.add('active');\n\n    this.lastActiveIndex = index;\n  }\n\n  addEventListenerToButtons() {\n    this.$buttons.forEach(($button, index) => {\n\n      $button.addEventListener('click', (event) => {\n        this.switchMap($button, index);\n        this.showFeedback();\n\n        event.preventDefault();\n      });\n\n    });\n  }\n}\n","/* eslint-disable no-nested-ternary */\nimport Component from '../component';\nimport { getSecondsMinutesFormat, mediaEvents } from './media';\n\nexport default class VideoPlayer extends Component {\n  constructor($element, options) {\n    super($element);\n\n    this.$media = this.target.querySelector('video');\n    this.options = Object(options);\n    this.prefix = this.options.prefix || 'media';\n    this.lang = Object(this.options.lang);\n    // lang.currentTime\n    // lang.play\n    // lang.pause\n    // lang.minutes\n    // lang.seconds\n    // lang.leaveFullscreen\n    // lang.enterFullscreen\n\n    this.paused = null;\n    this.currentTime = null;\n    this.duration = null;\n    this.interval = null;\n\n    this.$document = this.target.ownerDocument;\n    this.$controls = this.target.querySelector('.media-player-controls');\n    // play/pause toggle\n    this.$play = this.$controls.querySelector('[data-player-control]');\n    this.$playSymbol = this.$play.querySelector('.media-play-symbol');\n    this.$pauseSymbol = this.$play.querySelector('.media-pause-symbol');\n    // time slider\n    this.$time = this.$controls.querySelector('[data-video-time-progress]');\n    this.$timeMeter = this.$time.querySelector('.media-meter.media-time-meter');\n    this.$timeRange = this.$time.querySelector('.media-range.media-time-range');\n\n    // current time text\n    this.$currentTimeText = this.$document.createTextNode('');\n    this.$currentTime = this.$controls.querySelector('[data-video-time-left]');\n    this.$currentTime.appendChild(this.$currentTimeText);\n\n    // duration time text\n    this.durationTime = this.$media.duration;\n    this.$durationTime = this.$controls.querySelector('[data-video-time-duration]');\n    this.$durationTime.innerText = getSecondsMinutesFormat(this.durationTime);\n    this.$durationTime.setAttribute(\n      'title',\n      `${VideoPlayer.timeToAural(\n        this.durationTime,\n        this.lang.minutes || 'minutes',\n        this.lang.seconds || 'seconds',\n      )}`,\n    );\n\n    // fullscreen button\n    this.$fullscreen = this.$controls.querySelector(\n      '.fullscreen-toggle',\n    );\n    this.$enterFullscreenSymbol = this.$fullscreen.querySelector(\n      '.media-enterFullscreen-symbol',\n    );\n    this.$leaveFullscreenSymbol = this.$fullscreen.querySelector(\n      '.media-leaveFullscreen-symbol',\n    );\n\n    // fullscreen api\n    this._fullscreenchange = 'onfullscreenchange' in this.target\n      ? 'fullscreenchange'\n      : 'onwebkitfullscreenchange' in this.target\n        ? 'webkitfullscreenchange'\n        : 'onMSFullscreenChange' in this.target\n          ? 'MSFullscreenChange'\n          : 'fullscreenchange';\n\n    this._requestFullscreen = this.target.requestFullscreen\n    || this.target.webkitRequestFullscreen\n    // || this.target.mozRequestFullScreen\n    || this.target.msRequestFullscreen;\n\n    this.onCanPlayStart = this.onCanPlayStart.bind(this);\n    this.onLoadStart = this.onLoadStart.bind(this);\n    this.onLoadedData = this.onLoadedData.bind(this);\n    this.onPlayChange = this.onPlayChange.bind(this);\n    this.onTimeChange = this.onTimeChange.bind(this);\n    this.onPlayClick = this.onPlayClick.bind(this);\n    this.onTimeKeydown = this.onTimeKeydown.bind(this);\n    this.onTimeClick = this.onTimeClick.bind(this);\n    this.onTimeKeydown = this.onTimeKeydown.bind(this);\n    this.onFullscreenClick = this.onFullscreenClick.bind(this);\n    this.onFullscreenChange = this.onFullscreenChange.bind(this);\n\n    // add event listeners\n    this.$media.addEventListener('canplaythrough', this.onCanPlayStart);\n    this.$media.addEventListener('loadstart', this.onLoadStart);\n    this.$media.addEventListener('loadeddata', this.onLoadedData);\n    this.$media.addEventListener('pause', this.onPlayChange);\n    this.$media.addEventListener('play', this.onPlayChange);\n    this.$media.addEventListener('timeupdate', this.onTimeChange);\n    this.$controls.addEventListener('click', this.onPlayClick, false);\n    // this.$play.addEventListener('click', this.onPlayClick, false);\n    this.$play.addEventListener('keydown', this.onTimeKeydown);\n    this.$time.addEventListener('click', this.onTimeClick, false);\n    this.$time.addEventListener('keydown', this.onTimeKeydown);\n    this.$fullscreen.addEventListener('click', this.onFullscreenClick, false);\n    // listen for fullscreen changes\n    document.addEventListener(\n      this._fullscreenchange,\n      this.onFullscreenChange,\n    );\n\n    // pointer events from time control\n    VideoPlayer.onDrag(this.$time, this.$timeRange, (percentage) => {\n      this.$media.currentTime = this.duration * Math.max(0, Math.min(1, percentage));\n\n      this.onTimeChange();\n    });\n\n    this.onLoadStart();\n  }\n\n  static _fullscreenElement() {\n    return document.fullscreenElement\n    || document.webkitFullscreenElement\n    // || document.mozFullScreenElement\n    || document.msFullscreenElement;\n  }\n\n  static _exitFullscreen() {\n    return document.exitFullscreen\n    || document.webkitCancelFullScreen\n    // || document.mozCancelFullScreen\n    || document.msExitFullscreen;\n  }\n\n  // when the play state changes\n  onPlayChange() {\n    if (this.paused !== this.$media.paused) {\n      this.paused = this.$media.paused;\n\n      this.$play.setAttribute(\n        'aria-label',\n        this.paused ? this.lang.play || 'play' : this.lang.pause || 'pause',\n      );\n      this.target.setAttribute(\n        'data-player-state',\n        this.paused ? 'paused' : 'playing',\n      );\n      this.$playSymbol.setAttribute('aria-hidden', !this.paused);\n      this.$pauseSymbol.setAttribute('aria-hidden', this.paused);\n\n      clearInterval(this.interval);\n\n      if (!this.paused) {\n        // listen for time changes every 30th of a second\n        this.interval = setInterval(this.onTimeChange, 34);\n      }\n\n      // dispatch new \"playchange\" event\n      this.$media.dispatchEvent(mediaEvents.playchange);\n    }\n  }\n\n  // when the time changes\n  onTimeChange() {\n    if (\n      this.currentTime !== this.$media.currentTime\n      || this.duration !== this.$media.duration\n    ) {\n      this.currentTime = this.$media.currentTime;\n      this.duration = this.$media.duration || 0;\n\n      const currentTimePercentage = this.currentTime / this.duration;\n      // const currentTimeCode = VideoPlayer.timeToTimecode(this.currentTime);\n      const currentTimeCode = getSecondsMinutesFormat(this.currentTime);\n      // const remainingTimeCode = VideoPlayer.timeToTimecode(\n      //   this.duration - Math.floor(this.currentTime),\n      // );\n\n      if (currentTimeCode !== this.$currentTimeText.nodeValue) {\n        this.$currentTimeText.nodeValue = currentTimeCode;\n\n        this.$currentTime.setAttribute(\n          'title',\n          `${VideoPlayer.timeToAural(\n            this.currentTime,\n            this.lang.minutes || 'minutes',\n            this.lang.seconds || 'seconds',\n          )}`,\n        );\n      }\n\n      // if (remainingTimeCode !== this.$remainingTimeText.nodeValue) {\n      //   this.$remainingTimeText.nodeValue = remainingTimeCode;\n\n      //   $(this.$remainingTime, {\n      //     title: `${VideoPlayer.timeToAural(\n      //       this.duration - this.currentTime,\n      //       this.lang.minutes || 'minutes',\n      //       this.lang.seconds || 'seconds',\n      //     )}`,\n      //   });\n      // }\n\n      this.$time.setAttribute('aria-valuenow', this.currentTime);\n      this.$time.setAttribute('aria-valuemin', 0);\n      this.$time.setAttribute('aria-valuemax', this.duration);\n\n      this.$timeMeter.style.width = `${currentTimePercentage * 100}%`;\n\n      // dispatch new \"timechange\" event\n      this.$media.dispatchEvent(mediaEvents.timechange);\n    }\n  }\n\n  // when media loads for the first time\n  onLoadStart() {\n    this.$media.removeEventListener('canplaythrough', this.onCanPlayStart);\n    this.$media.addEventListener('canplaythrough', this.onCanPlayStart);\n\n    this.onPlayChange();\n    this.onFullscreenChange();\n    this.onTimeChange();\n  }\n\n  // when the immediate current playback position is available\n  onLoadedData() {\n    this.onTimeChange();\n  }\n\n  // when the media can play\n  onCanPlayStart() {\n    this.$media.removeEventListener('canplaythrough', this.nCanPlayStart);\n\n    // dispatch new \"canplaystart\" event\n    this.$media.dispatchEvent(mediaEvents.canplaystart);\n\n\n    if (!this.paused || this.$media.autoplay) {\n      this.$media.play();\n    }\n  }\n\n  onFullscreenChange() {\n    const isFullscreen = this.target === VideoPlayer._fullscreenElement();\n\n    this.$fullscreen.setAttribute(\n      'aria-label',\n      isFullscreen\n        ? this.lang.leaveFullscreen || 'leave full screen'\n        : this.lang.enterFullscreen || 'enter full screen',\n    );\n    this.$enterFullscreenSymbol.setAttribute('aria-hidden', isFullscreen);\n    this.$leaveFullscreenSymbol.setAttribute('aria-hidden', !isFullscreen);\n  }\n\n  // when the play control is clicked\n  onPlayClick(event) {\n    event.preventDefault();\n    event.stopPropagation();\n\n    this.$media[this.$media.paused ? 'play' : 'pause']();\n  }\n\n  // when the time control\n  onTimeClick(event) {\n    event.stopPropagation();\n\n    // handle click if clicked without pointer\n    if (!event.pointerType && !event.detail) {\n      this.onPlayClick(event);\n    }\n  }\n\n  // click from fullscreen control\n  onFullscreenClick(event) {\n    event.stopPropagation();\n\n    if (this._requestFullscreen) {\n      if (this.target === VideoPlayer._fullscreenElement()) {\n        // exit fullscreen\n        VideoPlayer._exitFullscreen().call(document);\n      } else {\n        // enter fullscreen\n        this._requestFullscreen.call(this.target);\n\n        // maintain focus in internet explorer\n        this.$fullscreen.focus();\n\n        // maintain focus in safari\n        setTimeout(() => {\n          this.$fullscreen.focus();\n        }, 200);\n      }\n    } else if (this.$media.webkitSupportsFullscreen) {\n      // iOS allows fullscreen of the video itself\n      if (this.$media.webkitDisplayingFullscreen) {\n        // exit ios fullscreen\n        this.$media.webkitExitFullscreen();\n      } else {\n        // enter ios fullscreen\n        this.$media.webkitEnterFullscreen();\n      }\n\n      this.onFullscreenChange();\n    }\n  }\n\n  // keydown from play control or current time control\n  onTimeKeydown(event) {\n    const { keyCode, shiftKey } = event;\n\n    // 37: LEFT, 38: UP, 39: RIGHT, 40: DOWN\n    if (keyCode >= 37 && keyCode <= 40) {\n      event.preventDefault();\n\n      const offset = keyCode === 37 || keyCode === 39 ? keyCode - 38 : keyCode - 39;\n\n      this.$media.currentTime = Math.max(\n        0,\n        Math.min(\n          this.$media.duration,\n          this.$media.currentTime + offset * (shiftKey ? 10 : 1),\n        ),\n      );\n\n      this.onTimeChange();\n    }\n  }\n\n  // Handle Drag Ranges\n  static onDrag(target, innerTarget, listener) {\n    // eslint-disable-line max-params\n    const hasPointerEvent = undefined !== target.onpointerup;\n    const hasTouchEvent = undefined !== target.ontouchstart;\n    const pointerDown = hasPointerEvent\n      ? 'pointerdown'\n      : hasTouchEvent\n        ? 'touchstart'\n        : 'mousedown';\n    const pointerMove = hasPointerEvent\n      ? 'pointermove'\n      : hasTouchEvent\n        ? 'touchmove'\n        : 'mousemove';\n    const pointerUp = hasPointerEvent\n      ? 'pointerup'\n      : hasTouchEvent\n        ? 'touchend'\n        : 'mouseup';\n\n    // ...\n    const axisProp = 'clientX';\n\n    let window;\n    let start;\n    let end;\n\n    function onpointermove(event) {\n      // prevent browser actions on this event\n      event.preventDefault();\n\n      // the pointer coordinate\n      const position = axisProp in event\n        ? event[axisProp]\n        : (event.touches && event.touches[0] && event.touches[0][axisProp])\n            || 0;\n\n      // the percentage of the pointer along the container\n      const percentage = (position - start) / (end - start);\n\n      // call the listener with percentage\n      listener(percentage);\n    }\n\n    function onpointerdown(event) {\n      // window\n      window = target.ownerDocument.defaultView;\n\n      // client boundaries\n      const rect = innerTarget.getBoundingClientRect();\n\n      // the container start and end coordinates\n      start = rect.left;\n      end = rect.right;\n\n      onpointermove(event);\n\n      window.addEventListener(pointerMove, onpointermove);\n      window.addEventListener(pointerUp, onpointerup);\n    }\n\n    function onpointerup() {\n      window.removeEventListener(pointerMove, onpointermove);\n      window.removeEventListener(pointerUp, onpointerup);\n    }\n\n    // on pointer down\n    target.addEventListener(pointerDown, onpointerdown);\n  }\n\n  // Time To Timecode\n  // DEPRECATED (media.util)\n  // static timeToTimecode(time) {\n  //   return `${`0${Math.floor(time / 60)}`.slice(-2)}:${`0${Math.floor(\n  //     time % 60,\n  //   )}`.slice(-2)}`;\n  // }\n\n  // Time To Aural\n  // DEPRECATED (media.util)\n  static timeToAural(time, langMinutes, langSeconds) {\n    return `${Math.floor(time / 60)} ${langMinutes}, ${Math.floor(\n      time % 60,\n    )} ${langSeconds}`;\n  }\n}\n","import domLoadComponents from './dom-load';\nimport windowLoadComponents from './window-load';\n\n// The DOMContentLoaded event fires when parsing of the current page is complete. DOMContentLoaded is a great event to use to hookup UI functionality to complex web pages.\ndocument.addEventListener('DOMContentLoaded', domLoadComponents, false);\n\n// The load event fires when all files have finished loading from all resources, including ads and images.\nwindow.addEventListener('load', windowLoadComponents, false);\n","\nconst domLoadComponents = () => {\n  console.log('domLoad:components');\n\n  // instantiate\n\n  // run\n\n};\n\nexport default domLoadComponents;\n","/* eslint-disable no-unused-vars */\nimport MagnifyingGlass from './magnifying-glass';\nimport PhotoDetail from './photo-detail';\nimport Sortable from './sortable';\nimport SVG from './svg';\nimport SVGRadialMenu from './svg-lib/svg-radial-menu';\nimport Editor from './editor/editor';\nimport AnalyticalTable from './analytical-table';\nimport Keywords from './keywords';\nimport EditorTagsPlaceholder from './editor-tags-placeholder';\nimport TestQuiz from './test-quiz';\nimport GenericTable from './generic-table';\nimport FullscreenToggle from './fullscreen';\nimport UserText from './user-text';\nimport AudioPlayerNormal from './media/audio-player-normal';\nimport AudioPlayerSimple from './media/audio-player-simple';\nimport FakeMap from './fake-map';\nimport { stopPlayingVideoPlayers } from './media/media';\nimport VideoPlayer from './media/video';\n// import actionTypes from '../store/store-constants';\n// import storeGlobal from '../store/store-global';\n\nconst windowLoadComponents = () => {\n  console.log('windowLoad:components');\n\n  // Video player - normal\n  const $videoPlayers = Array.from(\n    document.querySelectorAll('[data-player-video]'),\n  );\n  if ($videoPlayers.length > 0) {\n    $videoPlayers.forEach(($videoPlayer) => {\n      // console.log('$videoPlayer', $videoPlayer);\n      const videoPlayer = new VideoPlayer($videoPlayer);\n    });\n\n    document.addEventListener('slide.change', () => {\n      stopPlayingVideoPlayers($videoPlayers);\n    });\n  }\n\n  // Audio player - normal\n  const $audioPlayerNormals = Array.from(\n    document.querySelectorAll('[data-player-audio=\"normal\"]'),\n  );\n  if ($audioPlayerNormals.length > 0) {\n    $audioPlayerNormals.forEach(($audioPlayerNormal) => {\n      const audioPlayerNormal = new AudioPlayerNormal($audioPlayerNormal);\n    });\n\n    // TODO > audio-player-normal.js#61\n    // document.addEventListener('slide.change', () => {\n    //   stopPlayingVideoPlayers($audioPlayerNormals);\n    // });\n  }\n\n  // Audio player — simple\n  const $audioPlayerSimples = Array.from(document.querySelectorAll(\n    '[data-player-audio=\"simple\"]',\n  ));\n  if ($audioPlayerSimples.length > 0) {\n    $audioPlayerSimples.forEach(($audioPlayerSimple) => {\n      const audioPlayerSimple = new AudioPlayerSimple($audioPlayerSimple);\n    });\n\n    document.addEventListener('slide.change', () => {\n      stopPlayingVideoPlayers($audioPlayerSimples);\n    });\n  }\n\n  // Fullscreen\n  const $fullscreenToggles = document.querySelectorAll(\n    '[data-fullscreen=\"toggle\"]',\n  );\n  if ($fullscreenToggles.length > 0) {\n    Array.from($fullscreenToggles).forEach(($fullscreenToggle) => {\n      const fullscreenToggle = new FullscreenToggle($fullscreenToggle);\n    });\n  }\n\n  // Magnifying glass\n  const $magnifyingGlass = document.querySelectorAll('[data-lupa-target]');\n  if ($magnifyingGlass.length > 0) {\n    for (let i = 0; i < $magnifyingGlass.length; i += 1) {\n      const magnifyingGlass = new MagnifyingGlass($magnifyingGlass[i]);\n    }\n  }\n\n  // Photo detail\n  const $photoDetails = document.querySelectorAll('[data-photo-detail-target]');\n  if ($photoDetails.length > 0) {\n    for (let i = 0; i < $photoDetails.length; i += 1) {\n      const photoDetail = new PhotoDetail($photoDetails[i]);\n    }\n  }\n\n  // Fake Map\n  const $fakeMaps = document.querySelectorAll('[data-fake-map=\"target\"]');\n  if ($fakeMaps.length > 0) {\n    for (let i = 0; i < $fakeMaps.length; i += 1) {\n      const fakeMap = new FakeMap($fakeMaps[i]);\n    }\n  }\n\n  //\n  // load those only in working mode\n  if (HISTORYLAB.import.done !== true) {\n    // User texts\n    const $userTexts = document.querySelectorAll('[data-textarea-target=\"\"]');\n    if ($userTexts.length > 0) {\n      Array.from($userTexts).forEach(($userText) => {\n        const userText = new UserText($userText);\n      });\n    }\n\n    // Editor\n    const $editors = document.querySelectorAll('[data-editor]');\n    if ($editors.length > 0) {\n      Array.from($editors).forEach(($editor) => {\n        const editor = new Editor($editor);\n      });\n    }\n\n    // Test Quizes\n    const $testQuizs = document.querySelectorAll('[data-target-test-quiz]');\n    if ($testQuizs.length > 0) {\n      Array.from($testQuizs).forEach(($testQuiz) => {\n        const settings = document.querySelector(\n          `[data-test-quiz-id-reference=\"${$testQuiz.getAttribute(\n            'data-test-quiz-id',\n          )}\"]`,\n        );\n\n        const testQuiz = new TestQuiz(\n          $testQuiz.getAttribute('data-test-quiz-id'),\n          $testQuiz,\n          JSON.parse(settings.getAttribute('data-module-settings')),\n        );\n        testQuiz.init();\n      });\n    }\n\n    // Analytical tables\n    const $analyticalTables = document.querySelectorAll(\n      '[data-target-analytical-table]',\n    );\n\n    if ($analyticalTables.length > 0) {\n      Array.from($analyticalTables).forEach(($analyticalTable) => {\n        const settings = document.querySelector(\n          `[data-analytical-table-id-reference=\"${$analyticalTable.getAttribute(\n            'data-analytical-table-id',\n          )}\"]`,\n        );\n        const analyticalTable = new AnalyticalTable(\n          $analyticalTable.getAttribute('data-analytical-table-id'),\n          $analyticalTable,\n          JSON.parse(settings.getAttribute('data-module-settings')),\n        );\n        analyticalTable.init();\n      });\n    }\n\n    // Generic tables\n    const $genericTables = document.querySelectorAll(\n      '[data-target-generic-table]',\n    );\n    if ($genericTables.length > 0) {\n      Array.from($genericTables).forEach(($genericTable) => {\n        const settings = document.querySelector(\n          `[data-generic-table-id-reference=\"${$genericTable.id}\"]`,\n        );\n        const genericTable = new GenericTable(\n          $genericTable,\n          JSON.parse(settings.getAttribute('data-module-settings')),\n        );\n        genericTable.init();\n      });\n    }\n\n    // SVG + Radial menu\n    const $svgs = document.querySelectorAll('[data-svg-target]');\n    if ($svgs.length > 0) {\n      // radial menu\n      const $radialMenu = document.querySelector('[data-radial-menu]');\n      if ($radialMenu) {\n        const radialMenu = new SVGRadialMenu($radialMenu, $svgs);\n      }\n\n      // svgs\n      for (let i = 0; i < $svgs.length; i += 1) {\n        const svg = new SVG($svgs[i]);\n      }\n    }\n\n    // Sortable\n    const $sortables = document.querySelectorAll('[data-sortable-target]');\n    if ($sortables.length > 0) {\n      for (let i = 0; i < $sortables.length; i += 1) {\n        const sortable = new Sortable($sortables[i]);\n      }\n    }\n\n    // Keywords selection\n    const $keywords = document.querySelectorAll('[data-keywords]');\n    if ($keywords.length > 0) {\n      Array.from($keywords).forEach(($keyword) => {\n        const settings = $keyword.hasAttribute('data-module-settings')\n          ? $keyword.getAttribute('data-module-settings')\n          : {};\n        const keywords = new Keywords($keyword, JSON.parse(settings));\n        keywords.init();\n      });\n    }\n\n    // Editor tags placeholders\n    const $editorTagsPlaceholders = document.querySelectorAll(\n      '.editor-tags-placeholder',\n    );\n    if ($editorTagsPlaceholders.length > 0) {\n      Array.from($editorTagsPlaceholders).forEach((item) => {\n        const editorTagsPlaceholder = new EditorTagsPlaceholder(item);\n        editorTagsPlaceholder.init();\n      });\n    }\n  }\n};\n\nexport default windowLoadComponents;\n"],"names":["Component","$element","target","$slide","this","closest","$buttonFeedback","querySelector","$buttonFeedbackText","showFeedback","bind","classList","contains","remove","MagnifyingGlass","document","$canvas","ctx","_this","getContext","_onStart","_onMove","_onEnd","_update","_onResize","zoomGlassSize","targetBCR","zoomed","targetZoomed","x","y","trackingTouch","_addEventListeners","_initCanvas","window","requestAnimationFrame","width","height","dPR","devicePixelRation","style","scale","getBoundingClientRect","event","preventDefault","pageX","touches","pageY","TAU","Math","PI","radius","ratioX","max","min","left","ratioY","top","scaledTargetWidth","scaledTargetHeight","platform","os","family","indexOf","name","shadowColor","shadowBlur","shadowOffsetY","clearRect","fillStyle","beginPath","arc","closePath","fill","save","clip","drawImage","restore","transform","addEventListener","__createNewCustomEvent","options","data","properties","Object","assign","bubbles","CustomEvent","detail","__dispatchEvent","type","payload","dispatchEvent","__isObject","item","_typeof","Array","isArray","__insertBefore","newNode","referenceNode","parentNode","insertBefore","__remove","el","removeChild","__getHTML","node","tagName","outerHTML","wrapper","createElement","appendChild","cloneNode","innerHTML","__localPosition","container","pos","d3","mouse","format","__positionTranslated","curTransform","WebKitCSSMatrix","getComputedStyle","webkitTransform","body","pageYOffset","scrollTop","pageXOffset","scrollLeft","offsetLeft","m41","offsetTop","m42","__position","elAttibutes","__toggleClass","element","cls","__hasClass","__removeClass","__addClass","className","elements","classes","_elements","_classes","querySelectorAll","split","i","length","add","j","console","log","replace","RegExp","PhotoDetail","zoomIntensity","targetContainer","parentElement","_onClick","_getImageDimensions","clientX","clientY","positionY","positionX","mediaEvents","playchange","timechange","canplaystart","stopPlayingVideoPlayers","$players","forEach","$player","$media","paused","pause","setAttribute","getSecondsMinutesFormat","seconds","duration","floor","minutes","toString","slice","AudioPlayer","$item","$audio","$playButton","$timeLeft","getAttribute","from","play","stopPropagation","innerText","currentTime","Sortable","items","droppables","placeholder","direction","before","after","x0","y0","x1","y1","dragged","clone","posRel","rect","size","siblings","prev","next","hasAttribute","offsetWidth","offsetHeight","_addPlaceholder","_onOver","right","_onDrop","bottom","_removePlaceholder","_getReference","_addEventListenerToItem","addEventListeners","minHeight","src","img","nextElementSibling","previousElementSibling","SVGDragNDrop","select","raise","classed","diff","attr","toFixed","SVGDraw","$svg","callback","sourceEvent","nodeName","line","curve","curveLinear","d","subject","id","active","append","datum","on","dx","dy","push","$thisPath","svg","activity","d3svg","canvas","localPosition","hash","foreignObject","elementPosition","call","drag","start","end","SVGText","maxLength","minLength","svgID","svgGroup","$radialMenu","boxId","orientation","focus","updateTextareaHeight","value","SVG","removeItem","$target","scrollHeight","init","svgSpecificActions","_initPath","_initCircle","_setSize","_initComicBubbles","svgDuplicateSources","_getEvents","viewbox","maxWidth","_this2","p","renderPath","createCircle","_this3","comicBubbles","selectAll","textNode","pathNode","circleNode","textBox","e","includes","_this4","pathClone","circleClone","childNodes","color","textBoxClone","elem","selected","$parent","allActiveSvgs","deactivate","SVGRadialMenu","$svgs","$radialMenuItems","$colorItems","$textItems","$createTextItem","$removeItem","$tooltip","initialSetUp","menuRadius","parseInt","getPropertyValue","itemRadius","setUpRadialMenuItems","addEventListenersToRadialMenu","activate","deselectItem","filterMenuButtons","showRadialMenu","addEventListenersToRadialMenuItem","$items","_itemsLength","_menuRadius","_itemRadius","_menuOffset","_centerOffset","index","angle","sin","cos","onMouseLeave","hideRadialMenu","action","createText","changeColor","currentTarget","display","$activeSVG","globalPosition","__globalPosition","$activeRadialMenuItem","positionRadialMenuItems","setTimeout","_this5","mouseLeaveDelay","_this6","clearTimeout","clickedItem","$colorItem","$textItem","selectItem","$selected","Observer","_events","events","fn","_split","filter","current_fn","args","actionTypes","editor","ADD_TAG","DELETE_TAG","UPDATE_TAG","CHANGE","keywords","testQuiz","ADD_ANSWER","REMOVE_ANSWER","UPDATE_ANSWER","textOptions","ADD","DELETE","UPDATE","store","_data","tags","tagId","tagExists","tagContainer","_checkTagExists","Error","undefined","userSelectedNodeItems","trigger","splice","editorId","opts","key","selectedTags","objectExists","_checkExists","selectedObjs","Editor","$editor","settings","JSON","parse","__mergeDeep","source","output","keys","defaults","models","passive","interactive","withMenu","totalTagId","hasMenu","selection","lastSelectionSettings","isCollapsed","savedSelectionRange","selectionAttributes","dummyRangeElement","selectionMouseDown","selectionDirection","hasEditableContentChanged","lastPressedKey","hasToolbar","toolbar","originalContent","currentContent","_handlers","wrapLastDeletesTimeoutClass","wrapLastDeletesTimeoutFunction","wrapLastAdditionsTimeoutClass","wrapLastAdditionsTimeoutFunction","isWrappingLastText","isWriting","$groupDeleted","cache","_hasMenu","$menu","getElementsByClassName","menuClass","$menuActions","$menuClose","error","_hasToolbar","canvasClass","funkce","html","text","_generateNewTagGroupClass","$btnReset","registerEditableHandlers","initPreHighlightedTextOptions","handlerFocus","keycode","getSelection","keyCode","which","keyName","rangeCount","range","getRangeAt","cloneRange","setStart","startContainer","startOffset","collapse","setEnd","endContainer","endOffset","addedFragmentString","cloneContents","textContent","trim","dummyElementInner","surroundContents","removeAllRanges","addRange","dummyElement","contentEditable","newGeneratedId","_generateNewTagId","$btnClose","closeBtnClass","$nodeElement","_removeNodeKeepTextContent","getElementById","wrapLastDeletesTimeout","textToAddElement","insertNode","setStartAfter","groupDeletedId","$groupInnerDeleted","$groupInnerAdded","$groupAdded","registerMenuHandler","confirm","len","handlerMenuActions","handlerMenuClose","$textOptionsElements","$textOption","selectedClass","storeGlobal","tag","_setmenuDimensions","leftDimensions","topDimensions","menuDimensions","translated","clonedElement","visibility","nextSibling","elDimensions","elPosition","__getRealDimensions","parentTranslatedPosition","parentDimensions","isOverflowAt","menuMargin","toggleMenu","$el","command","commandName","setSelection","anchorOffset","focusOffset","_setSelectionPosition","selectionPosition","selectionDimension","$domEl","extractContents","newTagId","addTag","createTextNode","parentEl","$elClose","toggleClass","clickHandler","$closeBtn","removeEventListener","commentRef","deleteTag","$node","nodePosition","commentMargin","commentTemplate","div","commentDiv","nodeRef","commentNewTextarea","commentDivButtonSubmit","getElementsByTagName","commentCommentsContainer","calculatedCommentPosition","_calculateCommentPosition","commentItem","_createCommentForNode","closeBtn","_createCloseBtnForElement","comments","_addCommentHandlerForElement","commentsClass","_extractAndSaveContents","showCommentsOnInit","click","resetBtnClass","nodeSelectedClass","enable","animatedClass","deselectedClass","menu","AnalyticalTable","isAdvanced","rowIndex","tableResult","tableResultBody","tableSelectedItems","tableSelectedItemsBody","activeDragged","_getRowHTML","_getAdvancedRowHTML","_registerStoreHandlers","_registerHandlers","addedTagContainer","casti","sloupce","insertAdjacentHTML","letSecondCaseRunIfSame","_handlerDraggable","prototype","_handlerDrop","dataTransfer","setData","dropEffect","opacity","background","nodeHTML","keywordsId","newItems","newItemsHTML","itemsHTML","Keywords","$controls","$itemsContainer","itemsContainerClassName","inherit","isInherited","itemClassName","_getHTMLFromItems","change","_getItemsFromHTML","_getItemsHTML","onInit","_regenerateItemsContainerFromInherited","_changeSizeOfKeywordItem","skala","maxLevel","setNewLevelValue","$keyword","number","feedback","oldValue","newValue","abs","$control","tempContent","temp","renameItemsIds","_eventHandler","_getItemFromDOMElement","itemsClassName","itemsArray","_getDOMElementFromItem","newDiv","contentHTML","oldId","newId","expString","EditorTagsPlaceholder","commandNames","itemSubscribeAttributeClassName","getTagsBy","content","TestQuiz","$questions","itemClass","answersCorrect","colors","questions","zpetnaVazba","map","barva","$question","questionIndex","answered","answerCorrect","$answers","optionClass","$answer","answerIndex","$answerCurrent","$answersItem","feedbackActual","find","podminka","question","GenericTable","$tableResultBody","dataSettings","tasksToComplete","tasksCompleted","tasks","subscribe","join","$allRows","$newSelects","$select","taskNumber","$row","vyraz","Fullscreen","$fullscreen","$fullscreenImage","image","innerWidth","innerHeight","ratio","onload","naturalWidth","naturalHeight","FullscreenToggle","toggle","UserText","$userTexts","lengthExpected","avg","sendFeedback","valueLength","$userText","AudioPlayerNormal","$loadWave","$leftTime","$audioDuration","wavesurfer","WaveSurfer","create","waveColor","progressColor","responsive","barWidth","load","dataset","initWave","getDuration","addListenerAfterReady","time","playPause","$nextSlides","$nextSlide","AudioPlayerSimple","$duration","FakeMap","$buttons","$maps","lastActiveIndex","addEventListenerToButtons","$button","switchMap","VideoPlayer","prefix","lang","interval","$document","ownerDocument","$play","$playSymbol","$pauseSymbol","$time","$timeMeter","$timeRange","$currentTimeText","$currentTime","durationTime","$durationTime","timeToAural","$enterFullscreenSymbol","$leaveFullscreenSymbol","_fullscreenchange","_requestFullscreen","requestFullscreen","webkitRequestFullscreen","msRequestFullscreen","onCanPlayStart","onLoadStart","onLoadedData","onPlayChange","onTimeChange","onPlayClick","onTimeKeydown","onTimeClick","onFullscreenClick","onFullscreenChange","onDrag","percentage","clearInterval","setInterval","currentTimePercentage","currentTimeCode","nodeValue","nCanPlayStart","autoplay","isFullscreen","_fullscreenElement","leaveFullscreen","enterFullscreen","pointerType","_exitFullscreen","webkitSupportsFullscreen","webkitDisplayingFullscreen","webkitExitFullscreen","webkitEnterFullscreen","shiftKey","offset","fullscreenElement","webkitFullscreenElement","msFullscreenElement","exitFullscreen","webkitCancelFullScreen","msExitFullscreen","innerTarget","listener","hasPointerEvent","onpointerup","hasTouchEvent","ontouchstart","pointerDown","pointerMove","pointerUp","axisProp","onpointermove","position","defaultView","langMinutes","langSeconds","$videoPlayers","$videoPlayer","$audioPlayerNormals","$audioPlayerNormal","$audioPlayerSimples","$audioPlayerSimple","$fullscreenToggles","$fullscreenToggle","$magnifyingGlass","$photoDetails","$fakeMaps","HISTORYLAB","done","$editors","$testQuizs","$testQuiz","$analyticalTables","$analyticalTable","$genericTables","$genericTable","$sortables","$keywords","$editorTagsPlaceholders"],"mappings":"kpDAAqBA,wBACPC,kBACLC,OAASD,OACTE,OAASC,KAAKF,OAAOG,QAAQ,UAE9BD,KAAKD,cACFG,gBAAkBF,KAAKD,OAAOI,cAAc,+BAC5CC,oBAAsBJ,KAAKE,gBAAgBC,cAAc,cAG3DE,aAAeL,KAAKK,aAAaC,KAAKN,uDAIvCA,KAAKE,iBAAmBF,KAAKE,gBAAgBK,UAAUC,SAAS,uBAC7DN,gBAAgBK,UAAUE,OAAO,0BCbvBC,yBAEPb,mDACJA,KAODA,SAAWc,SAASR,cAAc,iBAClCS,QAAUD,SAASR,cAAc,wBACjCU,IAAMC,EAAKF,QAAQG,WAAW,QAE9BC,SAAWF,EAAKE,SAASV,aACzBW,QAAUH,EAAKG,QAAQX,aACvBY,OAASJ,EAAKI,OAAOZ,aACrBa,QAAUL,EAAKK,QAAQb,aACvBc,UAAYN,EAAKM,UAAUd,aAE3Be,cAAgB,MAChBC,UAAY,OACZC,OAAS,IACTC,aAAe,IAEfC,EAAI,IACJC,EAAI,IACJC,eAAgB,IAEhBC,uBACAC,gBACAT,YAELU,OAAOC,sBAAsBjB,EAAKK,sBAjCOvB,gDAqCnCoC,EAAQhC,KAAKqB,cACbY,EAASjC,KAAKqB,cAEda,EAAMJ,OAAOK,mBAAqB,OACnCvB,QAAQoB,MAAQA,EAAQE,OACxBtB,QAAQqB,OAASA,EAASC,OAE1BtB,QAAQwB,MAAMJ,gBAAWA,aACzBpB,QAAQwB,MAAMH,iBAAYA,aAE1BpB,IAAIwB,MAAMH,EAAKA,4CAIfZ,UAAYtB,KAAKF,OAAOwC,yDAGtBC,GACHA,EAAMzC,SAAWE,KAAKF,SAI1ByC,EAAMC,sBAGDf,EAAIc,EAAME,OAASF,EAAMG,QAAQ,GAAGD,WACpCf,EAAIa,EAAMI,OAASJ,EAAMG,QAAQ,GAAGC,WAEpChB,eAAgB,OAChBH,aAAe,OACfD,OAAS,EAEdO,OAAOC,sBAAsB/B,KAAKmB,0CAG5BoB,GACDvC,KAAK2B,qBAILF,EAAIc,EAAME,OAASF,EAAMG,QAAQ,GAAGD,WACpCf,EAAIa,EAAMI,OAASJ,EAAMG,QAAQ,GAAGC,wCAIrC3C,KAAKwB,mBAEFnB,oBAGFmB,aAAe,OACfG,eAAgB,wCAIfiB,EAAgB,EAAVC,KAAKC,GAEXC,EADa,IACJ/C,KAAKuB,YAEfD,UAAYtB,KAAKF,OAAOwC,4BAGvBU,EAEJH,KAAKI,IAAI,EAEPJ,KAAKK,IAAI,GAAKlD,KAAKyB,EAAIzB,KAAKsB,UAAU6B,MAAQnD,KAAKsB,UAAUU,QAG3DoB,EAEJP,KAAKI,IAAI,EAEPJ,KAAKK,IAAI,GAAKlD,KAAK0B,EAAI1B,KAAKsB,UAAU+B,KAAOrD,KAAKsB,UAAUW,SAM1DqB,EADa,IACOtD,KAAKsB,UAAUU,MACnCuB,EAFa,IAEQvD,KAAKsB,UAAUW,OAGpCuB,SAASC,GAAGC,OAAOC,QAAQ,YAAc,GAAKH,SAASI,KAAKD,QAAQ,YAAc,SAEjF9C,IAAIgD,YAAc,uBAClBhD,IAAIiD,WAAa,QACjBjD,IAAIkD,cAAgB,QAItBlD,IAAImD,UAAU,EAAG,EAAGhE,KAAKqB,cAAerB,KAAKqB,oBAC7CR,IAAIoD,UAAY,YAChBpD,IAAIqD,iBACJrD,IAAIsD,SAEF9C,cAAgB,OAEfA,cAAgB,GAAM0B,EAE5BA,EAAQ,EAAGH,QACR/B,IAAIuD,iBACJvD,IAAIwD,YAGJxD,IAAIyD,YAGJzD,IAAIqD,iBACJrD,IAAIsD,SAEF9C,cAAgB,OAEfA,cAAgB,IAAO0B,EAAS,GAE7B,KAATA,EAAe,EAAGH,QACf/B,IAAI0D,YACJ1D,IAAIuD,iBACJvD,IAAI2D,UAAUxE,KAAKF,QAEpBkD,EAASM,EAAsBtD,KAAKqB,cAAgB,GACpD+B,EAASG,EAAuBvD,KAAKqB,cAAgB,EAEvDiC,EAAmBC,QAIhB1C,IAAI4D,eAGJ5E,SAASuC,MAAMsC,8BAAyB1E,KAAKyB,iBAAQzB,KAAK0B,cAG1DH,SAAWvB,KAAKwB,aAAexB,KAAKuB,QAAU,EAG/CvB,KAAKuB,OAAS,KAEhBO,OAAOC,sBAAsB/B,KAAKmB,cAI7BI,OAAS,+CAMhBZ,SAASgE,iBAAiB,aAAc3E,KAAKgB,UAC7CL,SAASgE,iBAAiB,YAAa3E,KAAKiB,SAC5CN,SAASgE,iBAAiB,WAAY3E,KAAKkB,QAE3CP,SAASgE,iBAAiB,YAAa3E,KAAKgB,UAC5CL,SAASgE,iBAAiB,YAAa3E,KAAKiB,SAC5CN,SAASgE,iBAAiB,UAAW3E,KAAKkB,QAE1CY,OAAO6C,iBAAiB,SAAU3E,KAAKoB,oBC5KpC,SAASwD,EAAuBhB,OAAMiB,yDAAU,GAAIC,yDAAO,KAqB1DC,EAAaC,OAAOC,OApBT,CAEfC,SAAS,GAkBgCL,UAEpC,IAAIM,YAAYvB,sUACrBwB,OAAQN,GACLC,IAIA,SAASM,EAAgBxF,EAAUyF,EAAMT,EAASU,OACjDhD,EAAQqC,EAAuBU,EAAMT,EAASU,GAEpD1F,EAAS2F,cAAcjD,GAiClB,SAASkD,EAAWC,UACjBA,GAAwB,WAAhBC,EAAOD,KAAsBE,MAAMC,QAAQH,GA2BtD,SAASI,EAAeC,EAASC,GACtCA,EAAcC,WAAWC,aAAaH,EAASC,GAiC1C,SAASG,EAASC,GAEvBA,EAAGH,WAAWI,YAAYD,GAKrB,SAASE,EAAUC,MAEnBA,GAASA,EAAKC,YACfD,EAAKE,iBAAoBF,EAAKE,cAG5BC,EAAU/F,SAASgG,cAAc,cACvCD,EAAQE,YAAYL,EAAKM,WAAU,IAC5BH,EAAQI,WAkBV,SAASC,EAAgBC,OAIxBC,EAAMC,GAAGC,MAAMH,SACd,CACLvF,EAAGyF,GAAGE,OAAO,MAAVF,CAAiBD,EAAI,IACxBvF,EAAGwF,GAAGE,OAAO,MAAVF,CAAiBD,EAAI,KAIrB,SAASI,EAAqBjB,OAG7BkB,EAAe,IAAIC,gBAAgBzF,OAAO0F,iBAAiBpB,GAAIqB,iBAE/DC,EAAO/G,SAAS+G,KAEJ5F,OAAO6F,aAAeD,EAAKE,UAC1B9F,OAAO+F,aAAeH,EAAKI,iBAEvC,CACL3E,KAAMiD,EAAG2B,WAAaT,EAAaU,IACnC3E,IAAK+C,EAAG6B,UAAYX,EAAaY,KAK9B,SAASC,EAAW/B,OAEnBgC,EAAchC,EAAG9D,wBACjBoF,EAAO/G,SAAS+G,KAEhBE,EAAY9F,OAAO6F,aAAeD,EAAKE,UACvCE,EAAahG,OAAO+F,aAAeH,EAAKI,iBAEvC,CACL3E,KAAMiF,EAAYjF,KAAO2E,EACzBzE,IAAK+E,EAAY/E,IAAMuE,EACvB3F,OAAQmG,EAAYnG,OACpBD,MAAOoG,EAAYpG,OAKhB,SAASqG,EAAcC,EAASC,GACjCC,EAAWF,EAASC,GACtBE,EAAcH,EAASC,GAEvBG,EAAWJ,EAASC,GAIjB,SAASC,EAAWF,EAASC,YAE7BD,IAAYC,KACTD,EAAQ/H,UAAa+H,EAAQ/H,UAAUC,SAAS+H,GAAO,UAAID,EAAQK,eAAchF,kBAAW4E,SAAW,GAG1G,SAASG,EAAWE,EAAUC,OAC/BC,EAAYF,EACZG,EAAWF,KAGVC,GAAcC,KAEQ,iBAAfD,EAEVA,EAAYnI,SAASqI,iBAAiBF,GAC7BA,EAAUtC,UAEnBsC,EAAY,CAACA,IAGW,iBAAdC,GAEVA,EAAWA,EAASE,MAAM,SAOvB,IAAIC,EAAI,EAAGA,EAAIJ,EAAUK,OAAQD,GAAK,EAAG,UAExCJ,EAAUI,GAAG3I,aACfuI,EAAUI,GAAG3I,WAAU6I,cAAOL,SACzB,IAAKP,gBAAWM,EAAUI,aAAOH,SACjC,IAAIM,EAAI,EAAGA,EAAIN,EAASI,OAAQE,GAAK,EACxCP,EAAUI,GAAGL,oBAAeE,EAASM,UAXzCC,QAAQC,IAAI,qEAiBT,SAASd,EAAcG,EAAUC,OAClCC,EAAYF,EACZG,EAAWF,KAGVC,GAAcC,KAEQ,iBAAfD,EAEVA,EAAYnI,SAASqI,iBAAiBF,GAC7BA,EAAUtC,UAEnBsC,EAAY,CAACA,IAGW,iBAAdC,GAEVA,EAAWA,EAASE,MAAM,SAOvB,IAAIC,EAAI,EAAGA,EAAIJ,EAAUK,OAAQD,GAAK,EAAG,UAExCJ,EAAUI,GAAG3I,aACfuI,EAAUI,GAAG3I,WAAUE,iBAAUsI,aAE5B,IAAIM,EAAI,EAAGA,EAAIN,EAASI,OAAQE,GAAK,EACxCP,EAAUI,GAAGP,UAAYG,EAAUI,GAAGP,UAAUa,QAAQ,IAAIC,oBAAaZ,EAAQQ,UAAS,KAAM,UAXpGC,QAAQC,IAAI,yECrSKG,yBACPpB,mDACJA,KACDqB,cAAgB,IAChBC,gBAAkB9I,EAAKhB,OAAO+J,gBAE9BC,SAAWhJ,EAAKgJ,SAASxJ,aACzBW,QAAUH,EAAKG,QAAQX,aAEvBc,UAAYN,EAAKM,UAAUd,aAE3ByJ,wBACAnI,kCAZgChC,yDAkBhC0B,UAAYtB,KAAKF,OAAOwC,6BAKxBsH,gBAAgBxH,MAAMH,iBAAYjC,KAAKsB,UAAUW,sDAQjDX,UAAYtB,KAAKF,OAAOwC,yDAGtBC,GACHA,EAAMzC,SAAWE,KAAKF,SAK1ByC,EAAMC,iBAGDgG,EAAWxI,KAAKF,OAAQ,aAiBvB0I,EAAWxI,KAAKF,OAAQ,gBAC1B2I,EAAczI,KAAKF,OAAQ,eAI7B2I,EAAczI,KAAKF,OAAQ,iBAGtBA,OAAOsC,MAAMe,KAAO,QACpBrD,OAAOsC,MAAMiB,IAAM,UAxBnBjC,YAGLsH,EAAW1I,KAAKF,OAAQ,iBAGnB2B,EAAIc,EAAMyH,SAAWzH,EAAMG,QAAQ,GAAGD,WACtCf,EAAIa,EAAM0H,SAAW1H,EAAMG,QAAQ,GAAGC,WAGtC7C,OAAOsC,MAAMiB,cAASrD,KAAKkK,oBAC3BpK,OAAOsC,MAAMe,eAAUnD,KAAKmK,iDAiB7B5H,GACFA,EAAMzC,SAAWE,KAAKF,QAAW0I,EAAWxI,KAAKF,OAAQ,aAKzD0I,EAAWxI,KAAKF,OAAQ,cAGrB0I,EAAWxI,KAAKF,OAAQ,gBAC3B4I,EAAW1I,KAAKF,OAAQ,oBAIrB2B,EAAIc,EAAMyH,SAAWzH,EAAMG,QAAQ,GAAGD,WACtCf,EAAIa,EAAM0H,SAAW1H,EAAMG,QAAQ,GAAGC,WAGtC7C,OAAOsC,MAAMiB,cAASrD,KAAKkK,oBAC3BpK,OAAOsC,MAAMe,eAAUnD,KAAKmK,6DAcnCxJ,SAASgE,iBAAiB,aAAc3E,KAAK8J,UAC7CnJ,SAASgE,iBAAiB,YAAa3E,KAAKiB,SAE5CN,SAASgE,iBAAiB,YAAa3E,KAAK8J,UAC5CnJ,SAASgE,iBAAiB,YAAa3E,KAAKiB,oDAZlCjB,KAAK0B,EAAI1B,KAAKsB,UAAU+B,KAAOrD,KAAKsB,UAAUW,QAAW,KAAQjC,KAAK2J,cAAgB,4CAGtF3J,KAAKyB,EAAIzB,KAAKsB,UAAU6B,MAAQnD,KAAKsB,UAAUU,OAAU,KAAQhC,KAAK2J,cAAgB,YCvG9FS,EAAc,CAClBC,WAAYzF,EAAuB,cACnC0F,WAAY1F,EAAuB,cACnC2F,aAAc3F,EAAuB,iBAGvC,SAAS4F,EAAwBC,GAE/BA,EAASC,QAAQ,SAACC,OACVC,EAASD,EAAQxK,cAAc,UAAYwK,EAAQxK,cAAc,SACnEyK,IAAWA,EAAOC,SACpBD,EAAOE,QACPH,EACGxK,cAAc,yBACd4K,aAAa,sBAAuB,aAK7C,SAASC,EAAwBC,OACzBC,EAAW,CACfD,QAASpI,KAAKsI,MAAMF,GACpBG,QAASvI,KAAKsI,MAAMF,EAAU,YAGhCC,EAASD,SAAWC,EAASD,QAA8B,GAAnBC,EAASE,SAAeC,SAAS,cAE/DH,EAASE,oBAAW,WAAKF,EAASD,SAAWK,OAAO,QC1B3CC,yBAEP1L,0CACJA,eAH+BD,qDAOd4L,EAAOnL,OACxBoK,EAAW9J,SAASqI,iBAAiB,uBACrCyC,EAASD,EAAMrL,cAAc,SAC7BuL,EAAcF,EAAMrL,cAAc,yBAClCwL,EAAYH,EAAMrL,cAAc,0BAEtCuL,EAAY/G,iBAAiB,QAAS,SAACpC,GACmB,WAApDmJ,EAAYE,aAAa,wBAE3BpB,EAAwB5E,MAAMiG,KAAKpB,IACnCgB,EAAOK,OACPJ,EAAYX,aAAa,sBAAuB,aAGhDU,EAAOX,QACPY,EAAYX,aAAa,sBAAuB,WAGlD1K,IAEAkC,EAAMwJ,oBACL,GAGHL,EAAY/G,iBAAiB,YAAa,SAACpC,GACzCA,EAAMwJ,oBACL,GAEHN,EAAO9G,iBAAiB,aAAc,WACpCgH,EAAUK,UAAYhB,EAAwBS,EAAOQ,eAGvDR,EAAO9G,iBAAiB,QAAS,WAC/B+G,EAAYX,aAAa,sBAAuB,qBCvCjCmB,yBACPrM,mDACJA,KAEDmH,UAAYlG,EAAKhB,SACjBqM,MAAQtM,EAASmJ,iBAAiB,0BAClCoD,WAAavM,EAASmJ,iBAAiB,0BACvCqD,YAAc,kBAAM1L,SAASR,cAAc,4BAC3CsK,SAAW3J,EAAKkG,UAAUgC,iBAAiB,yBAG3CsD,UAAYxL,EAAKhB,OAAO8L,aAAa,0BACrCjK,eAAgB,IAChB4K,QAAS,IACTC,OAAQ,IAERrF,MAAQ,CACX1F,EAAG,SAAAc,UAASA,EAAMyH,SAAWzH,EAAMG,QAAQ,GAAGsH,SAC9CtI,EAAG,SAAAa,UAASA,EAAM0H,SAAW1H,EAAMG,QAAQ,GAAGuH,SAC9CwC,GAAI,EACJC,GAAI,EACJC,GAAI,EACJC,GAAI,KAGDC,QAAU,CACbzG,GAAI,KACJ0G,MAAO,KACPC,OAAQ,GACRC,KAAM,kBAAMlM,EAAK+L,QAAQzG,GAAG9D,yBAC5B2K,KAAM,MAGHC,SAAW,CACdC,KAAM,KACNC,KAAM,QAGHpM,SAAWF,EAAKE,SAASV,aACzBW,QAAUH,EAAKG,QAAQX,aACvBY,OAASJ,EAAKI,OAAOZ,aACrBa,QAAUL,EAAKK,QAAQb,aAEvBsB,kCA3C6BhC,uCA8C3B2C,GACFA,EAAMzC,OAAOuN,aAAa,wBAK3BrN,KAAKyK,SAAStB,OAAS,GACzBqB,EAAwBxK,KAAKyK,eAI1B9I,eAAgB,OAEhBkL,QAAQzG,GAAK7D,EAAMzC,YACnB+M,QAAQC,MAAQ9M,KAAK6M,QAAQzG,GAAGS,WAAU,QAC1CgG,QAAQE,OAAO1J,IAAMrD,KAAK6M,QAAQzG,GAAG6B,eACrC4E,QAAQE,OAAO5J,KAAOnD,KAAK6M,QAAQzG,GAAG2B,gBACtC8E,QAAQI,KAAKjL,MAAQhC,KAAK6M,QAAQzG,GAAGkH,iBACrCT,QAAQI,KAAKhL,OAASjC,KAAK6M,QAAQzG,GAAGmH,kBAEtCV,QAAQzG,GAAGhE,MAAMiB,cAASrD,KAAK6M,QAAQE,OAAO1J,eAC9CwJ,QAAQzG,GAAGhE,MAAMe,eAAUnD,KAAK6M,QAAQE,OAAO5J,gBAC/C0J,QAAQzG,GAAGhE,MAAMJ,gBAAWhC,KAAK6M,QAAQI,KAAKjL,iBAC9C6K,QAAQzG,GAAGhE,MAAMH,iBAAYjC,KAAK6M,QAAQI,KAAKhL,kBAC/C4K,QAAQzG,GAAG7F,UAAU6I,IAAI,mBAEzBpC,UAAUzG,UAAU6I,IAAI,mBAExBoE,gBAAgBxN,KAAK6M,QAAQzG,SAC7BqH,QAAQlL,QAER4E,MAAMsF,GAAKzM,KAAKmH,MAAM1F,EAAEc,QACxB4E,MAAMuF,GAAK1M,KAAKmH,MAAMzF,EAAEa,GAE7BA,EAAMC,kDAGAD,GACDvC,KAAK2B,qBAILwF,MAAMwF,GAAK3M,KAAKmH,MAAM1F,EAAEc,GAASvC,KAAKmH,MAAMsF,QAC5CtF,MAAMyF,GAAK5M,KAAKmH,MAAMzF,EAAEa,GAASvC,KAAKmH,MAAMuF,GAEjD5K,OAAOC,sBAAsB/B,KAAKmB,cAE7BsM,QAAQlL,mCAGRA,MACAvC,KAAK2B,oBAILA,eAAgB,OAChBqF,UAAUzG,UAAUE,OAAO,mBAC3BoM,QAAQzG,GAAG7F,UAAUE,OAAO,mBAC5BoM,QAAQzG,GAAGhE,MAAMiB,IAAM,QACvBwJ,QAAQzG,GAAGhE,MAAMe,KAAO,QACxB0J,QAAQzG,GAAGhE,MAAMJ,MAAQ,QACzB6K,QAAQzG,GAAGhE,MAAMH,OAAS,QAC1B4K,QAAQzG,GAAGhE,MAAMsC,UAAY,OAG5BsI,EADchN,KAAKqM,cACA/J,+BAEjBtC,KAAKsM,eACN,aACCU,EAAK7J,MAAQnD,KAAKmH,MAAM1F,EAAEc,IAAUyK,EAAKU,YACtCC,oBAGJ,WACCX,EAAK3J,KAAOrD,KAAKmH,MAAMzF,EAAEa,IAAUyK,EAAKY,aACrCD,eAQNE,sDAKCtL,WACDgK,QAAS,OACTC,OAAQ,OAERsB,gBAGH9N,KAAKkN,SAASE,MACXpN,KAAKkN,SAASE,KAAKC,aAAa,sBACnC,KACMD,EAAOpN,KAAKkN,SAASE,KAAK9K,+BAExBtC,KAAKsM,eACN,aACCtM,KAAK6M,QAAQG,OAAOU,MAASN,EAAKjK,KAAQiK,EAAKpL,MAAQ,WACpDwK,OAAQ,OACRgB,gBAAgBxN,KAAKkN,SAASE,iBAGlC,WACCpN,KAAK6M,QAAQG,OAAOY,OAAUR,EAAK/J,IAAO+J,EAAKnL,OAAS,WACrDuK,OAAQ,OACRgB,gBAAgBxN,KAAKkN,SAASE,WAUzCpN,KAAKkN,SAASC,MACXnN,KAAKkN,SAASC,KAAKE,aAAa,sBACnC,KACMF,EAAOnN,KAAKkN,SAASC,KAAK7K,+BAExBtC,KAAKsM,eACN,aACCtM,KAAK6M,QAAQG,OAAO7J,KAAQgK,EAAKO,MAASP,EAAKnL,MAAQ,WACpDuK,QAAS,OACTiB,gBAAgBxN,KAAKkN,SAASC,iBAGlC,WACCnN,KAAK6M,QAAQG,OAAO3J,IAAO8J,EAAKS,OAAUT,EAAKlL,OAAS,WACrDsK,QAAS,OACTiB,gBAAgBxN,KAAKkN,SAASC,+CAarCd,EAAcrM,KAAKqM,mBAEpB0B,wBAAwB/N,KAAK6M,QAAQC,OAEtC9M,KAAK6M,QAAQC,MAAM3M,cAAc,wBACnCoL,EAAYyC,kBAAkBhO,KAAK6M,QAAQC,MAAO9M,KAAKK,mBAGpD2G,UAAUd,aAAalG,KAAK6M,QAAQC,MAAOT,QAC3CQ,QAAQzG,GAAGH,WAAWI,YAAYrG,KAAK6M,QAAQzG,SAG/C/F,sDAIAwM,QAAQzG,GAAGhE,MAAMsC,gCAA2B1E,KAAKmH,MAAMwF,kBAC1D3M,KAAKmH,MAAMyF,kEAIClH,QACTmI,yBAECxB,EAAc1L,SAASgG,cAAc,UAC3C0F,EAAY9L,UAAU6I,IAAI,gBAAiB,wBAC3CiD,EAAYtB,aAAa,KAAM,wBAC/BsB,EAAYjK,MAAM6L,oBAAejO,KAAK6M,QAAQI,KAAKhL,aAE/CjC,KAAK6M,QAAQzG,GAAGjG,cAAc,OAAQ,KAClC+N,EAAMlO,KAAK6M,QAAQzG,GAAGjG,cAAc,OAAOyL,aAAa,OACxDuC,EAAMxN,SAASgG,cAAc,OACnCwH,EAAIpD,aAAa,MAAOmD,GACxB7B,EAAYzF,YAAYuH,GAGtBnO,KAAKwM,WACFxF,UAAUd,aAAamG,EAAa3G,EAAK0I,qBACrCpO,KAAKuM,YACTvF,UAAUd,aAAamG,EAAa3G,qDAOrC2G,EAAcrM,KAAKqM,cACrBA,GAAaA,EAAYpG,WAAWI,YAAYgG,+CAI9CA,EAAcrM,KAAKqM,mBACpBa,SAASC,KAAOd,EAAYgC,yBAA2BrO,KAAK6M,QAAQzG,GACrEpG,KAAK6M,QAAQzG,GAAGiI,uBAChBhC,EAAYgC,4BACXnB,SAASE,KAAOf,EAAY+B,qBAAuBpO,KAAK6M,QAAQzG,GACjEpG,KAAK6M,QAAQzG,GAAGgI,mBAChB/B,EAAY+B,mEAGM5C,GAEtBA,EAAM7G,iBAAiB,aAAc3E,KAAKgB,UAAU,GAEpDwK,EAAM7G,iBAAiB,YAAa3E,KAAKgB,UAAU,gDAKnDL,SAASgE,iBAAiB,YAAa3E,KAAKiB,SAC5CN,SAASgE,iBAAiB,WAAY3E,KAAKkB,QAE3CP,SAASgE,iBAAiB,YAAa3E,KAAKiB,SAC5CN,SAASgE,iBAAiB,UAAW3E,KAAKkB,YAErC,IAAIgI,EAAI,EAAGA,EAAIlJ,KAAKmM,MAAMhD,OAAQD,GAAK,OACrC6E,wBAAwB/N,KAAKmM,MAAMjD,aClRzBoF,iFAcNhG,GACXpB,GAAGqH,OAAOjG,GAASkG,QAAQC,QAAQ,cAAc,mCAGpCnG,EAASoG,GAEtBxH,GAAGqH,OAAOjG,GACPqG,KAAK,KAAMzH,GAAG3E,MAAMd,EAAIiN,EAAKjN,GAAGmN,WAChCD,KAAK,KAAMzH,GAAG3E,MAAMb,EAAIgN,EAAKhN,GAAGkN,uCAG1BtG,EAAShD,EAAMoJ,GAExBxH,GAAGqH,OAAOjG,GACPqG,KAAK,KAAMzH,GAAG3E,MAAMd,EAAIiN,EAAKjN,GAAGmN,WAChCD,KAAK,KAAMzH,GAAG3E,MAAMb,EAAIgN,EAAKhN,GAAGkN,WAIhCH,QAAQ,cAAc,YC5BRI,sFAKDC,EAAMC,MACuB,UAAzC7H,GAAG3E,MAAMyM,YAAYlP,OAAOmP,SAAsB,KAE9CC,EAAOhI,GAAGgI,OAGbC,MAAMjI,GAAGkI,aAENhI,EAASF,GAAGE,OAAO,OACnBiI,EAAInI,GAAG3E,MAAM+M,QAEf7C,EAAKrF,EAAOF,GAAG3E,MAAMd,GACrBiL,EAAKtF,EAAOF,GAAG3E,MAAMb,GAEnB6N,iBAAa9C,cAAMC,GAEnB8C,EAAStI,GAAGqH,kBAAWO,EAAKS,kBAAgBE,OAAO,YAGtDd,KAAK,gBAAiB,IACtBA,KAAK,QAAS,YACdA,KAAK,KAAMY,GACXG,MAAML,GAGTnI,GAAG3E,MACAoN,GAAG,OAAQ,eAEJhD,EAAKvF,EAAOF,GAAG3E,MAAMd,GACrBmL,EAAKxF,EAAOF,GAAG3E,MAAMb,GAErBkO,EAAKjD,EAAKF,EACVoD,EAAKjD,EAAKF,EAGXkD,EAAKA,EAAOC,EAAKA,EAAM,IAAKR,EAAES,KAAK,CAACrD,EAAKE,EAAID,EAAKE,IAElDyC,EAAEA,EAAElG,OAAS,GAAK,CAACwD,EAAIC,GAE5B4C,EAAOb,KAAK,IAAKO,KAElBS,GAAG,MAAO,eACHI,EAAY7I,GAAGqH,kBAAWgB,IAC5BQ,IACEA,EAAUpB,KAAK,KACboB,EAAUpB,KAAK,KAAKxF,OAAS,IAC/B4G,EAAUtP,SAEFsP,EAAUpB,KAAK,MACzBoB,EAAUtP,UAKd4E,EAAgB1E,SAAU,aAAc,GAAI,CAAEqP,IAAK,CAAET,GAAIT,EAAKS,GAAIU,SAAU,aAAcnQ,OAAQyP,KAElGR,MAGJ7H,GAAGqH,kBAAWgB,IAAMI,GAAG,QAAS,WAC9BzI,GAAGqH,kBAAWgB,IAAM9O,SAGpB4E,EAAgB1E,SAAU,aAAc,GAAI,CAAEqP,IAAK,CAAET,GAAIT,EAAKS,GAAIU,SAAU,aAAcnQ,OAAQyP,KAClGrI,GAAG3E,MAAMC,mBACR,yCAOasM,OACZoB,EAAQhJ,GAAGqH,kBAAWO,EAAKS,kBAC3BY,EAASxP,SAASR,yBAAkB2O,EAAKS,kBACzCa,EAAgBrJ,EAAgB+H,GAChCS,mBAAea,EAAc3O,cAAK2O,EAAc1O,GAChD2O,aAAWd,GAEXe,EAAgBJ,EAAMT,OAAO,qBAChCd,KAAK,kBAAmB,IACxBA,KAAK,KAAMY,GACXZ,KAAK,IAAKyB,EAAc3O,GACxBkN,KAAK,IAAKyB,EAAc1O,GACxBiN,KAAK,QAAS,GACdA,KAAK,SAAU,GAKZrG,EAAU3H,SAASR,cAAckQ,GACnCE,EAAkB,CACpBjI,EAAQsD,aAAa,KACrBtD,EAAQsD,aAAa,MAEnB8C,EAAO,GAEI4B,EAAcb,OAAO,aACjCd,KAAK,QAAS,cACdgB,GAAG,QAAS,WAGXtK,EAAgB1E,SAAU,aAAc,GAAI,CAAEqP,IAAK,CAAET,GAAIT,EAAKS,GAAIU,SAAU,qBAAsBnQ,OAAQyP,KAE1GrI,GAAGqH,OAAOrH,GAAG3E,MAAMzC,OAAOmG,YAAYxF,WAEvC+P,KAAKtJ,GAAGuJ,OACNzJ,UAAUmJ,GACVb,QAAQhH,GACRqH,GAAG,QAAS,WACXjB,EAAO,CACLjN,EAAGyF,GAAG3E,MAAMd,EAAI8O,EAAgB,GAChC7O,EAAGwF,GAAG3E,MAAMb,EAAI6O,EAAgB,IAGlCjC,EAAaoC,MAAML,KAEpBV,GAAG,OAAQ,WACVrB,EAAazB,QAAQwD,EAAM3B,KAE5BiB,GAAG,MAAO,WACTrB,EAAaqC,IAAIN,EAAM,SAAU3B,GAEjC6B,EAAkB,CAChBjI,EAAQsD,aAAa,KACrBtD,EAAQsD,aAAa,MAIvBvG,EAAgB1E,SAAU,aAAc,GAAI,CAAEqP,IAAK,CAAET,GAAIT,EAAKS,GAAIU,SAAU,eAAgBnQ,OAAQyP,QAMxGlK,EAAgB1E,SAAU,aAAc,GAAI,CAAEqP,IAAK,CAAET,GAAIT,EAAKS,GAAIU,SAAU,eAAgBnQ,OAAQyP,cC5IrFqB,4FACDC,yDAAY,IAAKC,yDAAY,EACvChC,EAAOnO,SAASR,cAAc,4BAC9B4Q,EAAQjC,EAAKS,GACbyB,EAAW9J,GAAGqH,OAAOO,GAAMP,OAAO,aAElC3N,EAAUkO,EAAK3O,cAAc,aAC7B8Q,EAActQ,SAASR,cAAc,sBACrCiQ,EAAgB,CACpB3O,EAAGwP,EAAYrF,aAAa,gBAC5BlK,EAAGuP,EAAYrF,aAAa,iBAExBsF,wBAAuBd,EAAc3O,cAAK2O,EAAc1O,GACxD6N,qBAAiBa,EAAc3O,cAAK2O,EAAc1O,GAClD2O,aAAWd,GACX4B,EAAc,CAClB1P,EAAIuP,EAASrC,KAAK,SAAWyB,EAAc3O,EAAK,IAAM,QAAU,OAChEC,EAAIsP,EAASrC,KAAK,UAAYyB,EAAc1O,EAAK,GAAK,SAAW,OAI7D4O,EAAgBU,EAASvB,OAAO,qBACnCd,KAAK,uCAAiCwC,EAAY1P,0BAAiB0P,EAAYzP,IAC/EiN,KAAK,gBAAiB,IACtBA,KAAK,KAAMuC,GACXvC,KAAK,IAAKyB,EAAc3O,GACxBkN,KAAK,IAAKyB,EAAc1O,GACxBiN,KAAK,QAAS,GACdA,KAAK,SAAU,GAGlB2B,EAAcb,OAAO,aAClBd,KAAK,QAAS,8BAEA2B,EAAcb,OAAO,kBACnCd,KAAK,YAAakC,GAClBlC,KAAK,WAAY,MACjBA,KAAK,KAAMY,GACXZ,KAAK,QAAS,gBACdA,KAAK,YAAa,IAClBA,KAAK,2BAA4BoC,GAGpCpQ,SAASR,wBAAiBkQ,IAAQe,YAK5B9I,EAAU3H,SAASR,cAAckQ,GAAMpK,WACzCsK,EAAkB,CACpBjI,EAAQsD,aAAa,KACrBtD,EAAQsD,aAAa,MAEnB8C,EAAO,GAGXrJ,EAAgB1E,SAAU,aAAc,GAAI,CAAEqP,IAAK,CAAET,GAAIwB,EAAOd,SAAU,aAAcnQ,OAAQoR,KAEhGhK,GAAGqH,iBAAU8B,IAEVG,KAAKtJ,GAAGuJ,OACNzJ,UAAUpG,GACV0O,QAAQhH,GACRqH,GAAG,QAAS,WACXjB,EAAO,CACLjN,EAAGyF,GAAG3E,MAAMd,EAAI8O,EAAgB,GAChC7O,EAAGwF,GAAG3E,MAAMb,EAAI6O,EAAgB,IAGlCjC,EAAaoC,MAAMpI,KAEpBqH,GAAG,OAAQ,WACVrB,EAAazB,QAAQvE,EAASoG,KAE/BiB,GAAG,MAAO,WACTrB,EAAaqC,IAAIrI,EAAS,OAAQoG,GAElC6B,EAAkB,CAChBjI,EAAQsD,aAAa,KACrBtD,EAAQsD,aAAa,MAIvBvG,EAAgB1E,SAAU,aAAc,GAAI,CAAEqP,IAAK,CAAET,GAAIwB,EAAOd,SAAU,aAAcnQ,OAAQoR,QAInGvB,GAAG,QAAS,WACXiB,EAAQS,qBAAqBnK,GAAG3E,MAAMzC,QAGtCuF,EAAgB1E,SAAU,aAAc,GAAI,CAAEqP,IAAK,CAAET,GAAIwB,EAAOd,SAAU,aAAcnQ,OAAQyP,EAAIzK,KAAMoC,GAAG3E,MAAMzC,OAAOwR,WAG3H3B,GAAG,OAAQ,eACJ7P,EAASoH,GAAG3E,MAAMzC,OAClBwR,EAAQxR,EAAOwR,MAEA,IAAjBA,EAAMnI,OAINmI,EAAMnI,OAAS2H,EACjBpI,EAAW5I,EAAQ,YACTwR,EAAMnI,QAAU2H,GAActI,EAAW1I,EAAQ,aAC3D2I,EAAc3I,EAAQ,YANtByR,EAAIC,WAAWnB,KAUlBV,GAAG,QAAS,WACXzI,GAAGqH,OAAOjG,GAASkG,uDAIGiD,GAC1BA,EAAQrP,MAAMH,OAAS,MACvBwP,EAAQrP,MAAMH,iBAAY,GAAKwP,EAAQC,4BCnHtBH,yBACP1R,mDACJA,KAED8R,oBAJwB/R,6CASvBgS,EAAqB5R,KAAKF,OAAO8L,aAAa,mBAAmB3C,MAAM,KACpEC,EAAI,EAAGA,EAAI0I,EAAmBzI,OAAQD,GAAK,EACpB,aAA1B0I,EAAmB1I,QAChB2I,UAAU7R,KAAKK,cAEa,WAA1BuR,EAAmB1I,SACrB4I,YAAY9R,KAAKK,mBASrB0R,gBAEAC,wBAGCC,EAAsBjS,KAAKF,OAAO8L,aAAa,iBAAiB3C,MAAM,KACxEgJ,EAAoB,SACjBC,WAAWD,0CAMZE,EAAUnS,KAAKF,OAAO8L,aAAa,WAAW3C,MAAM,KAEpD5G,EADSrC,KAAKF,OAAOwC,wBAAwBL,OAC5BkQ,EAAQ,QAE1BrS,OAAOsC,MAAMgQ,mBAAcD,EAAQ,GAAK9P,0CAYrC0M,cACR7H,GAAGqH,OAAOvO,KAAKF,QACZ0Q,KAAKtJ,GAAGuJ,OACNzJ,UAAU,kBAAMqL,EAAKvS,SACrBwP,QAAQ,eACDgD,EAAI,CAACpL,GAAG3E,MAAMd,EAAEmN,UAAW1H,GAAG3E,MAAMb,EAAEkN,iBAErC,CAAC0D,EAAGA,KAEZ3C,GAAG,QAAS,WACXd,EAAQ0D,WAAWF,EAAKvS,OAAQiP,0CAU5BA,cACV7H,GAAGqH,OAAOvO,KAAKF,QAAQ6P,GAAG,QAAS,WAGA,UAFpBzI,GAAG3E,MAAMzC,OACAmP,WAQtBJ,EAAQ2D,aAAaC,EAAK3S,QAC1BiP,IAEA7H,GAAG3E,MAAMC,oBACR,mDAIGkQ,EAAe1S,KAAKF,OAAOkJ,iBAAiB,6BAE9C0J,GACFxL,GAAGyL,UAAUD,GAAc/C,GAAG,QAAS,WACrCiB,EAAQS,qBAAqBnK,GAAG3E,MAAMzC,6CAKjCmS,cAELW,EAAW,KACXC,EAAW,KACXC,EAAa,KACbC,EAAU,KAEdpS,SAASgE,iBAAiB,aAAc,SAACqO,MAEnCf,EAAoBgB,SAASD,EAAE5N,OAAO4K,IAAIT,WACpCyD,EAAE5N,OAAO4K,IAAIC,cACd,iBACH4C,EAAWK,EAAKpT,OAAOK,cAAc,IAAM6S,EAAE5N,OAAO4K,IAAIlQ,UAEtD+S,EAASpS,SAEX6I,QAAQC,IAAI,cACZsJ,EAAWlS,SAASR,cAAc,IAAM6S,EAAE5N,OAAO4K,IAAIlQ,QACvC,KACNqT,EAAYN,EAAShM,WAAW,GACtCqM,EAAKpT,OAAO8G,YAAYuM,aAGvB,aACH7J,QAAQC,IAAI,eACZsJ,EAAWK,EAAKpT,OAAOK,cAAc,IAAM6S,EAAE5N,OAAO4K,IAAIlQ,SAC/CW,mBAEN,mBAEHqS,EAAaI,EAAKpT,OAAOK,cAAc,IAAM6S,EAAE5N,OAAO4K,IAAIlQ,OAAS,YAEjEgT,EAAWrS,SAEb6I,QAAQC,IAAI,gBACZuJ,EAAanS,SAASR,cAAc,IAAM6S,EAAE5N,OAAO4K,IAAIlQ,QACvC,KACRsT,EAAcN,EAAWjM,WAAW,GAC1CuM,EAAY7D,GAAK6D,EAAY7D,GAAK,SAClC2D,EAAKpT,OAAO8G,YAAYwM,aAGvB,oBACH9J,QAAQC,IAAI,sBACZuJ,EAAaI,EAAKpT,OAAOK,cAAc,IAAM6S,EAAE5N,OAAO4K,IAAIlQ,OAAS,UAAUuT,WAAW,MAEtF5K,EAAcqK,EAAY,YAC1BpK,EAAWoK,EAAYE,EAAE5N,OAAO4K,IAAIsD,kBAGnC,iBAEHV,EAAWM,EAAKpT,OAAOK,cAAc,IAAM6S,EAAE5N,OAAO4K,IAAIlQ,OAAS,YAE/D8S,EAASnS,SAEX6I,QAAQC,IAAI,cACZwJ,EAAUpS,SAASR,cAAc,IAAM6S,EAAE5N,OAAO4K,IAAIlQ,QACvC,KACLyT,EAAeR,EAAQlM,WAAU,GACvC0M,EAAahE,GAAKgE,EAAahE,GAAK,gDAInBgE,EAAaF,0DAAY,KAAjCG,UACW,aAAdA,EAAKlO,OACPkO,EAAKjE,GAAKiE,EAAKjE,GAAK,6FAIxB2D,EAAKpT,OAAO8G,YAAY2M,aAGvB,aACHjK,QAAQC,IAAI,eACZqJ,EAAWM,EAAKpT,OAAOK,cAAc,IAAM6S,EAAE5N,OAAO4K,IAAIlQ,OAAS,WACxDwR,MAAQ0B,EAAE5N,OAAO4K,IAAIlL,eAE3B,qBACHwE,QAAQC,IAAI,sBACL2J,EAAKpT,OAAOK,cAAc,IAAM6S,EAAE5N,OAAO4K,IAAIlQ,OAAS,UACxDW,iDAOGiF,GAChBA,EAAKqF,aAAa,oBAAqB,uDAMjC0I,EAAW9S,SAASqI,iBAAiB,8BAElCE,EAAI,EAAGA,EAAIuK,EAAStK,OAAQD,GAAK,EACxCuK,EAASvK,GAAG6B,aAAa,oBAAqB,kDAKhCrF,yDAAO,6BACjBsK,EAAMrP,SAASR,cAAc,4CAC7BuT,EAAU/S,SAASR,cAAcuF,GAAMO,WAG7CZ,EAAgB1E,SAAU,aAAc,GAAI,CAAEqP,IAAK,CAAET,GAAIS,EAAIT,GAAIU,SAAU,qBAAsBnQ,OAAQ4T,EAAQnE,MAExF,kBAArBmE,EAAQzE,SACV/H,GAAGqH,OAAOmF,GAASjT,SAEnByG,GAAGqH,OAAO7I,GAAMjF,sDAMZkT,EAAgBhT,SAASqI,iBAAiB,4BACvCE,EAAI,EAAGA,EAAIyK,EAAcxK,OAAQD,GAAK,EAC7CyK,EAAczK,GAAG6B,aAAa,kBAAmB,0CAKrCiF,GACduB,EAAIqC,aACJ5D,EAAIjF,aAAa,kBAAmB,iBC/NnB8I,wBAEP5C,EAAa6C,kBAClB7C,YAAcA,OACd8C,iBAAmB/T,KAAKiR,YAAYjI,iBAAiB,gCACrDgL,YAAchU,KAAKiR,YAAYjI,iBAAiB,2BAChDiL,WAAajU,KAAKiR,YAAYjI,iBAAiB,0BAC/CkL,gBAAkBlU,KAAKiR,YAAY9Q,cAAc,qBACjDgU,YAAcnU,KAAKiR,YAAY9Q,cAAc,wBAC7CiU,SAAWpU,KAAKiR,YAAY9Q,cAAc,mCAC1C2T,MAAQA,OAERO,cAAe,OAEfC,WAAaC,SAASzS,OAAO0F,iBAAiBxH,KAAKiR,YAAY9Q,cAAc,wBAAyB,MAAMqU,iBAAiB,SAAU,IAAM,OAC7IC,WAAaF,SAASzS,OAAO0F,iBAAiBxH,KAAKiR,YAAY9Q,cAAc,qBAAsB,MAAMqU,iBAAiB,SAAU,IAAM,OAE1I7C,gEAIA+C,4BACAC,gCAGL/O,MAAMiG,KAAK7L,KAAK8T,OAAOpJ,QAAQ,SAACoE,GAC9B5H,GAAGqH,OAAOO,GAAMa,GAAG,cAAe,WAEhC4B,EAAIqD,SAAS9F,GAEbyC,EAAIsD,eAGJ/T,EAAKgU,kBAAkB5N,GAAG3E,MAAMzC,QAChCgB,EAAKiU,eAAejG,EAAM5H,GAAG3E,OAE7B2E,GAAG3E,MAAMC,0BAIR6R,cAAe,4DAMpBzO,MAAMiG,KAAK7L,KAAK+T,kBAAkBrJ,QAAQ,SAACc,GACzC6G,EAAK2C,kCAAkCxJ,qDAInByJ,OAChBC,EAAeD,EAAO9L,OACtBgM,EAAcnV,KAAKsU,WACnBc,EAAcpV,KAAKyU,WACnBY,EAAcF,EAAcC,EAG5BE,EAFY,YAEyBJ,EAA4B,EAAhD,aAGvBtP,MAAMiG,KAAKoJ,GAAQvK,QAAQ,SAACc,EAAO+J,OAG3BC,EAAS3S,KAAKC,GARJ,YAQWyS,GAAsB,EAAMD,EAGjD7T,EAAK0T,EAActS,KAAK4S,IAAID,GAAUH,EACtC3T,EAAKyT,EAActS,KAAK6S,IAAIF,GAAUH,EAK5C7J,EAAMpJ,MAAMe,eAAU1B,EAAEmN,QAAQ,SAChCpD,EAAMpJ,MAAMiB,cAAS3B,EAAEkN,QAAQ,mFAS5B+G,oBAEA1E,YAAYtM,iBAAiB,QAAS,SAACpC,GAC1CkQ,EAAKmD,eAAenD,EAAKxB,aACzB1O,EAAMC,wBAGHyO,YAAYtM,iBAAiB,cAAe,SAACpC,GAChDkQ,EAAKmD,eAAenD,EAAKxB,aACzB1O,EAAMC,6EAIwBkD,cAC1B8F,EAAQ9F,EAGRmQ,EAASrK,EAAMI,aAAa,yBAEnB,mBAAXiK,EACFrK,EAAM7G,iBAAiB,QAAS,WAC9B4M,EAAIC,aACJ0B,EAAK0C,mBACJ,GAGe,gBAAXC,EACP3O,GAAGqH,OAAO/C,GAAOmE,GAAG,QAAS,WAC3BiB,EAAQkF,aACR5C,EAAK0C,mBACJ,GAGe,qBAAXC,EACPrK,EAAM7G,iBAAiB,QAAS,WAC9BkP,EAAckC,YAAY,QAC1B7C,EAAK0C,mBACJ,GAGe,oBAAXC,EACPrK,EAAM7G,iBAAiB,QAAS,WAC9BkP,EAAckC,YAAY,OAC1B7C,EAAK0C,mBACJ,GAGe,oBAAXC,GACPrK,EAAM7G,iBAAiB,QAAS,WAC9BkP,EAAckC,YAAY,OAC1B7C,EAAK0C,mBACJ,GA2BLpK,EAAM7G,iBAAiB,aAAc,SAACpC,GACpC2Q,EAAKkB,SAAStN,UAAYvE,EAAMyT,cAAcpK,aAAa,iCAC3DsH,EAAKkB,SAAShS,MAAM6T,QAAU,UAC7B,GACHzK,EAAM7G,iBAAiB,aAAc,WACnCuO,EAAKkB,SAAStN,UAAY,GAC1BoM,EAAKkB,SAAShS,MAAM6T,QAAU,SAC7B,0CAcUC,EAAY3T,OACnBuM,EAAOoH,GAAcvV,SAASR,cAAc,4BAE5CgW,ETxBH,SAA0B5T,SAIxB,CACLd,EAAGc,EAAME,MACTf,EAAGa,EAAMI,OSkBcyT,CAAiB7T,GAClC6N,EAAgBrJ,EAAgB+H,QACjCmC,YAAYlG,aAAa,eAAgBqF,EAAc3O,QACvDwP,YAAYlG,aAAa,eAAgBqF,EAAc1O,QAGvDuP,YAAY7O,MAAMiB,cAAS8S,EAAezU,EAAI,aAC9CuP,YAAY7O,MAAMe,eAAUgT,EAAe1U,EAAI,YAG9C4U,EAAwBrW,KAAKiR,YAAYjI,iBAAiB,mBAC3DsN,wBAAwBD,GAG7B3N,EAAW1I,KAAKiR,YAAa,iEAU7BxI,EAAczI,KAAKiR,YAAa,aAEhCM,EAAIqC,aAEJrC,EAAIsD,eAGJ0B,WAAW,WACJ/N,EAAWgO,EAAKvF,YAAa,cAChCrL,MAAMiG,KAAK2K,EAAKzC,kBAAkBrJ,QAAQ,SAACc,GACzC/C,EAAc+C,EAAO,gBAGxB,gDAICiL,cAECxF,YAAYtM,iBAAiB,aAAc,WAC9C8R,EAAkBF,WAAW,WAC3BG,EAAKd,eAAec,EAAKzF,cACxB,YAGAA,YAAYtM,iBAAiB,aAAc,WAC9CgS,aAAaF,+CAICG,IACZpO,EAAWoO,EAAa,aAAwC,SAAzBA,EAAY3H,YACrDvG,EAAW1I,KAAKkU,gBAAiB,aAGjCtO,MAAMiG,KAAK7L,KAAKgU,aAAatJ,QAAQ,SAACmM,GACpCnO,EAAWmO,EAAY,eAGzBjR,MAAMiG,KAAK7L,KAAKiU,YAAYvJ,QAAQ,SAACoM,GACnCrO,EAAcqO,EAAW,gBAMzBtO,EAAWoO,EAAa,gBAC1BlO,EAAW1I,KAAKkU,gBAAiB,aAGjCtO,MAAMiG,KAAK7L,KAAKgU,aAAatJ,QAAQ,SAACmM,GACpCnO,EAAWmO,EAAY,eAGzBjR,MAAMiG,KAAK7L,KAAKiU,YAAYvJ,QAAQ,SAACoM,GACnCrO,EAAcqO,EAAW,gBAMzBtO,EAAWoO,EAAa,kBAC1BnO,EAAczI,KAAKkU,gBAAiB,aAG/B1L,EAAWoO,EAAa,mBAC3BhR,MAAMiG,KAAK7L,KAAKgU,aAAatJ,QAAQ,SAACmM,GACpCpO,EAAcoO,EAAY,eAG5BjR,MAAMiG,KAAK7L,KAAKiU,YAAYvJ,QAAQ,SAACoM,GACnCpO,EAAWoO,EAAW,iBAOC,UAAzBF,EAAY3H,UACdvG,EAAW1I,KAAKkU,gBAAiB,aACjCzL,EAAczI,KAAKmU,YAAa,aAEhCvO,MAAMiG,KAAK7L,KAAKgU,aAAatJ,QAAQ,SAACmM,GACpCpO,EAAcoO,EAAY,eAG5BjR,MAAMiG,KAAK7L,KAAKiU,YAAYvJ,QAAQ,SAACoM,GACnCrO,EAAcqO,EAAW,iBAIvBtO,EAAWoO,EAAa,iBAC1BnO,EAAczI,KAAKmU,YAAa,aAEhCzL,EAAW1I,KAAKmU,YAAa,aAG/B5C,EAAIwF,WAAWH,0CAtIAtD,OACXtD,EAAMrP,SAASR,cAAc,4CAC7B6W,EAAYrW,SAASR,cAAc,8BACzCsI,EAAcuO,EAAW,YACzBtO,EAAWsO,EAAW1D,GAGtBjO,EAAgB1E,SAAU,aAAc,GAAI,CAAEqP,IAAK,CAAET,GAAIS,EAAIT,GAAIU,SAAU,oBAAqBnQ,OAAQkX,EAAU/Q,WAAWsJ,GAAI+D,MAAOA,cC/LvH2D,yCAGZC,QAAU,wCASdC,EAAQC,eAETD,EAASnX,KAAKqX,OAAOF,IAEdzM,QAAQ,SAACnI,GAETzB,EAAKoW,QAAQ3U,KAChBzB,EAAKoW,QAAQ3U,GAAS,IAGxBzB,EAAKoW,QAAQ3U,GAAOuN,KAAKsH,iCAKzBD,EAAQC,eAEVD,EAASnX,KAAKqX,OAAOF,IAEdzM,QAAQ,SAACnI,GAET8P,EAAK6E,QAAQ3U,KAElB8P,EAAK8E,OAAO5U,GAAS8P,EAAK6E,QAAQ3U,GAAO+U,OAAO,SAACC,UACxCA,IAAeH,uCASpBD,EAAQK,eAEdL,EAASnX,KAAKqX,OAAOF,IAIdzM,QAAQ,SAACnI,GAETkQ,EAAKyE,QAAQ3U,IAElBkQ,EAAKyE,QAAQ3U,GAAOmI,QAAQ,SAAC0M,GAC3BA,EAAG5G,KAAKiC,EAAMlQ,EAAOiV,sCAOpBL,UACEA,EAAO3N,QAAQ,aAAc,IAAIP,MAAM,gBChE5CwO,EAAc,CAClBC,OAAQ,CACNnI,GAAI,SACJoI,QAAS,iBACTC,WAAY,oBACZC,WAAY,oBACZC,OAAQ,iBAEVC,SAAU,CACRxI,GAAI,WACJuI,OAAQ,mBAEVE,SAAU,CACRzI,GAAI,WACJ0I,WAAY,sBACZC,cAAe,yBACfC,cAAe,yBACfL,OAAQ,mBAEVM,YAAa,CACX7I,GAAI,cACJ8I,IAAK,kBACLC,OAAQ,qBACRC,OAAQ,qBACRT,OAAQ,sBAEVU,MAAO,CACLjJ,GAAI,QACJ8I,IAAK,MACLC,OAAQ,SACRC,OAAQ,SACRT,OAAQ,WCgHNU,EAAQ,gFA1HLC,MAAQ,KACRA,MAAMC,KAAO,gBARFzB,8CAWF0B,OACVC,GAAY,cACXH,MAAMC,KAAKhO,QAAQ,SAAChF,EAAMwD,GAEzBxD,EAAK6J,KAAOoJ,IACdC,EAAY,CAAElT,KAAAA,EAAM6P,MAAOrM,MAKxB0P,iCAGFC,MAE0B,IAA3B7Y,KAAKyY,MAAMC,KAAKvP,QAAiBnJ,KAAK8Y,gBAAgBD,EAAatJ,UAoB/D,IAAIwJ,MAAM,6CAlBZC,IAAcH,EAAa/T,KAAKmU,wBAClCJ,EAAa/T,KAAKmU,sBAAwB,SAGvCR,MAAMC,KAAK5I,KAAK+I,GAErBL,EAAMU,QAAQzB,EAAYC,OAAOI,OAAQ,CACvCjC,OAAQ,CACNtG,GAAIkI,EAAYC,OAAOnI,GACvBjK,KAAMmS,EAAYC,OAAOC,QACzB7S,KAAM,CACJ+T,aAAAA,wCAYAA,OAEJD,EAAY5Y,KAAK8Y,gBAAgBD,EAAatJ,QAE9C,IAAUqJ,cAEPH,MAAMC,KAAKS,OAAOP,EAAUrD,MAAO,GAExCiD,EAAMU,QAAQzB,EAAYC,OAAOI,OAAQ,CACvCjC,OAAQ,CACNtG,GAAIkI,EAAYC,OAAOnI,GACvBjK,KAAMmS,EAAYC,OAAOE,WACzB9S,KAAM,CACJ+T,aAAc,CAAEO,SAAUP,EAAaO,SAAU7J,GAAIsJ,EAAatJ,GAAI/I,QAASqS,EAAarS,QAAS1B,KAAM,SAM1G,QAGD,IAAIiU,MAAM,8EAKTM,eAGLL,IAAcK,GAASA,EAAKD,SAEXpZ,KAAKyY,MAAMC,KAAKpB,OAAO,SAAC5R,UACpCA,EAAK0T,WAAaC,EAAKD,WAHmBpZ,KAAKyY,MAAMC,uCAStDW,eAIKL,IAATK,KACsC,IAHtB,CAAC,WAAY,KAAM,WAGtB1V,QAAS0V,EAAKC,OAE1B1T,MAAMC,QAAQwT,EAAK/H,SACtB+H,EAAK/H,MAAQ,CAAC+H,EAAK/H,QAMAtR,KAAKyY,MAAMC,KAAKpB,OAAO,SAAC5R,UAElCA,EAAK2T,EAAKC,OAASD,EAAK/H,MAAM,IAAU5L,EAAK2T,EAAKC,OAASD,EAAK/H,MAAM,0CAQxE+H,WAELL,IAAcK,IAASA,EAAKD,gBACvBpZ,KAAKyY,MAAMC,KAAK1Y,KAAKyY,MAAMC,KAAKvP,OAAS,OAG5CoQ,EAAevZ,KAAKyY,MAAMC,KAAKpB,OAAO,SAAC5R,UACpCA,EAAK0T,WAAaC,EAAKD,kBAGzBG,EAAaA,EAAapQ,OAAS,aC3BxCqP,EAAQ,gFArGLC,MAAQ,gBAPSxB,2CAWX1H,OACPiK,GAAe,cACdf,MAAM/N,QAAQ,SAAChF,EAAMwD,GAEpBxD,EAAK6J,KAAOA,IACdiK,EAAe,CAAE9T,KAAAA,EAAM6P,MAAOrM,MAK3BsQ,8BAGL1U,MAIwB,IAAtB9E,KAAKyY,MAAMtP,QAAiBnJ,KAAKyZ,aAAa3U,EAAKyK,UAY/C,IAAIwJ,MAAM,gDAVXN,MAAM3I,KAAKhL,GAEhB0T,EAAMU,QAAQzB,EAAYW,YAAY7I,GAAI,CACxCsG,OAAQ,CACNvQ,KAAMmS,EAAYW,YAAYC,KAEhCvT,KAAAA,mCASCA,OAEC0U,EAAexZ,KAAKyZ,aAAa3U,EAAKyK,QAEvB,IAAjBiK,cAEGf,MAAMU,OAAOK,EAAajE,MAAO,GAEtCiD,EAAMU,QAAQzB,EAAYW,YAAY7I,GAAI,CACxCsG,OAAQ,CACNvQ,KAAMmS,EAAYW,YAAYE,QAEhCxT,KAAAA,KAGK,QAGH,IAAIiU,MAAM,0EAKXM,eAEDL,IAAcK,GAASA,EAAK3B,OAEX1X,KAAKyY,MAAMnB,OAAO,SAAA5R,UAAQA,EAAK6J,KAAO8J,EAAK9J,KAFfvP,KAAKyY,oCAOlDY,eAIUL,IAATK,IAA2D,IAF5C,CAAC,MAEoB1V,QAAQ0V,EAAKC,OAIjD1T,MAAMC,QAAQwT,EAAK/H,SACtB+H,EAAK/H,MAAQ,CAAC+H,EAAK/H,QAGAtR,KAAKyY,MAAMnB,OAAO,SAAA5R,UAASA,EAAK2T,EAAKC,OAASD,EAAK/H,MAAM,IAAQ5L,EAAK2T,EAAKC,OAASD,EAAK/H,MAAM,sCAM9G+H,WAEFL,IAAcK,IAASA,EAAK3B,cACvB1X,KAAKyY,MAAMzY,KAAKyY,MAAMtP,OAAS,OAGlCuQ,EAAe1Z,KAAKyY,MAAMnB,OAAO,SAAA5R,UAAQA,EAAK6J,KAAO8J,EAAK9J,YAEzDmK,EAAaA,EAAavQ,OAAS,aCjGzBwQ,yBAEPrR,mDACJA,KAIDsR,QAAU9Y,EAAKhB,SACfyP,GAAKzO,EAAK8Y,QAAQrK,KAElBsK,SAAWC,KAAKC,MAAMpZ,SAASR,mDAA4CW,EAAKyO,UAAQ3D,aAAa,2BAErGyN,KdyEF,SAASW,EAAYla,EAAQma,OAC5BC,EAASlV,OAAOC,OAAO,GAAInF,UAC7B2F,EAAW3F,IAAW2F,EAAWwU,IACnCjV,OAAOmV,KAAKF,GAAQvP,QAAQ,SAAC4O,GACvB7T,EAAWwU,EAAOX,KACdA,KAAOxZ,EAGXoa,EAAOZ,GAAOU,EAAYla,EAAOwZ,GAAMW,EAAOX,IAGhDtU,OAAOC,OAAOiV,OAAWZ,EAAMW,EAAOX,OAIrCY,EcxFOF,CAAYL,EAAOS,SAAUtZ,EAAK+Y,YAEzCQ,OAAS,CACZC,QAAS,CACP,SAEFC,YAAa,CACX,cAAe,eAAgB,YAAa,SAE9CC,SAAU,CACR,cAAe,eAAgB,gBAI9BC,WAAa,IAEbC,SAAU,IAEVC,UAAY,OACZC,sBAAwB,KACxBC,YAAc,OACdC,oBAAsB,OACtBC,oBAAsB,OACtBC,kBAAoB,OAEpBC,oBAAqB,IACrBC,mBAAqB,OAErBC,2BAA4B,IAC5BC,eAAiB,OAEjBC,YAAa,IACbC,QAAU,KAEVC,gBAAkB,KAClBC,eAAiB,KAEjBC,UAAY,KAEZC,4BAA8B,KAC9BC,+BAAiC,eACjCC,8BAAgC,KAChCC,iCAAmC,eACnCC,oBAAqB,IACrBC,WAAY,IAEZC,cAAgB,OAEhBC,MAAQ,CACXvU,KAAM/G,SAAS+G,KACf5F,OAAAA,UAGG6P,oBAjE2B/R,wCAqE5B+Z,EAAOuC,SAASlc,KAAKqZ,eAEhB8C,MAAQnc,KAAK4Z,QAAQwC,uBAAuBpc,KAAKqZ,KAAKgD,WAAW,QAGjEC,aAAetc,KAAKmc,MAAMC,uBAAuB,QAAQ,GAAGA,uBAAuB,kBACnFG,WAAavc,KAAKmc,MAAMC,uBAAuB,SAAS,GAC7D,MAAOI,QACF9B,SAAU,YAGZA,SAAU,EAGbf,EAAO8C,YAAYzc,KAAKqZ,aACrBgC,YAAa,QAGfza,QAAUZ,KAAK4Z,QAAQwC,uBAAuBpc,KAAKqZ,KAAKqD,aAAa,GAGjD,UAArB1c,KAAKqZ,KAAKsD,SACZjU,EAAW1I,KAAKmc,MAAO,UAGE,UAArBnc,KAAKqZ,KAAKsD,cACPpB,gBAAgBqB,KAAO5c,KAAKY,QAAQkG,eACpCyU,gBAAgBsB,KAAO7c,KAAKY,QAAQoL,eACpCwP,eAAeoB,KAAO5c,KAAKY,QAAQkG,eACnC0U,eAAeqB,KAAO7c,KAAKY,QAAQoL,eAEnC0P,4BAA8B1b,KAAK8c,iCACnClB,8BAAgC5b,KAAK8c,6BAIxC9c,KAAKqb,kBACFC,QAAQzb,SAAWG,KAAK4Z,QAAQwC,uBAAuB,kBAAkB,QACzEd,QAAQyB,UAAY/c,KAAKsb,QAAQzb,SAASuc,uBAAuB,+BAA+B,SAGlGY,4BAIkB,gBAArBhd,KAAKqZ,KAAKsD,aACPM,wFAMFxC,WAAaza,KAAKya,WAAa,YAC1Bza,KAAKuP,eAAMvP,KAAKya,4EAIrBA,WAAaza,KAAKya,WAAa,kBACpBza,KAAKuP,eAAMvP,KAAKya,+EAO3B7Z,QAAQ+D,iBAAiB,YAAa3E,KAAKkd,aAAa5c,KAAKN,OAAO,QACpEY,QAAQ+D,iBAAiB,YAAa3E,KAAKkd,aAAa5c,KAAKN,OAAO,QAIpEic,MAAMvU,KAAK/C,iBAAiB,UAAW3E,KAAKkd,aAAa5c,KAAKN,OAAO,GAGjD,UAArBA,KAAKqZ,KAAKsD,aAEP/b,QAAQ+D,iBAAiB,UAAW,SAACqO,OdhFFmK,EckFhCxC,EAAY7Y,OAAOsb,eACnBC,EAAUrK,EAAEsK,OAAStK,EAAEqK,QACzBE,EAAUvK,EAAEsG,OAGhBjH,EAAKhS,eAGW,cAAZkd,GAAuC,WAAZA,MACzB5C,EAAU6C,WAAY,CACxB1b,OAAO6U,aAAatE,EAAKsJ,oCAEnB8B,EAAQ9C,EAAU+C,WAAW,GAC7BC,EAAaF,EAAME,gBAErBtL,EAAKuI,sBAAsBC,gBAG3B8C,EAAWC,SAASH,EAAMI,eAAgBJ,EAAMK,YAAc,GAC9D,MAAO9K,GAEP2K,EAAWC,SAASH,EAAMI,eAAgBJ,EAAMK,aAChDH,EAAWI,UAAS,QAItBJ,EAAWC,SAASH,EAAMI,eAAgBJ,EAAMK,aAIlDH,EAAWK,OAAOP,EAAMQ,aAAcR,EAAMS,eAItCC,EADgBR,EAAWS,gBACSC,YAAYC,UAEzB,KAAxBH,GAAsD,WAAxBA,GAAqC9L,EAAKyJ,mBAAoB,KAEzFyC,EAAoB5d,SAASgG,cAAc,QACjD4X,EAAkB5V,4CAAuC0J,EAAKqJ,6BAE9DiC,EAAWa,iBAAiBD,GAE5B5D,EAAU8D,kBACV9D,EAAU+D,SAASjB,GAEnBpL,EAAKsJ,+BAAiCpF,WAAW,WAE/ClE,EAAKyJ,oBAAqB,MAGpB6C,EAAehe,SAASgG,cAAc,QAC5CgY,EAAaC,iBAAkB,EAC/BD,EAAahW,UAAY,wBAEnBkW,EAAiBxM,EAAKyM,oBAC5BH,EAAapP,GAAKsP,MAEZjW,EAAWhD,MAAMiG,KAAKlL,SAASyb,uBAAuB/J,EAAKqJ,8BAEjE5V,EAAe6Y,EAAc/V,EAAS,IAEtCA,EAAS8B,QAAQ,SAACtE,EAAI8C,GACpByV,EAAa/X,YAAYR,SAKrB2Y,EAAYpe,SAASgG,cAAc,QACzCoY,EAAUpW,UAAY0J,EAAKgH,KAAK2F,cAQhCD,EAAUpa,iBAAiB,QANN,SAACqO,OACdiM,EAAejM,EAAEgD,cAAc/P,WACrCoM,EAAK6M,2BAA2BD,GAChCjM,EAAEjH,mBAG6CzL,KAAK+R,IAEtD1R,SAASwe,eAAeN,GAAgBjY,YAAYmY,GAEpD1M,EAAK+M,wBAAyB,EAC9B/M,EAAKqJ,4BAA8BrJ,EAAKyK,6BAEvC,KAEHzK,EAAKyJ,oBAAqB,EAE1B9I,EAAExQ,qBAEG,KAEA6P,EAAKyJ,0BAIV9I,EAAExQ,wBAOH,IdzLiC2a,EcyLCE,GdtLhC,IAAMF,EAAU,IAChB,IAAXA,GAA4B,IAAXA,GAChBA,EAAU,IAAMA,EAAU,IAC1BA,EAAU,IAAMA,EAAU,KAC1BA,EAAU,KAAOA,EAAU,KAC3BA,EAAU,KAAOA,EAAU,OcoLlB9K,EAAKuI,sBAAsBC,YAAa,IAG1B,KAAZwC,EAAgB,KACbhL,EAAKyJ,0BAKVyB,EAAU,OAIR5C,EAAU6C,WAAY,CAExB1b,OAAO6U,aAAatE,EAAKwJ,sCAEnB4B,EAAQ9C,EAAU+C,WAAW,GAC7BC,EAAaF,EAAME,aAEzBA,EAAWC,SAASH,EAAMI,eAAgBJ,EAAMK,aAChDH,EAAWK,OAAOP,EAAMQ,aAAcR,EAAMS,eAEtCmB,EAAmB1e,SAASgG,cAAc,QAChD0Y,EAAiBT,iBAAkB,EACnCS,EAAiB1W,6CAAwC0J,EAAKuJ,+BAC9DyD,EAAiBvY,UAAYyW,EAE7BI,EAAW2B,WAAWD,GAGtB5B,EAAM8B,cAAcF,GAEpB1E,EAAU8D,kBACV9D,EAAU+D,SAASjB,GAEnBpL,EAAKwJ,iCAAmCtF,WAAW,WAEjDlE,EAAKyJ,oBAAqB,MAGpB6C,EAAehe,SAASgG,cAAc,QAC5CgY,EAAaC,iBAAkB,EAC/BD,EAAahW,UAAY,yBAEnBkW,EAAiBxM,EAAKyM,oBAC5BH,EAAapP,GAAKsP,MAEZjW,EAAWhD,MAAMiG,KAAKlL,SAASyb,uBAAuB/J,EAAKuJ,gCAEjE9V,EAAe6Y,EAAc/V,EAAS,IAEtCA,EAAS8B,QAAQ,SAACtE,EAAI8C,GACpByV,EAAa/X,YAAYR,SAKrB2Y,EAAYpe,SAASgG,cAAc,QACzCoY,EAAUpW,UAAY0J,EAAKgH,KAAK2F,cAQhCD,EAAUpa,iBAAiB,QANN,SAACqO,GAEpB7M,EADqB6M,EAAEgD,cAAc/P,YAErC+M,EAAEjH,mBAG6CzL,KAAK+R,IACtD1R,SAASwe,eAAeN,GAAgBjY,YAAYmY,GAEpD1M,EAAKuJ,8BAAgCvJ,EAAKyK,6BAEzC,KAEHzK,EAAKyJ,oBAAqB,GAKW,IAAnCzJ,EAAK8I,4BACP9I,EAAK8I,2BAA4B,GAGnCnI,EAAExQ,qBAIC,CACHV,OAAO6U,aAAatE,EAAKwJ,sCAEnB4B,EAAQ9C,EAAU+C,WAAW,GAC7BC,EAAaF,EAAME,gBAEzBA,EAAWC,SAASH,EAAMI,eAAgBJ,EAAMK,aAChDH,EAAWK,OAAOP,EAAMQ,aAAcR,EAAMS,YAGrB,IAAnB7L,EAAK0J,WAAuBpB,EAAUtP,WAAWlC,OAAS,EAAG,CAE/DkJ,EAAK2J,cAAgBrb,SAASgG,cAAc,QAC5C0L,EAAK2J,cAAc4C,iBAAkB,EACrCvM,EAAK2J,cAAcrT,UAAY,wBAEzB6W,EAAiBnN,EAAKyM,oBAC5BzM,EAAK2J,cAAczM,GAAKiQ,MAElBC,EAAqB9e,SAASgG,cAAc,QAClD8Y,EAAmB9W,UAAY,0BAE/B0J,EAAK2J,cAAcpV,YAAY6Y,GAE/B9B,EAAWa,iBAAiBnM,EAAK2J,mBAG3B+C,EAAYpe,SAASgG,cAAc,QACzCoY,EAAUpW,UAAY0J,EAAKgH,KAAK2F,cAQhCD,EAAUpa,iBAAiB,QANN,SAACqO,OACdiM,EAAejM,EAAEgD,cAAc/P,WACrCoM,EAAK6M,2BAA2BD,GAChCjM,EAAEjH,mBAG6CzL,KAAK+R,IACtDA,EAAK2J,cAAcpV,YAAYmY,GAKjC1M,EAAK0J,WAAY,MAEX2D,EAAmB/e,SAASgG,cAAc,QAChD+Y,EAAiBd,iBAAkB,EACnCc,EAAiB/W,6CAAwC0J,EAAKuJ,+BAG9D8D,EAAiB5Y,oBAAeyW,GAGhCzX,EAAe4Z,EAAkBrN,EAAK2J,eACtCyB,EAAM8B,cAAcG,GAEpB/E,EAAU8D,kBACV9D,EAAU+D,SAASjB,GAEnBpL,EAAKwJ,iCAAmCtF,WAAW,WACjDlE,EAAK0J,WAAY,MAGX4D,EAAchf,SAASgG,cAAc,QAC3CgZ,EAAYf,iBAAkB,EAC9Be,EAAYhX,UAAY,yBAElBkW,EAAiBxM,EAAKyM,oBAC5Ba,EAAYpQ,GAAKsP,MAEXjW,EAAWhD,MAAMiG,KAAKlL,SAASyb,uBAAuB/J,EAAKuJ,gCAEjE9V,EAAe6Z,EAAa/W,EAAS,IAErCA,EAAS8B,QAAQ,SAACtE,EAAI8C,GACpByW,EAAY/Y,YAAYR,SAGpB2Y,EAAYpe,SAASgG,cAAc,QACzCoY,EAAUpW,UAAY0J,EAAKgH,KAAK2F,cAQhCD,EAAUpa,iBAAiB,QANN,SAACqO,GAEpB7M,EADqB6M,EAAEgD,cAAc/P,YAErC+M,EAAEjH,mBAG6CzL,KAAK+R,IACtD1R,SAASwe,eAAeN,GAAgBjY,YAAYmY,GAEpD1M,EAAKuJ,8BAAgCvJ,EAAKyK,6BAEzC,KAEH9J,EAAExQ,oBAQNxC,KAAK0a,cACFkF,sBAGH5f,KAAKqb,iBACFC,QAAQyB,UAAUpY,iBAAiB,QAAS,WAE3Bkb,QAAQ,+EAG1BxN,EAAKzR,QAAQkG,UAAYuL,EAAKkJ,gBAAgBqB,0DAS/C,IAAI1T,EAAI,EAAG4W,EAAM9f,KAAKsc,aAAanT,OAAQD,EAAI4W,EAAK5W,GAAK,OACvDoT,aAAapT,GAAGvE,iBAAiB,QAAS3E,KAAK+f,mBAAmBzf,KAAKN,OAAO,QAGhFuc,WAAW5X,iBAAiB,QAAS3E,KAAKggB,iBAAiB1f,KAAKN,OAAO,2EAOvEigB,qBAAuBjgB,KAAK4Z,QAAQ5Q,4BAHxB,yBAIjBpD,MAAMiG,KAAK7L,KAAKigB,sBAAsBvV,QAAQ,SAACwV,GAE7CA,EAAYvb,iBAAiB,QAAS,WACpC0D,EAAc6X,EAAazN,EAAK4G,KAAKjB,YAAY+H,eAE7C3X,EAAW0X,EAAazN,EAAK4G,KAAKjB,YAAY+H,eAChDC,EAAYhX,IAAI,CACdsO,OAAQjF,EAAKlD,GACbA,GAAI2Q,EAAY3Q,GAChB8Q,IAAKH,EACLpb,KAAMgV,KAAKC,MAAMmG,EAAYtU,aAdpB,uBAiBXwU,SAAmB,CACjB1I,OAAQjF,EAAKlD,GACbA,GAAI2Q,EAAY3Q,KAKpBkD,EAAKpS,yDASU,gEAKa,IAA5BL,KAAKib,mBAKLzS,EAAWxI,KAAKmc,MAAO,YAAyC,IAA5Bnc,KAAKib,0BACtCqF,qBACL7X,EAAczI,KAAKmc,MAAO,WAX1BzT,EAAW1I,KAAKmc,MAAO,2DA6BrBoE,EACAC,EAbEC,EdjZH,SAA6Bra,OANNL,EAASC,EAMC0a,6DAEhCC,EAAgBva,EAAGS,WAAU,GAEnC8Z,EAAcve,MAAMwe,WAAa,SACjCD,EAAcve,MAAM6T,QAAU,QAXFlQ,EAad4a,GAbuB3a,EAaRI,GAXfH,WAAWC,aAAaH,EAASC,EAAc6a,iBAavDC,EAAeH,EAAcre,wBAC7Bye,EAAcL,EAAcrZ,EAAqBsZ,GAAiBxY,EAAWwY,UAGnFxa,EAASwa,GAEF,CACL3e,MAAO8e,EAAa9e,MACpBC,OAAQ6e,EAAa7e,OACrBoB,IAAK0d,EAAW1d,IAChBF,KAAM4d,EAAW5d,Mc8XM6d,CAAoBhhB,KAAKmc,OAC1C8E,EAA2B5Z,EAAqBrH,KAAK4Z,SACrDsH,EAAmB/Y,EAAWnI,KAAK4Z,SAInCuH,EACInhB,KAAK+a,oBAAoB5X,KAAOnD,KAAK+a,oBAAoB/Y,MAAQye,EAAeze,MAAQhC,KAAKqZ,KAAK+H,WAAW3f,EAAMwf,EAAyB9d,KAAO+d,EAAiBlf,MADxKmf,EAEEnhB,KAAK+a,oBAAoB1X,IAAMod,EAAexe,OAASjC,KAAKqZ,KAAK+H,WAAW1f,EAAMuf,EAAyB5d,IACxGrD,KAAK+a,oBAAoB1X,IAAMrD,KAAK+a,oBAAoB9Y,OAASwe,EAAexe,OAASjC,KAAKqZ,KAAK+H,WAAW1f,EAAMuf,EAAyB5d,IAAM6d,EAAiBjf,OAQ7Kse,EAFEY,EAEenhB,KAAK+a,oBAAoB5X,KAAOsd,EAAeze,MAAQhC,KAAKqZ,KAAK+H,WAAW3f,EAI5EzB,KAAK+a,oBAAoB5X,KAAOnD,KAAK+a,oBAAoB/Y,MAAQhC,KAAKqZ,KAAK+H,WAAW3f,EAMvG+e,EAFEW,EAEcnhB,KAAK+a,oBAAoB1X,IAAMod,EAAexe,OAASjC,KAAKqZ,KAAK+H,WAAW1f,EAI5E1B,KAAK+a,oBAAoB1X,IAAMod,EAAexe,OAASjC,KAAKqZ,KAAK+H,WAAW1f,OAIzFya,MAAM/Z,MAAMe,eAAUod,aACtBpE,MAAM/Z,MAAMiB,cAASmd,iDAIXxN,QAEVqO,YAAW,GAEhBrO,EAAExQ,4DAIewQ,OAEXsO,EAAMtO,EAAEgD,cACRuL,EAAUD,EAAI1V,aAAa,gBAC3B4V,EAAcF,EAAI1V,aAAa,qBAG/B/G,EAAUiV,KAAKC,MAAMuH,EAAI1V,aAAa,8BAEvC6V,aAAaF,EAASC,EAAa3c,GAExCmO,EAAExQ,sDAISwQ,GAC2B,IAAZA,EAAEsK,OAIxB9U,EAAWwK,EAAElT,OAAQ,eAErB0I,EAAWwK,EAAElT,OAAQ,mBAEV,cAAXkT,EAAE1N,YAGC2V,oBAAqB,GAEL,IAAjBjb,KAAK0a,cACF2G,cAKM,YAAXrO,EAAE1N,MAAsBtF,KAAKib,0BAG1BL,sBAAwB,QAExBD,UAAY7Y,OAAOsb,oBACnBvC,YAAc7a,KAAK4a,sBAAsBC,YAAc7a,KAAK2a,UAAUE,iBACtEC,oBAAsB9a,KAAK2a,UAAU+C,WAAW,QAEhDzC,oBAAqB,OAErBL,sBAAsB8G,aAAe1hB,KAAK2a,UAAU+G,kBACpD9G,sBAAsB+G,YAAc3hB,KAAK2a,UAAUgH,iBACnD/G,sBAAsBiC,KAAO7c,KAAK8a,oBAAoBzP,YAKxB,IAA/BrL,KAAK2a,UAAUE,aAAwE,KAA/C7a,KAAK8a,oBAAoBzP,WAAWiT,cAEzEpD,mBAAsBlb,KAAK2a,UAAU+G,cAAgB1hB,KAAK2a,UAAUgH,YAAe,QAAU,QAE7E,IAAjB3hB,KAAK0a,eAEFkH,6BAEAP,qEAWL1C,EAAehe,SAASgG,cAAc,QAC5CgY,EAAahW,UAAY,2BAEpBmS,oBAAoB0D,iBAAiBG,OAEpCkD,EAAoBxa,EAAqBsX,GACzCmD,EAAqB3Z,EAAWwW,QAEjC5D,oBAAsB,CACzB5X,KAAM0e,EAAkB1e,KACxBE,IAAKwe,EAAkBxe,IACvBrB,MAAO8f,EAAmB9f,MAC1BC,OAAQ6f,EAAmB7f,QAG7BwG,EAAckW,EAAc,4BAEvBO,2BAA2BP,mDAIVoD,GACtBA,EAAOnb,YAAY5G,KAAK8a,oBAAoBkH,wBACvClH,oBAAoBwE,WAAWyC,OAE9Bvb,EAAUub,EAAOnW,aAAa,qBAC9BqW,EAAWjiB,KAAK8e,oBAEtBiD,EAAOhX,aAAa,cAAekX,GAEnCzJ,EAAM0J,OAAO,CACXxK,OAAQ1X,KAAKuP,GACbA,GAAI0S,EACJ5B,IAAK0B,EACLvb,QAAAA,EACA1B,KAAM,wDAKiByB,OACnBsW,EAAOtW,EAAK8X,YAClB9X,EAAKN,WAAWC,aAAavF,SAASwhB,eAAetF,GAAOtW,GAC5DJ,EAASI,qDAGe6b,cAAU/I,yDAAO,GAEnCgJ,EAAW1hB,SAASgG,cAAc,QACxC0b,EAAStX,aAAa,QAASsO,SAEPA,EAAKiJ,YAAYrZ,MAAM,KAmC/CoZ,EAAS1d,iBAAiB,QAhCL,SAAf4d,EAAgBvP,OAEdwP,EAAYxP,EAAEgD,cACdiJ,EAAeuD,EAAUvc,WAE/Buc,EAAUC,oBAAoB,QAASF,GACvCtD,EAAa5Y,YAAYmc,QAErBxJ,IAAciG,EAAayD,aAG7BxP,EAAK0G,QAAQvT,YAAY4Y,EAAayD,YACtCzD,EAAayD,WAAa,MAI5BxP,EAAKgM,2BAA2BD,OAE1BzY,EAAUyY,EAAarT,aAAa,qBAE1C4M,EAAMmK,UAAU,CACdjL,OAAQxE,EAAK3D,GACbA,GAAI0P,EAAarT,aAAa,eAC9ByU,IAAKpB,EACLzY,QAAAA,EACA1B,KAAM,KAGRkO,EAAEjH,mBAI4CzL,KAAKN,OAErDoiB,EAASxb,YAAYyb,qDAIGO,OAElBC,EAAexb,EAAqBub,SAEnC,CACLzf,eAAS0f,EAAa1f,KAAOoR,SAASqO,EAAMtV,YAAa,IAAMtN,KAAKqZ,KAAKyJ,cAAcrhB,QACvF4B,cAAQwf,EAAaxf,IAAMrD,KAAKqZ,KAAKyJ,cAAcphB,uDAKjC4f,OAAKjI,yDAAO,GAE1B0J,EAAkBpiB,SAASwe,eAAe,oBAAoBrY,UAE9Dkc,EAAMriB,SAASgG,cAAc,OACnCqc,EAAIlc,UAAYic,MAEVE,EAAaD,EAAI3P,WAAW,GAGlC4P,EAAWne,KAAO,GAClBme,EAAWne,KAAKoe,QAAU5B,MAEpB6B,EAAqBF,EAAW7G,uBAAuB,oBAAoB,GAC3EgH,EAAyBH,EAAWI,qBAAqB,UAAU,GACnEC,EAA2BL,EAAW7G,uBAAuB,sBAAsB,GAEnFmH,EAA4BvjB,KAAKwjB,0BAA0BlC,GAEjE2B,EAAW7gB,MAAMe,KAAOogB,EAA0BpgB,KAClD8f,EAAW7gB,MAAMiB,IAAMkgB,EAA0BlgB,IAEjDqF,EAAWua,EAAY5J,SAEvB4J,EAAWte,iBAAiB,QAAS,SAACqO,GAEhCxK,EAAWwK,EAAElT,OAAQ,WAEvB4I,EAAWua,EAAY,UACvBxa,EAAc6Y,EAAK,aAMvB8B,EAAuBze,iBAAiB,QAAS,SAACqO,MAEf,KAA7BmQ,EAAmB7R,MAAc,KAE7BmS,EAAc9iB,SAASgG,cAAc,OAC3C8c,EAAY9a,UAAY,eAExB8a,EAAYzX,UAAYmX,EAAmB7R,MAE3CgS,EAAyB1c,YAAY6c,GAErCN,EAAmB7R,MAAQ,WAK1BsI,QAAQnK,OAAOwT,GAEpBva,EAAW4Y,EAAK,mBAGhBA,EAAIoB,WAAaO,uDAKU3B,OAAKjI,yDAAO,GAEvC3Q,EAAW4Y,EAAK,gBAuChBA,EAAI3c,iBAAiB,iBArCCqO,OAEfxK,EAAWwK,EAAElT,OAAQ,cAAe,IAElC0I,EAAW8Y,EAAK,mBAId,KAGCiC,EAA4BvjB,KAAKwjB,0BAA0BlC,GAEjEA,EAAIoB,WAAWtgB,MAAMe,KAAOogB,EAA0BpgB,KACtDme,EAAIoB,WAAWtgB,MAAMiB,IAAMkgB,EAA0BlgB,IAErDoF,EAAc6Y,EAAIoB,WAAY,oBAVzBgB,sBAAsBpC,EAAKjI,GAc7B7Q,EAAW8Y,EAAK,WAMnB7Y,EAAc6Y,EAAK,UACnB5Y,EAAW4Y,EAAIoB,WAAY,WAL3Bha,EAAW4Y,EAAK,UAWpBtO,EAAEjH,mBAIuCzL,KAAKN,4CAIrCuhB,EAASC,OAAanI,yDAAO,MAEpCrZ,KAAK2a,UAAW,IAEF,iBAAZ4G,EAA4B,KAExBD,EAAM3gB,SAASgG,cAAc,QACnC2a,EAAIvW,aAAa,QAASsO,EAAKiJ,aAC/BhB,EAAIvW,aAAa,oBAAqByW,IAEhB,IAAlBnI,EAAKsK,eACFC,0BAA0BtC,EAAK,OAC3B,aACPgB,YAAajJ,EAAKiJ,eAIA,IAAlBjJ,EAAKwK,eACFC,6BAA6BxC,EAAK,OAC9BjI,EAAK0K,qBAIXC,wBAAwB1C,IAEG,IAA5BjI,EAAK4K,oBACP3C,EAAI4C,aAMH7C,YAAW,QAGXhhB,yBAQXsZ,EAAOS,SAAW,CAChBiC,UAAW,4BACXK,YAAa,SACbyH,cAAe,QACfnF,cAAe,aACfoF,kBAAmB,gBACnBtB,cAAe,CACbrhB,EAAG,GACHC,EAAG,GAEL0f,WAAY,CACV3f,EAAG,GACHC,EAAG,IAEL0W,YAAa,CACXiM,QAAQ,EACRC,cAAe,SACfnE,cAAe,WACfoE,gBAAiB,eAKrB5K,EAAOuC,SAAW,SAAA7C,SAAwB,UAAhBA,EAAKsD,QAAsC,UAAhBtD,EAAKsD,SAAqC,IAAdtD,EAAKmL,WAAgCxL,IAAdK,EAAKmL,MAC7G7K,EAAO8C,YAAc,SAAApD,SAAwB,UAAhBA,EAAKsD,SAAwC,IAAjBtD,EAAKiC,cAAsCtC,IAAjBK,EAAKiC,aCr5BnEmJ,yBAEPlV,EAAIjH,EAAS+Q,mDACjB/Q,KAEDiH,GAAKA,IAEL8J,KAAOrU,OAAOC,OAAO,GAAIwf,EAAgBrK,SAAUf,KAEnDqL,WAAa5jB,EAAKuY,KAAKqL,aAEvBC,SAAW,IAEXC,YAAc9jB,EAAKhB,OAAOsc,uBAAuB,gBAAgB,KACjEyI,gBAAkB/jB,EAAK8jB,YAAYxI,uBAAuB,cAAc,KACxE0I,mBAAqBhkB,EAAKhB,OAAOsc,uBAAuB,wBAAwB,KAChF2I,uBAAyBjkB,EAAKgkB,mBAAmB1I,uBAAuB,cAAc,KAEtF4I,cAAgB,OAGhBC,YAAenkB,EAAK4jB,WAAcD,EAAgBS,oBAAsBT,EAAgBQ,yBArBpDrlB,0CA0BpCulB,uBAAuBnlB,KAAK6kB,gBAAiB7kB,KAAK+kB,6BAClDK,mEAGgBP,EAAiBE,cAEtCvM,EAAM7I,GAAG8H,EAAYC,OAAOI,OAAQ,SAACvV,EAAOgD,OAGtC8f,EACAzC,EAFE/M,EAAStQ,EAAQsQ,cAKfA,EAAOvQ,WAERmS,EAAYC,OAAOC,gBAEtB0N,EAAoBxP,EAAO/Q,KAAK+T,cAENrS,cAEnB6L,EAAKgH,KAAKiM,MAAM,GAAGC,QAAQ,GAAGlF,OAEjCwE,EAAgBW,mBAAmB,YAAanT,EAAK4S,YAAY3e,EAAU+e,EAAkBhF,KAAMgF,EAAkB9V,MAIjH8C,EAAKgH,KAAKoM,wBAA0BpT,EAAKgH,KAAKiM,MAAM,GAAGC,QAAQ,GAAGlF,MAAQhO,EAAKgH,KAAKiM,MAAM,GAAGC,QAAQ,GAAGlF,eAOzGhO,EAAKgH,KAAKiM,MAAM,GAAGC,QAAQ,GAAGlF,KAGjCuC,EAAQyC,EAAkBhF,IAAIxZ,WAAU,IAClCkE,aAAa,aAAa,GAChC6X,EAAMje,iBAAiB,QAAS0N,EAAKqT,kBAAkBplB,KAAK+R,IAAO,GACnEuQ,EAAMje,iBAAiB,YAAa0N,EAAKqT,kBAAkBplB,KAAK+R,IAAO,GACvEuQ,EAAMje,iBAAiB,UAAW0N,EAAKqT,kBAAkBplB,KAAK+R,IAAO,GACrEuQ,EAAMje,iBAAiB,OAAQ0N,EAAKqT,kBAAkBplB,KAAK+R,IAAO,GAElE0S,EAAuBne,YAAYgc,cAWpCnL,EAAYC,OAAOE,WAEtByN,EAAoBxP,EAAO/Q,KAAK+T,aAOhCjT,MAAM+f,UAAUjb,QAAQ8F,KAAK7P,SAASqI,yCAAkCqc,EAAkB9V,UAAS,SAACqT,GAE9Fpa,EAAWoa,EAAM3c,WAAY,kBAG/BE,EAASyc,EAAM3c,WAAWA,YAG1BE,EAASyc,yDAkBd9iB,OAAO6E,iBAAiB,WAAY3E,KAAK4lB,aAAatlB,KAAKN,OAAO,QAClEF,OAAO6E,iBAAiB,YAAa3E,KAAK4lB,aAAatlB,KAAKN,OAAO,QACnEF,OAAO6E,iBAAiB,OAAQ3E,KAAK4lB,aAAatlB,KAAKN,OAAO,6CAKnDgT,SAED,cAAXA,EAAE1N,OACJ0N,EAAE6S,aAAaC,QAAQ,aAAc,QACrC9S,EAAE6S,aAAaE,WAAa,GAC5B/S,EAAElT,OAAOsC,MAAM4jB,QAAU,QAEpBhB,cAAgBhS,EAAElT,OAAO+G,WAAU,IAG3B,YAAXmM,EAAE1N,OACJ0N,EAAElT,OAAOsC,MAAM4jB,QAAU,OAGpB3lB,iBAGA,uCAII2S,UAEPxK,EAAWwK,EAAElT,OAAQ,qCAER,aAAXkT,EAAE1N,OAEJ0N,EAAExQ,iBACFwQ,EAAE6S,aAAaE,WAAa,GAC5B/S,EAAElT,OAAOsC,MAAM6jB,WAAa,QAGf,cAAXjT,EAAE1N,OAEJ0N,EAAElT,OAAOsC,MAAM6jB,WAAa,QAIf,SAAXjT,EAAE1N,OAGJ0N,EAAExQ,iBAEFwQ,EAAElT,OAAOsC,MAAM6jB,WAAa,YACvBjB,cAAc5iB,MAAM4jB,QAAU,OAG9BhB,cAAcrgB,iBAAiB,QAAS,SAACqO,GAExCxK,EAAWwK,EAAElT,OAAQ,eAEvBkT,EAAElT,OAAOmG,WAAWxF,WAMxBuS,EAAElT,OAAO8G,YAAY5G,KAAKglB,kBASvB,WAOXP,EAAgBrK,SAAW,CACzBsK,YAAY,GAIdD,EAAgBQ,YAAc,SAACiB,2GAI4BA,6FAS3DzB,EAAgBS,oBAAsB,SAACgB,OAAU3Q,yDAAQ,0GAIE2Q,0LAGZ3Q,wIC5KzCiD,EAAQ,gFAnCLC,MAAQ,gBAPWxB,qCAYnBkP,EAAYC,EAAUC,GAEtBrmB,KAAKyY,MAAM0N,UACT1N,MAAM0N,GAAc,SAGtB1N,MAAM0N,GAAYha,MAAQia,OAC1B3N,MAAM0N,GAAYG,UAAYD,EAEnC7N,EAAMU,QAAQzB,EAAYM,SAASD,OAAQ,CACzCjC,OAAQ,CACNtG,GAAIkI,EAAYM,SAASxI,GACzBjK,KAAMmS,EAAYM,SAASD,OAC3BhT,KAAM,CACJqhB,WAAYA,EACZC,SAAUA,EACVC,aAAcA,8CASbrmB,KAAKyY,gBC5CK8N,yBACP1mB,SAAUwZ,yDAAO,6CACrBxZ,KACD0P,GAAKzO,EAAKhB,OAAOyP,cACNzO,EAAKhB,OAAO8L,aAAa,kBAAoB,YACxD4a,UAAY5gB,MAAMiG,KAAK/K,EAAKhB,OAAOkJ,iBAAiB,8BAEpDqQ,KAAOrU,OAAOC,OAAO,GAAIshB,EAASnM,SAAUf,KAE5CoN,gBAAkB3lB,EAAKhB,OAAOsc,uBAAuBtb,EAAKuY,KAAKqN,yBAAyB,GAEzF5lB,EAAKuY,KAAKsN,SAAW7lB,EAAKuY,KAAKsN,QAAQ9a,KAAK1C,OAAS,IAElDyd,aAAc,IAEd3R,OAASnU,EAAKhB,OAAOsc,uBAAuBtb,EAAKuY,KAAKwN,4BAf3BjnB,4CAqB1BI,mBACD,UAECA,KAAKqZ,aAAerZ,KAAKqZ,YAAYlQ,OAAS,SAC3Csd,gBAAgB3f,UAAYyf,EAASO,kBAAkB9mB,KAAKqZ,cAKnEb,EAAMuO,OACJ/mB,KAAKuP,GACLgX,EAASS,kBAAkBhnB,KAAKymB,gBAAiBzmB,KAAKqZ,KAAKwN,eAC3DN,EAASU,cAAcjnB,KAAKymB,kBAI1BzmB,KAAK4mB,cAGH5mB,KAAKqZ,KAAKsN,QAAQO,aACfC,8CAGFhC,+BAGFC,8BAGF,YACHxf,MAAMiG,KAAK7L,KAAKiV,QAAQvK,QAAQ,SAACc,GAC/BA,EAAMT,aAAa,qBAAsB,UAEtCqc,yBAAyBpnB,KAAKqZ,KAAKgO,yDAQrBC,uBAGdC,EAAiBC,EAAUC,EAAQC,OACpCC,EAAWpT,SAASiT,EAAS5b,aAAa,sBAAuB,IACjEgc,EAAWD,EAAWF,EACtBnW,EAAQzO,KAAKglB,IAAID,GAAYN,EAAWK,EAAWC,EACzDJ,EAASzc,aAAa,qBAAsBuG,GAE5CoW,IARFJ,EAAWA,EAAW/S,SAAS+S,EAAU,IAAM,OAW1Cd,UAAU9b,QAAQ,SAACod,OAChBN,EAAWM,EAASje,cAAcA,qBAChBie,EAASlc,aAAa,8BAGvC,QACHkc,EAASnjB,iBAAiB,QAAS,SAACpC,GAClCglB,EAAiBC,GAAW,EAAGnV,EAAKhS,cACpCkC,EAAMC,6BAIL,OACHslB,EAASnjB,iBAAiB,QAAS,SAACpC,GAClCglB,EAAiBC,EAAU,EAAGnV,EAAKhS,cACnCkC,EAAMC,kGAWVulB,EAAc,QAEb1O,KAAKsN,QAAQ9a,KAAKnB,QAAQ,SAAC6E,OACxByY,EAAOrnB,SAASwe,eAAe5P,GAAI6M,uBAAuB3J,EAAK4G,KAAKqN,yBAAyB,GAAG5f,UAEtGihB,GAAexB,EAAS0B,eAAe1Y,EAAIkD,EAAKlD,GAAIyY,UAIjDvB,gBAAgB3f,UAAYihB,OAE5B9S,OAASjV,KAAKF,OAAOsc,uBAAuBpc,KAAKqZ,KAAKwN,eAE3DrO,EAAMuO,OACJ/mB,KAAKuP,GACLgX,EAASS,kBAAkBhnB,KAAKymB,gBAAiBzmB,KAAKqZ,KAAKwN,eAC3DN,EAASU,cAAcjnB,KAAKymB,yEAO9B7gB,MAAMiG,KAAK7L,KAAKF,OAAOsc,uBAAuBpc,KAAKqZ,KAAKwN,gBAAgBnc,QAAQ,SAACc,GAC/EA,EAAM7G,iBAAiB,QAASuO,EAAKgV,cAAc5nB,KAAK4S,IAAO,iEAMjEsF,EAAM7I,GAAG8H,EAAYM,SAASD,OAAQ,SAACvV,EAAOgD,OAEtCsQ,EAAStQ,EAAQsQ,OACjB/Q,EAAOS,EAAQsQ,OAAO/Q,YAEpB+Q,EAAOvQ,WAERmS,EAAYM,SAASD,OAGpBtB,EAAK6C,KAAKsN,QAAQ9a,KAAKlI,QAAQmB,EAAKqhB,aAAe,IACrD3P,EAAK2Q,yCAGL3Q,EAAK4O,8DAcDpS,GAEG,UAAXA,EAAE1N,OAEJ+C,EAAc2K,EAAEgD,cAAe,YAE/BwC,EAAMuO,OACJ/mB,KAAKuP,GACLgX,EAASS,kBAAkBhnB,KAAKymB,gBAAiBzmB,KAAKqZ,KAAKwN,eAC3DN,EAASU,cAAcjnB,KAAKymB,uBAGzBpmB,yBAQXkmB,EAAS4B,uBAAyB,SAAA3c,SAAU,OACnCA,EAAM7C,UACb4G,GAAI/D,EAAMI,aAAa,MACvBiR,KAAMrR,EAAMQ,YAGdua,EAASU,cAAgB,SAAAR,UAAmBA,EAAgB3f,WAE5Dyf,EAASS,kBAAoB,SAACP,EAAiB2B,OACvCnT,EAASwR,EAAgBrK,uBAAuBgM,GAChDC,EAAa,UAEnBziB,MAAMiG,KAAKoJ,GAAQvK,QAAQ,SAACc,GAC1B6c,EAAWvY,KAAKyW,EAAS4B,uBAAuB3c,MAI3C6c,GAIT9B,EAAS+B,uBAAyB,SAAC5iB,OAE3B6iB,EAAS5nB,SAASgG,cAAc,cACtC4hB,EAAOxd,aAAa,QAASrF,SAC7B6iB,EAAOxd,aAAa,KAAMrF,EAAK6J,IAC/BgZ,EAAOzhB,UAAYpB,EAAKmX,KAEjBvW,EAAUiiB,IAInBhC,EAASO,kBAAoB,SAAC3a,OAExBqc,EAAc,UAElBrc,EAAMzB,QAAQ,SAAChF,GAEb8iB,GAAejC,EAAS+B,uBAAuB5iB,KAI1C8iB,GAKTjC,EAAS0B,eAAiB,SAACQ,EAAOC,EAAOpC,OAEjCqC,EAAY,IAAIlf,OAAOgf,EAAO,YAE7BnC,EAAU9c,QAAQmf,EAAWD,IAItCnC,EAASnM,SAAW,CAClBsM,wBAAyB,2BACzBG,cAAe,qBC3OI+B,wBACPtgB,OAAS+Q,yDAAO,kBAErBxZ,SAAWyI,OACXiH,GAAKvP,KAAKH,SAAS+L,aAAa,WAEhCyN,KAAOrU,OAAOC,OAAO,GAAI2jB,EAAsBxO,SAAUf,QAEzDwP,aAAe/O,KAAKC,MAAM/Z,KAAKH,SAAS+L,aAAa5L,KAAKqZ,KAAKyP,uCAC/DrC,gBAAkBzmB,KAAKH,SAASuc,uBAAuBpc,KAAKqZ,KAAKqN,yBAAyB,iDAM1FvB,qFAOL3M,EAAM7I,GAAG8H,EAAYC,OAAOI,OAAQ,SAACvV,EAAOgD,GAE3BA,EAAQsQ,WAEjBgD,EADOtT,EAAQsQ,OAAO/Q,KACF+T,gBAEtB/X,EAAK+nB,aAAallB,QAAQkV,EAAarS,UAAY,EAAG,KAElDkS,EAAOF,EAAMuQ,UAAU,CAACzP,IAAK,UAAWhI,MAAOxQ,EAAK+nB,eAEtDG,EAAU,GAEdtQ,EAAKhO,QAAQ,SAAC2V,GAEZ2I,GAAW1iB,EAAW+Z,EAAIA,OAI5Bvf,EAAK2lB,gBAAgB3f,UAAYkiB,cAgBzCJ,EAAsBxO,SAAW,CAC/BsM,wBAAyB,kCACzBoC,gCAAiC,yCC1DdG,yBAEP1Z,EAAIjH,EAAS+Q,mDACjB/Q,KAEDiH,GAAKA,IAEL8J,KAAOrU,OAAOC,OAAO,GAAIgkB,EAAS7O,SAAUf,KAE5C6P,WAAapoB,EAAKhB,OAAOsc,uBAAuBtb,EAAKuY,KAAK8P,aAC1DlN,MAAQ,CACXmN,eAAgB,EAChBC,OAAQ,GACRC,UAAW,IAITxoB,EAAKuY,KAAKkQ,gBACPtN,MAAMoN,OAASvoB,EAAKuY,KAAKkQ,YAAYC,IAAI,SAAA9B,UAAYA,EAAS+B,sBAlBnC7pB,0CAwB7BwlB,2EAKLxf,MAAMiG,KAAK7L,KAAKkpB,YAAYxe,QAAQ,SAACgf,EAAWC,GAE9CtX,EAAK4J,MAAMqN,UAAUxZ,KAAK,CAAE8Z,UAAU,QAEhCC,EAAgBtV,SAASmV,EAAU9d,aAAa,sBAAuB,IACvEke,EAAWlkB,MAAMiG,KAAK6d,EAAUtN,uBAAuB/J,EAAKgH,KAAK0Q,cAEvED,EAASpf,QAAQ,SAACsf,EAASC,GACzBD,EAAQrlB,iBAAiB,QAAS,eAC1BulB,EAAiBF,MAGnBE,EAAe3pB,UAAUC,SAAS,gBAKtCspB,EAASpf,QAAQ,SAAAyf,UAAgB1hB,EAAc0hB,EAAc9X,EAAKgH,KAAK8G,iBAEvE9X,EAAc6hB,EAAgB7X,EAAKgH,KAAK8G,eAGpC9N,EAAKgH,KAAKkQ,YAAa,OACrBU,IAAgBJ,EAClBxX,EAAK4J,MAAMmN,gBAAkB,EACU,IAA9B/W,EAAK4J,MAAMmN,iBAAyE,IAAjD/W,EAAK4J,MAAMqN,UAAUK,GAAeC,WAChFvX,EAAK4J,MAAMmN,gBAAkB,OAGzBgB,EAAiB/X,EAAKgH,KAAKkQ,YAAYc,KAAK,SAAA3C,UAAYA,EAAS4C,SAASrX,SAASZ,EAAK4J,MAAMmN,qBAGpG/W,EAAKnS,gBAAgBK,WAAUE,iBAAU4R,EAAK4J,MAAMoN,SACpDhX,EAAKnS,gBAAgBK,UAAU6I,IAAIghB,EAAeX,OAClDpX,EAAKjS,oBAAoB4L,UAAYoe,EAAevN,KAItDxK,EAAK4J,MAAMqN,UAAUK,GAAeC,UAAW,OAGmB5Q,IAA9D3G,EAAK4J,MAAMqN,UAAUe,KAAK,SAAAE,UAAaA,EAASX,YAClDvX,EAAKhS,kBAGN,gBAMX4oB,EAAS7O,SAAW,CAClB+O,UAAW,iBACXY,YAAa,SACb5J,cAAe,gBCnFIqK,yBAEP3qB,EAAUwZ,mDACdxZ,KAED0P,GAAKzO,EAAKhB,OAAOyP,KACjB8J,KAAOrU,OAAOC,OAAO,GAAIulB,EAAapQ,SAAUf,KAEhDsL,SAAW,IAEX8F,iBAAmB3pB,EAAKhB,OAAOsc,uBAAuB,cAAc,KAEpEsO,aAAe5pB,EAAKuY,KAAKvU,OAEzBmX,MAAQ,CACX0O,gBAAiB,EACjBC,eAAgB,EAChBC,MAAO,iBAjB6BjrB,qCAuBL,UAA7BI,KAAK0qB,aAAazQ,aACfkL,qFAUP/E,EAAYzQ,GAAG3P,KAAK0qB,aAAaI,UAAUC,KAAK,KAAM,SAACxoB,EAAOgD,OACtDsQ,EAAStQ,EAAQsQ,OACjB/Q,EAAOS,EAAQT,YAEb+Q,EAAOvQ,WAERmS,EAAYlV,GAAO8V,IACtBhG,EAAKoY,iBAAiBjF,mBAAmB,YAAagF,EAAavF,YAAYngB,QAEzEkmB,EAAW3Y,EAAKoY,iBAAiBzhB,iBAAiB,cAGlDiiB,EAFWD,EAASA,EAAS7hB,OAAS,GAEfH,iBAAiB,UAE9CqJ,EAAK4J,MAAM0O,iBAAmBM,EAAY9hB,OAE1CvD,MAAMiG,KAAKof,GAAavgB,QAAQ,SAACwgB,GAC/B7Y,EAAK4J,MAAM4O,MAAM/a,KAAK,CAAE8Z,UAAU,QAC5BuB,EAAa9Y,EAAK4J,MAAM4O,MAAM1hB,OAAS,EAE7C+hB,EAAQvmB,iBAAiB,SAAU,YACa,IAA1C0N,EAAK4J,MAAM4O,MAAMM,GAAYvB,WAC/BvX,EAAK4J,MAAM2O,gBAAkB,EAC7BvY,EAAK4J,MAAM4O,MAAMM,GAAYvB,UAAW,GAEtCvX,EAAK4J,MAAM0O,kBAAoBtY,EAAK4J,MAAM2O,gBAE5CvY,EAAKhS,8BAMRoX,EAAYlV,GAAO+V,WAChB8S,EAAOzqB,SAASwe,yBAAkBra,EAAKyK,cAC7CpJ,EAASilB,GACT/Y,EAAK4J,MAAM0O,iBAAmBS,EAAKpiB,iBAAiB,UAAUG,OAC9DkJ,EAAK4J,MAAM2O,gBAAkBQ,EAAKpiB,iBAAiB,UAAUG,OAEzDkJ,EAAK4J,MAAM0O,iBAAmBtY,EAAK4J,MAAM2O,gBAE3CvY,EAAKhS,2BAgBjBmqB,EAAapQ,SAAW,GAIxBoQ,EAAavF,YAAc,SAACngB,oDAEKA,EAAKyK,gDACZzK,EAAKA,KAAK+X,gDACV/X,EAAKA,KAAKumB,uEAEdvmB,EAAKyK,waAYLzK,EAAKyK,kVCpHrB+b,yBACQzrB,mDACJA,KAED0rB,YAAc5qB,SAASR,cAAc,gCACrCqrB,iBAAmB1qB,EAAKyqB,YAAYprB,cAAc,+BAElD2B,OAAS,KACT2pB,MAAQ,KAER3pB,OAAOE,MAAQF,OAAO4pB,aACtB5pB,OAAOG,OAASH,OAAO6pB,cACvB7pB,OAAO8pB,MAAQ9qB,EAAKgB,OAAOE,MAAQlB,EAAKgB,OAAOG,SAE/CupB,iBAAiBK,OAAS,aACxBJ,MAAMzpB,MAAQlB,EAAK0qB,iBAAiBM,eACpCL,MAAMxpB,OAASnB,EAAK0qB,iBAAiBO,gBACrCN,MAAMG,MAAQ9qB,EAAK2qB,MAAMzpB,MAAQlB,EAAK2qB,MAAMxpB,OAE7CnB,EAAK2qB,MAAMG,OAAS9qB,EAAKgB,OAAO8pB,SAC7BJ,iBAAiBppB,MAAMJ,MAAQ,SAC/BwpB,iBAAiBppB,MAAMH,OAAS,WAEhCupB,iBAAiBppB,MAAMJ,MAAQ,SAC/BwpB,iBAAiBppB,MAAMH,iBAAYnB,EAAKgB,OAAOG,4BAxBnCrC,QA+BJosB,yBACPnsB,mDACJA,KAEDC,OAAO6E,iBAAiB,QAAS,SAACpC,KAChCipB,iBAAiBtd,IAAMmE,EAAKvS,OAAOsO,mBAAmBF,MACtDqd,YAAYhrB,UAAU0rB,OAAO,YAE7B5rB,eAELkC,EAAMC,iBACND,EAAMwJ,oBACL,gBAZuCuf,QChCzBY,yBACPrsB,mDACJA,KACDssB,WAAarrB,EAAKf,OAAOiJ,iBAAiB,4BAE1CojB,eAAiB,CACpBlpB,IAAKqR,SAAmD,MAA1CzT,EAAKhB,OAAO8L,aAAa,aAAuB,EAAI9K,EAAKhB,OAAO8L,aAAa,aAAc,IACzGygB,IAAK,KACLppB,IAAKsR,SAASzT,EAAKhB,OAAO8L,aAAa,aAAe,EAAG,OAEtDwgB,eAAeC,IAAMxpB,KAAKsI,OAAOrK,EAAKsrB,eAAenpB,IAAMnC,EAAKsrB,eAAelpB,KAAO,EAAIpC,EAAKsrB,eAAelpB,OAE9G+Y,MAAQ,CACXmN,eAAgB,EAChBC,OAAQ,CACN,YACA,eACA,eAEFC,UAAW,MAGRgD,4BAtB6B1sB,6DA0B7BE,OAAO6E,iBAAiB,QAAS,SAACpC,SACrCA,EAAMwJ,sBAEAwgB,EAAcla,EAAKvS,OAAOwR,MAAMnI,WAItCkJ,EAAKnS,gBAAgBK,WAAUE,iBAAU4R,EAAK4J,MAAMoN,SAChDkD,EAAcla,EAAK+Z,eAAelpB,MACpCmP,EAAKnS,gBAAgBK,UAAU6I,IAAIiJ,EAAK4J,MAAMoN,OAAO,IACrDhX,EAAKjS,oBAAoB4L,UAAY,gBAGjCugB,GAAela,EAAK+Z,eAAeC,KACrCha,EAAKnS,gBAAgBK,UAAU6I,IAAIiJ,EAAK4J,MAAMoN,OAAO,IACrDhX,EAAKjS,oBAAoB4L,UAAY,kBAE9BugB,EAAcla,EAAK+Z,eAAeC,MACzCha,EAAKnS,gBAAgBK,UAAU6I,IAAIiJ,EAAK4J,MAAMoN,OAAO,IACrDhX,EAAKjS,oBAAoB4L,UAAY,eAGvCqG,EAAKvS,OAAOiL,aAAa,uBAAwB,gBAI5BiO,IAFApT,MAAMiG,KAAKwG,EAAK8Z,YAAY9B,KAAK,SAAAmC,SAAiE,YAAnDA,EAAU5gB,aAAa,2BAIzFyG,EAAKhS,2BCtDMosB,yBAEP5sB,mDACJA,KAED6L,YAAc5K,EAAKhB,OAAOK,cAAc,2BACxCusB,UAAY5rB,EAAKhB,OAAOK,cAAc,uBACtCwsB,UAAY7rB,EAAKhB,OAAOK,cAAc,4BACtCysB,eAAiB9rB,EAAKhB,OAAOK,cAAc,gCAE3C0sB,WAAaC,WAAWC,OAAO,CAClC/lB,UAAWlG,EAAK4rB,UAChBM,UAAW,UACXC,cAAe,UACfhrB,OAAQ,GACRirB,YAAY,EACZC,SAAU,MAEPN,WAAWO,KAAKtsB,EAAK4rB,UAAUW,QAAQnf,OAEvCof,wBApBsC1tB,yDAwBtCitB,WAAWld,GAAG,QAAS,WAC1B0C,EAAKsa,UAAUtO,YAAc,WACvBnT,EAAWmH,EAAKwa,WAAWU,cAC3BniB,EAAUvI,KAAKsI,MAAOD,EAAW,KAAQ,IACzCD,EAAU,YAAMpI,KAAKsI,MAAMD,EAAW,KAAOI,OAAO,GAC1D+G,EAAKua,eAAevO,sBAAiBjT,cAAWH,GAEhDoH,EAAKmb,0FAKFX,WAAWld,GAAG,eAAgB,SAAC8d,OAC5BriB,EAAUvI,KAAKsI,MAAOsiB,EAAO,KAAQ,IACrCxiB,EAAU,YAAMpI,KAAKsI,MAAMsiB,EAAO,KAAOniB,OAAO,GACtDmH,EAAKka,UAAUtO,sBAAiBjT,cAAWH,UAGxC4hB,WAAWld,GAAG,SAAU,WAC3B8C,EAAK/G,YAAYX,aAAa,sBAAuB,iBAGlDW,YAAY/G,iBAAiB,QAAS,WACzC8N,EAAKoa,WAAWa,YAE6C,WAAzDjb,EAAK/G,YAAYE,aAAa,uBAChC6G,EAAK/G,YAAYX,aAAa,sBAAuB,WAErD0H,EAAK/G,YAAYX,aAAa,sBAAuB,UAGvD0H,EAAKpS,qBAIDstB,EAAchtB,SAASqI,iBAAiB,qBAC9CpD,MAAMiG,KAAK8hB,GAAajjB,QAAQ,SAACkjB,GAC/BA,EAAWjpB,iBAAiB,QAAS,WAC0B,YAAzD8N,EAAK/G,YAAYE,aAAa,yBAChC6G,EAAKoa,WAAWa,YAChBjb,EAAK/G,YAAYX,aAAa,sBAAuB,wBC/D1C8iB,yBACPhuB,mDACJA,KAED4L,OAAS3K,EAAKhB,OAAOK,cAAc,WACnCwL,UAAY7K,EAAKhB,OAAOK,cAAc,4BACtC2tB,UAAYhtB,EAAKhB,OAAOK,cAAc,gCAEtC2tB,UAAU9hB,qBAAgBhB,EAAwBlK,EAAK2K,OAAOP,WAEnEK,EAAYyC,kBAAkBlN,EAAKhB,OAAQgB,EAAKT,2BAVLkL,QCD1BwiB,yBACPluB,mDACJA,KAEDmuB,SAAWltB,EAAKhB,OAAOkJ,iBAAiB,8BACxCilB,MAAQntB,EAAKhB,OAAOkJ,iBAAiB,2BACrCklB,gBAAkB,IAElBC,yCAR4BvuB,wCAWzBwuB,EAAS7Y,QACZ0Y,MAAMjuB,KAAKkuB,iBAAiB3tB,UAAUE,OAAO,eAC7CutB,SAAShuB,KAAKkuB,iBAAiB3tB,UAAUE,OAAO,eAEhDwtB,MAAM1Y,GAAOhV,UAAU6I,IAAI,UAChCglB,EAAQ7tB,UAAU6I,IAAI,eAEjB8kB,gBAAkB3Y,sEAIlByY,SAAStjB,QAAQ,SAAC0jB,EAAS7Y,GAE9B6Y,EAAQzpB,iBAAiB,QAAS,SAACpC,GACjC8P,EAAKgc,UAAUD,EAAS7Y,GACxBlD,EAAKhS,eAELkC,EAAMC,8BC1BO8rB,0BACPzuB,EAAUgF,mDACdhF,KAED+K,OAAS9J,EAAKhB,OAAOK,cAAc,WACnC0E,QAAUG,OAAOH,KACjB0pB,OAASztB,EAAK+D,QAAQ0pB,QAAU,UAChCC,KAAOxpB,OAAOlE,EAAK+D,QAAQ2pB,QAS3B3jB,OAAS,OACToB,YAAc,OACdf,SAAW,OACXujB,SAAW,OAEXC,UAAY5tB,EAAKhB,OAAO6uB,gBACxBnI,UAAY1lB,EAAKhB,OAAOK,cAAc,4BAEtCyuB,MAAQ9tB,EAAK0lB,UAAUrmB,cAAc,2BACrC0uB,YAAc/tB,EAAK8tB,MAAMzuB,cAAc,wBACvC2uB,aAAehuB,EAAK8tB,MAAMzuB,cAAc,yBAExC4uB,MAAQjuB,EAAK0lB,UAAUrmB,cAAc,gCACrC6uB,WAAaluB,EAAKiuB,MAAM5uB,cAAc,mCACtC8uB,WAAanuB,EAAKiuB,MAAM5uB,cAAc,mCAGtC+uB,iBAAmBpuB,EAAK4tB,UAAUvM,eAAe,MACjDgN,aAAeruB,EAAK0lB,UAAUrmB,cAAc,4BAC5CgvB,aAAavoB,YAAY9F,EAAKouB,oBAG9BE,aAAetuB,EAAK8J,OAAOM,WAC3BmkB,cAAgBvuB,EAAK0lB,UAAUrmB,cAAc,gCAC7CkvB,cAAcrjB,UAAYhB,EAAwBlK,EAAKsuB,gBACvDC,cAActkB,aACjB,kBACGujB,EAAYgB,YACbxuB,EAAKsuB,aACLtuB,EAAK0tB,KAAKpjB,SAAW,UACrBtK,EAAK0tB,KAAKvjB,SAAW,eAKpBsgB,YAAczqB,EAAK0lB,UAAUrmB,cAChC,wBAEGovB,uBAAyBzuB,EAAKyqB,YAAYprB,cAC7C,mCAEGqvB,uBAAyB1uB,EAAKyqB,YAAYprB,cAC7C,mCAIGsvB,kBAAoB,uBAAwB3uB,EAAKhB,OAClD,mBACA,6BAA8BgB,EAAKhB,OACjC,yBACA,yBAA0BgB,EAAKhB,OAC7B,qBACA,qBAEH4vB,mBAAqB5uB,EAAKhB,OAAO6vB,mBACnC7uB,EAAKhB,OAAO8vB,yBAEZ9uB,EAAKhB,OAAO+vB,sBAEVC,eAAiBhvB,EAAKgvB,eAAexvB,aACrCyvB,YAAcjvB,EAAKivB,YAAYzvB,aAC/B0vB,aAAelvB,EAAKkvB,aAAa1vB,aACjC2vB,aAAenvB,EAAKmvB,aAAa3vB,aACjC4vB,aAAepvB,EAAKovB,aAAa5vB,aACjC6vB,YAAcrvB,EAAKqvB,YAAY7vB,aAC/B8vB,cAAgBtvB,EAAKsvB,cAAc9vB,aACnC+vB,YAAcvvB,EAAKuvB,YAAY/vB,aAC/B8vB,cAAgBtvB,EAAKsvB,cAAc9vB,aACnCgwB,kBAAoBxvB,EAAKwvB,kBAAkBhwB,aAC3CiwB,mBAAqBzvB,EAAKyvB,mBAAmBjwB,aAG7CsK,OAAOjG,iBAAiB,iBAAkB7D,EAAKgvB,kBAC/CllB,OAAOjG,iBAAiB,YAAa7D,EAAKivB,eAC1CnlB,OAAOjG,iBAAiB,aAAc7D,EAAKkvB,gBAC3CplB,OAAOjG,iBAAiB,QAAS7D,EAAKmvB,gBACtCrlB,OAAOjG,iBAAiB,OAAQ7D,EAAKmvB,gBACrCrlB,OAAOjG,iBAAiB,aAAc7D,EAAKovB,gBAC3C1J,UAAU7hB,iBAAiB,QAAS7D,EAAKqvB,aAAa,KAEtDvB,MAAMjqB,iBAAiB,UAAW7D,EAAKsvB,iBACvCrB,MAAMpqB,iBAAiB,QAAS7D,EAAKuvB,aAAa,KAClDtB,MAAMpqB,iBAAiB,UAAW7D,EAAKsvB,iBACvC7E,YAAY5mB,iBAAiB,QAAS7D,EAAKwvB,mBAAmB,GAEnE3vB,SAASgE,iBACP7D,EAAK2uB,kBACL3uB,EAAKyvB,oBAIPjC,EAAYkC,OAAO1vB,EAAKiuB,MAAOjuB,EAAKmuB,WAAY,SAACwB,KAC1C7lB,OAAOqB,YAAcnL,EAAKoK,SAAWrI,KAAKI,IAAI,EAAGJ,KAAKK,IAAI,EAAGutB,MAE7DP,mBAGFH,2BAjHgCnwB,6CAoIjCI,KAAK6K,SAAW7K,KAAK4K,OAAOC,cACzBA,OAAS7K,KAAK4K,OAAOC,YAErB+jB,MAAM7jB,aACT,aACA/K,KAAK6K,OAAS7K,KAAKwuB,KAAK1iB,MAAQ,OAAS9L,KAAKwuB,KAAK1jB,OAAS,cAEzDhL,OAAOiL,aACV,oBACA/K,KAAK6K,OAAS,SAAW,gBAEtBgkB,YAAY9jB,aAAa,eAAgB/K,KAAK6K,aAC9CikB,aAAa/jB,aAAa,cAAe/K,KAAK6K,QAEnD6lB,cAAc1wB,KAAKyuB,UAEdzuB,KAAK6K,cAEH4jB,SAAWkC,YAAY3wB,KAAKkwB,aAAc,UAI5CtlB,OAAOpF,cAAc4E,EAAYC,uDAOtCrK,KAAKiM,cAAgBjM,KAAK4K,OAAOqB,aAC9BjM,KAAKkL,WAAalL,KAAK4K,OAAOM,SACjC,MACKe,YAAcjM,KAAK4K,OAAOqB,iBAC1Bf,SAAWlL,KAAK4K,OAAOM,UAAY,MAElC0lB,EAAwB5wB,KAAKiM,YAAcjM,KAAKkL,SAEhD2lB,EAAkB7lB,EAAwBhL,KAAKiM,aAKjD4kB,IAAoB7wB,KAAKkvB,iBAAiB4B,iBACvC5B,iBAAiB4B,UAAYD,OAE7B1B,aAAapkB,aAChB,kBACGujB,EAAYgB,YACbtvB,KAAKiM,YACLjM,KAAKwuB,KAAKpjB,SAAW,UACrBpL,KAAKwuB,KAAKvjB,SAAW,mBAiBtB8jB,MAAMhkB,aAAa,gBAAiB/K,KAAKiM,kBACzC8iB,MAAMhkB,aAAa,gBAAiB,QACpCgkB,MAAMhkB,aAAa,gBAAiB/K,KAAKkL,eAEzC8jB,WAAW5sB,MAAMJ,gBAAmC,IAAxB4uB,YAG5BhmB,OAAOpF,cAAc4E,EAAYE,wDAMnCM,OAAO6X,oBAAoB,iBAAkBziB,KAAK8vB,qBAClDllB,OAAOjG,iBAAiB,iBAAkB3E,KAAK8vB,qBAE/CG,oBACAM,0BACAL,2DAKAA,6DAKAtlB,OAAO6X,oBAAoB,iBAAkBziB,KAAK+wB,oBAGlDnmB,OAAOpF,cAAc4E,EAAYG,cAGjCvK,KAAK6K,SAAU7K,KAAK4K,OAAOomB,eACzBpmB,OAAOkB,wDAKRmlB,EAAejxB,KAAKF,SAAWwuB,EAAY4C,0BAE5C3F,YAAYxgB,aACf,aACAkmB,EACIjxB,KAAKwuB,KAAK2C,iBAAmB,oBAC7BnxB,KAAKwuB,KAAK4C,iBAAmB,0BAE9B7B,uBAAuBxkB,aAAa,cAAekmB,QACnDzB,uBAAuBzkB,aAAa,eAAgBkmB,uCAI/C1uB,GACVA,EAAMC,iBACND,EAAMwJ,uBAEDnB,OAAO5K,KAAK4K,OAAOC,OAAS,OAAS,+CAIhCtI,GACVA,EAAMwJ,kBAGDxJ,EAAM8uB,aAAgB9uB,EAAM6C,aAC1B+qB,YAAY5tB,6CAKHA,cAChBA,EAAMwJ,kBAEF/L,KAAK0vB,mBACH1vB,KAAKF,SAAWwuB,EAAY4C,qBAE9B5C,EAAYgD,kBAAkB9gB,KAAK7P,gBAG9B+uB,mBAAmBlf,KAAKxQ,KAAKF,aAG7ByrB,YAAYna,QAGjBmF,WAAW,WACTlE,EAAKkZ,YAAYna,SAChB,MAEIpR,KAAK4K,OAAO2mB,2BAEjBvxB,KAAK4K,OAAO4mB,gCAET5mB,OAAO6mB,4BAGP7mB,OAAO8mB,6BAGTnB,4DAKKhuB,OACJ8a,EAAsB9a,EAAtB8a,QAASsU,EAAapvB,EAAbovB,YAGbtU,GAAW,IAAMA,GAAW,GAAI,CAClC9a,EAAMC,qBAEAovB,EAAqB,KAAZvU,GAA8B,KAAZA,EAAiBA,EAAU,GAAKA,EAAU,QAEtEzS,OAAOqB,YAAcpJ,KAAKI,IAC7B,EACAJ,KAAKK,IACHlD,KAAK4K,OAAOM,SACZlL,KAAK4K,OAAOqB,YAAc2lB,GAAUD,EAAW,GAAK,UAInDzB,sEA5MAvvB,SAASkxB,mBACblxB,SAASmxB,yBAETnxB,SAASoxB,qEAILpxB,SAASqxB,gBACbrxB,SAASsxB,wBAETtxB,SAASuxB,gDAuMApyB,EAAQqyB,EAAaC,OAuB7BtwB,EACA4O,EACAC,EAvBE0hB,OAAkBrZ,IAAclZ,EAAOwyB,YACvCC,OAAgBvZ,IAAclZ,EAAO0yB,aACrCC,EAAcJ,EAChB,cACAE,EACE,aACA,YACAG,EAAcL,EAChB,cACAE,EACE,YACA,YACAI,EAAYN,EACd,YACAE,EACE,WACA,UAGAK,EAAW,mBAMRC,EAActwB,GAErBA,EAAMC,qBAGAswB,EAAWF,KAAYrwB,EACzBA,EAAMqwB,GACLrwB,EAAMG,SAAWH,EAAMG,QAAQ,IAAMH,EAAMG,QAAQ,GAAGkwB,IAClD,EAMTR,GAHoBU,EAAWpiB,IAAUC,EAAMD,aAuBxC4hB,IACPxwB,EAAO2gB,oBAAoBiQ,EAAaG,GACxC/wB,EAAO2gB,oBAAoBkQ,EAAWL,GAIxCxyB,EAAO6E,iBAAiB8tB,WAvBDlwB,GAErBT,EAAShC,EAAO6uB,cAAcoE,gBAGxB/lB,EAAOmlB,EAAY7vB,wBAGzBoO,EAAQ1D,EAAK7J,KACbwN,EAAM3D,EAAKU,MAEXmlB,EAActwB,GAEdT,EAAO6C,iBAAiB+tB,EAAaG,GACrC/wB,EAAO6C,iBAAiBguB,EAAWL,yCAsBpB7E,EAAMuF,EAAaC,mBAC1BpwB,KAAKsI,MAAMsiB,EAAO,gBAAOuF,eAAgBnwB,KAAKsI,MACtDsiB,EAAO,gBACJwF,YCzZTtyB,SAASgE,iBAAiB,mBCHA,WACxB2E,QAAQC,IAAI,wBDEmD,GAGjEzH,OAAO6C,iBAAiB,OEeK,WAC3B2E,QAAQC,IAAI,6BAGN2pB,EAAgBttB,MAAMiG,KAC1BlL,SAASqI,iBAAiB,wBAExBkqB,EAAc/pB,OAAS,IACzB+pB,EAAcxoB,QAAQ,SAACyoB,GAED,IAAI7E,GAAY6E,KAGtCxyB,SAASgE,iBAAiB,eAAgB,WACxC6F,EAAwB0oB,UAKtBE,EAAsBxtB,MAAMiG,KAChClL,SAASqI,iBAAiB,iCAExBoqB,EAAoBjqB,OAAS,GAC/BiqB,EAAoB1oB,QAAQ,SAAC2oB,GACD,IAAI5G,EAAkB4G,SAU9CC,EAAsB1tB,MAAMiG,KAAKlL,SAASqI,iBAC9C,iCAEEsqB,EAAoBnqB,OAAS,IAC/BmqB,EAAoB5oB,QAAQ,SAAC6oB,GACD,IAAI1F,EAAkB0F,KAGlD5yB,SAASgE,iBAAiB,eAAgB,WACxC6F,EAAwB8oB,UAKtBE,EAAqB7yB,SAASqI,iBAClC,8BAEEwqB,EAAmBrqB,OAAS,GAC9BvD,MAAMiG,KAAK2nB,GAAoB9oB,QAAQ,SAAC+oB,GACb,IAAIzH,EAAiByH,SAK5CC,EAAmB/yB,SAASqI,iBAAiB,yBAC/C0qB,EAAiBvqB,OAAS,MACvB,IAAID,EAAI,EAAGA,EAAIwqB,EAAiBvqB,OAAQD,GAAK,EACxB,IAAIxI,EAAgBgzB,EAAiBxqB,QAK3DyqB,EAAgBhzB,SAASqI,iBAAiB,iCAC5C2qB,EAAcxqB,OAAS,MACpB,IAAID,EAAI,EAAGA,EAAIyqB,EAAcxqB,OAAQD,GAAK,EACzB,IAAIQ,EAAYiqB,EAAczqB,QAKhD0qB,EAAYjzB,SAASqI,iBAAiB,+BACxC4qB,EAAUzqB,OAAS,MAChB,IAAID,EAAI,EAAGA,EAAI0qB,EAAUzqB,OAAQD,GAAK,EACzB,IAAI6kB,EAAQ6F,EAAU1qB,QAMX,IAA3B2qB,kBAAkBC,KAAe,KAE7B3H,EAAaxrB,SAASqI,iBAAiB,6BACzCmjB,EAAWhjB,OAAS,GACtBvD,MAAMiG,KAAKsgB,GAAYzhB,QAAQ,SAAC8hB,GACb,IAAIN,EAASM,SAK5BuH,EAAWpzB,SAASqI,iBAAiB,iBACvC+qB,EAAS5qB,OAAS,GACpBvD,MAAMiG,KAAKkoB,GAAUrpB,QAAQ,SAACkP,GACb,IAAID,EAAOC,SAKxBoa,EAAarzB,SAASqI,iBAAiB,2BACzCgrB,EAAW7qB,OAAS,GACtBvD,MAAMiG,KAAKmoB,GAAYtpB,QAAQ,SAACupB,OACxBpa,EAAWlZ,SAASR,sDACS8zB,EAAUroB,aACzC,4BAIa,IAAIqd,EACnBgL,EAAUroB,aAAa,qBACvBqoB,EACAna,KAAKC,MAAMF,EAASjO,aAAa,0BAE1B+F,aAKPuiB,EAAoBvzB,SAASqI,iBACjC,kCAGEkrB,EAAkB/qB,OAAS,GAC7BvD,MAAMiG,KAAKqoB,GAAmBxpB,QAAQ,SAACypB,OAC/Bta,EAAWlZ,SAASR,6DACgBg0B,EAAiBvoB,aACvD,mCAGoB,IAAI6Y,EAC1B0P,EAAiBvoB,aAAa,4BAC9BuoB,EACAra,KAAKC,MAAMF,EAASjO,aAAa,0BAEnB+F,aAKdyiB,EAAiBzzB,SAASqI,iBAC9B,+BAEEorB,EAAejrB,OAAS,GAC1BvD,MAAMiG,KAAKuoB,GAAgB1pB,QAAQ,SAAC2pB,OAC5Bxa,EAAWlZ,SAASR,0DACak0B,EAAc9kB,UAEhC,IAAIib,EACvB6J,EACAva,KAAKC,MAAMF,EAASjO,aAAa,0BAEtB+F,aAKXmC,EAAQnT,SAASqI,iBAAiB,wBACpC8K,EAAM3K,OAAS,EAAG,KAEd8H,EAActQ,SAASR,cAAc,sBACvC8Q,GACiB,IAAI4C,EAAc5C,EAAa6C,OAI/C,IAAI5K,EAAI,EAAGA,EAAI4K,EAAM3K,OAAQD,GAAK,EACzB,IAAIqI,EAAIuC,EAAM5K,QAKxBorB,EAAa3zB,SAASqI,iBAAiB,6BACzCsrB,EAAWnrB,OAAS,MACjB,IAAID,EAAI,EAAGA,EAAIorB,EAAWnrB,OAAQD,GAAK,EACzB,IAAIgD,EAASooB,EAAWprB,QAKvCqrB,EAAY5zB,SAASqI,iBAAiB,mBACxCurB,EAAUprB,OAAS,GACrBvD,MAAMiG,KAAK0oB,GAAW7pB,QAAQ,SAAC8c,OACvB3N,EAAW2N,EAASna,aAAa,wBACnCma,EAAS5b,aAAa,wBACtB,GACa,IAAI2a,EAASiB,EAAU1N,KAAKC,MAAMF,IAC1ClI,aAKP6iB,EAA0B7zB,SAASqI,iBACvC,4BAEEwrB,EAAwBrrB,OAAS,GACnCvD,MAAMiG,KAAK2oB,GAAyB9pB,QAAQ,SAAChF,GACb,IAAIkjB,EAAsBljB,GAClCiM,YFtNwB"}